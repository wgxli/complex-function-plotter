{"version":3,"sources":["gl-code/grammar.js","theme.js","components/ControlBar/ControlBar.js","gl-code/complex-functions.js","gl-code/translators/custom-functions.js","gl-code/translators/to-js.js","gl-code/translators/index.js","gl-code/shaders.js","gl-code/scene.js","components/util.js","components/FunctionPlot/CoordinateOverlay.js","components/FunctionPlot/index.js","components/SidePanel/SidePanel.js","gl-code/function-list.js","components/SliderPanel/VariableAdder.js","components/SliderPanel/editable-value/parsers.js","components/SliderPanel/editable-value/EditableValue.js","components/SliderPanel/slider/Slider.js","components/SliderPanel/SliderPanel.js","components/OptionsPanel/OptionsPanel.js","components/IntegralCalculator/ResultTooltip.js","components/IntegralCalculator/strategies/Strategy.js","components/IntegralCalculator/strategies/util.js","components/IntegralCalculator/strategies/Freeform.js","components/IntegralCalculator/strategies/Circle.js","components/IntegralCalculator/index.js","components/IntegralCalculator/strategies/FreeformClosed.js","components/IntegralCalculator/IntegralPanel.js","components/FunctionEditor/FunctionEditor.js","components/HelpText/HelpText.js","App.js","registerServiceWorker.js","index.js"],"names":["id","x","grammar","Lexer","undefined","ParserRules","d","concat","parseInt","join","parseFloat","data","l","reject","token","includes","ParserStart","module","exports","window","theme","createMuiTheme","palette","primary","blue","ControlPanel","event","this","props","onChange","target","value","disabled","onMenuButton","onHelpButton","error","AppBar","Toolbar","disableGutters","IconButton","onClick","TextField","placeholder","handleTextChange","autoFocus","fullWidth","Button","React","PureComponent","compiledGrammar","nearley","Grammar","fromCompiled","argument_names","ComplexFunction","name","body","dependencies","num_args","parameters","types","Array","fill","i","push","mul_i","reciprocal","cconj","cabs","carg","csgn","creal","cimag","cfloor","cceil","cround","cstep","ccis","cexp","clog","csqrt","csquare","csin","ccos","ctan","csec","ccsc","ccot","carcsin_bottom","carcsin_top","carcsin","carccos","carctan","carccot","carcsec","carccsc","csinh","ccosh","ctanh","csech","ccsch","ccoth","carsinh","carcosh","cartanh","carsech","carcsch","carcoth","cneg","cadd","csub","cmul","cdiv","cpow","cgamma","cgamma_left","cgamma_right","cfact","ceta","ceta_left","zeta_character","ceta_strip","innerWidth","ceta_right","czeta","rerf","cerf_large","cerf_small","cerf","ctheta00","ctheta01","ctheta10","ctheta11","theta000","invert_tau","jacobi_reduce","invert_code","raw_sn","raw_cn","raw_dn","csn","ccn","cdn","cwp","complex_functions","raw_wpp","parseExpression","expression","parser","Parser","feed","results","console","functionDefinitions","ast","required","isArray","getRequirements","Set","requirements","slice","req","add","stack","from","length","f","pop","dep","has","Object","keys","log","functions","map","declarations","declaration","definitions","code","declarationString","definitionString","math","require","I","complex","sum","subtract","divide","multiply","sin","exp","sqrt","pow","z","gamma_right","gamma","re","pi","gamma_left","ETA_COEFFICIENTS","eta_right","a","b","eta","eta_left","w","neg","zp1","im","conj","component_a","log_r","abs","theta","arg","Math","PI","component_b","multiplier_a","multiplier_b","LN2","component","multiplier","theta00","tau","result","n","A","B","C","theta01","theta10","theta11","k","root_k","q","t00","zz","round","e2","e1","e3","cm","fns","sub","unaryMinus","mul","div","real","imag","step","arcsin","asin","arccos","acos","arctan","atan","arcsec","asec","arccsc","acsc","arccot","acot","arsinh","asinh","arcosh","acosh","artanh","atanh","arsech","asech","arcsch","acsch","arcoth","acoth","cis","zeta","erf","erf_large","W","W_BAR","rs","r","s","CS","cos","I0","I1","integral","TWO_SQRTPI","K","series","kk","factorial","sn","cn","dn","wp","t002","t102","wpp","t004","t104","t014","PI2_3","sm","toJS","variables","errorValue","NaN","constants","E","operator","args","get","func","isNil","destructure","subtree","toGLSL","infixOperators","toUpperCase","loadShader","gl","type","source","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","deleteShader","createShaderProgram","customShader","variableNames","fragmentShaderSource","width","height","x_offset","toFixed","y_offset","dpr","devicePixelRatio","variableDeclarations","custom_code","glsl_expression","getFragmentShaderSource","drawingBufferWidth","drawingBufferHeight","vertexShader","VERTEX_SHADER","vertexShaderSource","fragmentShader","FRAGMENT_SHADER","shaderProgram","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","initializeScene","vertexBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","initBuffers","useProgram","positionLocation","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","FLOAT","variableLocations","getUniformLocation","drawScene","axis_ctx","values","location","uniform2f","drawArrays","TRIANGLES","ctx","innerHeight","clearRect","enable_axes","scale","log_scale","rawLogLabelScale","logLabelScale","labelScale","x0","center_x","y0","center_y","x_min","x_max","y_min","y_max","horizontalLine","y","yy","moveTo","lineTo","verticalLine","lineWidth","xx","xLabel","dy","min","max","label","replace","textWidth","measureText","textAlign","strokeText","fillText","yLabel","iWidth","alignLeft","dx","font","clearWidth","textOffset","iOffset","globalAlpha","strokeStyle","beginPath","ceil","stroke","fillStyle","lineJoin","drawAxes","formatComplex","precision","formatReal","CONSTANTS","almostInteger","forceSign","magnitude","sign","prettyMagnitude","entries","denominator","ratio","numerator","toString","formatInteger","checkKnown","exponent","floor","log10","CoordinateOverlay","state","faded","fadeTimer","lastX","lastY","changed","componentDidUpdate","hasChanged","clearTimeout","setTimeout","setState","mapping","u","v","className","isFinite","canvasSize","pixelToPlot","offset_x","offset_y","FunctionPlot","position","mouseDown","initialized","lastUpdate","addEventListener","compilePlot","bind","initializeWebGL","onError","initializePlot","updatePlot","lastExpression","mouseEvent","nativeEvent","targetTouches","touches","pageX","pageY","x1","y1","hypot","getPosition","wheelEvent","deltaLogScale","every","mouse_plotx","mouse_ploty","deltaY","x_shift","y_shift","updatePosition","logDistance","deltaPosition","handleZoom","handleMouseDown","handleMouseMove","handleMouseUp","update","canvas","refs","axes","getContext","offsetWidth","offsetHeight","viewport","custom_function","variableAssignments","now","Date","ref","onMouseDown","onMouseMove","onMouseUp","onMouseEnter","onMouseLeave","onTouchStart","handleTouchStart","onTouchMove","handleTouchMove","onTouchEnd","handleTouchEnd","onWheel","jsx","SidePanel","classes","updateWidth","transitionWidth","Drawer","anchor","open","variant","paper","toolbar","children","SwipeableDrawer","onOpen","onToggle","onClose","disableDiscovery","disableSwipeToOpen","withStyles","mixins","restrictedFunctions","functionList","blacklist","VariableAdder","errorMessage","keyCode","handleClick","toLowerCase","match","setValue","ListItem","css","onKeyDown","handleKeyPress","helperText","parsers","number","text","parsed","Number","isNaN","lower","EditableValue","focused","element","createRef","DEFAULT_PARSERS","getParser","parsedValue","document","e","key","current","blur","reset","valid","classString","setAttribute","displayText","html","onFocus","handleFocus","handleChange","onBlur","handleBlur","tagName","innerRef","SPEEDS","AnimationMode","mode","speed","onChangeMode","onChangeSpeed","nextMode","Icon","PlayIcon","BounceIcon","LoopIcon","Slider","animationMode","animationSpeed","animationCurrentDirection","deleted","ensureConsistency","timestamp","dt","lastAnimationTick","newValue","requestAnimationFrame","runAnimationTick","onNameChange","setMin","setMax","onDelete","hiddenVariables","SliderPanel","textField","onUpdate","forceUpdate","sliderList","onRemove","List","ListSubheader","disableSticky","renderSliderList","onAdd","Component","BooleanOption","checked","button","Checkbox","ListItemText","OptionsPanel","options","variable","heading","renderOptions","PREFIX","style","contents","Strategy","initialize","clientX","clientY","integrate","draw","GAUSS_COEFFICIENTS","integrateReal","start","end","weight","abscissa","FreeformIntegrator","accumulator","lastPoint","lastPagePoint","df","t","integrateSegment","kahanSum","list","c","STRATEGY_DICT","FreeformStrategy","startPoint","startPagePoint","Freeform","center","radius","pageCenter","pageRadius","arc","integrand","gammaPrime","up","vp","scaleFactor","summands","IntegralCalculator","done","mousePosition","strategy","integrator","resizeCanvas","context","finish","resetState","tooltip","snap","ResultTooltip","top","left","zIndex","calculators","icon","IntegralPanel","entry","hidePanels","openCalculator","ListItemIcon","paddingLeft","renderIntegrator","Typography","onValueChange","highlight","languages","glsl","padding","fontFamily","fontSize","backgroundColor","color","marginTop","borderRadius","SyntaxHighlighter","registerLanguage","glslHighlighter","supportedFunctions","EXAMPLES","HelpText","setExpression","closeMenu","Chip","showExample","chip","sections","section","renderChips","src","alt","href","renderSupportedFunctions","marginBottom","buttonStyle","Accordion","margin","AccordionSummary","expandIcon","AccordionDetails","language","docco","typography","defaultShader","App","expressionText","expressionError","typingTimer","shaderError","menuOpen","helpOpen","integrationStrategy","enable_checkerboard","invert_gradient","continuous_gradient","handleHashChange","preventDefault","passive","plot","handleVariableUpdate","message","hash","decodeURIComponent","fromHash","history","replaceState","encodeURIComponent","trim","extractVariables","output","newVariables","finalizeExpression","FunctionEditor","setCustomShader","useCustomShader","ControlBar","handleMenuButton","handleHelpButton","handleVariableAdd","handleVariableRemove","handleOptionToggle","renderFunctionEditor","setErrorMessage","Boolean","hostname","render","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.06079005.chunk.js","sourcesContent":["// Generated automatically by nearley, version 2.20.1\n// http://github.com/Hardmath123/nearley\n(function () {\nfunction id(x) { return x[0]; }\nvar grammar = {\n    Lexer: undefined,\n    ParserRules: [\n    {\"name\": \"_$ebnf$1\", \"symbols\": []},\n    {\"name\": \"_$ebnf$1\", \"symbols\": [\"_$ebnf$1\", \"wschar\"], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"_\", \"symbols\": [\"_$ebnf$1\"], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"__$ebnf$1\", \"symbols\": [\"wschar\"]},\n    {\"name\": \"__$ebnf$1\", \"symbols\": [\"__$ebnf$1\", \"wschar\"], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"__\", \"symbols\": [\"__$ebnf$1\"], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"wschar\", \"symbols\": [/[ \\t\\n\\v\\f]/], \"postprocess\": id},\n    {\"name\": \"unsigned_int$ebnf$1\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"unsigned_int$ebnf$1\", \"symbols\": [\"unsigned_int$ebnf$1\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"unsigned_int\", \"symbols\": [\"unsigned_int$ebnf$1\"], \"postprocess\": \n        function(d) {\n            return parseInt(d[0].join(\"\"));\n        }\n        },\n    {\"name\": \"int$ebnf$1$subexpression$1\", \"symbols\": [{\"literal\":\"-\"}]},\n    {\"name\": \"int$ebnf$1$subexpression$1\", \"symbols\": [{\"literal\":\"+\"}]},\n    {\"name\": \"int$ebnf$1\", \"symbols\": [\"int$ebnf$1$subexpression$1\"], \"postprocess\": id},\n    {\"name\": \"int$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"int$ebnf$2\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"int$ebnf$2\", \"symbols\": [\"int$ebnf$2\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"int\", \"symbols\": [\"int$ebnf$1\", \"int$ebnf$2\"], \"postprocess\": \n        function(d) {\n            if (d[0]) {\n                return parseInt(d[0][0]+d[1].join(\"\"));\n            } else {\n                return parseInt(d[1].join(\"\"));\n            }\n        }\n        },\n    {\"name\": \"unsigned_decimal$ebnf$1\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"unsigned_decimal$ebnf$1\", \"symbols\": [\"unsigned_decimal$ebnf$1\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"unsigned_decimal$ebnf$2$subexpression$1$ebnf$1\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"unsigned_decimal$ebnf$2$subexpression$1$ebnf$1\", \"symbols\": [\"unsigned_decimal$ebnf$2$subexpression$1$ebnf$1\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"unsigned_decimal$ebnf$2$subexpression$1\", \"symbols\": [{\"literal\":\".\"}, \"unsigned_decimal$ebnf$2$subexpression$1$ebnf$1\"]},\n    {\"name\": \"unsigned_decimal$ebnf$2\", \"symbols\": [\"unsigned_decimal$ebnf$2$subexpression$1\"], \"postprocess\": id},\n    {\"name\": \"unsigned_decimal$ebnf$2\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"unsigned_decimal\", \"symbols\": [\"unsigned_decimal$ebnf$1\", \"unsigned_decimal$ebnf$2\"], \"postprocess\": \n        function(d) {\n            return parseFloat(\n                d[0].join(\"\") +\n                (d[1] ? \".\"+d[1][1].join(\"\") : \"\")\n            );\n        }\n        },\n    {\"name\": \"decimal$ebnf$1\", \"symbols\": [{\"literal\":\"-\"}], \"postprocess\": id},\n    {\"name\": \"decimal$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"decimal$ebnf$2\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"decimal$ebnf$2\", \"symbols\": [\"decimal$ebnf$2\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"decimal$ebnf$3$subexpression$1$ebnf$1\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"decimal$ebnf$3$subexpression$1$ebnf$1\", \"symbols\": [\"decimal$ebnf$3$subexpression$1$ebnf$1\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"decimal$ebnf$3$subexpression$1\", \"symbols\": [{\"literal\":\".\"}, \"decimal$ebnf$3$subexpression$1$ebnf$1\"]},\n    {\"name\": \"decimal$ebnf$3\", \"symbols\": [\"decimal$ebnf$3$subexpression$1\"], \"postprocess\": id},\n    {\"name\": \"decimal$ebnf$3\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"decimal\", \"symbols\": [\"decimal$ebnf$1\", \"decimal$ebnf$2\", \"decimal$ebnf$3\"], \"postprocess\": \n        function(d) {\n            return parseFloat(\n                (d[0] || \"\") +\n                d[1].join(\"\") +\n                (d[2] ? \".\"+d[2][1].join(\"\") : \"\")\n            );\n        }\n        },\n    {\"name\": \"percentage\", \"symbols\": [\"decimal\", {\"literal\":\"%\"}], \"postprocess\": \n        function(d) {\n            return d[0]/100;\n        }\n        },\n    {\"name\": \"jsonfloat$ebnf$1\", \"symbols\": [{\"literal\":\"-\"}], \"postprocess\": id},\n    {\"name\": \"jsonfloat$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"jsonfloat$ebnf$2\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"jsonfloat$ebnf$2\", \"symbols\": [\"jsonfloat$ebnf$2\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"jsonfloat$ebnf$3$subexpression$1$ebnf$1\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"jsonfloat$ebnf$3$subexpression$1$ebnf$1\", \"symbols\": [\"jsonfloat$ebnf$3$subexpression$1$ebnf$1\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"jsonfloat$ebnf$3$subexpression$1\", \"symbols\": [{\"literal\":\".\"}, \"jsonfloat$ebnf$3$subexpression$1$ebnf$1\"]},\n    {\"name\": \"jsonfloat$ebnf$3\", \"symbols\": [\"jsonfloat$ebnf$3$subexpression$1\"], \"postprocess\": id},\n    {\"name\": \"jsonfloat$ebnf$3\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"jsonfloat$ebnf$4$subexpression$1$ebnf$1\", \"symbols\": [/[+-]/], \"postprocess\": id},\n    {\"name\": \"jsonfloat$ebnf$4$subexpression$1$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"jsonfloat$ebnf$4$subexpression$1$ebnf$2\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"jsonfloat$ebnf$4$subexpression$1$ebnf$2\", \"symbols\": [\"jsonfloat$ebnf$4$subexpression$1$ebnf$2\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"jsonfloat$ebnf$4$subexpression$1\", \"symbols\": [/[eE]/, \"jsonfloat$ebnf$4$subexpression$1$ebnf$1\", \"jsonfloat$ebnf$4$subexpression$1$ebnf$2\"]},\n    {\"name\": \"jsonfloat$ebnf$4\", \"symbols\": [\"jsonfloat$ebnf$4$subexpression$1\"], \"postprocess\": id},\n    {\"name\": \"jsonfloat$ebnf$4\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"jsonfloat\", \"symbols\": [\"jsonfloat$ebnf$1\", \"jsonfloat$ebnf$2\", \"jsonfloat$ebnf$3\", \"jsonfloat$ebnf$4\"], \"postprocess\": \n        function(d) {\n            return parseFloat(\n                (d[0] || \"\") +\n                d[1].join(\"\") +\n                (d[2] ? \".\"+d[2][1].join(\"\") : \"\") +\n                (d[3] ? \"e\" + (d[3][1] || \"+\") + d[3][2].join(\"\") : \"\")\n            );\n        }\n        },\n    {\"name\": \"sum\", \"symbols\": [\"sum\", \"_\", \"sumOperator\", \"_\", \"product\"], \"postprocess\": \n        (data) => [data[2], data[0], data[4]]\n            },\n    {\"name\": \"sum\", \"symbols\": [\"product\"], \"postprocess\": id},\n    {\"name\": \"product\", \"symbols\": [\"product\", \"_\", \"productOperator\", \"_\", \"power\"], \"postprocess\": \n        (data) => [data[2], data[0], data[4]]\n            },\n    {\"name\": \"product\", \"symbols\": [{\"literal\":\"-\"}, \"_\", \"power\"], \"postprocess\": data => ['neg', data[2]]},\n    {\"name\": \"product\", \"symbols\": [\"power\"], \"postprocess\": id},\n    {\"name\": \"power\", \"symbols\": [\"function\", \"_\", \"powerOperator\", \"_\", \"power\"], \"postprocess\": \n        (data) => ['pow', data[0], data[4]]\n            },\n    {\"name\": \"power\", \"symbols\": [\"function\"], \"postprocess\": id},\n    {\"name\": \"function\", \"symbols\": [\"unaryFunction\", {\"literal\":\"(\"}, \"sum\", {\"literal\":\")\"}], \"postprocess\": data => [data[0][0], data[2]]},\n    {\"name\": \"function\", \"symbols\": [\"unaryFunction\", {\"literal\":\"[\"}, \"sum\", {\"literal\":\"]\"}], \"postprocess\": data => [data[0][0], data[2]]},\n    {\"name\": \"function\", \"symbols\": [\"binaryFunction\", {\"literal\":\"(\"}, \"sum\", {\"literal\":\",\"}, \"_\", \"sum\", {\"literal\":\")\"}], \"postprocess\": data => [data[0][0], data[2], data[5]]},\n    {\"name\": \"function\", \"symbols\": [\"binaryFunction\", {\"literal\":\"[\"}, \"sum\", {\"literal\":\",\"}, \"_\", \"sum\", {\"literal\":\"]\"}], \"postprocess\": data => [data[0][0], data[2], data[5]]},\n    {\"name\": \"function\", \"symbols\": [\"parenthesis\"], \"postprocess\": id},\n    {\"name\": \"parenthesis\", \"symbols\": [{\"literal\":\"(\"}, \"sum\", {\"literal\":\")\"}], \"postprocess\": (data) => data[1]},\n    {\"name\": \"parenthesis\", \"symbols\": [{\"literal\":\"[\"}, \"sum\", {\"literal\":\"]\"}], \"postprocess\": (data) => data[1]},\n    {\"name\": \"parenthesis\", \"symbols\": [\"literal\"], \"postprocess\": id},\n    {\"name\": \"parenthesis\", \"symbols\": [\"literal\", {\"literal\":\"!\"}], \"postprocess\": (data) => ['factorial', data[0]]},\n    {\"name\": \"sumOperator\", \"symbols\": [{\"literal\":\"+\"}], \"postprocess\": () => 'add'},\n    {\"name\": \"sumOperator\", \"symbols\": [{\"literal\":\"-\"}], \"postprocess\": () => 'sub'},\n    {\"name\": \"sumOperator\", \"symbols\": [{\"literal\":\"−\"}], \"postprocess\": () => 'sub'},\n    {\"name\": \"productOperator\", \"symbols\": [{\"literal\":\"*\"}], \"postprocess\": () => 'mul'},\n    {\"name\": \"productOperator\", \"symbols\": [{\"literal\":\"×\"}], \"postprocess\": () => 'mul'},\n    {\"name\": \"productOperator\", \"symbols\": [{\"literal\":\"/\"}], \"postprocess\": () => 'div'},\n    {\"name\": \"powerOperator$string$1\", \"symbols\": [{\"literal\":\"*\"}, {\"literal\":\"*\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"powerOperator\", \"symbols\": [\"powerOperator$string$1\"]},\n    {\"name\": \"powerOperator\", \"symbols\": [{\"literal\":\"^\"}]},\n    {\"name\": \"binaryFunction$string$1\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"n\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$1\"]},\n    {\"name\": \"binaryFunction$string$2\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"n\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$2\"]},\n    {\"name\": \"binaryFunction$string$3\", \"symbols\": [{\"literal\":\"d\"}, {\"literal\":\"n\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$3\"]},\n    {\"name\": \"binaryFunction$string$4\", \"symbols\": [{\"literal\":\"w\"}, {\"literal\":\"p\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$4\"]},\n    {\"name\": \"binaryFunction$string$5\", \"symbols\": [{\"literal\":\"w\"}, {\"literal\":\"p\"}, {\"literal\":\"'\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$5\"], \"postprocess\": () => ['wpp']},\n    {\"name\": \"binaryFunction$string$6\", \"symbols\": [{\"literal\":\"t\"}, {\"literal\":\"h\"}, {\"literal\":\"e\"}, {\"literal\":\"t\"}, {\"literal\":\"a\"}, {\"literal\":\"0\"}, {\"literal\":\"0\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$6\"]},\n    {\"name\": \"binaryFunction$string$7\", \"symbols\": [{\"literal\":\"t\"}, {\"literal\":\"h\"}, {\"literal\":\"e\"}, {\"literal\":\"t\"}, {\"literal\":\"a\"}, {\"literal\":\"0\"}, {\"literal\":\"1\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$7\"]},\n    {\"name\": \"binaryFunction$string$8\", \"symbols\": [{\"literal\":\"t\"}, {\"literal\":\"h\"}, {\"literal\":\"e\"}, {\"literal\":\"t\"}, {\"literal\":\"a\"}, {\"literal\":\"1\"}, {\"literal\":\"0\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$8\"]},\n    {\"name\": \"binaryFunction$string$9\", \"symbols\": [{\"literal\":\"t\"}, {\"literal\":\"h\"}, {\"literal\":\"e\"}, {\"literal\":\"t\"}, {\"literal\":\"a\"}, {\"literal\":\"1\"}, {\"literal\":\"1\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$9\"]},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"trigFunction\"]},\n    {\"name\": \"unaryFunction$string$1\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"i\"}, {\"literal\":\"s\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$1\"]},\n    {\"name\": \"unaryFunction$string$2\", \"symbols\": [{\"literal\":\"e\"}, {\"literal\":\"x\"}, {\"literal\":\"p\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$2\"]},\n    {\"name\": \"unaryFunction$string$3\", \"symbols\": [{\"literal\":\"l\"}, {\"literal\":\"o\"}, {\"literal\":\"g\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$3\"]},\n    {\"name\": \"unaryFunction$string$4\", \"symbols\": [{\"literal\":\"l\"}, {\"literal\":\"n\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$4\"], \"postprocess\": () => ['log']},\n    {\"name\": \"unaryFunction$string$5\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"q\"}, {\"literal\":\"r\"}, {\"literal\":\"t\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$5\"]},\n    {\"name\": \"unaryFunction$string$6\", \"symbols\": [{\"literal\":\"g\"}, {\"literal\":\"a\"}, {\"literal\":\"m\"}, {\"literal\":\"m\"}, {\"literal\":\"a\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$6\"]},\n    {\"name\": \"unaryFunction$string$7\", \"symbols\": [{\"literal\":\"e\"}, {\"literal\":\"t\"}, {\"literal\":\"a\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$7\"]},\n    {\"name\": \"unaryFunction$string$8\", \"symbols\": [{\"literal\":\"z\"}, {\"literal\":\"e\"}, {\"literal\":\"t\"}, {\"literal\":\"a\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$8\"]},\n    {\"name\": \"unaryFunction$string$9\", \"symbols\": [{\"literal\":\"e\"}, {\"literal\":\"r\"}, {\"literal\":\"f\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$9\"]},\n    {\"name\": \"unaryFunction$string$10\", \"symbols\": [{\"literal\":\"a\"}, {\"literal\":\"b\"}, {\"literal\":\"s\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$10\"]},\n    {\"name\": \"unaryFunction$string$11\", \"symbols\": [{\"literal\":\"a\"}, {\"literal\":\"r\"}, {\"literal\":\"g\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$11\"]},\n    {\"name\": \"unaryFunction$string$12\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"g\"}, {\"literal\":\"n\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$12\"]},\n    {\"name\": \"unaryFunction$string$13\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"o\"}, {\"literal\":\"n\"}, {\"literal\":\"j\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$13\"]},\n    {\"name\": \"unaryFunction$string$14\", \"symbols\": [{\"literal\":\"r\"}, {\"literal\":\"e\"}, {\"literal\":\"a\"}, {\"literal\":\"l\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$14\"]},\n    {\"name\": \"unaryFunction$string$15\", \"symbols\": [{\"literal\":\"i\"}, {\"literal\":\"m\"}, {\"literal\":\"a\"}, {\"literal\":\"g\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$15\"]},\n    {\"name\": \"unaryFunction$string$16\", \"symbols\": [{\"literal\":\"f\"}, {\"literal\":\"l\"}, {\"literal\":\"o\"}, {\"literal\":\"o\"}, {\"literal\":\"r\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$16\"]},\n    {\"name\": \"unaryFunction$string$17\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"e\"}, {\"literal\":\"i\"}, {\"literal\":\"l\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$17\"]},\n    {\"name\": \"unaryFunction$string$18\", \"symbols\": [{\"literal\":\"r\"}, {\"literal\":\"o\"}, {\"literal\":\"u\"}, {\"literal\":\"n\"}, {\"literal\":\"d\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$18\"]},\n    {\"name\": \"unaryFunction$string$19\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"t\"}, {\"literal\":\"e\"}, {\"literal\":\"p\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$19\"]},\n    {\"name\": \"unaryFunction$string$20\", \"symbols\": [{\"literal\":\"r\"}, {\"literal\":\"e\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$20\"], \"postprocess\": () => ['real']},\n    {\"name\": \"unaryFunction$string$21\", \"symbols\": [{\"literal\":\"i\"}, {\"literal\":\"m\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$21\"], \"postprocess\": () => ['imag']},\n    {\"name\": \"unaryFunction$string$22\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"m\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$22\"]},\n    {\"name\": \"unaryFunction$string$23\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"m\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$23\"]},\n    {\"name\": \"baseTrigFunction$string$1\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"i\"}, {\"literal\":\"n\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"baseTrigFunction\", \"symbols\": [\"baseTrigFunction$string$1\"]},\n    {\"name\": \"baseTrigFunction$string$2\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"o\"}, {\"literal\":\"s\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"baseTrigFunction\", \"symbols\": [\"baseTrigFunction$string$2\"]},\n    {\"name\": \"baseTrigFunction$string$3\", \"symbols\": [{\"literal\":\"t\"}, {\"literal\":\"a\"}, {\"literal\":\"n\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"baseTrigFunction\", \"symbols\": [\"baseTrigFunction$string$3\"]},\n    {\"name\": \"baseTrigFunction$string$4\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"e\"}, {\"literal\":\"c\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"baseTrigFunction\", \"symbols\": [\"baseTrigFunction$string$4\"]},\n    {\"name\": \"baseTrigFunction$string$5\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"s\"}, {\"literal\":\"c\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"baseTrigFunction\", \"symbols\": [\"baseTrigFunction$string$5\"]},\n    {\"name\": \"baseTrigFunction$string$6\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"o\"}, {\"literal\":\"t\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"baseTrigFunction\", \"symbols\": [\"baseTrigFunction$string$6\"]},\n    {\"name\": \"hyperbolicTrigFunction\", \"symbols\": [\"baseTrigFunction\", {\"literal\":\"h\"}], \"postprocess\": (data) => data.join('')},\n    {\"name\": \"trigFunction$ebnf$1$string$1\", \"symbols\": [{\"literal\":\"a\"}, {\"literal\":\"r\"}, {\"literal\":\"c\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"trigFunction$ebnf$1\", \"symbols\": [\"trigFunction$ebnf$1$string$1\"], \"postprocess\": id},\n    {\"name\": \"trigFunction$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"trigFunction\", \"symbols\": [\"trigFunction$ebnf$1\", \"baseTrigFunction\"], \"postprocess\": (data) => data.join('')},\n    {\"name\": \"trigFunction\", \"symbols\": [{\"literal\":\"a\"}, \"baseTrigFunction\"], \"postprocess\": (data) => 'arc' + data[1]},\n    {\"name\": \"trigFunction$ebnf$2$string$1\", \"symbols\": [{\"literal\":\"a\"}, {\"literal\":\"r\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"trigFunction$ebnf$2\", \"symbols\": [\"trigFunction$ebnf$2$string$1\"], \"postprocess\": id},\n    {\"name\": \"trigFunction$ebnf$2\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"trigFunction\", \"symbols\": [\"trigFunction$ebnf$2\", \"hyperbolicTrigFunction\"], \"postprocess\": (data) => data.join('')},\n    {\"name\": \"literal\", \"symbols\": [\"complexNumber\"], \"postprocess\": id},\n    {\"name\": \"literal\", \"symbols\": [\"variable\"], \"postprocess\": id},\n    {\"name\": \"variable$ebnf$1\", \"symbols\": [/[a-z]/]},\n    {\"name\": \"variable$ebnf$1\", \"symbols\": [\"variable$ebnf$1\", /[a-z]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"variable\", \"symbols\": [\"variable$ebnf$1\"], \"postprocess\": \n        function(data, l, reject) {\n            const constants = ['e', 'pi', 'tau', 'phi'];\n            const token = data[0].join('')\n            if (token === 'i') {return reject;}\n            return constants.includes(token) ? ['constant', token] : ['variable', token];\n        }\n        },\n    {\"name\": \"complexNumber\", \"symbols\": [\"decimal\"], \"postprocess\": (data) => ['number', data[0], 0]},\n    {\"name\": \"complexNumber\", \"symbols\": [\"decimal\", {\"literal\":\"i\"}], \"postprocess\": (data) => ['number', 0, data[0]]},\n    {\"name\": \"complexNumber\", \"symbols\": [{\"literal\":\"i\"}], \"postprocess\": () => ['number', 0, 1]}\n]\n  , ParserStart: \"sum\"\n}\nif (typeof module !== 'undefined'&& typeof module.exports !== 'undefined') {\n   module.exports = grammar;\n} else {\n   window.grammar = grammar;\n}\n})();\n","import createMuiTheme from '@material-ui/core/styles/createMuiTheme';\nimport blue from '@material-ui/core/colors/blue';\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: blue,\n  },\n});\n\nexport default theme;\n","import React from 'react';\n\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport IconButton from '@material-ui/core/IconButton';\n\nimport MenuIcon from '@material-ui/icons/Menu';\n\nimport './control-bar.css';\n\n\nclass ControlPanel extends React.PureComponent {\n  handleTextChange(event) {\n    this.props.onChange(event.target.value);\n  }\n\n  render() {\n      const {disabled, onMenuButton, onHelpButton, error, value} = this.props;\n      return (\n        <AppBar id='app-bar'>\n          <Toolbar disableGutters>\n            <IconButton\n              onClick={onMenuButton}\n            >\n              <MenuIcon/>\n            </IconButton>\n            <div id='function-input'>\n              <TextField\n                  id='function-input'\n                  placeholder='Enter a complex function of z'\n                  value={value}\n                  onChange={(event) => this.handleTextChange(event)}\n                  error={error}\n                  autoFocus\n                  fullWidth\n                  disabled={disabled}\n              />\n            </div>\n            <div id='help-button'>\n                <Button onClick={onHelpButton}>Help</Button>\n            </div>\n          </Toolbar>\n        </AppBar>\n      );\n  }\n}\n\nexport default ControlPanel;\n","import nearley from 'nearley';\nimport grammar from './grammar.js';\n\nconst compiledGrammar = nearley.Grammar.fromCompiled(grammar);\n\nconst argument_names = ['z', 'w', 'w1', 'w2'];\n\nclass ComplexFunction {\n    constructor(name, body, dependencies, num_args) {\n        if (num_args === undefined) {num_args = 1;}\n\n        this.name = name;\n        this.body = body;\n        this.dependencies = dependencies || [];\n        this.num_args = num_args;\n    }\n\n    apply(...parameters) {\n        return `${this.name}(${parameters.join(', ')})`;\n    }\n\n    get declaration() {\n        let types = Array(this.num_args);\n        types.fill('vec2');\n        return `vec2 ${this.name}(${types.join(', ')});`\n    }\n\n    get code() {\n        let parameters = [];\n        for (let i = 0; i < this.num_args; i++) {\n            parameters.push(`vec2 ${argument_names[i]}`);\n        }\n        return `vec2 ${this.name}(${parameters.join(', ')}) {${this.body}}`;\n    }\n}\n\n\n// DEFINITIONS //\n\n// Miscellaneous\nconst mul_i = new ComplexFunction('mul_i', 'return vec2(-z.y, z.x);');\nconst reciprocal = new ComplexFunction('reciprocal', 'return cconj(z) / dot(z, z);', ['conj']);\nconst cconj = new ComplexFunction('cconj', 'return z * vec2(1.0, -1.0);');\nconst cabs = new ComplexFunction('cabs', 'return vec2(length(z), 0);');\nconst carg = new ComplexFunction('carg', 'return vec2(atan(z.y, z.x), 0);');\nconst csgn = new ComplexFunction('csgn', 'return z/length(z);');\nconst creal = new ComplexFunction('creal', 'return vec2(z.x, 0);');\nconst cimag = new ComplexFunction('cimag', 'return vec2(z.y, 0);');\nconst cfloor = new ComplexFunction('cfloor', 'return floor(z);');\nconst cceil = new ComplexFunction('cceil', 'return ceil(z);');\nconst cround = new ComplexFunction('cround', 'return floor(z + vec2(0.5, 0.5));');\nconst cstep = new ComplexFunction('cstep', 'return vec2(step(0.0, z.x), 0.0);');\n\n// Exponentials\nconst ccis = new ComplexFunction('ccis',\n    'return cexp(mul_i(z));',\n    ['exp', 'mul_i']);\nconst cexp = new ComplexFunction('cexp',\n`float magnitude = exp(z.x);\nfloat phase = z.y;\nreturn magnitude * vec2(cos(phase), sin(phase));`);\nconst clog = new ComplexFunction('clog',\n`float magnitude = log(length(z));\nfloat phase = atan(z.y, z.x);\nreturn vec2(magnitude, phase);`);\nconst csqrt = new ComplexFunction('csqrt',\n`float magnitude = length(z);\nfloat phase = 0.5 * atan(z.y, z.x);\nreturn sqrt(magnitude) * vec2(cos(phase), sin(phase));`);\nconst csquare = new ComplexFunction('csquare',\n`float magnitude = length(z);\nfloat phase = atan(z.y, z.x) * 2.0;\nreturn (magnitude * magnitude) * vec2(cos(phase), sin(phase));`);\n\n// Trigonometry //\n// Basic Trigonometric Functions\nconst csin = new ComplexFunction('csin',\n`vec2 iz = mul_i(z);\nreturn -0.5 * mul_i(cexp(iz) - cexp(-iz));`, ['mul_i', 'exp']);\nconst ccos = new ComplexFunction('ccos',\n`vec2 iz = mul_i(z);\nreturn 0.5 * (cexp(iz) + cexp(-iz));`, ['mul_i', 'exp']);\nconst ctan = new ComplexFunction('ctan', 'return mul_i(ctanh(-mul_i(z)));', ['mul_i', 'tanh']);\nconst csec = new ComplexFunction('csec', 'return reciprocal(ccos(z));',\n    ['reciprocal', 'cos']);\nconst ccsc = new ComplexFunction('ccsc', 'return reciprocal(csin(z));',\n    ['reciprocal', 'sin']);\nconst ccot = new ComplexFunction('ccot', 'return reciprocal(ctan(z));',\n    ['reciprocal', 'tan']);\n\n// Inverse Trigonomeric Functions\nconst carcsin_bottom = new ComplexFunction('carcsin_bottom',\n    'return -mul_i(clog(mul_i(z) + csqrt(ONE - csquare(z))));',\n     ['mul_i', 'log', 'sqrt', 'square']);\nconst carcsin_top = new ComplexFunction('carcsin_top',\n    'return -mul_i(clog(reciprocal(csqrt(ONE - csquare(z)) - mul_i(z))));',\n    ['mul_i', 'log', 'reciprocal', 'square']);\nconst carcsin = new ComplexFunction('carcsin',\n    'if (z.y < 0.0) {return carcsin_bottom(z);} else {return carcsin_top(z);}',\n    ['carcsin_bottom', 'carcsin_top']);\n\n\nconst carccos = new ComplexFunction('carccos',\n`vec2 b = csqrt(csquare(z) - ONE);\nvec2 a = z + b;\nif (z.x < 0.0) {a = z - b;}\nreturn -mul_i(clog(a));`,\n['mul_i', 'log', 'sqrt', 'square']);\nconst carctan = new ComplexFunction('carctan',\n`vec2 iz = mul_i(z);\nreturn 0.5 * mul_i(clog(ONE - iz) - clog(ONE + iz));`,\n['mul_i', 'log']);\n\nconst carccot = new ComplexFunction('carccot', 'return carctan(reciprocal(z));', ['arctan', 'reciprocal']);\nconst carcsec = new ComplexFunction('carcsec', 'return carccos(reciprocal(z));', ['arccos', 'reciprocal']);\nconst carccsc = new ComplexFunction('carccsc', 'return carcsin(reciprocal(z));', ['arcsin', 'reciprocal']);\n\n\n// Hyperbolic Trigonometric Functions\nconst csinh = new ComplexFunction('csinh',\n    'return 0.5 * (cexp(z) - cexp(-z));', ['exp']);\nconst ccosh = new ComplexFunction('ccosh',\n    'return 0.5 * (cexp(z) + cexp(-z));', ['exp']);\nconst ctanh = new ComplexFunction('ctanh',\n`vec2 a = cexp(2.0*z);\nvec2 b = cexp(-2.0*z);\nif (z.x > 0.0) {\nreturn cdiv(ONE - b, ONE + b);\n} else {\nreturn cdiv(a - ONE, a + ONE);\n}`, ['exp', 'div']);\nconst csech = new ComplexFunction('csech',\n    'return reciprocal(ccosh(z));', ['reciprocal', 'cosh']);\nconst ccsch = new ComplexFunction('ccsch',\n    'return reciprocal(csinh(z));', ['reciprocal', 'sinh']);\nconst ccoth = new ComplexFunction('ccoth', 'return reciprocal(ctanh(z));', ['reciprocal', 'tanh']);\n\n// Inverse hyperbolic trigonometric functions\nconst carsinh = new ComplexFunction('carsinh',\n'return -mul_i(carcsin(mul_i(z)));', ['mul_i', 'arcsin']);\nconst carcosh = new ComplexFunction('carcosh',\n    'return -mul_i(carccos(z));', ['mul_i', 'arccos']);\nconst cartanh = new ComplexFunction('cartanh',\n    'return -mul_i(carctan(mul_i(z)));', ['mul_i', 'arctan']);\nconst carsech = new ComplexFunction('carsech',\n    'return -mul_i(carcsec(z));', ['mul_i', 'arcsec']);\nconst carcsch = new ComplexFunction('carcsch',\n    'return -mul_i(carccsc(-mul_i(z)));', ['mul_i', 'arccsc']);\nconst carcoth = new ComplexFunction('carcoth',\n    'return -mul_i(carccot(-mul_i(z)));', ['mul_i', 'arccot']);\n\n\n// Infix Operators //\nconst cneg = new ComplexFunction('cneg', 'return -z;');\nconst cadd = new ComplexFunction('cadd', 'return z+w;', [], 2);\nconst csub = new ComplexFunction('csub', 'return z-w;', [], 2);\nconst cmul = new ComplexFunction('cmul',\n    'return mat2(z, -z.y, z.x) * w;', [], 2);\nconst cdiv = new ComplexFunction('cdiv',\n'return cmul(z, reciprocal(w));', ['mul', 'reciprocal'], 2);\nconst cpow = new ComplexFunction('cpow', 'return cexp(cmul(clog(z), w));',\n    ['exp', 'mul', 'log'], 2);\n\n// Lanczos approximation\nconst cgamma = new ComplexFunction('cgamma',\n    'if (z.x < 0.5) {return cgamma_left(z);} else {return cgamma_right(z);}',\n    ['cgamma_left', 'cgamma_right']);\nconst cgamma_left = new ComplexFunction('cgamma_left',\n    'return PI * reciprocal(cmul(csin(PI*z), cgamma_right(ONE-z)));',\n    ['mul', 'sin', 'cgamma_right']);\nconst cgamma_right = new ComplexFunction('cgamma_right',\n`vec2 w = z - ONE;\nvec2 t = w + vec2(7.5, 0);\nvec2 x = vec2(0.99999999999980993, 0);\nx += 676.5203681218851 * reciprocal(w + vec2(1, 0));\nx -= 1259.1392167224028 * reciprocal(w + vec2(2, 0));\nx += 771.32342877765313 * reciprocal(w + vec2(3, 0));\nx -= 176.61502916214059 * reciprocal(w + vec2(4, 0));\nx += 12.507343278686905 * reciprocal(w + vec2(5, 0));\nx -= .13857109526572012 * reciprocal(w + vec2(6, 0));\nx += 9.9843695780195716e-6 * reciprocal(w + vec2(7, 0));\nx += 1.5056327351493116e-7 * reciprocal(w + vec2(8, 0));\nreturn sqrt(TAU) * cmul(cpow(t, w + vec2(0.5, 0)), cmul(cexp(-t), x));`,\n['reciprocal', 'mul', 'pow', 'exp']);\nconst cfact = new ComplexFunction('cfact', 'return cgamma(z + ONE);', ['gamma']);\n\n// Dirichlet eta function\nconst ceta = new ComplexFunction('ceta',\n`vec2 conjugate_mask = vec2(1.0, 1.0);\nif (z.y < 0.0) {\n    z = cconj(z);\n    conjugate_mask.y *= -1.0;\n}\nvec2 result;\nif (z.x < 0.0) {\n    result = ceta_left(z);\n} else {\n    result = ceta_right(z);\n}\nreturn result * conjugate_mask;`, ['conj', 'ceta_left', 'ceta_right']);\nconst ceta_left = new ComplexFunction('ceta_left',\n`z.x *= -1.0;\nvec2 component_a;\nconst float SQ2PI2 = 1.2533141373155001;\nfloat log_r = log(length(z));\nif (z.y > 200.0) {\n    component_a = SQ2PI2 * mul_i(cexp(\n        vec2(z.x, 0)\n        + (log_r - 1.0) * z\n        - vec2(log_r/2.0, PI/4.0)\n    ));\n} else if (z.y > 20.0) {\n    float theta = atan(z.y, z.x);\n    component_a = SQ2PI2 * mul_i(cexp(\n        (theta - PI/2.0) * mul_i(z)\n        + (log_r - 1.0) * z\n        - 0.5 * vec2(log_r, theta)\n    ));\n} else {\n    component_a = cmul(cgamma(z), csin(z * PI/2.0));\n}\nvec2 component_b = cmul(z, ceta_right(z + ONE));\nvec2 multiplier_a = cexp(-log(PI) * (z + ONE));\nvec2 multiplier_b = cdiv(ONE - cexp(-LN2 * (z + ONE)), ONE - cexp(-LN2 * z));\nvec2 component = cmul(component_a, component_b);\nvec2 multiplier = cmul(multiplier_a, multiplier_b);\nreturn 2.0 * cconj(cmul(component, multiplier));`,\n['mul_i', 'exp', 'mul', 'gamma', 'sin', 'ceta_right', 'div']);\n\n// Charater chi in zeta(z) = chi(1-z) zeta(1-z)\nconst zeta_character = new ComplexFunction('zeta_character',\n`const vec2 A = vec2(-1.0 - 2.0*LN2, PI/2.0); // -1 + ln(i/4)\nconst vec2 B = vec2(1.0 + LN2, 0);\n\n// Asymptotic approximation to\n// gamma(0.5 * z) / gamma((1-z)/2)\n// Good for Im(z) > 10\nvec2 multiplier = cexp(\n    cmul(z, A + clog(ONE - 2.0 * z))\n    + 0.5 * (B - clog(z))\n);\n\nreturn cmul(\n    cexp((0.5 * LNPI) * (ONE - 2.0 * z)),\n    multiplier\n);`,\n['exp', 'mul', 'log']);\n\n// Riemann-Siegel Formula\nconst ceta_strip = new ComplexFunction('ceta_strip',\n`const int N = ${window.innerWidth < 700 ? 32 : 64};\n\nvec2 zetaA = vec2(0.0, 0.0); // Estimate zeta(z)\nvec2 zetaB = vec2(0.0, 0.0); // Estimate of zeta(1-z)\n\nfor (int i=1; i <= N; i++) {\n    float n = float(i);\n    float base = log(n);\n    vec2 term = cexp(-base * z);\n    zetaA += term;\n    zetaB += reciprocal(n * term);\n}\n\n// Convert to an estimate of zeta(z) via the functional equation\nzetaB = cmul(zetaB, cconj(zeta_character(ONE - cconj(z))));\n\n// Interpolate between the two estimates of zeta(z)\nfloat t = 1.0 - min(z.x, 1.0);\nfloat alpha = t*t * (3.0 - 2.0*t); // Hermite interpolation (smoothstep)\nvec2 zeta_val = mix(zetaA, zetaB, alpha);\n\n// Convert to eta(z) via functional equation\nreturn cmul(ONE - cexp(LN2 * (ONE - z)), zeta_val);`,\n['exp', 'reciprocal', 'mul', 'conj', 'zeta_character']);\n\nconst ceta_right = new ComplexFunction('ceta_right',\n`if (z.x < 3.0 && z.y > 50.0) {return ceta_strip(z);}\nvec2 result = vec2(1.000000000000000, 0.0);\nresult -= 1.00000000000000000000 * cexp(-0.69314718055994528623 * z);\nresult += 1.00000000000000000000 * cexp(-1.09861228866810978211 * z);\nresult -= 1.00000000000000000000 * cexp(-1.38629436111989057245 * z);\nresult += 0.99999999999999555911 * cexp(-1.60943791243410028180 * z);\nresult -= 0.99999999999979938270 * cexp(-1.79175946922805495731 * z);\nresult += 0.99999999999386091076 * cexp(-1.94591014905531323187 * z);\nresult -= 0.99999999986491050485 * cexp(-2.07944154167983574766 * z);\nresult += 0.99999999776946757457 * cexp(-2.19722457733621956422 * z);\nresult -= 0.99999997147371189055 * cexp(-2.30258509299404590109 * z);\nresult += 0.99999971045373836631 * cexp(-2.39789527279837066942 * z);\nresult -= 0.99999762229395061652 * cexp(-2.48490664978800035456 * z);\nresult += 0.99998395846577381452 * cexp(-2.56494935746153673861 * z);\nresult -= 0.99990996358087780305 * cexp(-2.63905732961525840707 * z);\nresult += 0.99957522481587246510 * cexp(-2.70805020110221006391 * z);\nresult -= 0.99830090896564482872 * cexp(-2.77258872223978114491 * z);\nresult += 0.99419535104495204703 * cexp(-2.83321334405621616526 * z);\nresult -= 0.98295446518722640050 * cexp(-2.89037175789616451738 * z);\nresult += 0.95672573151919981793 * cexp(-2.94443897916644026225 * z);\nresult -= 0.90449212250748245445 * cexp(-2.99573227355399085425 * z);\nresult += 0.81569498718756294764 * cexp(-3.04452243772342301398 * z);\nresult -= 0.68698555062628596790 * cexp(-3.09104245335831606667 * z);\nresult += 0.52834368695773525904 * cexp(-3.13549421592914967505 * z);\nresult -= 0.36280435095576935023 * cexp(-3.17805383034794575181 * z);\nresult += 0.21751716776255453079 * cexp(-3.21887582486820056360 * z);\nresult -= 0.11124997091266028426 * cexp(-3.25809653802148213586 * z);\nresult += 0.04729731398489586680 * cexp(-3.29583686600432912428 * z);\nresult -= 0.01619245778522847637 * cexp(-3.33220451017520380432 * z);\nresult += 0.00427566222821304867 * cexp(-3.36729582998647414271 * z);\nresult -= 0.00081524972526846008 * cexp(-3.40119738166215546116 * z);\nresult += 0.00009970680093076545 * cexp(-3.43398720448514627179 * z);\nresult -= 0.00000586510593565794 * cexp(-3.46573590279972654216 * z);\nreturn result;`,\n['ceta_strip', 'exp']);\n\n// Riemann zeta function\nconst czeta = new ComplexFunction('czeta',\n'return cdiv(ceta(z), ONE - cexp(LN2 * (ONE - z)));', ['div', 'eta', 'exp']);\n\n\n/***** Special Functions *****/\n// Erf\n// Small z: https://math.stackexchange.com/questions/712434/erfaib-error-function-separate-into-real-and-imaginary-part\n// Large z: Custom expansion with Fresnel integral (centered around y=x).\n// See https://samuelj.li/blog/2021-05-05-erf-expansion\nconst rerf = new ComplexFunction('rerf',\n`float k = 1.0 - exp(-z.x*z.x);\nconst float K = 1.1283791671;\n\nconst vec4 coeff = vec4(\n    1.0/12.0,\n    7.0/480.0,\n    5.0/896.0,\n    787.0/276480.0\n);\n\nfloat series = 1.0;\nseries -= dot(\n    coeff,\n    vec4(k, k*k, k*k*k, k*k*k*k)\n);\n\nreturn vec2(K * sqrt(k) * series, 0.0);\n`\n);\nconst cerf_large = new ComplexFunction('cerf_large',\n`const float TWO_SQRTPI = 1.1283791671;\nconst vec2 W = 0.70710678118 * vec2(1.0, 1.0);\nconst vec2 W_BAR = W * vec2(1.0, -1.0);\nvec2 rs = cmul(z, W_BAR);\nfloat r = rs.x;\nfloat s = rs.y;\n\nvec2 CS = ONE - TWO_SQRTPI * (0.5/r) * cmul(W, cmul(\n    vec2(cos(r*r), -sin(r*r)),\n    vec2(0.5/(r*r), -1.0)\n));\n\nconst vec4 re_coeff = vec4(2.0, -1.5, 13.125, -324.84375);\nconst vec4 im_coeff = vec4(1.0, -3.75, 59.0625, -2111.484375);\nfloat r4 = r*r*r*r;\nvec4 r_power = vec4(1.0, 1.0/r4, 1.0/(r4*r4), 1.0/(r4*r4*r4))/r;\n\nvec2 I0 = vec2(dot(r_power, re_coeff), dot(r_power, im_coeff)/(r*r));\nvec2 I1 = s/(r*r) * vec2(-2.0*s/r - 3.0/(r*r), 2.0 - 2.0*s*s/(r*r));\nvec2 integral = cmul(\n    cexp(s * vec2(2.0*r, s)),\n    I1 + I0 \n) - I0;\nreturn CS + (TWO_SQRTPI/4.0) * cmul(W, cmul(vec2(sin(r*r), cos(r*r)), integral));\n`, ['mul', 'exp'])\nconst cerf_small = new ComplexFunction('cerf_small',\n`\nfloat K = exp(-z.x*z.x)/PI;\nfloat q = 4.0*z.x*z.x;\nfloat a = cos(2.0*z.x*z.y);\nfloat b = sin(2.0*z.x*z.y);\n\nmat2 M = mat2(-z.x*a, z.x*b, 0.5*b, 0.5*a);\n\nvec2 series = vec2(0.0, 0.0);\nfor (int i = 1; i < 32; i++) {\n    float k = float(i);\n    float kk = k*k/4.0 + z.x*z.x;\n    float e1 = exp(k*z.y - kk);\n    float e2 = exp(-k*z.y - kk);\n\n    series += 1.0/(k*k + q) * (\n        vec2(2.0*z.x * exp(-kk), 0.0)\n        + M * vec2(e1+e2, k * (e1-e2))\n    );\n}\nreturn rerf(z) + (K/(2.0 * z.x)) * vec2(1.0-a, b) + 2.0/PI*series;\n`,\n['rerf']\n);\nconst cerf = new ComplexFunction('cerf',\n`\nvec2 result;\n\nif (abs(z.y) > 8.0) {\n    result = cerf_large(abs(z));\n} else {\n    result = cerf_small(abs(z));\n}\n\nif (z.y < 0.0) {result.y *= -1.0;}\nif (z.x < 0.0) {result.x *= -1.0;}\n\nreturn result;\n`, ['cerf_small', 'cerf_large'])\n\n\n/***** Elliptic Functions *****/\n// Jacobi Theta functions\nconst ctheta00 = new ComplexFunction('ctheta00',\n`vec2 result = vec2(1.0, 0.0);\nvec2 A = 2.0 * z;\nfor (int i = 1; i < 6; i++) {\n    float n = float(i);\n    vec2 B = n * w;\n    result += ccis(PI * n * (B + A));\n    result += ccis(PI * n * (B - A));\n}\nreturn result;`, ['cis'], 2);\nconst ctheta01 = new ComplexFunction('ctheta01', 'return ctheta00(z + 0.5 * ONE, w);', ['theta00'], 2);\nconst ctheta10 = new ComplexFunction('ctheta10',\n'return cmul(ccis(PI * (z + 0.25 * w)), ctheta00(z + 0.5 * w, w));',\n['mul', 'cis', 'theta00'], 2);\nconst ctheta11 = new ComplexFunction('ctheta11',\n'return cmul(ccis(0.25 * PI * (w + 4.0 * z + 2.0 * ONE)), ctheta00(z + 0.5 * (w + ONE), w));', ['mul', 'cis', 'theta00'], 2);\n\nconst theta000 = new ComplexFunction('theta000',\n`vec2 result = vec2(1.0, 0.0);\nfor (int i = 1; i < 8; i++) {\n    float n = float(i);\n    result += 2.0 * ccis(PI * n * n * z);\n}\nreturn result;`, ['cis']); // theta00(0, z);\n\n// Jacobi elliptic functions\nconst invert_tau = new ComplexFunction('invert_tau',\n`\nvec2 rt_k = csqrt(csqrt(ONE - csquare(z)));\nvec2 ell = 0.5 * cdiv(ONE - rt_k, ONE + rt_k);\nvec2 log_l = clog(ell);\nvec2 q = ell + 2.0 * cexp(5.0 * log_l) + 15.0 * cexp(9.0 * log_l);\nreturn -mul_i(clog(q))/PI;`, ['sqrt', 'div', 'exp', 'mul_i', 'log']); // Computes tau from elliptic modulus k\nconst jacobi_reduce = new ComplexFunction('jacobi_reduce',\n`vec2 t00 = theta000(w);\nvec2 zz = cdiv(z, PI * csquare(t00));\nfloat n = 2.0 * floor(0.5 * zz.y / w.y + 0.5);\nreturn zz - n * w;`, ['theta000', 'div', 'square'], 2); // Given (z, tau), reduce z to fundamental period\n\nconst invert_code = `vec2 tau = invert_tau(w);\nvec2 zz = jacobi_reduce(z, tau);`;\nconst raw_sn = new ComplexFunction('raw_sn',\n`return -cdiv(\n    cmul(theta000(w), ctheta11(z, w)),\n    cmul(ctheta10(vec2(0, 0), w), ctheta01(z, w))\n);`,\n['div', 'mul', 'theta000', 'theta11', 'theta10', 'theta01'], 2);\nconst raw_cn = new ComplexFunction('raw_cn',\n`return cdiv(\n    cmul(ctheta01(vec2(0, 0), w), ctheta10(z, w)),\n    cmul(ctheta10(vec2(0, 0), w), ctheta01(z, w))\n);`,\n['div', 'mul', 'theta01', 'theta10'], 2);\nconst raw_dn = new ComplexFunction('raw_dn',\n`return cdiv(\n    cmul(ctheta01(vec2(0, 0), w), ctheta00(z, w)),\n    cmul(theta000(w), ctheta01(z, w))\n);`,\n['div', 'mul', 'theta01', 'theta00', 'theta000'], 2);\nconst csn = new ComplexFunction('csn',\n`${invert_code}\nreturn raw_sn(zz, tau);`,\n['invert_tau', 'jacobi_reduce', 'raw_sn'], 2);\nconst ccn = new ComplexFunction('ccn',\n`${invert_code}\nreturn raw_cn(zz, tau);`,\n['invert_tau', 'jacobi_reduce', 'raw_cn'], 2);\nconst cdn = new ComplexFunction('cdn',\n`${invert_code}\nreturn raw_dn(zz, tau);`,\n['invert_tau', 'jacobi_reduce', 'raw_dn'], 2);\n\n// Weierstrass p-function\n// Here e1, e2, e3 are roots of 4z^3 = 1/27.\nconst cwp = new ComplexFunction('cwp',\n`float n = floor(z.y/w.y + 0.5);\nvec2 zz = z - n * w;\nvec2 t002 = csquare(theta000(w));\nvec2 t102 = csquare(ctheta10(vec2(0,0), w));\nvec2 e2 = -(PI*PI/3.0) * (csquare(t102) + csquare(t002));\nreturn PI*PI*cmul(cmul(t002, t102), csquare(cdiv(ctheta01(zz, w), ctheta11(zz, w)))) + e2;` ,\n['square', 'div', 'mul', 'theta000', 'theta10', 'theta01', 'theta11'], 2);\nconst raw_wpp = new ComplexFunction('raw_wpp',\n`return -2.0 * cmul(\n    cpow(cdiv(w, raw_sn(z, w1)), 3.0*ONE),\n    cmul(raw_cn(z, w1), raw_dn(z, w1))\n);`, [\n    'mul', 'pow', 'div',\n    'raw_sn', 'raw_cn', 'raw_dn',\n], 3); // wp'(zz, A, tau), post-reduction\nconst cwpp = new ComplexFunction('cwpp',\n`vec2 t004 = csquare(csquare(theta000(w)));\nvec2 t104 = csquare(csquare(ctheta10(vec2(0, 0), w)));\nvec2 t014 = csquare(csquare(ctheta01(vec2(0, 0), w)));\n\nconst float PI2_3 = PI*PI/3.0;\nvec2 e1 = PI2_3 * (t004 + t014);\nvec2 e2 = -PI2_3 * (t104 + t004);\nvec2 e3 = PI2_3 * (t104 - t014);\n\nvec2 A = csqrt(e1 - e3);\nvec2 B = csqrt(e2 - e3);\n\nvec2 u = cmul(z, A);\nvec2 k = cdiv(B, A);\nvec2 tau = invert_tau(k);\nvec2 zz = jacobi_reduce(u, tau);\n\nreturn raw_wpp(zz, A, tau);`, [\n    'mul', 'div', 'sqrt', 'square', \n    'theta000', 'theta10', 'theta01',\n    'invert_tau', 'jacobi_reduce',\n    'raw_wpp',\n], 2);\n\n// Dixon ellptic functions\nconst csm = new ComplexFunction('csm', 'return ccm(1.7666387502854499*ONE-z);', ['cm']);\nconst ccm = new ComplexFunction('ccm', \n`const vec2 A = vec2(0.42644336004913946, 0.42644336004913946);\nconst vec2 tau = vec2(-0.5, 0.8660254037844386);\nvec2 u = cmul(z, A);\nvec2 zz = jacobi_reduce(u, tau);\nreturn ONE + 2.0 * reciprocal(3.0 * raw_wpp(zz, A, tau) - ONE);`,\n['reciprocal', 'jacobi_reduce', 'raw_wpp']);\n\nvar complex_functions = {\n    mul_i, reciprocal,\n    'square': csquare,\n\n    'real': creal,\n    'imag': cimag,\n\n    'conj': cconj,\n    'abs': cabs,\n    'arg': carg,\n    'sgn': csgn,\n    'cis': ccis,\n    'floor': cfloor,\n    'ceil': cceil,\n    'round': cround,\n    'step': cstep,\n\n    'exp': cexp,\n    'log': clog,\n\n    'sqrt': csqrt,\n    'pow': cpow,\n    'sin': csin,  'cos': ccos,  'tan': ctan,\n    'sec': csec,  'csc': ccsc,  'cot': ccot,\n\n    carcsin_top,\n    carcsin_bottom,\n\n    'arcsin': carcsin,  'arccos': carccos,  'arctan': carctan,\n    'arcsec': carcsec,  'arccsc': carccsc,  'arccot': carccot,\n    'sinh': csinh, 'cosh': ccosh, 'tanh': ctanh,\n    'sech': csech, 'csch': ccsch, 'coth': ccoth,\n    'arsinh': carsinh, 'arcosh': carcosh, 'artanh': cartanh,\n    'arsech': carsech, 'arcsch': carcsch, 'arcoth': carcoth,\n    'neg': cneg,\n    'add': cadd,\n    'sub': csub,\n    'mul': cmul,\n    'div': cdiv,\n    'factorial': cfact,\n\n    cgamma_left, cgamma_right,\n    'gamma': cgamma,\n\n    ceta_left, ceta_strip, ceta_right,\n    zeta_character,\n    rerf, cerf_small, cerf_large,\n    'eta': ceta,\n    'zeta': czeta,\n    'erf': cerf,\n\n    invert_tau, jacobi_reduce, theta000,\n    'theta00': ctheta00,\n    'theta01': ctheta01,\n    'theta10': ctheta10,\n    'theta11': ctheta11,\n\n    raw_sn, raw_cn, raw_dn,\n    'sn': csn,\n    'cn': ccn,\n    'dn': cdn,\n\n    raw_wpp,\n    'wp': cwp,\n    'wpp': cwpp,\n\n    'sm': csm,\n    'cm': ccm,\n};\n\nfunction parseExpression(expression) {\n    try {\n        const parser = new nearley.Parser(compiledGrammar);\n        parser.feed(expression)\n        const result = parser.results[0];\n        return result || null;\n    } catch (error) {\n        console.error(error);\n        return null;\n    }\n}\n\nfunction getRequirements(ast) {\n    if (['number', 'variable', 'constant'].includes(ast[0])) {return new Set();}\n    const requirements = new Set([ast[0]]);\n    for (let subast of ast.slice(1)) {\n        for (let req of getRequirements(subast)) {\n            requirements.add(req);\n        }\n    }\n    return requirements;\n}\n\n// Get function declarations and definitions.\n// Only loads used functions and their dependencies.\nfunction functionDefinitions(ast) {\n    let required = null;\n\n    if (Array.isArray(ast)) {\n        // Extract functions used\n        required = getRequirements(ast);\n\n        // Resolve dependencies\n        const stack = Array.from(required);\n        while (stack.length > 0) {\n            const f = stack.pop();\n            for (let dep of complex_functions[f].dependencies) {\n                if (!required.has(dep)) {\n                    required.add(dep);\n                    stack.push(dep);\n                }\n            }\n        }\n    } else {\n        required = new Set();\n        for (let name of Object.keys(complex_functions)) {\n            required.add(name);\n        }\n    }\n    \n    console.log('Functions loaded:', required);\n\n    const functions = Array.from(required).map(name => complex_functions[name]);\n    const declarations = functions.map(f => f.declaration);\n    const definitions = functions.map(f => f.code);\n\n    const declarationString = declarations.join('\\n');\n    const definitionString = definitions.join('\\n');\n    return `${declarationString}\\n\\n${definitionString}`;\n}\n\nexport {complex_functions, parseExpression, functionDefinitions};\n","const math = require('mathjs');\n\nconst I = math.complex(0, 1);\n\nconst cadd = math.sum;\nconst csub = math.subtract;\nconst cdiv = math.divide;\nconst cmul = math.multiply;\nconst csin = math.sin;\nconst cexp = math.exp;\nconst clog = math.log;\nconst csqrt = math.sqrt;\nconst cpow = math.pow;\nconst csquare = z => cmul(z, z);\n\nconst gamma_right = math.gamma;\nconst gamma_left = z => math.divide(math.pi, math.multiply(\n    math.sin(math.multiply(z, math.pi)),\n    gamma_right(math.subtract(1, z))\n));\nconst gamma = z => z.re < 0.5 ? gamma_left(z) : gamma_right(z);\n\n\nconst ETA_COEFFICIENTS = [\n[ 1.00000000000000000000, 0.00000000000000000000],\n[-1.00000000000000000000, 0.69314718055994528623],\n[ 1.00000000000000000000, 1.09861228866810978211], \n[-1.00000000000000000000, 1.38629436111989057245], \n[ 0.99999999999999555911, 1.60943791243410028180], \n[-0.99999999999979938270, 1.79175946922805495731], \n[ 0.99999999999386091076, 1.94591014905531323187], \n[-0.99999999986491050485, 2.07944154167983574766], \n[ 0.99999999776946757457, 2.19722457733621956422], \n[-0.99999997147371189055, 2.30258509299404590109], \n[ 0.99999971045373836631, 2.39789527279837066942], \n[-0.99999762229395061652, 2.48490664978800035456], \n[ 0.99998395846577381452, 2.56494935746153673861], \n[-0.99990996358087780305, 2.63905732961525840707], \n[ 0.99957522481587246510, 2.70805020110221006391], \n[-0.99830090896564482872, 2.77258872223978114491], \n[ 0.99419535104495204703, 2.83321334405621616526], \n[-0.98295446518722640050, 2.89037175789616451738], \n[ 0.95672573151919981793, 2.94443897916644026225], \n[-0.90449212250748245445, 2.99573227355399085425], \n[ 0.81569498718756294764, 3.04452243772342301398], \n[-0.68698555062628596790, 3.09104245335831606667], \n[ 0.52834368695773525904, 3.13549421592914967505], \n[-0.36280435095576935023, 3.17805383034794575181], \n[ 0.21751716776255453079, 3.21887582486820056360], \n[-0.11124997091266028426, 3.25809653802148213586], \n[ 0.04729731398489586680, 3.29583686600432912428], \n[-0.01619245778522847637, 3.33220451017520380432], \n[ 0.00427566222821304867, 3.36729582998647414271], \n[-0.00081524972526846008, 3.40119738166215546116], \n[ 0.00009970680093076545, 3.43398720448514627179], \n[-0.00000586510593565794, 3.46573590279972654216], \n];\n\nfunction eta_right(z) {\n    return math.sum(...ETA_COEFFICIENTS.map(\n        ([a, b]) => cmul(a, cexp(cmul(-b, z)))\n    ));\n}\n\nfunction eta_left(w) {\n    const z = w.neg();\n    const zp1 = math.add(z, 1);\n\n    if (z.im < 0) {return math.conj(eta_left(math.conj(w)));}\n\n\n    let component_a = cmul(gamma(z), csin(cmul(z, math.pi/2)));\n    if (z.im > 50) {\n        const log_r = math.log(math.abs(z));\n        const theta = math.arg(z);\n\n        component_a = cmul(\n            Math.sqrt(2 * Math.PI) / 2,\n            I,\n            cexp(cadd(\n                cmul(theta - Math.PI/2, I, z),\n                cmul(log_r - 1, z),\n                cmul(-0.5, math.complex(log_r, theta))\n            )\n        ));\n    }\n    const component_b = cmul(z, eta_right(zp1));\n\n    const multiplier_a = cexp(cmul(-math.log(math.pi), zp1));\n    const multiplier_b = cdiv(\n        csub(1, cexp(cmul(-Math.LN2, zp1))),\n        csub(1, cexp(cmul(-Math.LN2, z)))\n    );\n\n    const component = cmul(component_a, component_b);\n    const multiplier = cmul(multiplier_a, multiplier_b);\n\n    return cmul(2, cmul(component, multiplier));\n}\n\nconst eta = z => z.re < 0 ? eta_left(z) : eta_right(z);\nconst zeta = z => cdiv(eta(z), csub(1, cexp(cmul(Math.LN2, csub(1, z)))));\n\n// Small z: https://math.stackexchange.com/questions/712434/erfaib-error-function-separate-into-real    -and-imaginary-part\n// Large z: Custom expansion with Fresnel integral (centered around y=x).\n// See https://samuelj.li/blog/2021-05-05-erf-expansion\nfunction erf_large(z) {\n    if (z.re < 0) {return erf_large(z.neg()).neg();}\n    if (z.im < 0) {return math.conj(erf_large(math.conj(z)));}\n    const TWO_SQRTPI = 1.1283791671;\n    const W = math.complex(0.70710678118, 0.70710678118);\n    const W_BAR = math.complex(0.70710678118, -0.70710678118);\n    const rs = cmul(z, W_BAR);\n    const r = rs.re;\n    const s = rs.im;\n\n    const CS = csub(1, cmul(TWO_SQRTPI * (0.5/r), cmul(W, cmul(\n        math.complex(Math.cos(r*r), -Math.sin(r*r)),\n        math.complex(1/(2*r*r), -1)\n    ))));\n\n    const I0 = math.complex(2/r, 1/(r*r*r));\n    const I1 = cmul(s/(r*r), math.complex(-2*s/r - 3/(r*r), 2 - 2*s*s/(r*r)));\n    const integral = csub(cmul(\n        cexp(math.complex(2*r*s, s*s)),\n        math.add(I1, I0)\n    ), I0);\n    return cadd(CS, cmul(TWO_SQRTPI/4.0, cmul(W, cmul(math.complex(Math.sin(r*r), Math.cos(r*r)), integral))));\n}\n\nfunction erf(z) {\n    if (Math.abs(z.im) > 8) {\n        return erf_large(z);\n    }\n\n    const K = math.exp(-z.re*z.re)/Math.PI;\n    const q = 4*z.re*z.re;\n    const a = math.cos(2*z.re*z.im);\n    const b = math.sin(2*z.re*z.im);\n\n    const series = [math.erf(z.re), cmul(K/(2*z.re), math.complex(1-a, b))];\n    for (let k = 1; k < 32; k++) {\n        const kk = k*k/4 + z.re*z.re;\n        const e1 = math.exp(k*z.im - kk)/2;\n        const e2 = math.exp(-k*z.im - kk)/2;\n        const multiplier = 1/(k*k+q);\n        const re = multiplier * (2*z.re*(math.exp(-kk)-a*(e1+e2)) + k*b*(e1-e2));\n        const im = multiplier * (2*z.re*b*(e1+e2) + k*a*(e1-e2));\n        series.push(math.complex(re, im));\n    }\n\n    return math.sum(series);\n}\n\n/***** Elliptic Functions *****/\nfunction theta00(z, tau) {\n    let result = 1;\n    for (let n = 1; n < 8; n++) {\n        const A = math.complex(0, Math.PI * n);\n        const B = cmul(A, 2, z);\n        const C = cmul(A, n, tau);\n        result = cadd(\n            result,\n            cexp(cadd(C, B)),\n            cexp(csub(C, B))\n        );\n    }\n    return result;\n}\nconst theta01 = (z, tau) => theta00(cadd(z, 0.5), tau);\nconst theta10 = (z, tau) => cmul(\n    cexp(cmul(math.complex(0, Math.PI/4), cadd(tau, cmul(4, z)))),\n    theta00(cadd(z, cmul(0.5, tau)), tau)\n);\nconst theta11 = (z, tau) => cmul(\n    cexp(cmul(math.complex(0, Math.PI/4), cadd(tau, cmul(4, z), 2))),\n    theta00(cadd(z, cmul(0.5, tau), 0.5), tau)\n);\n\nfunction invert_tau(k) {\n    const root_k = csqrt(csqrt(csub(1, cmul(k, k))));\n    const l = cmul(0.5, cdiv(csub(1, root_k), cadd(1, root_k)));\n    const q = cadd(\n        l,\n        cmul(2, cpow(l, 5)),\n        cmul(15, cpow(l, 9)),\n        cmul(150, cpow(l, 13))\n    );\n    return cmul(clog(q), math.complex(0, -1/Math.PI));\n}\n\nfunction jacobi_reduce(z, k) {\n    const tau = invert_tau(k);\n    const t00 = theta00(0, tau);\n    const zz = cdiv(z, cmul(Math.PI, t00, t00));\n    const n = 2 * Math.round(0.5 * zz.im/tau.im);\n    return [csub(zz, cmul(n, tau)), tau];\n}\n\nfunction raw_sn(zz, tau) {\n    return cdiv(cmul(\n        -1, theta00(0, tau), theta11(zz, tau)\n    ), cmul(\n        theta10(0, tau), theta01(zz, tau)\n    ));\n}\n\nfunction raw_cn(zz, tau) {\n    return cdiv(cmul(\n        theta01(0, tau), theta10(zz, tau)\n    ), cmul(\n        theta10(0, tau), theta01(zz, tau)\n    ));\n}\n\nfunction raw_dn(zz, tau) {\n    return cdiv(cmul(\n        theta01(0, tau), theta00(zz, tau)\n    ), cmul(\n        theta00(0, tau), theta01(zz, tau)\n    ));\n}\n\nconst sn = (z, k) => raw_sn(...jacobi_reduce(z, k));\nconst cn = (z, k) => raw_cn(...jacobi_reduce(z, k));\nconst dn = (z, k) => raw_dn(...jacobi_reduce(z, k));\n\n\n// Weierstrass p-function\nfunction wp(z, tau) {\n    const n = Math.round(z.im/tau.im);\n    const zz = csub(z, cmul(n, tau));\n\n    const t002 = csquare(theta00(0, tau));\n    const t102 = csquare(theta10(0, tau));\n    const e2 = cmul(-Math.PI*Math.PI/3, cadd(csquare(t102), csquare(t002)));\n    return cadd(cmul(\n        Math.PI*Math.PI,\n        t002, t102,\n        csquare(cdiv(theta01(zz, tau), theta11(zz, tau)))\n    ), e2);\n}\n\nfunction raw_wpp(zz, A, tau) {\n    return cmul(\n        -2,\n        cpow(cdiv(A, raw_sn(zz, tau)), 3),\n        raw_cn(zz, tau), raw_dn(zz, tau)\n    );\n}\n\nfunction wpp(z, tau) {\n    const t004 = csquare(csquare(theta00(0, tau)));\n    const t104 = csquare(csquare(theta10(0, tau)));\n    const t014 = csquare(csquare(theta01(0, tau)));\n\n    const PI2_3 = Math.PI * Math.PI / 3;\n    const e1 = cmul(PI2_3, cadd(t004, t014));\n    const e2 = cmul(-PI2_3, cadd(t104, t004));\n    const e3 = cmul(PI2_3, csub(t104, t014));\n    const A = csqrt(csub(e1, e3));\n    const B = csqrt(csub(e2, e3));\n\n    const u = cmul(z, A);\n    const k = cdiv(B, A);\n    const [zz, tau2] = jacobi_reduce(u, k);\n\n    return raw_wpp(zz, A, tau2);\n}\n\n\n// Dixon elliptic functions\nconst e2 = math.complex(0.20998684165, 0);\nconst e1 = math.complex(-0.10499342083, 0.18185393933);\nconst e3 = math.complex(-0.10499342083, -0.18185393933);\n\nconst A = csqrt(csub(e1, e3));\nconst B = csqrt(csub(e2, e3));\nconst k = cdiv(B, A);\n\nfunction cm(z) {\n    const u = cmul(z, A);\n    const [zz, tau] = jacobi_reduce(u, k);\n    return cadd(1, cdiv(2, csub(cmul(3, raw_wpp(zz, A, tau)), 1)));\n}\n\nfunction sm(z) {\n    return cm(csub(1.7666387502854499, z));\n}\n\n\n\nexport {\n    zeta, eta, gamma, erf,\n    theta00, theta01, theta10, theta11,\n    sn, cn, dn,\n    wp, wpp,\n    sm, cm,\n};\n","import {get, isNil} from 'lodash';\nimport {\n    zeta, eta, gamma, erf,\n    theta00, theta01, theta10, theta11,\n    sn, cn, dn,\n    wp, wpp,\n    sm, cm,\n} from './custom-functions.js'\nconst math = require('mathjs');\n\n\nconst I = math.complex(0, 1);\nconst fns = {\n    sub: math.subtract,\n    neg: math.unaryMinus,\n    mul: math.multiply,\n    div: math.divide,\n    real: math.re,\n    imag: math.im,\n    step: z => (z.re >= 0) ? 1 : 0,\n\n    arcsin: math.asin,\n    arccos: math.acos,\n    arctan: math.atan,\n    arcsec: math.asec,\n    arccsc: math.acsc,\n    arccot: math.acot,\n\n    arsinh: math.asinh,\n    arcosh: math.acosh,\n    artanh: math.atanh,\n    arsech: math.asech,\n    arcsch: math.acsch,\n    arcoth: math.acoth,\n\n    cis: z => math.exp(math.multiply(z, I)),\n\n    gamma,\n    eta,\n    zeta,\n    erf,\n\n    factorial: z => gamma(math.add(z, 1)),\n\n    theta00, theta01, theta10, theta11,\n    sn, cn, dn,\n    wp, wpp,\n    sm, cm,\n}\n\n/**\n * Returns a JS function that evaluates\n * the given AST.\n *\n * Inputs of the returned function\n * are [real, imag],\n * representing the complex input.\n * The returned function outputs a\n * 2-tuple [real, imag]\n * representing the complex output.\n */\nfunction toJS(ast, variables) {\n    const errorValue = [NaN, NaN];\n    if (ast === null) {return z => errorValue;}\n\n    const constants = {\n        'e': Math.E,\n        'pi': Math.PI,\n        'tau': 2 * Math.PI,\n        'phi': (1 + Math.sqrt(5))/2,\n    }\n\n    // Destructure this level of the AST\n    const [operator, ...args] = ast;\n\n    // Complex number literal\n    if (operator === 'number') {return z => args;}\n\n    // User-defined variable\n    if (operator === 'variable') {\n        const [name] = args;\n        if (name === 'z') {return z => z;}\n        return z => [get(variables, name, NaN), 0];\n    }\n\n    // Built-in constant\n    if (operator === 'constant') {\n        const [name] = args;\n        return z => [constants[name], 0];\n    }\n\n    // Built-in function\n    const func = fns[operator] || math[operator];\n    if (!isNil(func)) {\n        const destructure = z => isNil(z.re) ? [z, 0] : [z.re, z.im];\n        return z => destructure(func(...args.map(\n                subtree => math.complex(...toJS(subtree, variables)(z))\n        )));\n    }\n\n    // Fallback if no match\n    return z => errorValue;\n}\n\nexport default toJS;\n","import {get} from 'lodash';\n\nimport toJS from './to-js';\n\nfunction toGLSL(ast) {\n    if (ast === null) {return null;}\n\n    const infixOperators = {\n        'add': '+',\n        'sub': '-',\n    };\n\n    const [operator, ...args] = ast;\n\n    if (operator === 'number') {\n        const [real, imag] = args;\n        return `vec2(${real}, ${imag})`;\n    }\n\n    if (operator === 'variable') {return args[0];}\n    if (operator === 'constant') {return 'C_' + args[0].toUpperCase();}\n    if (operator in infixOperators) {\n        return toGLSL(args[0]) + infixOperators[operator] + '(' + toGLSL(args[1]) + ')';\n    }\n\n    // Unary function\n    const unaryFunctions = {\n        'factorial': 'cfact',\n    };\n    const internalName = get(unaryFunctions, operator, 'c' + operator);\n\n    return internalName + '(' + args.map(toGLSL).join(', ') + ')';\n}\n\nexport {toGLSL, toJS};\n","import {\n  functionDefinitions,\n} from './complex-functions.js';\nimport {\n    toGLSL\n} from './translators';\n\nfunction loadShader(gl, type, source) {\n  // Create and compile shader\n  const shader = gl.createShader(type);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n\n  // Test for successful compilation\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    console.error('Shader failed to compile: '\n      + gl.getShaderInfoLog(shader));\n    gl.deleteShader(shader);\n    return null;\n  }\n\n  return shader;\n}\n\n\nfunction createShaderProgram(gl, expression, customShader, variableNames) {\n  if (expression === null) {return null;}\n\n  const fragmentShaderSource = getFragmentShaderSource(\n    expression,\n    customShader, \n    gl.drawingBufferWidth, gl.drawingBufferHeight,\n    variableNames\n  );\n\n  if (fragmentShaderSource === null) {return null;}\n\n  // Load vertex and fragment shaders\n  const vertexShader = loadShader(gl,\n    gl.VERTEX_SHADER, vertexShaderSource);\n  const fragmentShader = loadShader(gl,\n    gl.FRAGMENT_SHADER, fragmentShaderSource);\n\n  if (vertexShader === null | fragmentShader === null) {\n    return null;\n  }\n\n  // Create shader program\n  const shaderProgram = gl.createProgram();\n  gl.attachShader(shaderProgram, vertexShader);\n  gl.attachShader(shaderProgram, fragmentShader);\n  gl.linkProgram(shaderProgram);\n\n  // Test for successful linkage\n  if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\n    console.error('Shader program failed to initialize: '\n      + gl.getProgramInfoLog(shaderProgram));\n    return null;\n  }\n\n  return shaderProgram;\n}\n\nexport default createShaderProgram;\n\n\nconst vertexShaderSource = `\n  attribute vec2 a_position;\n\n  void main() {\n    gl_Position = vec4(a_position, 0, 1);\n  }\n`;\n\n\nfunction getFragmentShaderSource(expression, customShader, width, height, variableNames) {\n  const x_offset = (width/2).toFixed(2);\n  const y_offset = (height/2).toFixed(2);\n  const dpr = window.devicePixelRatio.toFixed(4);\n\n  const variableDeclarations = variableNames.map(\n    (name) => `uniform vec2 ${name};`\n  ).join('\\n');\n\n  let custom_code = '';\n  let glsl_expression = null;\n  if (customShader) {\n    custom_code = expression;\n    glsl_expression = 'mapping(z)';\n  } else {\n    glsl_expression = toGLSL(expression);\n  }\n  if (glsl_expression === null) {return null;}\n\n  console.log('AST:', expression);\n  console.log('Shader Code:', glsl_expression);\n\n  return `\n  #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n  #else\n    precision mediump float;\n  #endif\n\n  const float PI = 3.14159265358979323846264;\n  const float TAU = 2.0 * PI;\n  const float E = 2.718281845904523;\n  const float LN2 = 0.69314718055994531;\n  const float LNPI = 1.1447298858494001741434;\n  const float PHI = 1.61803398874989484820459;\n  const float SQ2 = 1.41421356237309504880169;\n\n  const float checkerboard_scale = 0.25;\n\n  const vec2 ONE = vec2(1, 0);\n  const vec2 I = vec2(0, 1);\n  const vec2 C_PI = vec2(PI, 0);\n  const vec2 C_TAU = vec2(TAU, 0);\n  const vec2 C_E = vec2(E, 0);\n  const vec2 C_PHI = vec2(PHI, 0);\n\n  ${variableDeclarations}\n\n  ${functionDefinitions(expression)}\n\n  vec3 hsv2rgb(vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n  }\n\n  vec3 get_color(vec2 z, float derivative) {\n    float magnitude = length(z);\n    float phase = atan(z.y, z.x);\n\n    float color_value;\n    float color_saturation = 1.0;\n    if (continuous_gradient.x > 0.5) {\n      float color_lightness = 0.5 + atan(0.5 * log(magnitude))/PI;\n      color_saturation = 1.0;\n\n      if (invert_gradient.x > 0.5) {\n\tcolor_lightness = 1.0 - color_lightness;\n      }\n\n      /* HSL to HSV conversion */\n      color_lightness *= 2.0;\n      color_saturation *= 1.0 - abs(color_lightness - 1.0);\n      color_value = (color_lightness + color_saturation) / 2.0;\n      color_saturation /= color_value;\n    } else {\n      color_value = 0.5 * exp2(fract(log2(magnitude)));\n\n      if (invert_gradient.x > 0.5) {\n\tcolor_value = 1.5 - color_value;\n      }\n    }\n\n    if (enable_checkerboard.x > 0.5) {\n      vec2 checkerboard_components = floor(2.0 * fract(z/checkerboard_scale));\n      float checkerboard = floor(2.0 * fract((checkerboard_components.x + checkerboard_components.y)/2.0));\n\n      // Anti-Moire\n      float decay_factor = clamp(40.0 * derivative, 1.0, 10000.0) - 1.0;\n      checkerboard = 0.5 + (checkerboard - 0.5) / (1.0 + 3.0 * decay_factor);\n\n      color_value *= 0.8 + 0.2 * checkerboard;\n    }\n\n    vec3 hsv_color = vec3(phase/TAU, color_saturation, color_value);\n    return hsv2rgb(hsv_color);\n  }\n\n  ${custom_code}\n\n  const vec2 screen_offset = vec2(${x_offset}, ${y_offset});\n  vec2 from_pixel(vec2 xy) {\n    vec2 plot_center = vec2(center_x.x, center_y.x);\n\n    float scale = exp(-log_scale.x) / ${dpr};\n\n    return scale * (xy - screen_offset) + plot_center;\n  }\n\n  vec2 internal_mapping(vec2 xy) {\n      vec2 z = from_pixel(xy);\n      return ${glsl_expression};\n  }\n\n  void main() {\n    // Set up for supersampling\n    const vec2 A = vec2(0.125, 0.375);\n    const vec2 B = vec2(0.375, -0.125);\n    vec2 xy = gl_FragCoord.xy;\n\n    // 4-Rook supersampling\n    vec2 w1 = internal_mapping(xy + A);\n    vec2 w2 = internal_mapping(xy - A);\n    vec2 w3 = internal_mapping(xy + B);\n    vec2 w4 = internal_mapping(xy - B);\n\n    // Anti-Moire\n    float derivative = 0.5 * (length(w1 - w2) + length(w3 - w4));\n\n    vec3 color1 = get_color(w1, derivative);\n    vec3 color2 = get_color(w2, derivative);\n    vec3 color3 = get_color(w3, derivative);\n    vec3 color4 = get_color(w4, derivative);\n\n    vec3 color =  0.25 * (color1 + color2 + color3 + color4);\n    gl_FragColor = vec4(color, 1.0);\n  }\n  `;\n}\n","import createShaderProgram from './shaders.js';\n\n\nfunction initBuffers(gl) {\n  const vertexBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n\n  // Positions of vertices (two triangles)\n  const vertices = [\n    -1, -1,\n    1, -1,\n    -1, 1,\n\n    -1, 1,\n    1, -1,\n    1, 1\n  ]\n\n  // Initialize buffer with position data\n  gl.bufferData(\n    gl.ARRAY_BUFFER,\n    new Float32Array(vertices),\n    gl.STATIC_DRAW\n  );\n}\n\nfunction initializeScene(gl, expression, customShader, variableNames) {\n  if (expression === null) {return null;}\n\n  const shaderProgram = createShaderProgram(\n    gl,\n    expression, customShader,\n    variableNames\n  );\n\n  if (shaderProgram === null) {\n    console.error('AST could not be compiled:', expression);\n    return null;\n  }\n\n  // Initialize shader program\n  initBuffers(gl);\n  gl.useProgram(shaderProgram);\n\n  // Initialize vertex array\n  const positionLocation = gl.getAttribLocation(shaderProgram, 'a_position');\n  gl.enableVertexAttribArray(positionLocation);\n  gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);\n\n  // Retrieve pointers to variables\n  const variableLocations = {};\n  for (const name of variableNames) {\n    variableLocations[name] = gl.getUniformLocation(shaderProgram, name);\n  }\n  return variableLocations;\n}\n\nfunction drawScene(gl, variables, axis_ctx) {\n  // Set variable values\n  for (const [location, value] of Object.values(variables)) {\n    gl.uniform2f(location, value, 0);\n  }\n\n  // Draw scene\n  gl.drawArrays(gl.TRIANGLES, 0, 6);\n\n  // Draw coordinate axes\n  drawAxes(axis_ctx, variables);\n}\n\nfunction drawAxes(ctx, variables) {\n    // Clear canvas\n    const dpr = window.devicePixelRatio;\n    const [width, height] = [window.innerWidth * dpr, window.innerHeight * dpr];\n    ctx.clearRect(0, 0, width, height);\n    if (variables.enable_axes[1] < 0.5) {return;}\n\n    // Compute display scales\n    const scale = Math.exp(variables.log_scale[1]) * dpr;\n    \n    let rawLogLabelScale = 2.3 - variables.log_scale[1] / Math.log(10);\n    rawLogLabelScale += 3e-2 * Math.abs(rawLogLabelScale); // Make room for long labels\n    let logLabelScale = Math.round(rawLogLabelScale);\n    let labelScale = Math.pow(10, logLabelScale);\n\n    if (logLabelScale - rawLogLabelScale > 0.2) {\n        labelScale /= 5;\n        logLabelScale--;\n    } else if (logLabelScale - rawLogLabelScale > 0) {\n        labelScale /= 2;\n        logLabelScale--;\n    }\n\n    // Compute origin location in screen space\n    const [x0, y0] = [\n        width/2 - scale*variables.center_x[1],\n        height/2 + scale*variables.center_y[1],\n    ];\n\n    // Compute window bounds\n    const [x_min, x_max] = [-x0/scale, (width - x0)/scale];\n    const [y_min, y_max] = [(y0-height)/scale, y0/scale];\n\n\n    // Utility functions\n    function horizontalLine(y) {\n        const yy = Math.round(y0 - scale*y);\n        ctx.moveTo(0, yy);\n        ctx.lineTo(width, yy);\n    }\n\n    function verticalLine(x, lineWidth) {\n        const xx = Math.round(x0 + scale*x);\n        ctx.moveTo(xx, 0);\n        ctx.lineTo(xx, height);\n    }\n\n    function xLabel(x) {\n        const xx = x0 + scale * x;\n        if (xx > width - 30*dpr || xx < 30*dpr) {return;}\n\n        const dy = (y0 < height/3) ? 22 : -10;\n        const y = Math.min(Math.max(y0 + dy*dpr, 90 * dpr), height-20*dpr);\n\n        let label = x.toFixed(Math.max(0, -logLabelScale)).replace('-', '−');\n        const textWidth = ctx.measureText(label).width + 6 * dpr;\n\n        ctx.textAlign = 'center'\n        ctx.clearRect(xx - textWidth/2, y - 18*dpr, textWidth, 24*dpr);\n        ctx.strokeText(label, xx, y);\n        ctx.fillText(label, xx, y);\n    }\n\n    function yLabel(y, iWidth) {\n        const yy = y0 - scale * y + 6 * dpr;\n        if (yy > height - 50*dpr || yy < 100*dpr) {return;}\n\n        const alignLeft = (x0 < 2*width/3);\n        const dx = alignLeft ? 10: -10;\n        ctx.textAlign = alignLeft ? 'left' : 'right';\n\n        const x = Math.min(Math.max(x0 + dx*dpr, 20 * dpr), width -20*dpr);\n\n        let label = y.toFixed(Math.max(0, -logLabelScale)).replace('-', '−');\n        if (label === '1') {label = '';}\n        if (label === '−1') {label = '−';}\n\n        ctx.font = `${20 * dpr}px Computer Modern Serif`;\n        const textWidth = ctx.measureText(label).width;\n\n        const clearWidth = textWidth + iWidth + 8*dpr;\n        ctx.clearRect(\n            x - (alignLeft ? 3*dpr : clearWidth - 4*dpr),\n            yy - 18*dpr,\n            clearWidth,\n            24*dpr\n        );\n\n        const textOffset = alignLeft ? 0 : -iWidth - dpr;\n        ctx.strokeText(label, x + textOffset, yy);\n        ctx.fillText(label, x + textOffset, yy);\n\n        ctx.font = `italic ${20 * dpr}px Computer Modern Serif`;\n        const iOffset = alignLeft ? textWidth + dpr : 0;\n        ctx.strokeText('i', x + iOffset, yy);\n        ctx.fillText('i', x + iOffset, yy);\n    }\n\n\n    // Draw gridlines\n    ctx.globalAlpha = 0.8;\n    ctx.strokeStyle= '#ffffff';\n\n    ctx.lineWidth = 1;\n    ctx.beginPath();\n    for (let i = Math.ceil(x_min/labelScale); i < x_max/labelScale; i++) {\n        if (i === 0) {continue;}\n        verticalLine(i * labelScale);\n    }\n    for (let i = Math.ceil(y_min/labelScale); i < y_max/labelScale; i++) {\n        if (i === 0) {continue;}\n        horizontalLine(i * labelScale);\n    }\n    ctx.stroke();\n\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    verticalLine(0);\n    horizontalLine(0);\n    ctx.stroke();\n\n    // Draw labels\n    ctx.font = `${20 * dpr}px Computer Modern Serif`;\n    ctx.globalAlpha = 1;\n    ctx.fillStyle = '#ffffff';\n    ctx.lineWidth = 4;\n    ctx.lineJoin = 'round';\n    ctx.strokeStyle = '#444444';\n    for (let i = Math.ceil(x_min/labelScale); i < x_max/labelScale; i++) {\n        if (i === 0) {continue;}\n        xLabel(i * labelScale);\n    }\n\n\n    ctx.font = `italic ${20 * dpr}px Computer Modern Serif`;\n    const iWidth = ctx.measureText('i').width;\n    for (let i = Math.ceil(y_min/labelScale); i < y_max/labelScale; i++) {\n        if (i === 0) {continue;}\n        yLabel(i * labelScale, iWidth);\n    }\n}\n\nexport {initializeScene, drawScene};\n","import {isNil} from 'lodash';\n\nfunction formatComplex(x, y, precision) {\n    if (x !== 0) {\n        if (y !== 0) {\n            return formatReal(x, false, precision) + formatReal(y, true, precision) + '\\\\, i';\n        } else {\n            return formatReal(x, false, precision);\n        }\n    } else if (y !== 0) {\n        return formatReal(y, false, precision) + '\\\\, i';\n    } else {\n        return '0';\n    }\n}\n\nconst CONSTANTS = {\n    '\\\\pi': Math.PI,\n    '\\\\sqrt{2}': Math.sqrt(2),\n    'e': Math.E,\n}\n\nfunction almostInteger(x) {\n    return Math.abs(x - Math.round(x)) < 1e-10;\n}\n\n// Checks if the value is close to a nice multiple of known constants.\nfunction checkKnown(x) {\n    for (let [name, value] of Object.entries(CONSTANTS)) {\n        for (let denominator of [1, 2, 3, 6, 12]) {\n            const ratio = denominator * x / value;\n\n            // Check if ratio is almost integer\n            if (ratio > 0.5 && almostInteger(ratio)) {\n                console.log(ratio);\n                const formatInteger = x => x === 1 ? '' : x.toString()\n                const numerator = formatInteger(Math.round(ratio)) + ' ' + name;\n\n                if (denominator === 1) {\n                    return numerator;\n                } else {\n                    return '\\\\frac{' + numerator + '}{' + denominator + '}';\n                }\n            }\n        }\n    }\n\n    return null;\n}\n\nfunction formatReal(x, forceSign, precision) {\n    const magnitude = Math.abs(x);\n    const sign = x < 0 ? '-' : (\n        forceSign ? '+' : ''\n    );\n\n    if (precision > 3) {\n        // Try to see if value is a multiple of known constant\n        const prettyMagnitude = checkKnown(magnitude);\n        if (!isNil(prettyMagnitude)) {return sign + prettyMagnitude;}\n    }\n\n    let exponent = magnitude > 0 ? Math.floor(Math.log10(magnitude)) : 0;\n    if (Math.abs(exponent) < 3) {exponent = 0;}\n\n    const mantissa = magnitude * Math.pow(10, -exponent);\n\n    const formattedMagnitude = mantissa.toFixed(precision);\n    const formattedExponent = exponent === 0 ? '' : `\\\\times 10^{${exponent}}`;\n\n    return sign + formattedMagnitude + formattedExponent;\n}\n\nexport {formatComplex};\n","import React, {PureComponent} from 'react';\n\nimport {InlineMath} from 'react-katex';\n\nimport {formatComplex} from '../util';\n\n\nclass CoordinateOverlay extends PureComponent {\n    state = {\n        faded: false\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.fadeTimer = null;\n        this.lastX = null;\n        this.lastY = null;\n    }\n\n    hasChanged() {\n        const {x, y} = this.props;\n        const changed = (this.lastX !== x) || (this.lastY !== y);\n\n        this.lastX = x;\n        this.lastY = y;\n\n        return changed;\n    }\n\n    componentDidMount() {\n        this.componentDidUpdate();\n    }\n\n    componentDidUpdate() {\n        if (this.hasChanged()) {\n            if (this.fadeTimer !== null) {\n                clearTimeout(this.fadeTimer);\n            }\n            this.fadeTimer = setTimeout(() => this.setState({faded: true}), 2e3);\n            this.setState({faded: false});\n        }\n    }\n\n    render() {\n        const {faded} = this.state;\n        const {x, y, mapping} = this.props;\n\n        const [u, v] = mapping([x, y]);\n\n        return <div className='coordinate-container'>\n            <InlineMath>{'z = ' + formatComplex(x, y, 3)}</InlineMath>\n            {isFinite(u) && isFinite(v) ? <InlineMath>{'f(z) = ' + formatComplex(u, v, 3)}</InlineMath> : null}\n            <style>{`\n                .coordinate-container {\n                    position: absolute;\n                    bottom: 0;\n                    right: 0;\n                    z-index: 20;\n\n                    padding: 5px 20px;\n                    min-width: 180px;\n\n                    display: flex;\n                    flex-direction: column;\n                    align-items: center;\n                    justify-content: center;\n\n                    background-color: hsla(213, 5%, 15%, 0.3);\n                    border: 1px solid hsla(213, 5%, 90%, 0.1);\n                    box-shadow: -1px -1px 4px hsla(213, 10%, 10%, 0.1);\n\n                    border-radius: 8px 0 0 0;\n\n                    backdrop-filter: blur(6px);\n\n                    color: white;\n                    font-size: 22px;\n                    line-height: 1;\n\n                    opacity: ${faded ? 0 : 1};\n                    transition: ${faded ? 1 : 0.1}s opacity ease-out;\n                }\n\n                @media (max-width: 700px) {\n                    .coordinate-container {\n                        border-radius: 0;\n                        left: 0;\n                        font-size: 18px;\n                    }\n                }\n            `}</style>\n        </div>;\n   }\n}\n\nexport default CoordinateOverlay;\n","import React, {PureComponent} from 'react';\n\nimport {initializeScene, drawScene} from '../../gl-code/scene.js';\nimport {toJS} from '../../gl-code/translators';\n\nimport CoordinateOverlay from './CoordinateOverlay';\n\nimport './function-plot.css';\n\n\nconst FPS_LIMIT = 70;\n\nlet canvasSize = [];\n\nfunction pixelToPlot(x, y, variables) {\n    const scale = Math.exp(variables.log_scale);\n    const offset_x = variables.center_x;\n    const offset_y = variables.center_y;\n\n    const plot_x = (x - canvasSize[0]/2) / scale + offset_x;\n    const plot_y = (canvasSize[1]/2 - y) / scale + offset_y;\n    return [plot_x, plot_y];\n}\n\nfunction plotToPixel(plot_x, plot_y, variables) {\n    const scale = Math.exp(variables.log_scale);\n    const offset_x = variables.center_x;\n    const offset_y = variables.center_y;\n\n    const x = scale * (plot_x - offset_x) + canvasSize[0]/2;\n    const y = -scale * (plot_y - offset_y) - canvasSize[1]/2;\n    return [x, y];\n}\n\nclass FunctionPlot extends PureComponent {\n    state = {\n        position: [NaN, NaN, 0],\n        mouseDown: false,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.gl = null;\n\n        this.variableLocations = {};\n        this.initialized = false;\n\n        this.lastUpdate = null; // Timestamp of last update, for debouncing\n    }\n\n    componentDidMount() {\n        window.addEventListener('resize', this.compilePlot.bind(this));\n\n        this.initializeWebGL();\n        this.componentDidUpdate();\n        this.compilePlot();\n    }\n\n    // Perform a full update of the plot (expensive!)\n    compilePlot() {\n        const {onError} = this.props;\n        this.initializePlot();\n        this.updatePlot();\n        onError(!this.initialized);\n    }\n\n    componentDidUpdate() {\n        const {expression} = this.props;\n        if (this.lastExpression !== expression) {\n            this.compilePlot();\n        }\n        this.lastExpression = expression;\n            \n    }\n\n    getPosition(mouseEvent) {\n        const nativeEvent = mouseEvent.nativeEvent;\n\n        if (nativeEvent.targetTouches !== undefined) {\n            const touches = nativeEvent.targetTouches;\n            if (touches.length === 1) {\n                return [touches[0].pageX, touches[0].pageY, 1];\n            } else {\n                const [x0, y0] = [touches[0].pageX, touches[0].pageY];\n                const [x1, y1] = [touches[1].pageX, touches[1].pageY];\n\n                const centerX = (x0 + x1) / 2;\n                const centerY = (y0 + y1) / 2;\n                const logDistance = Math.log(Math.hypot(x1-x0, y1-y0));\n                return [centerX, centerY, logDistance];\n            }\n        } else {\n            return [nativeEvent.pageX, nativeEvent.pageY, 1];\n        }\n    }\n\n    updatePosition(mouseEvent) {\n        this.setState({position: this.getPosition(mouseEvent)});\n    }\n\n    handleZoom(wheelEvent, deltaLogScale) {\n        const {position} = this.state;\n        const {variables} = this.props;\n\n        if (!position.every(isFinite)) {return;}\n        const [x, y, _] = position;\n\n        // Recenter plot at scroll location\n        const [mouse_plotx, mouse_ploty] = pixelToPlot(x, y, variables);\n        variables.center_x = mouse_plotx;\n        variables.center_y = mouse_ploty;\n\n        // Change scale\n        if (deltaLogScale === undefined) {\n            deltaLogScale = (wheelEvent.deltaY > 0) ? -0.05: 0.05;\n        }\n        variables.log_scale += deltaLogScale;\n\n        // Move center back onto mouse\n        const [new_mouse_plotx, new_mouse_ploty] = pixelToPlot(x, y, variables);\n        const [x_shift, y_shift] = [new_mouse_plotx - mouse_plotx, new_mouse_ploty - mouse_ploty];\n        variables.center_x -= x_shift;\n        variables.center_y -= y_shift;\n\n        this.updatePlot();\n    }\n\n    handleMouseDown(event) {\n        this.updatePosition(event);\n        this.setState({mouseDown: true});\n    }\n\n    handleMouseUp(event) {\n        this.setState({mouseDown: false});\n    }\n\n    handleMouseMove(event) {\n        const {mouseDown} = this.state;\n        const {variables} = this.props;\n\n        // Handle dragging of plot\n        if (mouseDown) {\n            const {position} = this.state;\n            const [x, y, logDistance] = this.getPosition(event);\n\n            const deltaPosition = [\n                x - position[0],\n                y - position[1],\n                logDistance - position[2]\n            ];\n\n            const scale = Math.exp(variables.log_scale);\n            variables.center_x -= deltaPosition[0] / scale;\n            variables.center_y += deltaPosition[1] / scale;\n            this.handleZoom(null, deltaPosition[2]);\n            this.updatePlot();\n        }\n        this.updatePosition(event);\n    }\n\n    handleTouchStart(event) {\n        this.handleMouseDown(event);\n    }\n\n    handleTouchMove(event) {\n        this.handleMouseMove(event);\n    }\n\n    handleTouchEnd(event) {\n        this.handleMouseUp(event);\n    }\n\n    handleVariableUpdate(update) {\n        const {variables} = this.props;\n\n        for (const [name, value] of Object.entries(update)) {\n            variables[name] = value;\n        }\n\n        this.updatePlot();\n    }\n\n    initializeWebGL() {\n        const canvas = this.refs.canvas;\n        const axes = this.refs.axes;\n        this.gl = canvas.getContext('webgl');\n        this.axes = axes.getContext('2d');\n\n        if (this.gl === null) {\n            console.error('Unable to initialize WebGL.');\n            return null;\n        }\n    }\n\n    initializePlot() {\n        const {expression, variables} = this.props;\n\n        const canvas = this.refs.canvas;\n        const axes = this.refs.axes;\n        let dpr = window.devicePixelRatio;\n\n        // Resize canvas and WebGL viewport\n        canvas.width = canvas.offsetWidth * dpr;\n        canvas.height = canvas.offsetHeight * dpr;\n\n        axes.width = axes.offsetWidth * dpr;\n        axes.height = axes.offsetHeight * dpr;\n\n        // Record canvas size and update GL viewport\n        canvasSize = [canvas.offsetWidth, canvas.offsetHeight];\n        this.gl.viewport(0, 0, canvas.width, canvas.height);\n\n        // Initialize scene and obtain WebGL variable pointers\n        const variableLocations = initializeScene(\n            this.gl,\n            expression,\n            variables.custom_function > 0.5,\n            Object.keys(variables)\n        );\n\n        // Check if initialized\n        this.initialized = (variableLocations !== null);\n        if (this.initialized) {\n            this.variableLocations = variableLocations;\n        }\n    }\n\n    updatePlot() {\n        const {variables} = this.props;\n        const variableAssignments = {};\n        for (const [name, value] of Object.entries(variables)) {\n            variableAssignments[name] = [this.variableLocations[name], value];\n        }\n\n        // Debounce\n        const now = +new Date();\n        if (this.lastUpdate === null || now - this.lastUpdate > 1e3 / FPS_LIMIT) {\n            drawScene(this.gl, variableAssignments, this.axes);\n            this.lastUpdate = now;\n        }\n    }\n\n    render() {\n        const {position, mouseDown} = this.state;\n        const {expression, variables} = this.props;\n\n        const [x, y] = pixelToPlot(position[0], position[1], variables);\n        const mapping = toJS(expression, variables);\n\n        return (\n            <div id='function-plot'>\n                <div id='fallback-text'>\n                    Loading...\n                    <div className='small'>If nothing happens, please check that Javascript and WebGL are enabled.</div>\n                </div>\n                <canvas\n                    ref='canvas'\n\n                    onMouseDown={(event) => this.handleMouseDown(event)}\n                    onMouseMove={(event) => this.handleMouseMove(event)}\n                    onMouseUp={(event) => this.handleMouseUp(event)}\n\n                    onMouseEnter={(event) => this.handleMouseMove(event)}\n                    onMouseLeave={(event) => this.handleMouseUp(event)}\n\n                    onTouchStart={(event) => this.handleTouchStart(event)}\n                    onTouchMove={(event) => this.handleTouchMove(event)}\n                    onTouchEnd={(event) => this.handleTouchEnd(event)}\n\n                    onWheel={(event) => this.handleZoom(event)}\n\n                    className='full-canvas main-plot'\n                />\n                <canvas\n                    ref='axes'\n                    className='full-canvas axes'\n                />\n\n                {isFinite(x) && isFinite(y) ?\n                    <CoordinateOverlay x={x} y={y} mapping={mapping}/>\n                    : null}\n\n                <style jsx>{`\n            canvas.main-plot {\n                cursor: ${mouseDown ? 'grabbing' : 'grab'};\n            }\n        `}</style>\n            </div>\n        );\n    }\n}\n\nexport {pixelToPlot, plotToPixel};\nexport default FunctionPlot;\n","import React from 'react';\n\nimport withStyles from '@material-ui/core/styles/withStyles';\n\nimport Drawer from '@material-ui/core/Drawer';\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer';\n\nimport './side-panel.css';\n\n\nconst styles = theme => ({\n  toolbar: theme.mixins.toolbar\n});\n\nclass SidePanel extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.classes = props.classes;\n    this.state = {\n      width: null\n    }\n  }\n  \n  componentDidMount() {\n    this.updateWidth();\n    window.addEventListener('resize', this.updateWidth.bind(this));\n  }\n\n  updateWidth() {\n    this.setState({width: window.innerWidth});\n  }\n\n  render() {\n    if (this.state.width > this.props.transitionWidth) {\n      return (\n\t<Drawer\n\t  anchor={this.props.anchor}\n\t  open={this.props.open}\n\t  variant='persistent'\n\t  classes={{\n\t    paper: this.props.className\n\t  }}\n\t>\n\t  <div className={this.classes.toolbar}/>\n\t  <div className='drawer-content'>\n\t    {this.props.children}\n\t  </div>\n\t</Drawer>\n      );\n    } else {\n      return (\n\t<SwipeableDrawer\n\t  anchor={this.props.anchor}\n\t  open={this.props.open}\n\t  onOpen={this.props.onToggle}\n\t  onClose={this.props.onToggle}\n\t  classes={{\n\t    paper: this.props.className\n\t  }}\n\t  disableDiscovery\n\t  disableSwipeToOpen\n\t>\n\t  <div className='drawer-content'>\n\t    {this.props.children}\n\t  </div>\n\t</SwipeableDrawer>\n      );\n    }\n  }\n}\n\nexport default withStyles(styles)(SidePanel);\n","import {complex_functions} from './complex-functions.js';\n\nconst restrictedFunctions = [];\n\nrestrictedFunctions.push(...Object.keys(complex_functions));\nrestrictedFunctions.push(...Object.values(complex_functions).map(f => f.name));\nrestrictedFunctions.push('z', 'i', 'e', 'pi', 'tau', 'phi');\n\n/* GLSL Keywords */\nrestrictedFunctions.push(\n  'attribute', 'const', 'uniform', 'varying',\n  'layout',\n  'centroid', 'flat', 'smooth', 'noperspective',\n  'break', 'continue', 'do', 'for', 'while', 'switch', 'case', 'default',\n  'if', 'else',\n  'in', 'out', 'inout',\n  'float', 'int', 'void', 'bool', 'true', 'false',\n  'invariant', 'discard', 'return',\n  'lowp', 'mediump', 'highp', 'precision',\n  'struct',\n  'common', 'partition', 'active',\n  'asm', 'class', 'union', 'enum', 'typedef', 'template',\n  'this', 'packed',\n  'goto', 'inline', 'noinline', 'volatile', 'public', 'static',\n  'extern', 'external', 'interface',\n  'long', 'short', 'double', 'half', 'fixed', 'unsigned', 'superp',\n  'input', 'output',\n  'filter',\n  'sizeof', 'cast',\n  'namespace', 'using'\n);\n\n/* GLSL Built-In Functions */\nrestrictedFunctions.push(\n  'radians', 'degrees',\n  'sin', 'cos', 'tan',\n  'asin', 'acos', 'atan',\n  'sinh', 'cosh', 'tanh',\n  'asinh', 'acosh', 'atanh',\n  'pow', 'exp', 'log', 'exp2', 'log2',\n  'sqrt', 'inversesqrt',\n  'abs', 'sign', 'floor', 'trunc', 'round',\n  'ceil', 'fract',\n  'mod', 'modf', 'min', 'max',\n  'clamp', 'mix', 'step', 'smoothstep',\n  'isnan', 'isinf',\n  'length', 'distance', 'dot',\n  'cross', 'normalize', 'ftransform',\n  'faceforward',\n  'reflect', 'refract',\n  'transpose', 'inverse',\n  'equal', 'any', 'all', 'not',\n  'texture'\n);\n\nconst functionList = new Set(restrictedFunctions);\nexport default functionList;\n","import React from 'react';\nimport { css } from '@emotion/css';\n\nimport functionList from '../../gl-code/function-list.js';\n\nimport ListItem from '@material-ui/core/ListItem';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\n\n\nconst blacklist = functionList;\n\nclass VariableAdder extends React.PureComponent {\n    constructor(props) {\n        super(props);\n        this.state = {\n            value: '',\n            errorMessage: ''\n        };\n    }\n\n    setValue(value) {\n        this.setState({value: value, errorMessage: ''});\n    }\n\n    handleKeyPress(event) {\n        if (event.keyCode === 13) {\n            this.handleClick();\n        }\n    }\n\n    handleClick() {\n        const name = this.state.value.toLowerCase();\n        if (name === '') {\n            this.setState({errorMessage: 'Must be nonempty'});\n        } else if (name.match(/^[a-z]+$/) === null) {\n            this.setState({errorMessage: 'Letters only'});\n        } else if (blacklist.has(name)) {\n            this.setState({errorMessage: 'Restricted keyword'});\n        } else {\n            this.setValue('');\n            this.props.onClick(name);\n        }\n    }\n\n    render() {\n        return (\n            <ListItem className={css`\n                margin-left: 10px;\n                width: 100%;\n            `}>\n                <TextField\n                    placeholder='Name'\n                    onChange={event => this.setValue(event.target.value)}\n                    onKeyDown={(event) => this.handleKeyPress(event)}\n                    error={this.state.errorMessage !== ''}\n                    helperText={this.state.errorMessage}\n                    value={this.state.value}\n                    className={css`\n                        flex-grow: 1;\n                    `}\n                />\n                <Button\n                    onClick={() => this.handleClick()}\n                >Add</Button>\n            </ListItem>\n        );\n    }\n}\n\nexport default VariableAdder;\n","function lowerParser(text) {\n    return text.toLowerCase();\n}\n\nfunction numberParser(text) {\n    const parsed = Number(text);\n\n    if (!Number.isNaN(parsed)) {\n        return parsed;\n    }\n}\n\nconst parsers = {\n    number: numberParser,\n    lower: lowerParser\n};\nexport default parsers;\n","import React, {PureComponent} from 'react';\nimport ContentEditable from 'react-contenteditable';\n\nimport DEFAULT_PARSERS from './parsers.js';\nimport './EditableValue.css';\n\n\nclass EditableValue extends PureComponent {\n    constructor() {\n        super();\n        this.state = {\n            focused: false,\n            text: ''\n        };\n        this.element = React.createRef();\n    }\n\n    /*** Value Parsing ***/\n    getParser() {\n        if (this.props.parser in DEFAULT_PARSERS) {\n            return DEFAULT_PARSERS[this.props.parser];\n        } else {\n            return this.props.parser;\n        }\n    }\n\n    parsedValue() {\n        return this.getParser()(this.state.text);\n    }\n\n    valid() {\n        return this.parsedValue() !== undefined;\n    }\n\n    // Resets this.state.text to match this.props.value\n    reset() {\n        const propText = this.props.value.toString();\n        if (propText !== this.state.text) {\n            this.setState({text: this.props.value.toString()});\n        }\n    }\n\n\n    /*** Event Handlers ***/\n    componentDidMount() {\n        // Exit on Enter keypress\n        document.addEventListener('keydown', e => {\n            if (e.key === 'Enter' && this.state.focused) {\n                this.element.current.blur();\n            }\n        });\n    }\n\n    handleFocus(e) {\n        this.setState({focused: true});\n        this.reset();\n    }\n\n    handleChange(e) {\n        this.setState({text: e.target.value.toString()});\n    }\n\n    handleBlur(e) {\n        this.setState({focused: false});\n\n        if (this.valid()) {\n            this.props.onChange(this.parsedValue());\n        }\n    }\n\n    componentDidUpdate() {if (!this.state.focused) {this.reset();}}\n\n    render() {\n        const classes = ['editable-value', this.props.name];\n\n        if (this.state.focused) {\n            classes.push('focus')\n            if (!this.valid()) {\n                classes.push('invalid')\n            };\n        }\n\n        const classString = classes.join(' ');\n        const current = this.element.current;\n        if (current !== null) {\n            this.element.current.setAttribute('class', classString);\n        }\n\n        const displayText = this.state.focused ? this.state.text : this.props.value.toString();\n\n        if (this.props.disabled) {\n            return (\n                <span className={classString}>\n                    {displayText}\n                </span>\n            );\n        } else {\n            return (\n                <ContentEditable\n                    html={displayText}\n\n                    onFocus={this.handleFocus.bind(this)}\n                    onChange={this.handleChange.bind(this)}\n                    onBlur={this.handleBlur.bind(this)}\n\n                    className={classString}\n\n                    tagName='span'\n\n                    innerRef={this.element}\n                />\n            );\n        }\n    }\n}\n\nexport default EditableValue;\n","import React, { PureComponent } from 'react';\nimport { css } from '@emotion/css';\n\n\nimport BaseSlider from '@material-ui/core/Slider';\nimport IconButton from '@material-ui/core/IconButton';\nimport DeleteIcon from '@material-ui/icons/Delete';\n\nimport PlayIcon from '@material-ui/icons/PlayArrow';\nimport BounceIcon from '@material-ui/icons/SyncAlt';\nimport LoopIcon from '@material-ui/icons/ArrowRightAlt';\n\nimport EditableValue from '../editable-value/EditableValue.js';\n\nimport './Slider.css';\n\nconst SPEEDS = [\n    0.2,\n    0.5,\n    1,\n    2,\n    3,\n    4\n];\n\nfunction AnimationMode({mode, speed, onChangeMode, onChangeSpeed}) {\n    const nextMode = {\n        '': 'bounce',\n        'bounce': 'loop',\n        'loop': '',\n    };\n    const icons = {\n        '': PlayIcon,\n        'bounce': BounceIcon, \n        'loop': LoopIcon,\n    }\n    const Icon = icons[mode];\n\n    return <div className={css`\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        margin-right: 10px;\n    `}>\n        <Icon className={css`\n            color: ${mode === '' ? 'hsl(200, 10%, 80%)' : 'hsl(200, 60%, 50%)'};\n            cursor: pointer;\n        `}\n        onClick={() => {\n            const newMode = nextMode[mode];\n            onChangeMode(newMode) ;\n        }}/>\n        <span\n            onClick={() => {\n                onChangeSpeed((speed + 1) % SPEEDS.length);\n            }}\n            className={css`\n                font-size: 12px;\n                color: hsl(200, 20%, 40%);\n                cursor: pointer;\n                user-select: none;\n            `}\n        >\n            {SPEEDS[speed].toFixed(1)}×\n        </span>\n    </div>;\n}\n\n\nclass Slider extends PureComponent {\n    state = {\n        min: 0,\n        max: 1,\n        animationMode: '',\n        animationSpeed: 2,\n        animationCurrentDirection: 1,\n    };\n    deleted = false;\n\n\n    setMin(min) {\n        const {value, onChange} = this.props;\n        this.setState({min});\n        if (value < min) {onChange(min);}\n    }\n\n    setMax(max) {\n        const {value, onChange} = this.props;\n        this.setState({max});\n        if (value > max) {onChange(max);}\n    }\n\n    setValue(value) {\n        this.ensureConsistency();\n        this.props.onChange(value);\n    }\n\n    // Adjust this.state.min and this.state.max\n    // if this.props.value is out of bounds.\n    ensureConsistency() {\n        const [min, max, value] = [this.state.min, this.state.max, this.props.value];\n        if (min > value) {this.setState({min: value});}\n        if (max < value) {this.setState({max: value});}\n    }\n\n    runAnimationTick(timestamp) {\n        const {onChange, value} = this.props;\n        const {\n            min, max,\n            animationMode, animationCurrentDirection, animationSpeed\n        } = this.state;\n\n        if (this.deleted) {return;}\n\n        let dt = 0;\n        if (timestamp !== undefined && this.lastAnimationTick !== undefined) {\n            dt = timestamp - this.lastAnimationTick;\n        }\n        this.lastAnimationTick = timestamp;\n\n        const delta = (max - min) * SPEEDS[animationSpeed] * animationCurrentDirection * dt/4e3;\n        let newValue = value + delta;\n\n        if (animationMode === 'bounce') {\n            if (newValue > max) {\n                newValue = max;\n                this.setState({animationCurrentDirection: -1});\n            }\n            if (newValue < min) {\n                newValue = min;\n                this.setState({animationCurrentDirection: 1});\n            }\n        }\n\n        if (animationMode === 'loop') {\n            if (newValue > max) {newValue = min;}\n        }\n\n        onChange(Math.round(1e3 * newValue)/1e3);\n\n        if (animationMode === '') {return;}\n        requestAnimationFrame(this.runAnimationTick.bind(this));\n    }\n\n    componentDidMount() {\n        this.ensureConsistency();\n    }\n\n    render() {\n        const {min, max, animationMode, animationSpeed} = this.state;\n        return (\n            <div className={css`\n                display: flex;\n                flex-direction: row;\n                align-items: center;\n                margin: 10px 0;\n                margin-left: 10px;\n            `}>\n                <AnimationMode\n                    mode={animationMode}\n                    speed={animationSpeed}\n                    onChangeMode={\n                        (mode) => {\n                            this.state.animationMode = mode; // To avoid race conditions\n                            this.setState({animationMode: mode, animationCurrentDirection: 1});\n                            this.runAnimationTick();\n                        }\n                    }\n                    onChangeSpeed={\n                        (speed) => {\n                            this.setState({animationSpeed: speed});\n                        }\n                    }\n                />\n                <div className='slider'>\n                    <div className='info-row'>\n                        <EditableValue\n                            name='name'\n                            value={this.props.name}\n                            parser='lower'\n                            onChange={this.props.onNameChange}\n                            disabled\n                        />\n                        <span>=</span>\n                        <EditableValue\n                            name='value'\n                            value={this.props.value}\n                            parser='number'\n                            onChange={this.setValue.bind(this)}\n                        />\n                    </div>\n                    <div className='main-row'>\n                        <EditableValue\n                            name='lower-bound'\n                            value={min}\n                            parser='number'\n                            onChange={this.setMin.bind(this)}\n                        />\n                        <BaseSlider\n                            className='main-slider'\n                            min={min}\n                            max={max}\n                            value={this.props.value}\n                            step={(max - min)/1e3}\n                            onChange={(e, v) => this.setValue(v)}\n                        />\n                        <EditableValue\n                            name='upper-bound'\n                            value={max}\n                            parser='number'\n                            onChange={this.setMax.bind(this)}\n                        />\n                    </div>\n                </div>\n                <IconButton onClick={() => {\n                    this.deleted = true;\n                    this.props.onDelete();\n                }} className='delete-icon'>\n                    <DeleteIcon/>\n                </IconButton>\n            </div>\n        );\n    }\n}\n\nexport default Slider;\n","import React from 'react';\n\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\n\nimport VariableAdder from './VariableAdder.js';\n\nimport Slider from './slider/Slider.js';\n\nimport './slider-panel.css';\n\n\nconst hiddenVariables = new Set([\n  'log_scale', 'center_x', 'center_y',\n\n  'enable_checkerboard',\n  'invert_gradient',\n  'continuous_gradient',\n  'enable_axes',\n\n  'custom_function'\n]);\n\nclass SliderPanel extends React.Component {\n  constructor(props) {\n    super(props);\n    this.textField = React.createRef();\n  }\n\n  handleChange(name, value) {\n    this.props.variables[name] = value;\n    this.props.onUpdate({[name]: value});\n    this.forceUpdate();\n  }\n\n  renderSliderList() {\n    const {variables} = this.props;\n    let sliderList = [];\n    for (const [name, value] of Object.entries(variables)) {\n      // Skip variables in hidden blacklist\n      if (hiddenVariables.has(name)) {continue;}\n\n      // Return slider component\n      sliderList.push(\n\t<Slider \n\t  key={name}\n\t  name={name}\n\t  value={value}\n\t  onChange={(value) => this.handleChange(name, value)}\n\t  onDelete={() => this.props.onRemove(name)}\n\t/>\n      );\n    }\n\n    return sliderList;\n  }\n\n  render() {\n    return (\n      <List id='variable-list'>\n\t<ListSubheader disableSticky>Variables</ListSubheader>\n\t{this.renderSliderList()}\n\t<VariableAdder\n\t  onClick={name => this.props.onAdd(name, 0.5)}\n\t/>\n      </List>\n    );\n  }\n}\n\nexport default SliderPanel;\n","import React from 'react';\n\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Checkbox from '@material-ui/core/Checkbox';\n\n\nclass BooleanOption extends React.PureComponent {\n  render() {\n    const {onClick, checked, label} = this.props;\n    return (\n      <ListItem\n\tbutton\n\tonClick={onClick}\n      >\n\t<Checkbox\n\t  checked={checked}\n\t/>\n\t<ListItemText>{label}</ListItemText>\n      </ListItem>\n    );\n  }\n}\n\nclass OptionsPanel extends React.PureComponent {\n  renderOptions() {\n    const options = [];\n    for (const [variable, label] of Object.entries(this.props.options)) {\n      options.push(\n\t<BooleanOption\n\t  key={variable}\n\t  onClick={() => this.props.onToggle(variable)}\n\t  checked={this.props.variables[variable] > 0.5}\n\t  label={label}\n\t/>\n      );\n    }\n    return options;\n  }\n\n  render() {\n    return (\n      <List id='options-panel'>\n\t<ListSubheader disableSticky>{this.props.heading}</ListSubheader>\n\t{this.renderOptions()}\n      </List>\n    );\n  }\n}\n\nexport default OptionsPanel;\n","import React from 'react';\nimport { css } from '@emotion/css';\n\nimport {InlineMath, BlockMath} from 'react-katex';\n\nimport {formatComplex} from '../util';\n\nconst PREFIX = '\\\\int_{\\\\gamma} f(z) \\\\, \\\\mathrm{d}z = ';\n\nexport default ({x, y, style}) => {\n    let contents = <div className={css`\n        color: hsl(0, 100%, 30%);\n        font-size: 18px;\n        padding: 8px 0;\n    `}>\n        Custom functions are currently unsupported.\n    </div>;\n\n    if (isFinite(x) && isFinite(y)) {\n        if (window.innerWidth < 700) {\n            contents = <div className={css`\n            font-size: 16px;\n            color: hsl(213, 10%, 15%);\n\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n\n            margin: 5px 0;\n        `}>\n                <InlineMath>{PREFIX}</InlineMath>\n                <InlineMath>{formatComplex(x, y, 3)}</InlineMath>\n            </div>;\n        } else {\n            contents = <div className={css`\n            margin: -10px 0;\n            font-size: 20px;\n            color: hsl(213, 10%, 15%);\n        `}>\n                <BlockMath>{PREFIX + formatComplex(x, y, 5)}</BlockMath>\n            </div>;\n        }\n    }\n\n    return <div className={css`\n        background-color: white;\n        box-shadow: 3px 3px 8px hsla(213, 10%, 10%, 0.2);\n        border: 1px solid hsl(213, 10%, 85%);\n        border-radius: 8px;\n\n        padding: 0 15px;\n    `} style={style || {}}>\n        <div className='math'>{contents}</div>\n    </div>};\n","class Strategy {\n    constructor(mapping, canvas, dpr) {\n        this.mapping = mapping;\n        this.canvas = canvas;\n        this.dpr = dpr;\n\n        this.initialize();\n    }\n\n    initialize() {\n        this.canvas.strokeStyle = 'white';\n        this.canvas.lineWidth = 2 * this.dpr;\n    }\n    \n    update(data) {\n        const {x, y, clientX, clientY} = data;\n        this.integrate(x, y);\n        this.draw(clientX, clientY);\n    }\n\n    finish() {}\n\n    integrate(x, y) {}\n\n    draw(x, y) {}\n\n    value() {\n        return [0, 0];\n    }\n}\n\nexport default Strategy;\n","// 16-point Gaussian quadrature\nconst GAUSS_COEFFICIENTS = [\n    [0.1894506104550685,  0.0950125098376374],\n    [0.1826034150449236,  0.2816035507792589],\n    [0.1691565193950025,  0.4580167776572274],\n    [0.1495959888165767,  0.6178762444026438],\n    [0.1246289712555339,  0.7554044083550030],\n    [0.0951585116824928,  0.8656312023878318],\n    [0.0622535239386479,  0.9445750230732326],\n    [0.0271524594117541,  0.9894009349916499],\n\n    [0.1894506104550685, -0.0950125098376374],\n    [0.1826034150449236, -0.2816035507792589],\n    [0.1691565193950025, -0.4580167776572274],\n    [0.1495959888165767, -0.6178762444026438],\n    [0.1246289712555339, -0.7554044083550030],\n    [0.0951585116824928, -0.8656312023878318],\n    [0.0622535239386479, -0.9445750230732326],\n    [0.0271524594117541, -0.9894009349916499],\n];\n\n// Integrates a function R -> C\n// from start to end via\n// Gaussian quadrature.\nfunction integrateReal(start, end, mapping) {\n    // Reparameterize to [-1, 1]\n    const dx = end - start;\n    const submap = t => mapping(\n        start + 0.5 * dx * (1 + t)\n    );\n\n    // Estimate average value of f over the given interval\n    const result = [0, 0];\n    for (let [weight, abscissa] of GAUSS_COEFFICIENTS) {\n        const [u, v] = submap(abscissa);\n        result[0] += u * dx * weight / 2;\n        result[1] += v * dx * weight / 2;\n    }\n    return result;\n}\n\n// Integrates f(z) dz along the given line segment.\n// Start and end are 2-tuples representing\n// the start and end points in the complex plane.\n// Mapping is a function [x, y] -> [u, v]\n// representing f.\nfunction integrateSegment(start, end, mapping) {\n    const [x0, y0] = start;\n    const [x1, y1] = end;\n\n    // Compute dz\n    const dx = x1 - x0;\n    const dy = y1 - y0;\n\n    // Approximate average value of f(z)\n    // along the segment by Gaussian quadrature\n    const submap = t => mapping([\n        x0 + t * dx,\n        y0 + t * dy,\n    ]);\n    const [u, v] = integrateReal(0, 1, submap);\n\n    return [\n        u * dx - v * dy,\n        v * dx + u * dy,\n    ];\n}\n\nexport {integrateReal, integrateSegment};\n","import Strategy from './Strategy';\n\nimport {isNil} from 'lodash';\n\nimport {integrateSegment} from './util';\n\n\nclass FreeformIntegrator extends Strategy {\n    accumulator = [0, 0];\n\n    lastPoint = null;\n    lastPagePoint = null;\n\n    integrate(x, y) {\n        if (!isNil(this.lastPoint)) {\n            // Integrate along segment between last and current points\n            const df = integrateSegment(this.lastPoint, [x, y], this.mapping);\n            this.accumulator[0] += df[0]\n            this.accumulator[1] += df[1];\n        }\n        this.lastPoint = [x, y];\n    }\n\n    draw(x, y) {\n        if (!isNil(this.lastPagePoint)) {\n            const [lastX, lastY] = this.lastPagePoint;\n            this.canvas.beginPath();\n            this.canvas.moveTo(lastX, lastY);\n            this.canvas.lineTo(x, y);\n            this.canvas.stroke();\n        }\n        this.lastPagePoint = [x, y];\n    }\n\n    value() {\n        return this.accumulator;\n    }\n}\n\nexport default FreeformIntegrator;\n","import Strategy from './Strategy';\n\nimport {isNil} from 'lodash';\n\nimport {integrateReal} from './util';\n\n// Kahan summation algorithm\nfunction kahanSum(list) {\n    let sum = 0;\n    let c = 0;\n\n    for (let entry of list) {\n        const y = entry - c;\n        const t = sum + y;\n        c = (t - sum) - y;\n        sum = t;\n    }\n\n    return sum;\n}\n\n\nclass Circle extends Strategy {\n    center = null;\n    radius = null;\n\n    pageCenter = null;\n    pageRadius = null;\n\n    integrate(x, y) {\n        if (isNil(this.center)) {this.center = [x, y];}\n        this.radius = Math.hypot(x - this.center[0], y - this.center[1]);\n    }\n\n    draw(x, y) {\n        if (isNil(this.pageCenter)) {this.pageCenter = [x, y];}\n        this.pageRadius = Math.hypot(x - this.pageCenter[0], y - this.pageCenter[1]);\n\n        this.canvas.clearRect(0, 0, this.canvas.canvas.width, this.canvas.canvas.height);\n        this.canvas.beginPath();\n        this.canvas.arc(...this.pageCenter, this.pageRadius, 0, 2 * Math.PI);\n        this.canvas.stroke();\n    }\n\n    value() {\n        // Return 0 if not initialized\n        if (isNil(this.center)) {return [0, 0];}\n        const [x, y] = this.center;\n\n        // Parameterize circle and compute pullback of integrand\n        const gamma = theta => [\n            x + this.radius * Math.cos(theta),\n            y + this.radius * Math.sin(theta),\n        ];\n        const gammaPrime = theta => [\n            -this.radius * Math.sin(theta),\n            this.radius * Math.cos(theta),\n        ];\n        const integrand = theta => {\n            const [u, v] = this.mapping(gamma(theta));\n            const [up, vp] = gammaPrime(theta);\n            return [u * up - v * vp, u * vp + v * up];\n        }\n\n        // Divide circle into arcs and integrate along each\n        const N = 32;\n        const scaleFactor = 2 * Math.PI / N;\n        const summands = [[], []];\n        for (let i=0; i < N; i++) {\n            const [u, v] = integrateReal(\n                i * scaleFactor, (i + 1) * scaleFactor, integrand\n            );\n            summands[0].push(u);\n            summands[1].push(v);\n        }\n\n        return [kahanSum(summands[0]), kahanSum(summands[1])];\n    }\n}\n\nexport default Circle;\n","import React, {PureComponent} from 'react';\n\nimport {isNil} from 'lodash';\n\nimport {pixelToPlot} from '../FunctionPlot';\nimport {toJS} from '../../gl-code/translators';\n\nimport ResultTooltip from './ResultTooltip';\n\nimport FreeformStrategy from './strategies/Freeform';\nimport ClosedFreeformStrategy from './strategies/FreeformClosed';\nimport CircleStrategy from './strategies/Circle';\n\nconst STRATEGY_DICT = {\n    'freeform': FreeformStrategy,\n    'freeform-closed': ClosedFreeformStrategy,\n    'circle': CircleStrategy,\n}\n\nclass IntegralCalculator extends PureComponent {\n    state = {\n        done: false,\n\n        mouseDown: false,\n        mousePosition: null,\n        strategy: null,\n    }\n\n    constructor(props) {\n        super(props);\n\n        // Create canvas ref\n        this.canvas = React.createRef();\n    }\n\n    resizeCanvas() {\n        const canvas = this.canvas.current;\n        const dpr = window.devicePixelRatio;\n        canvas.width = canvas.offsetWidth * dpr;\n        canvas.height = canvas.offsetHeight * dpr;\n    }\n\n\n    // Re-initialized the state if dirty\n    resetState() {\n        const {done} = this.state;\n        if (done) {\n            this.setState({\n                done: false,\n                mousePosition: null,\n                strategy: null,\n           });\n        }\n    }\n\n    handleMouseDown(e) {\n        const {integrator, expression, variables, onClose} = this.props;\n        const {done} = this.state;\n\n        if (done) {\n            // Close if already integrated once\n            onClose();\n        } else {\n            // Compile plotted expression to JS\n            const mapping = toJS(expression, variables);\n\n            // Clear canvas\n            this.resizeCanvas();\n            const context = this.canvas.current.getContext('2d');\n            context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n\n            // Start integrating\n            this.setState({\n                mouseDown: true,\n                strategy: new STRATEGY_DICT[integrator](\n                    mapping, context, window.devicePixelRatio,\n                ),\n            });\n        }\n    }\n\n    handleMouseMove(e) {\n        const {strategy, mouseDown} = this.state;\n        const {variables} = this.props;\n\n        if (!mouseDown) {return;}\n\n        const {clientX, clientY} = e;\n        const [x, y] = pixelToPlot(clientX, clientY, variables);\n\n        this.setState({mousePosition: [clientX, clientY]});\n\n        if (!isNil(strategy)) {\n            const dpr = window.devicePixelRatio;\n            strategy.update({\n                x, y,\n                clientX: clientX * dpr,\n                clientY: clientY * dpr,\n            });\n        }\n    }\n\n    handleMouseUp(e) {\n        const {strategy} = this.state;\n\n        // Notify integrator\n        strategy.finish();\n\n        // Set finished state\n        this.setState({mouseDown: false, done: true});\n    }\n\n    render() {\n        const {integrator} = this.props;\n        const {done, mouseDown, mousePosition, strategy} = this.state;\n\n        if (isNil(integrator)) {\n            this.resetState();\n            return null;\n        }\n\n        let tooltip = null;\n        if (!(isNil(strategy) || isNil(mousePosition))) {\n            const [x, y] = strategy.value();\n\n            const snap = x => (Math.abs(x) < 1e-10 ? 0 : x);\n\n            tooltip = <ResultTooltip\n                x={snap(x)} y={snap(y)}\n                style={{\n                    position: 'absolute',\n                    top: mousePosition[1],\n                    left: mousePosition[0] - (window.innerWidth < 700 ? 80 : 0),\n                    zIndex: 3,\n                }}\n            />;\n        }\n\n\n        return <div className='integral container'\n            onMouseDown={this.handleMouseDown.bind(this)}\n            onMouseMove={this.handleMouseMove.bind(this)}\n            onMouseUp={this.handleMouseUp.bind(this)}\n\n            onTouchStart={this.handleMouseDown.bind(this)}\n            onTouchMove={e => this.handleMouseMove(e.touches[0])}\n            onTouchEnd={this.handleMouseUp.bind(this)}\n        >\n            <canvas\n                ref={this.canvas}\n                className='canvas'\n            />\n            {tooltip}\n            <p className='instructions'>\n                Click and drag to draw a contour\n            </p>\n            <style>{`\n                .integral.container {\n                    position: absolute;\n\n                    top: 0;\n                    bottom: 0;\n                    left: 0;\n                    right: 0;\n\n                    z-index: 15;\n                    cursor: ${done ? 'default' : 'crosshair'};\n\n                    overflow: hidden;\n\n                    background-color: hsla(213, 10%, 10%, 0.6);\n\n                    display: flex;\n                    flex-direction: row;\n                    align-items: center;\n                    justify-content: center;\n                }\n\n                .integral canvas.canvas {\n                    position: absolute;\n                    top: 0;\n                    left: 0;\n\n                    width: 100%;\n                    height: 100%;\n                    \n                    z-index: 1;\n                }\n\n                .integral .instructions {\n                    color: hsl(213, 10%, 85%);\n                    font-size: 20px;\n                    text-align: center;\n\n                    margin: 0;\n                    display: ${mouseDown || done ? 'none' : 'block'};\n                    z-index: 2;\n                }\n            `}</style>\n        </div>;\n    }\n}\n\nexport default IntegralCalculator;\n","import Freeform from './Freeform';\n\nimport {isNil} from 'lodash';\n\nclass FreeformClosed extends Freeform {\n    startPoint = null;\n    startPagePoint = null;\n\n    integrate(x, y) {\n        super.integrate(x, y);\n        if (isNil(this.startPoint)) {\n            this.startPoint = [x, y];\n        }\n    }\n\n    draw(x, y) {\n        super.draw(x, y);\n        if (isNil(this.startPagePoint)) {\n            this.startPagePoint = [x, y];\n        }\n    }\n\n    finish() {\n        if (isNil(this.startPoint) || isNil(this.startPagePoint)) {return;}\n\n        // Loop back to start\n        const [x, y] = this.startPoint;\n        const [clientX, clientY] = this.startPagePoint;\n        this.update({\n            x, y,\n            clientX, clientY\n        });\n    }\n}\n\nexport default FreeformClosed;\n","import React, {PureComponent} from 'react';\n\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\n\nimport FreeformIcon from '@material-ui/icons/Brush';\nimport ClosedLoopIcon from '@material-ui/icons/SettingsBackupRestore';\nimport CircleIcon from '@material-ui/icons/PanoramaFishEye';\n\n\nconst calculators = [\n    {\n        strategy: 'freeform',\n        label: 'Freeform',\n        icon: <FreeformIcon/>,\n    },\n    {\n        strategy: 'freeform-closed',\n        label: 'Freeform (Closed Loop)',\n        icon: <ClosedLoopIcon/>,\n    },\n    {\n        strategy: 'circle',\n        label: 'Circular Contour',\n        icon: <CircleIcon/>,\n    },\n];\n\nclass IntegralPanel extends PureComponent {\n    renderIntegrator(entry) {\n        const {strategy, label, icon} = entry;\n        const {hidePanels, openCalculator} = this.props;\n\n        const onClick = () => {\n            // Hide panels on mobile\n            if (window.innerWidth < 700) {hidePanels();}\n\n            // Close existing calculator, if present\n            openCalculator(null);\n\n            // Show desired integral calculator\n            // (setTimeout to ensure old calculator closes)\n            setTimeout(() => openCalculator(strategy), 0);\n        };\n\n        return <ListItem button key={strategy} onClick={onClick}>\n            <ListItemIcon>{icon}</ListItemIcon>\n            <ListItemText style={{paddingLeft: 0}}>{label}</ListItemText>\n        </ListItem>;\n    }\n\n    render() {\n        return <List>\n            <ListSubheader disableSticky>Contour Integrals</ListSubheader>\n            {calculators.map(this.renderIntegrator.bind(this))}\n        </List>;\n    }\n}\n\nexport default IntegralPanel;\n","import React from 'react';\n\nimport Typography from '@material-ui/core/Typography';\n\nimport Editor from 'react-simple-code-editor';\nimport { highlight, languages } from 'prismjs/components/prism-core';\nimport 'prismjs/components/prism-clike';\nimport 'prismjs/components/prism-c';\nimport 'prismjs/components/prism-glsl';\nimport 'prismjs/themes/prism-okaidia.css';\n\nimport './function-editor.css';\n\nexport default ({value, onChange, errorMessage}) => <div id='function-editor'>\n    <Typography variant='caption'>\n      Please read the “Advanced Features” documentation in the right pane before proceeding!\n      <br/>\n      Compilation errors are currently logged to the developer console.\n    </Typography>\n    <Editor\n        value={value}\n        onValueChange={onChange}\n        highlight={code => {var a = highlight(code, languages.glsl); console.log(a); return a;}}\n        padding={10}\n        style={{\n          fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n          fontSize: 14,\n          backgroundColor: 'hsl(200, 20%, 10%)',\n          color: 'white',\n          marginTop: 10,\n          borderRadius: 8,\n        }}\n    />\n</div>;\n","import React from 'react';\n\nimport withStyles from '@material-ui/core/styles/withStyles';\n\nimport Typography from '@material-ui/core/Typography';\nimport Chip from '@material-ui/core/Chip';\nimport Accordion from '@material-ui/core/Accordion';\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\n\nimport MenuIcon from '@material-ui/icons/Menu';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\n\nimport {Light as SyntaxHighlighter} from 'react-syntax-highlighter';\nimport glslHighlighter from 'react-syntax-highlighter/dist/esm/languages/hljs/glsl';\nimport { docco } from 'react-syntax-highlighter/dist/esm/styles/hljs';\n\nimport './help-text.css';\n\nSyntaxHighlighter.registerLanguage('glsl', glslHighlighter);\n\n\nconst styles = theme => ({\n    buttonStyle: {\n        ...theme.typography.button\n    },\n    chip: {\n        margin: 3\n    }\n});\n\nconst supportedFunctions = [\n    {\n        name: 'Operators',\n        entries: ['+', '-', '*', '/', '^', '!']\n    },\n    {\n        name: 'Trigonometry',\n        entries: [\n            'sin', 'cos', 'tan', 'sec', 'csc', 'cot',\n            'arcsin', 'arccos', 'arctan', 'arcsec', 'arccsc', 'arccot',\n            'sinh', 'cosh', 'tanh', 'sech', 'csch', 'coth',\n            'arsinh', 'arcosh', 'artanh', 'arsech', 'arcsch', 'arcoth'\n        ]\n    },\n    {\n        name: 'Exponential',\n        entries: ['exp', 'log', 'ln']\n    },\n    {\n        name: 'Constants',\n        entries: ['e', 'pi', 'phi', 'tau'],\n    },\n    {\n        name: 'Elliptic',\n        entries: [\n            'sn(z, k)',\n            'cn(z, k)',\n            'dn(z, k)',\n            'wp(z, τ)',\n            \"wp'(z, τ)\",\n            'theta00(z, τ)',\n            'theta01(z, τ)',\n            'theta10(z, τ)',\n            'theta11(z, τ)',\n            'sm', 'cm',\n        ]\n    },\n    {\n        name: 'Special Functions',\n        entries: [\n            'sqrt',\n            'gamma', 'eta', 'zeta',\n            'erf',\n        ]\n    },\n    {\n        name: 'Miscellaneous',\n        entries: [\n            'abs', 'arg', 'sgn', 'cis',\n            'conj',\n            'real', 'imag',\n            'floor', 'ceil', 'round', 'step',\n        ]\n    }\n];\n\n\nconst EXAMPLES = {\n    '+': 'z + t',\n    '-': 'z - t',\n    '*': 't * z',\n    '/': '1/z',\n    '^': 'z^z^z^z^z^z^z',\n    '!': 'z!',\n\n    'e': null,\n    'pi': null,\n    'tau': null,\n    'phi': null,\n\n    'sn(z, k)': 'sn(z, t + i)',\n    'cn(z, k)': 'cn(z, t + i)',\n    'dn(z, k)': 'dn(z, t + i)',\n    'wp(z, τ)': 'wp(z, t + i)',\n    \"wp'(z, τ)\": \"wp'(z, t + i)\",\n    'theta00(z, τ)': 'theta00(z, t + i)',\n    'theta01(z, τ)': 'theta01(z, t + i)',\n    'theta10(z, τ)': 'theta10(z, t + i)',\n    'theta11(z, τ)': 'theta11(z, t + i)',\n};\n\n\nclass HelpText extends React.Component {\n    constructor(props) {\n        super(props);\n        this.classes = props.classes;\n    }\n\n    shouldComponentUpdate() {\n        return false;\n    }\n\n    renderChips(entries) {\n        const {setExpression, closeMenu} = this.props;\n        const showExample = (label) => setExpression(\n            EXAMPLES[label] || `${label}(z)`\n        );\n        return entries.map(label =>\n            <Chip \n                key={label}\n                label={label}\n                onClick={EXAMPLES[label] === null ? undefined : () => {\n                    if (window.innerWidth <= 900) {closeMenu();}\n                    showExample(label);\n                }}\n                className={this.classes.chip}\n            />\n        );\n    }\n\n    renderSupportedFunctions() {\n        const sections = []\n        for (const section of supportedFunctions) {\n            sections.push(\n                <div key={section.name}>\n                    <h3>{section.name}</h3>\n                    {this.renderChips(section.entries)}\n                </div>\n            );\n        }\n        return sections;\n    }\n\n    render() {\n        return (\n            <div id='help-text'>\n                <h1>\n                    <img src='android-chrome-192x192.png' className='logo' alt='logo'/>\n                    <div className='text'>\n                        Complex Function Plotter\n                        <div className='subtitle'>\n                            Made with {'<3'} by Samuel J. Li\n                        </div>\n                    </div>\n                </h1>\n\n                <h2>Introduction</h2>\n                <p>Creates interactive domain-coloring plots of complex functions.</p>\n                <p>Each point on the complex plane is colored according to the value of the function at that point.\n                    Hue and brightness are used to display phase and magnitude, respectively.</p>\n                <p>To increase the displayable range of values, brightness cycles from dark to light repeatedly with magnitude, jumping at every power of two.\n                    The “edges” of regions with different brightness correspond to curves along which the function has constant magnitude.\n                </p>\n                <p>This method allows for quick visualization of the locations and orders of any poles and zeros.\n                    For more information, see the <a href='https://en.wikipedia.org/wiki/Domain_coloring'>Wikipedia article on domain coloring.</a></p>\n\n                <h2>Controls</h2>\n                <p>To plot a complex function, enter its expression in the top bar. Parentheses (curved or square), complex number literals, and arbitrary variables (see “Variables” below) are supported. Input is case-insensitive.</p>\n                <p>A red underline will appear if the expression cannot be plotted. You might have made a syntax error or forgot to declare a variable.</p>\n                <p>Drag the plot to pan, and use the scroll wheel to zoom in and out.</p>\n\n                <h2>Supported Functions</h2>\n                <p>Click on any function to see an example.</p>\n                <div className='help-indent'>\n                    {this.renderSupportedFunctions()}\n                </div>\n\n                <h2>Variables</h2>\n                <p>Expressions can contain arbitrary user-defined variables.</p>\n                <p>\n                    Click on the <MenuIcon style={{fontSize: 20, marginBottom: -5}}/> icon in the upper-left corner to open the variables panel.\n                    Variables can be added with the <span className={this.classes.buttonStyle}>Add</span> button and removed with the <DeleteIcon style={{fontSize: 20, marginBottom: -5}}/> button.</p>\n\n                <p>\n                    Click on the variable’s current value or the slider’s upper & lower bounds to edit them.\n                </p>\n\n                <p>Any string of lowercase letters can be used as a variable name, except for reserved functions, the built-in variable <i>z</i>, and the constant <i>i</i>.</p>\n\n                <h2>Contour Integrals</h2>\n                <p>The calculator is able to compute arbitrary contour integrals and residues. The following options\n                    are available under the ‘Contour Integral’ section of the left pane:</p>\n\n                <div className='help-indent'>\n                    <h3>Freeform</h3>\n                    <p>After selecting this option, click and drag to draw an arbitrary contour. The integral of the currently plotted function along the given contour will be displayed.</p>\n\n                    <h3>Freeform (Closed Loop)</h3>\n                    <p>Same as ‘Freeform,’ except that the contour is closed with a line segment connecting the start and end points after it is drawn.</p>\n\n                    <h3>Circular Contour</h3>\n                    <p>After selecting this option, click and drag to draw a circular contour. The integral of the currently plotted function along the given circle (with counterclockwise orientation) will be displayed.</p>\n                </div>\n\n                <p>Note that custom functions and some of the more intricate built-in functions are not yet supported.\n                    The computed values are generally accurate to the displayed precision unless the function is highly pathological.</p>\n\n\n                <h2>Graphics Options</h2>\n                <p>The following options can be found below the variables panel:</p>\n\n                <div className='help-indent'>\n                    <h3>Enable Checkerboard</h3>\n                    <p>Overlays a checkerboard with eight squares per unit length, colored according to the real and imaginary parts of the function’s value.</p>\n\n                    <h3>Invert Gradient</h3>\n                    <p>Reverses the direction of the magnitude gradient. When the gradient is inverted, the apparent height of the “layers” formed correlate with the magnitude of the function.</p>\n\n                    <h3>Continuous Gradient</h3>\n                    <p>Use a continuous magnitude gradient rather than the “stepped” default. Reduces the range of visually discernible magnitudes, but removes shading artifacts in certain situations.</p>\n                    <h3>Enable Axes</h3>\n                    <p>Overlay coordinate axes and gridlines on the plot. May decrease performance on some devices.</p>\n                </div>\n\n                <h2>Tips</h2>\n                <p>To share a graph, just copy and paste the URL! The address automatically changes to reflect the plotted expression.</p>\n\n                <h2>Advanced Features</h2>\n                <Accordion style={{margin: '0 -5px'}}>\n                    <AccordionSummary expandIcon={<ExpandMoreIcon/>}>\n                        <Typography variant='caption'>\n                            Please read thoroughly iff you are using advanced options.\n                        </Typography>\n                    </AccordionSummary>\n                    <AccordionDetails>\n                        <div>\n                            <h3>Custom Functions</h3>\n                            <p>This option can be found under the “Advanced Options” heading in the left pane. Overrides the main expression bar, allowing you to code your own function.</p>\n                            <p>Custom functions use the <a href='https://en.wikipedia.org/wiki/OpenGL_Shading_Language'>GLSL</a> programming language. If you've never worked with GLSL before, it's extremely similar to C. Here are a few tips and caveats:</p>\n                            <ul>\n                                <li>Complex numbers are represented by the <tt>vec2</tt> type, which represents a 2D vector. The real part can be accessed through <tt>z.x</tt> and the imaginary part by <tt>z.y</tt>.</li>\n                                <li>Your custom function should be named <tt>mapping</tt>, and should take one input of type <tt>vec2</tt> and return an output of type <tt>vec2</tt>.</li>\n                                <li>Complex number literals <i>a+bi</i> should be entered as <tt>vec2(a, b)</tt>, even if they are real. GLSL doesn’t support addition or subtraction between the “complex” <tt>vec2</tt> type and floats. Scalar multiplication should work fine with floats, however. For convenience, there are constants <tt>ONE</tt> and <tt>I</tt> available.</li>\n                                <li>Addition and subtraction operators (<tt>+</tt> and <tt>-</tt>) work fine between <tt>vec2</tt> complex numbers. However, multiplication, division, and exponentiation operators act component-wise on the real and imaginary parts, which is probably not what you want. There are <tt>cmul</tt>, <tt>cdiv</tt>, and <tt>cpow</tt> functions available which will perform the proper complex operation.</li>\n                                <li>All supported functions are available, but with a <tt>c</tt> prefix. For example, the sin function is named <tt>csin</tt>. This is to avoid clashing with the built-in (real-valued) GLSL functions.</li>\n                                <li>Constants are available in uppercase with a <tt>C_</tt> prefix (e.g. <tt>C_PI</tt>), and are already in complex <tt>vec2</tt> form.</li>\n                            </ul>\n\n                            <h3>Limitations</h3>\n                            <p>There are currently a few limitations with the custom function feature which I hope to resolve soon:</p>\n                            <ul>\n                                <li>URL-based sharing doesn’t currently work for custom functions. You may share the code directly instead.</li>\n                                <li>The editor will show a red underline if your code fails to compile, but currently does not show useful error information. For now, this information is visible in the developer console.</li>\n                                <li><i>(Thanks to Tim N. for pointing this out.)</i> Due to low-level limitations of GLSL, variable-length loops such as the following do not work:\n                                    <SyntaxHighlighter language='glsl' style={docco}>{`for (int i=0; i<x; i++) {\n    // do stuff\n}`}</SyntaxHighlighter>\n                                    The following workaround is available:\n                                    <SyntaxHighlighter language='glsl' style={docco}>{`for (int i=0; i<1000; i++) {\n    if (i<x) {\n        // do stuff\n    }\n}`}</SyntaxHighlighter>\n                                    This effectively requires setting an arbitrary but finite limit on the number of iterations you wish to do;\n                                    however, this may be acceptable in several applications.\n                                    Note that the loop will be unrolled during compilation, so setting an excessively high limit will lead to poor performance.\n                                </li>\n                            </ul>\n\n                            <h3>Tips</h3>\n                            <p>Most desktop browsers will display a small resize handle at the bottom-right corner of the left pane. This can be very useful when working on complex code.</p>\n                            <p>You can define arbitrary helper functions before your <tt>mapping</tt> function — you have the full power of GLSL!</p>\n\n                            <p><b>You can use all your declared variables</b> directly in your code! They’ve already been converted into complex <tt>vec2</tt> form.</p>\n\n                            <h3>Obligatory Warning</h3>\n                            <p>This is an advanced feature — you may break things! If anything freezes or crashes, a quick reload should resolve the issue (save your code first)!</p>\n                        </div>\n                    </AccordionDetails>\n                </Accordion>\n\n                <h2>Citations</h2>\n                <p>If you use this tool to produce images for a publication, I would greatly appreciate a citation! Something along the lines of:</p>\n                <ul><li>Li, Samuel Jinglian, 2018. “Complex Function Plotter.” <a href='https://samuelj.li/complex-function-plotter/'>https://samuelj.li/complex-function-plotter/</a>.</li></ul>\n                <p>or the equivalent in your journal's citation style is enough.</p>\n\n                <h2>Acknowledgements</h2>\n                <ul>\n                    <li>Inspired by David Bau’s <a href='http://davidbau.com/conformal'>Conformal Map Plotter</a>.</li>\n                    <li>Thanks to Tim N. for helping improve the custom function documentation for variable-length loops.</li>\n                    <li>Thanks to Liu Yi (Ireis, CAS) for requesting the implementation of elliptic functions.</li>\n                    <li>Thanks to Jason Poulin for requesting variable animation support and other improvements.</li>\n                    <li>Thanks to Marius Sarbach for requesting the coordinate axis overlay.</li>\n                </ul>\n\n                <Typography variant='caption'>Complex Function Plotter — Made with love by Samuel J. Li</Typography><br/>\n                <Typography variant='caption'><a href='https://github.com/wgxli/complex-function-plotter'>View the source</a> on GitHub</Typography><br/>\n                <Typography variant='caption'>Found a bug? — <a href='mailto:bug.report@samuelj.li'>bug.report@samuelj.li</a></Typography>\n            </div>\n        );\n    }\n}\n\nexport default withStyles(styles)(HelpText);\n","import React from 'react';\nimport './App.css';\nimport 'katex/dist/katex.min.css';\n\nimport {ThemeProvider as MuiThemeProvider} from '@material-ui/core/styles';\nimport theme from './theme.js';\n\nimport ControlBar from './components/ControlBar/ControlBar.js';\nimport FunctionPlot from './components/FunctionPlot';\n\nimport SidePanel from './components/SidePanel/SidePanel.js';\nimport './components/control-panel.css';\n\nimport SliderPanel from './components/SliderPanel/SliderPanel.js';\nimport OptionsPanel from './components/OptionsPanel/OptionsPanel.js';\n\nimport IntegralCalculator from './components/IntegralCalculator';\nimport IntegralPanel from './components/IntegralCalculator/IntegralPanel';\n\nimport FunctionEditor from './components/FunctionEditor/FunctionEditor.js';\n\nimport HelpText from './components/HelpText/HelpText.js';\n\nimport {parseExpression} from './gl-code/complex-functions';\n\n\nconst defaultShader = `vec2 mapping(vec2 z) {\n  vec2 c = z;\n  for (int i=0; i<64; i++) {\n    z = cmul(z, z) + c;\n  }\n  return z;\n}`;\n\n\nfunction extractVariables(expression) {\n    if (!Array.isArray(expression)) {return new Set();}\n    if (expression[0] === 'variable' && expression[1] !== 'z') {\n        return new Set([expression[1]]);\n    }\n\n    let output = new Set();\n    for (let entry of expression) {\n        output = new Set([...output, ...extractVariables(entry)]);\n    }\n    return output;\n}\n\n\nclass App extends React.Component {\n    state = {\n        expressionText: 'z',\n        expression: ['variable', 'z'],\n        expressionError: false,\n        typingTimer: null,\n\n        customShader: defaultShader,\n        shaderError: false,\n\n        menuOpen: false,\n        helpOpen: false,\n\n        integrationStrategy: null,\n\n        variables: {\n            log_scale: 5,\n            center_x: 0,\n            center_y: 0,\n\n            t: 0.3,\n\n            enable_checkerboard: 1,\n            invert_gradient: 0,\n            continuous_gradient: 0,\n            enable_axes: 1,\n\n            custom_function: 0,\n        }\n    }\n\n    componentDidMount() {\n        window.addEventListener('hashchange', this.handleHashChange.bind(this));\n\n        document.addEventListener(\n            'gesturestart',\n            (event) => this.preventDefault(event),\n            {passive: false}\n        );\n        document.addEventListener(\n            'touchmove',\n            (event) => this.preventDefault(event),\n            {passive: false}\n        );\n\n        this.handleHashChange();\n    }\n\n    preventDefault(event) {\n        const tagName = event.target.tagName.toLowerCase();\n        if (tagName === 'canvas') {\n            event.preventDefault();\n        } else {\n            return event;\n        }\n    }\n\n    // Toolbar buttons\n    handleMenuButton() {\n        this.setState({menuOpen: !this.state.menuOpen});\n    }\n\n    handleHelpButton() {\n        this.setState({helpOpen: !this.state.helpOpen});\n    }\n\n    // Variable Sliders\n    handleVariableUpdate(update) {\n        this.refs.plot.handleVariableUpdate(update);\n    }\n\n    handleVariableAdd(name, value) {\n        const variables = this.state.variables;\n        variables[name] = value;\n        this.setState({variables: variables});\n    }\n\n    handleVariableRemove(name) {\n        const variables = this.state.variables;\n        delete variables[name];\n        this.setState({variables: variables});\n    }\n\n    handleOptionToggle(name) {\n        const variables = this.state.variables;\n        variables[name] = (variables[name] < 0.5) ? 1 : 0;\n        this.handleVariableUpdate({[name]: variables[name]});\n        this.setState({variables});\n    }\n\n    setErrorMessage(message) {\n        const {variables, expressionError, shaderError} = this.state;\n\n        if (variables.custom_function > 0.5) {\n            if (message !== shaderError) {\n                this.setState({shaderError: message});\n            }\n        } else {\n            if (message !== expressionError) {\n                this.setState({expressionError: message});\n            }\n        }\n    }\n\n    handleHashChange() {\n        const hash = window.location.hash;\n        if (hash === '') {\n            this.setExpression('z', true);\n        } else {\n            this.setExpression(decodeURIComponent(hash.slice(1)), true);\n        }\n    }\n\n    setExpression(text, fromHash) {\n        text = text.toLowerCase();\n\n        window.history.replaceState(\n            undefined, undefined,\n            '#' + encodeURIComponent(text)\n        );\n\n        this.setState({\n            expressionText: text,\n            integrationStrategy: null,\n        });\n\n        if (fromHash) {\n            const expression = parseExpression(text.trim());\n            const variables = extractVariables(expression);\n            const newVariables = {...this.state.variables};\n            \n            for (let entry of variables) {\n                newVariables[entry] = 0.5;\n            }\n\n            this.setState({expression, variables: newVariables});\n        } else {\n            clearTimeout(this.typingTimer);\n            this.typingTimer = setTimeout(this.finalizeExpression.bind(this), 100);\n        }\n    }\n\n    finalizeExpression() {\n        const {expressionText} = this.state;\n        const expression = parseExpression(expressionText.trim());\n        this.setState({expression});\n    }\n\n    setCustomShader(text) {\n        this.setState({customShader: text});\n    }\n\n    renderFunctionEditor() {\n        const {variables, customShader, shaderError} = this.state;\n        if (variables.custom_function > 0.5) {\n            return (\n                <FunctionEditor\n                    onChange={this.setCustomShader.bind(this)}\n                    errorMessage={shaderError}\n                    value={customShader}\n                />\n            );\n        } else {\n            return; \n        }\n    }\n\n    render() {\n        const {\n            variables,\n            customShader,\n            expression, expressionText,\n            menuOpen, helpOpen,\n            expressionError,\n            integrationStrategy,\n        } = this.state;\n\n        const useCustomShader = variables.custom_function > 0.5;\n\n        const ast = useCustomShader ? customShader : expression;\n\n        return (\n            <MuiThemeProvider theme={theme}>\n                <div id='app'>\n                    <ControlBar\n                        menuOpen={menuOpen}\n                        helpOpen={helpOpen}\n                        onMenuButton={this.handleMenuButton.bind(this)}\n                        onHelpButton={this.handleHelpButton.bind(this)}\n\n                        onChange={this.setExpression.bind(this)}\n                        value={expressionText}\n                        error={expressionError}\n                        disabled={useCustomShader}\n                    />\n                    <SidePanel\n                        className='control-panel'\n                        open={menuOpen} \n                        onToggle={this.handleMenuButton.bind(this)}\n                        anchor='left'\n                        transitionWidth={480}\n                    >\n                        <SliderPanel\n                            variables={variables}\n                            onUpdate={this.handleVariableUpdate.bind(this)}\n                            onAdd={this.handleVariableAdd.bind(this)}\n                            onRemove={this.handleVariableRemove.bind(this)}\n                        />\n                        <IntegralPanel\n                            variables={variables}\n                            hidePanels={() => this.setState({helpOpen: false, menuOpen: false})}\n                            openCalculator={integrationStrategy => this.setState({integrationStrategy})}\n                        />\n                        <OptionsPanel\n                            heading='Graphics Options'\n                            options={{\n                                enable_checkerboard: 'Enable Checkerboard',\n                                invert_gradient: 'Invert Gradient',\n                                continuous_gradient: 'Continuous Gradient',\n                                enable_axes: 'Enable Axes',\n                            }}\n                            onToggle={this.handleOptionToggle.bind(this)}\n                            variables={variables}\n                        />\n                        <OptionsPanel\n                            heading='Advanced Options'\n                            options={{\n                                custom_function: 'Custom Function'\n                            }}\n                            onToggle={this.handleOptionToggle.bind(this)}\n                            variables={variables}\n                        />\n                        {this.renderFunctionEditor()}\n                    </SidePanel>\n                    <IntegralCalculator\n                        expression={ast}\n                        variables={variables}\n                        integrator={integrationStrategy}\n                        onClose={() => this.setState({integrationStrategy: null})}\n                    />\n                    <FunctionPlot\n                        ref='plot'\n                        expression={ast}\n                        variables={variables}\n                        onError={this.setErrorMessage.bind(this)}\n                    />\n                    <SidePanel\n                        className='help-panel'\n                        open={helpOpen}\n                        anchor='right'\n                        onToggle={this.handleHelpButton.bind(this)}\n                        transitionWidth={900}\n                    >\n                        <HelpText\n                            setExpression={(expression) => {\n                                this.setExpression(expression);\n                                this.handleVariableUpdate({\n                                    ...this.state.variables,\n                                    custom_function: 0,\n                                });\n                            }}\n                            closeMenu={() => this.setState({helpOpen: false})}\n                        />\n                    </SidePanel>\n                </div>\n            </MuiThemeProvider>\n        );\n    }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import 'babel-polyfill';\n\nimport React from 'react';\nimport {render} from 'react-snapshot';\n\nimport './index.css';\n\nimport App from './App';\nimport {unregister} from './registerServiceWorker';\n\n\nrender(<App />, document.getElementById('root'));\n//registerServiceWorker();\nunregister();\n"],"sourceRoot":""}