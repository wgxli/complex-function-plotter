{"version":3,"sources":["gl-code/grammar.js","theme.js","components/ControlBar/ControlBar.js","gl-code/translators/custom-functions.js","gl-code/translators/to-js.js","gl-code/translators/derivative.js","gl-code/translators/compiler.js","gl-code/complex-functions.js","gl-code/translators/to-glsl.js","gl-code/shaders.js","gl-code/scene.js","components/util.js","components/FunctionPlot/CoordinateOverlay.js","components/FunctionPlot/index.js","components/SidePanel/SidePanel.js","gl-code/function-list.js","components/SliderPanel/VariableAdder.js","components/SliderPanel/editable-value/parsers.js","components/SliderPanel/editable-value/EditableValue.js","components/SliderPanel/slider/Slider.js","components/SliderPanel/SliderPanel.js","components/OptionsPanel/OptionsPanel.js","components/IntegralCalculator/ResultTooltip.js","components/IntegralCalculator/strategies/Strategy.js","components/IntegralCalculator/strategies/util.js","components/IntegralCalculator/strategies/Freeform.js","components/IntegralCalculator/strategies/Circle.js","components/IntegralCalculator/index.js","components/IntegralCalculator/strategies/FreeformClosed.js","components/IntegralCalculator/IntegralPanel.js","components/FunctionEditor/FunctionEditor.js","components/HelpText/HelpText.js","App.js","registerServiceWorker.js","index.js"],"names":["id","x","grammar","Lexer","undefined","ParserRules","d","concat","parseInt","join","parseFloat","data","l","reject","token","includes","ParserStart","module","exports","window","theme","createMuiTheme","palette","primary","blue","ControlPanel","event","this","props","onChange","target","value","disabled","onMenuButton","onHelpButton","error","AppBar","Toolbar","disableGutters","IconButton","onClick","TextField","placeholder","innerWidth","handleTextChange","autoFocus","fullWidth","Button","React","PureComponent","math","require","I","complex","cadd","sum","csub","subtract","cdiv","divide","cmul","multiply","cmul_i","z","csin","sin","cexp","exp","clog","log","csqrt","sqrt","cpow","pow","csquare","gamma_right","gamma","re","pi","gamma_left","ETA_COEFFICIENTS","eta_right","map","a","b","eta","eta_left","w","neg","zp1","add","im","conj","component_a","log_r","abs","theta","arg","Math","PI","component_b","multiplier_a","multiplier_b","LN2","component","multiplier","erf_large","k","creciprocal","k2","corrections","theta00","tau","result","n","A","B","C","theta01","theta10","theta11","jacobi_reduce","root_k","q","invert_tau","t00","zz","round","raw_sn","raw_cn","raw_dn","raw_wpp","e2","e1","e3","cm","dot","constants","E","add4","c","fns","add8","e","f","g","h","mul4","rawpow","sub","unaryMinus","mul","div","reciprocal","component_mul","alpha","component_mul_prelog","real","imag","step","arcsin","asin","arccos","acos","arctan","atan","arcsec","asec","arccsc","acsc","arccot","acot","arsinh","asinh","arcosh","acosh","artanh","atanh","arsech","asech","arcsch","acsch","arcoth","acoth","cis","zeta","erf","K","cos","series","kk","push","sn","cn","dn","wp","t002","t102","wpp","t004","t104","t014","PI2_3","sm","j","coeffs","i","mu","num","denom","res","lattice_reduce","toJS","ast","variables","errorValue","NaN","isNaN","operator","args","name","get","func","isNil","destructure","subtree","substitute","Array","isArray","ZERO","ONE","diffTable","diff","compile","contains","some","analyticDiff","internal","console","high","low","numericalDiff","compose","terms","op","op4","op8","length","N","floor","app","slice","NN","NNN","getConst","val","isConst","isZero","idxVar","termAST","sumProd","every","subAST","compiledGrammar","nearley","Grammar","fromCompiled","argument_names","ComplexFunction","body","log_body","dependencies","log_dep","num_args","log_dependencies","parameters","types","fill","params","ComponentMul","ZetaHelper","ZetaHelper2","LatticeReduce","code","mul_i","cconj","cabs","carg","csgn","creal","cimag","cfloor","cceil","cround","cstep","ccis","cexp_raw","ccos","ctan","csec","ccsc","ccot","carcsin","carccos","carctan","carccot","carcsec","carccsc","csinh","ccosh","ctanh","csech","ccsch","ccoth","carsinh","carcosh","cartanh","carsech","carcsch","carcoth","cneg","ccomponent_mul","ccomponent_mul_prelog","cadd4","cadd8","cmul4","cgamma","cgamma_left","cgamma_right","cfact","ceta","ceta_left","zeta_character","ceta_strip","czeta_helper","czeta_helper_2","czeta_strip","ceta_right","czeta","rerf","cerf_large","cerf_small","cerf","ctheta00","ctheta01","ctheta10","ctheta11","theta000","theta00f","theta01f","theta10f","theta11f","invert_code","csn","ccn","cdn","cwp","complex_functions","parseExpression","expression","parser","Parser","feed","results","functionDefinitions","LOG_MODE","required","getRequirements","Set","requirements","req","stack","from","pop","fObj","dep","has","Object","keys","VEC_TYPE","comp_suffix","functions","declarations","declaration","replaceAll","definitions","log_code","declarationString","definitionString","terminateFloat","terminator","Number","isInteger","toString","toGLSL","infixOperators","hypot","toUpperCase","operands","loadShader","gl","type","source","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","deleteShader","createShaderProgram","customShader","variableNames","fragmentShaderSource","width","height","x_offset","toFixed","y_offset","dpr","devicePixelRatio","vectype","variableDeclarations","custom_code","glsl_expression","getFragmentShaderSource","drawingBufferWidth","drawingBufferHeight","vertexShader","VERTEX_SHADER","vertexShaderSource","fragmentShader","FRAGMENT_SHADER","shaderProgram","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","initializeScene","vertexBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","initBuffers","useProgram","positionLocation","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","FLOAT","variableLocations","getUniformLocation","drawScene","axis_ctx","key","location","uniform3f","uniform2f","drawArrays","TRIANGLES","ctx","innerHeight","clearRect","enable_axes","scale","log_scale","rawLogLabelScale","logLabelScale","labelScale","x0","center_x","y0","center_y","x_min","x_max","y_min","y_max","horizontalLine","y","yy","moveTo","lineTo","verticalLine","lineWidth","xx","xLabel","dy","min","max","label","replace","textWidth","measureText","textAlign","strokeText","fillText","yLabel","iWidth","alignLeft","dx","font","clearWidth","textOffset","iOffset","globalAlpha","strokeStyle","beginPath","ceil","stroke","fillStyle","lineJoin","drawAxes","formatComplex","precision","formatReal","CONSTANTS","almostInteger","forceSign","magnitude","sign","prettyMagnitude","entries","denominator","ratio","numerator","formatInteger","checkKnown","exponent","log10","CoordinateOverlay","state","faded","fadeTimer","lastX","lastY","changed","componentDidUpdate","hasChanged","clearTimeout","setTimeout","setState","mapping","u","v","className","isFinite","canvasSize","pixelToPlot","offset_x","offset_y","FunctionPlot","position","mouseDown","initialized","lastUpdate","addEventListener","compilePlot","bind","initializeWebGL","onError","initializePlot","updatePlot","lastExpression","mouseEvent","nativeEvent","targetTouches","touches","pageX","pageY","x1","y1","getPosition","wheelEvent","deltaLogScale","mouse_plotx","mouse_ploty","deltaY","x_shift","y_shift","updatePosition","logDistance","deltaPosition","handleZoom","handleMouseDown","handleMouseMove","handleMouseUp","update","canvas","refs","axes","getContext","offsetWidth","offsetHeight","viewport","custom_function","variableAssignments","now","Date","ref","onMouseDown","onMouseMove","onMouseUp","onMouseEnter","onMouseLeave","onTouchStart","handleTouchStart","onTouchMove","handleTouchMove","onTouchEnd","handleTouchEnd","onWheel","jsx","SidePanel","classes","updateWidth","transitionWidth","Drawer","anchor","open","variant","paper","toolbar","children","SwipeableDrawer","onOpen","onToggle","onClose","disableDiscovery","disableSwipeToOpen","withStyles","mixins","restrictedFunctions","values","functionList","blacklist","VariableAdder","errorMessage","keyCode","handleClick","toLowerCase","match","setValue","ListItem","css","onKeyDown","handleKeyPress","helperText","parsers","number","text","parsed","lower","EditableValue","focused","element","createRef","DEFAULT_PARSERS","getParser","parsedValue","document","current","blur","reset","valid","classString","setAttribute","displayText","html","onFocus","handleFocus","handleChange","onBlur","handleBlur","tagName","innerRef","SPEEDS","AnimationMode","mode","speed","onChangeMode","onChangeSpeed","nextMode","Icon","PlayIcon","BounceIcon","LoopIcon","Slider","animationMode","animationSpeed","animationCurrentDirection","changing","deleted","ensureConsistency","timestamp","dt","lastAnimationTick","newValue","_mounted","requestAnimationFrame","runAnimationTick","setChanging","handleCommit","onNameChange","setMin","setMax","onDelete","hiddenVariables","SliderPanel","textField","onUpdate","forceUpdate","sliderList","onRemove","handleSetChanging","List","ListSubheader","disableSticky","renderSliderList","onAdd","Component","BooleanOption","checked","button","Checkbox","ListItemText","OptionsPanel","options","variable","heading","renderOptions","PREFIX","style","contents","Strategy","initialize","clientX","clientY","integrate","draw","GAUSS_COEFFICIENTS","integrateReal","start","end","weight","abscissa","FreeformIntegrator","accumulator","lastPoint","lastPagePoint","df","t","integrateSegment","kahanSum","list","STRATEGY_DICT","FreeformStrategy","startPoint","startPagePoint","Freeform","center","radius","pageCenter","pageRadius","arc","integrand","gammaPrime","up","vp","scaleFactor","summands","IntegralCalculator","done","mousePosition","strategy","integrator","resizeCanvas","context","finish","resetState","tooltip","snap","ResultTooltip","top","left","zIndex","calculators","icon","IntegralPanel","entry","hidePanels","openCalculator","ListItemIcon","paddingLeft","renderIntegrator","Typography","onValueChange","highlight","languages","glsl","padding","fontFamily","fontSize","backgroundColor","color","marginTop","borderRadius","SyntaxHighlighter","registerLanguage","glslHighlighter","supportedFunctions","EXAMPLES","HelpText","setExpression","closeMenu","Chip","showExample","chip","sections","section","renderChips","src","alt","href","renderSupportedFunctions","marginBottom","buttonStyle","Accordion","margin","AccordionSummary","expandIcon","AccordionDetails","language","docco","typography","defaultShader","App","expressionText","expressionError","typingTimer","shaderError","menuOpen","helpOpen","variableChanging","integrationStrategy","enable_checkerboard","invert_gradient","continuous_gradient","handleHashChange","preventDefault","passive","plot","handleVariableUpdate","message","hash","decodeURIComponent","fromHash","history","replaceState","encodeURIComponent","trim","extractVariables","output","newVariables","finalizeExpression","FunctionEditor","setCustomShader","useCustomShader","ControlBar","handleMenuButton","handleHelpButton","handleVariableAdd","handleVariableRemove","handleOptionToggle","renderFunctionEditor","setErrorMessage","Boolean","hostname","render","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"8EAEA,WACA,SAASA,EAAGC,GAAK,OAAOA,EAAE,GAC1B,IAAIC,EAAU,CACVC,WAAOC,EACPC,YAAa,CACb,CAAC,KAAQ,WAAY,QAAW,IAChC,CAAC,KAAQ,WAAY,QAAW,CAAC,WAAY,UAAW,YAAe,SAAiBC,GAAI,OAAOA,EAAE,GAAGC,OAAO,CAACD,EAAE,OAClH,CAAC,KAAQ,IAAK,QAAW,CAAC,YAAa,YAAe,SAASA,GAAI,OAAO,OAC1E,CAAC,KAAQ,YAAa,QAAW,CAAC,WAClC,CAAC,KAAQ,YAAa,QAAW,CAAC,YAAa,UAAW,YAAe,SAAiBA,GAAI,OAAOA,EAAE,GAAGC,OAAO,CAACD,EAAE,OACpH,CAAC,KAAQ,KAAM,QAAW,CAAC,aAAc,YAAe,SAASA,GAAI,OAAO,OAC5E,CAAC,KAAQ,SAAU,QAAW,CAAC,eAAgB,YAAeN,GAC9D,CAAC,KAAQ,sBAAuB,QAAW,CAAC,UAC5C,CAAC,KAAQ,sBAAuB,QAAW,CAAC,sBAAuB,SAAU,YAAe,SAAiBM,GAAI,OAAOA,EAAE,GAAGC,OAAO,CAACD,EAAE,OACvI,CAAC,KAAQ,eAAgB,QAAW,CAAC,uBAAwB,YACzD,SAASA,GACL,OAAOE,SAASF,EAAE,GAAGG,KAAK,OAGlC,CAAC,KAAQ,6BAA8B,QAAW,CAAC,CAAC,QAAU,OAC9D,CAAC,KAAQ,6BAA8B,QAAW,CAAC,CAAC,QAAU,OAC9D,CAAC,KAAQ,aAAc,QAAW,CAAC,8BAA+B,YAAeT,GACjF,CAAC,KAAQ,aAAc,QAAW,GAAI,YAAe,SAASM,GAAI,OAAO,OACzE,CAAC,KAAQ,aAAc,QAAW,CAAC,UACnC,CAAC,KAAQ,aAAc,QAAW,CAAC,aAAc,SAAU,YAAe,SAAiBA,GAAI,OAAOA,EAAE,GAAGC,OAAO,CAACD,EAAE,OACrH,CAAC,KAAQ,MAAO,QAAW,CAAC,aAAc,cAAe,YACrD,SAASA,GACL,OAAIA,EAAE,GACKE,SAASF,EAAE,GAAG,GAAGA,EAAE,GAAGG,KAAK,KAE3BD,SAASF,EAAE,GAAGG,KAAK,OAItC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,UAChD,CAAC,KAAQ,0BAA2B,QAAW,CAAC,0BAA2B,SAAU,YAAe,SAAiBH,GAAI,OAAOA,EAAE,GAAGC,OAAO,CAACD,EAAE,OAC/I,CAAC,KAAQ,iDAAkD,QAAW,CAAC,UACvE,CAAC,KAAQ,iDAAkD,QAAW,CAAC,iDAAkD,SAAU,YAAe,SAAiBA,GAAI,OAAOA,EAAE,GAAGC,OAAO,CAACD,EAAE,OAC7L,CAAC,KAAQ,0CAA2C,QAAW,CAAC,CAAC,QAAU,KAAM,mDACjF,CAAC,KAAQ,0BAA2B,QAAW,CAAC,2CAA4C,YAAeN,GAC3G,CAAC,KAAQ,0BAA2B,QAAW,GAAI,YAAe,SAASM,GAAI,OAAO,OACtF,CAAC,KAAQ,mBAAoB,QAAW,CAAC,0BAA2B,2BAA4B,YAC5F,SAASA,GACL,OAAOI,WACHJ,EAAE,GAAGG,KAAK,KACTH,EAAE,GAAK,IAAIA,EAAE,GAAG,GAAGG,KAAK,IAAM,OAI3C,CAAC,KAAQ,iBAAkB,QAAW,CAAC,CAAC,QAAU,MAAO,YAAeT,GACxE,CAAC,KAAQ,iBAAkB,QAAW,GAAI,YAAe,SAASM,GAAI,OAAO,OAC7E,CAAC,KAAQ,iBAAkB,QAAW,CAAC,UACvC,CAAC,KAAQ,iBAAkB,QAAW,CAAC,iBAAkB,SAAU,YAAe,SAAiBA,GAAI,OAAOA,EAAE,GAAGC,OAAO,CAACD,EAAE,OAC7H,CAAC,KAAQ,wCAAyC,QAAW,CAAC,UAC9D,CAAC,KAAQ,wCAAyC,QAAW,CAAC,wCAAyC,SAAU,YAAe,SAAiBA,GAAI,OAAOA,EAAE,GAAGC,OAAO,CAACD,EAAE,OAC3K,CAAC,KAAQ,iCAAkC,QAAW,CAAC,CAAC,QAAU,KAAM,0CACxE,CAAC,KAAQ,iBAAkB,QAAW,CAAC,kCAAmC,YAAeN,GACzF,CAAC,KAAQ,iBAAkB,QAAW,GAAI,YAAe,SAASM,GAAI,OAAO,OAC7E,CAAC,KAAQ,UAAW,QAAW,CAAC,iBAAkB,iBAAkB,kBAAmB,YACnF,SAASA,GACL,OAAOI,YACFJ,EAAE,IAAM,IACTA,EAAE,GAAGG,KAAK,KACTH,EAAE,GAAK,IAAIA,EAAE,GAAG,GAAGG,KAAK,IAAM,OAI3C,CAAC,KAAQ,aAAc,QAAW,CAAC,UAAW,CAAC,QAAU,MAAO,YAC5D,SAASH,GACL,OAAOA,EAAE,GAAG,MAGpB,CAAC,KAAQ,mBAAoB,QAAW,CAAC,CAAC,QAAU,MAAO,YAAeN,GAC1E,CAAC,KAAQ,mBAAoB,QAAW,GAAI,YAAe,SAASM,GAAI,OAAO,OAC/E,CAAC,KAAQ,mBAAoB,QAAW,CAAC,UACzC,CAAC,KAAQ,mBAAoB,QAAW,CAAC,mBAAoB,SAAU,YAAe,SAAiBA,GAAI,OAAOA,EAAE,GAAGC,OAAO,CAACD,EAAE,OACjI,CAAC,KAAQ,0CAA2C,QAAW,CAAC,UAChE,CAAC,KAAQ,0CAA2C,QAAW,CAAC,0CAA2C,SAAU,YAAe,SAAiBA,GAAI,OAAOA,EAAE,GAAGC,OAAO,CAACD,EAAE,OAC/K,CAAC,KAAQ,mCAAoC,QAAW,CAAC,CAAC,QAAU,KAAM,4CAC1E,CAAC,KAAQ,mBAAoB,QAAW,CAAC,oCAAqC,YAAeN,GAC7F,CAAC,KAAQ,mBAAoB,QAAW,GAAI,YAAe,SAASM,GAAI,OAAO,OAC/E,CAAC,KAAQ,0CAA2C,QAAW,CAAC,QAAS,YAAeN,GACxF,CAAC,KAAQ,0CAA2C,QAAW,GAAI,YAAe,SAASM,GAAI,OAAO,OACtG,CAAC,KAAQ,0CAA2C,QAAW,CAAC,UAChE,CAAC,KAAQ,0CAA2C,QAAW,CAAC,0CAA2C,SAAU,YAAe,SAAiBA,GAAI,OAAOA,EAAE,GAAGC,OAAO,CAACD,EAAE,OAC/K,CAAC,KAAQ,mCAAoC,QAAW,CAAC,OAAQ,0CAA2C,4CAC5G,CAAC,KAAQ,mBAAoB,QAAW,CAAC,oCAAqC,YAAeN,GAC7F,CAAC,KAAQ,mBAAoB,QAAW,GAAI,YAAe,SAASM,GAAI,OAAO,OAC/E,CAAC,KAAQ,YAAa,QAAW,CAAC,mBAAoB,mBAAoB,mBAAoB,oBAAqB,YAC/G,SAASA,GACL,OAAOI,YACFJ,EAAE,IAAM,IACTA,EAAE,GAAGG,KAAK,KACTH,EAAE,GAAK,IAAIA,EAAE,GAAG,GAAGG,KAAK,IAAM,KAC9BH,EAAE,GAAK,KAAOA,EAAE,GAAG,IAAM,KAAOA,EAAE,GAAG,GAAGG,KAAK,IAAM,OAIhE,CAAC,KAAQ,MAAO,QAAW,CAAC,MAAO,IAAK,cAAe,IAAK,WAAY,YACpE,SAACE,GAAD,MAAU,CAACA,EAAK,GAAIA,EAAK,GAAIA,EAAK,MAEtC,CAAC,KAAQ,MAAO,QAAW,CAAC,WAAY,YAAeX,GACvD,CAAC,KAAQ,UAAW,QAAW,CAAC,UAAW,IAAK,kBAAmB,IAAK,SAAU,YAC9E,SAACW,GAAD,MAAU,CAACA,EAAK,GAAIA,EAAK,GAAIA,EAAK,MAEtC,CAAC,KAAQ,UAAW,QAAW,CAAC,CAAC,QAAU,KAAM,IAAK,SAAU,YAAe,SAAAA,GAAI,MAAI,CAAC,MAAOA,EAAK,MACpG,CAAC,KAAQ,UAAW,QAAW,CAAC,SAAU,YAAeX,GACzD,CAAC,KAAQ,QAAS,QAAW,CAAC,WAAY,IAAK,gBAAiB,IAAK,SAAU,YAC3E,SAACW,GAAD,MAAU,CAAC,MAAOA,EAAK,GAAIA,EAAK,MAEpC,CAAC,KAAQ,QAAS,QAAW,CAAC,YAAa,YAAeX,GAC1D,CAAC,KAAQ,WAAY,QAAW,CAAC,gBAAiB,CAAC,QAAU,KAAM,IAAK,MAAO,IAAK,CAAC,QAAU,MAAO,YAAe,SAAAW,GAAI,MAAI,CAACA,EAAK,GAAG,GAAIA,EAAK,MAC/I,CAAC,KAAQ,WAAY,QAAW,CAAC,gBAAiB,CAAC,QAAU,KAAM,IAAK,MAAO,IAAK,CAAC,QAAU,MAAO,YAAe,SAAAA,GAAI,MAAI,CAACA,EAAK,GAAG,GAAIA,EAAK,MAC/I,CAAC,KAAQ,WAAY,QAAW,CAAC,iBAAkB,CAAC,QAAU,KAAM,IAAK,MAAO,CAAC,QAAU,KAAM,IAAK,MAAO,IAAK,CAAC,QAAU,MAAO,YAAe,SAAAA,GAAI,MAAI,CAACA,EAAK,GAAG,GAAIA,EAAK,GAAIA,EAAK,MACtL,CAAC,KAAQ,WAAY,QAAW,CAAC,iBAAkB,CAAC,QAAU,KAAM,IAAK,MAAO,CAAC,QAAU,KAAM,IAAK,MAAO,IAAK,CAAC,QAAU,MAAO,YAAe,SAAAA,GAAI,MAAI,CAACA,EAAK,GAAG,GAAIA,EAAK,GAAIA,EAAK,MACtL,CAAC,KAAQ,WAAY,QAAW,CAAC,eAAgB,CAAC,QAAU,KAAM,IAAK,MAAO,CAAC,QAAU,KAAM,IAAK,MAAO,CAAC,QAAU,KAAM,IAAK,MAAO,CAAC,QAAU,KAAM,IAAK,MAAO,IAAK,CAAC,QAAU,MAAO,YAAe,SAAAA,GAAI,MAAI,CAACA,EAAK,GAAG,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,OAChQ,CAAC,KAAQ,WAAY,QAAW,CAAC,eAAgB,CAAC,QAAU,KAAM,IAAK,MAAO,CAAC,QAAU,KAAM,IAAK,MAAO,CAAC,QAAU,KAAM,IAAK,MAAO,CAAC,QAAU,KAAM,IAAK,MAAO,IAAK,CAAC,QAAU,MAAO,YAAe,SAAAA,GAAI,MAAI,CAACA,EAAK,GAAG,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,OAChQ,CAAC,KAAQ,WAAY,QAAW,CAAC,eAAgB,CAAC,QAAU,KAAM,IAAK,MAAO,IAAK,CAAC,QAAU,MAAO,YAAe,SAAAA,GAAI,MAAI,CAACA,EAAK,GAAG,GAAIA,EAAK,GAAI,CAAC,WAAY,QAC/J,CAAC,KAAQ,WAAY,QAAW,CAAC,eAAgB,CAAC,QAAU,KAAM,IAAK,MAAO,IAAK,CAAC,QAAU,MAAO,YAAe,SAAAA,GAAI,MAAI,CAACA,EAAK,GAAG,GAAIA,EAAK,GAAI,CAAC,WAAY,QAC/J,CAAC,KAAQ,WAAY,QAAW,CAAC,gBAAiB,YAAeX,GACjE,CAAC,KAAQ,cAAe,QAAW,CAAC,CAAC,QAAU,KAAM,MAAO,CAAC,QAAU,MAAO,YAAe,SAACW,GAAD,OAAUA,EAAK,KAC5G,CAAC,KAAQ,cAAe,QAAW,CAAC,CAAC,QAAU,KAAM,MAAO,CAAC,QAAU,MAAO,YAAe,SAACA,GAAD,OAAUA,EAAK,KAC5G,CAAC,KAAQ,cAAe,QAAW,CAAC,WAAY,YAAeX,GAC/D,CAAC,KAAQ,eAAgB,QAAW,CAAC,eAAgB,YAAeA,GACpE,CAAC,KAAQ,eAAgB,QAAW,CAAC,cAAe,CAAC,QAAU,MAAO,YAAe,SAACW,GAAD,MAAU,CAAC,YAAaA,EAAK,MAClH,CAAC,KAAQ,cAAe,QAAW,CAAC,CAAC,QAAU,MAAO,YAAe,iBAAM,QAC3E,CAAC,KAAQ,cAAe,QAAW,CAAC,CAAC,QAAU,MAAO,YAAe,iBAAM,QAC3E,CAAC,KAAQ,cAAe,QAAW,CAAC,CAAC,QAAU,WAAO,YAAe,iBAAM,QAC3E,CAAC,KAAQ,kBAAmB,QAAW,CAAC,CAAC,QAAU,MAAO,YAAe,iBAAM,QAC/E,CAAC,KAAQ,kBAAmB,QAAW,CAAC,CAAC,QAAU,SAAO,YAAe,iBAAM,QAC/E,CAAC,KAAQ,kBAAmB,QAAW,CAAC,CAAC,QAAU,MAAO,YAAe,iBAAM,QAC/E,CAAC,KAAQ,yBAA0B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBL,GAAI,OAAOA,EAAEG,KAAK,MACnI,CAAC,KAAQ,gBAAiB,QAAW,CAAC,2BACtC,CAAC,KAAQ,gBAAiB,QAAW,CAAC,CAAC,QAAU,OACjD,CAAC,KAAQ,wBAAyB,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACnJ,CAAC,KAAQ,eAAgB,QAAW,CAAC,0BACrC,CAAC,KAAQ,wBAAyB,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACvN,CAAC,KAAQ,eAAgB,QAAW,CAAC,yBAA0B,YAAe,iBAAM,CAAC,UACrF,CAAC,KAAQ,wBAAyB,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpK,CAAC,KAAQ,eAAgB,QAAW,CAAC,0BACrC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpI,CAAC,KAAQ,iBAAkB,QAAW,CAAC,4BACvC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpI,CAAC,KAAQ,iBAAkB,QAAW,CAAC,4BACvC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpI,CAAC,KAAQ,iBAAkB,QAAW,CAAC,4BACvC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpI,CAAC,KAAQ,iBAAkB,QAAW,CAAC,4BACvC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACrJ,CAAC,KAAQ,iBAAkB,QAAW,CAAC,2BAA4B,YAAe,iBAAM,CAAC,SACzF,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACzN,CAAC,KAAQ,iBAAkB,QAAW,CAAC,4BACvC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACzN,CAAC,KAAQ,iBAAkB,QAAW,CAAC,4BACvC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACzN,CAAC,KAAQ,iBAAkB,QAAW,CAAC,4BACvC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACzN,CAAC,KAAQ,iBAAkB,QAAW,CAAC,4BACvC,CAAC,KAAQ,iBAAkB,QAAW,CAAC,gBAAiB,YAAe,SAAAR,GAAC,OAAIA,EAAE,KAC9E,CAAC,KAAQ,wBAAyB,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBK,GAAI,OAAOA,EAAEG,KAAK,MAC1Q,CAAC,KAAQ,eAAgB,QAAW,CAAC,yBAA0B,YAAe,iBAAM,CAAC,UACrF,CAAC,KAAQ,wBAAyB,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpK,CAAC,KAAQ,eAAgB,QAAW,CAAC,0BACrC,CAAC,KAAQ,gBAAiB,QAAW,CAAC,iBACtC,CAAC,KAAQ,yBAA0B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpJ,CAAC,KAAQ,gBAAiB,QAAW,CAAC,2BACtC,CAAC,KAAQ,yBAA0B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpJ,CAAC,KAAQ,gBAAiB,QAAW,CAAC,2BACtC,CAAC,KAAQ,yBAA0B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpJ,CAAC,KAAQ,gBAAiB,QAAW,CAAC,2BACtC,CAAC,KAAQ,yBAA0B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACnI,CAAC,KAAQ,gBAAiB,QAAW,CAAC,0BAA2B,YAAe,iBAAM,CAAC,SACvF,CAAC,KAAQ,yBAA0B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACrK,CAAC,KAAQ,gBAAiB,QAAW,CAAC,2BACtC,CAAC,KAAQ,yBAA0B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACtL,CAAC,KAAQ,gBAAiB,QAAW,CAAC,2BACtC,CAAC,KAAQ,yBAA0B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpJ,CAAC,KAAQ,gBAAiB,QAAW,CAAC,2BACtC,CAAC,KAAQ,yBAA0B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACrK,CAAC,KAAQ,gBAAiB,QAAW,CAAC,2BACtC,CAAC,KAAQ,yBAA0B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpJ,CAAC,KAAQ,gBAAiB,QAAW,CAAC,2BACtC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACrJ,CAAC,KAAQ,gBAAiB,QAAW,CAAC,4BACtC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACrJ,CAAC,KAAQ,gBAAiB,QAAW,CAAC,4BACtC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACrJ,CAAC,KAAQ,gBAAiB,QAAW,CAAC,4BACtC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACtK,CAAC,KAAQ,gBAAiB,QAAW,CAAC,4BACtC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACtK,CAAC,KAAQ,gBAAiB,QAAW,CAAC,4BACtC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACtK,CAAC,KAAQ,gBAAiB,QAAW,CAAC,4BACtC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACvL,CAAC,KAAQ,gBAAiB,QAAW,CAAC,4BACtC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACtK,CAAC,KAAQ,gBAAiB,QAAW,CAAC,4BACtC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACvL,CAAC,KAAQ,gBAAiB,QAAW,CAAC,4BACtC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACtK,CAAC,KAAQ,gBAAiB,QAAW,CAAC,4BACtC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpI,CAAC,KAAQ,gBAAiB,QAAW,CAAC,2BAA4B,YAAe,iBAAM,CAAC,UACxF,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpI,CAAC,KAAQ,gBAAiB,QAAW,CAAC,2BAA4B,YAAe,iBAAM,CAAC,UACxF,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpI,CAAC,KAAQ,gBAAiB,QAAW,CAAC,4BACtC,CAAC,KAAQ,0BAA2B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACpI,CAAC,KAAQ,gBAAiB,QAAW,CAAC,4BACtC,CAAC,KAAQ,gBAAiB,QAAW,CAAC,CAAC,QAAU,OACjD,CAAC,KAAQ,4BAA6B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACvJ,CAAC,KAAQ,mBAAoB,QAAW,CAAC,8BACzC,CAAC,KAAQ,4BAA6B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACvJ,CAAC,KAAQ,mBAAoB,QAAW,CAAC,8BACzC,CAAC,KAAQ,4BAA6B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACvJ,CAAC,KAAQ,mBAAoB,QAAW,CAAC,8BACzC,CAAC,KAAQ,4BAA6B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACvJ,CAAC,KAAQ,mBAAoB,QAAW,CAAC,8BACzC,CAAC,KAAQ,4BAA6B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACvJ,CAAC,KAAQ,mBAAoB,QAAW,CAAC,8BACzC,CAAC,KAAQ,4BAA6B,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MACvJ,CAAC,KAAQ,mBAAoB,QAAW,CAAC,8BACzC,CAAC,KAAQ,yBAA0B,QAAW,CAAC,mBAAoB,CAAC,QAAU,MAAO,YAAe,SAACE,GAAD,OAAUA,EAAKF,KAAK,MACxH,CAAC,KAAQ,+BAAgC,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBH,GAAI,OAAOA,EAAEG,KAAK,MAC1J,CAAC,KAAQ,sBAAuB,QAAW,CAAC,gCAAiC,YAAeT,GAC5F,CAAC,KAAQ,sBAAuB,QAAW,GAAI,YAAe,SAASM,GAAI,OAAO,OAClF,CAAC,KAAQ,eAAgB,QAAW,CAAC,sBAAuB,oBAAqB,YAAe,SAACK,GAAD,OAAUA,EAAKF,KAAK,MACpH,CAAC,KAAQ,eAAgB,QAAW,CAAC,CAAC,QAAU,KAAM,oBAAqB,YAAe,SAACE,GAAD,MAAU,MAAQA,EAAK,KACjH,CAAC,KAAQ,+BAAgC,QAAW,CAAC,CAAC,QAAU,KAAM,CAAC,QAAU,MAAO,YAAe,SAAgBL,GAAI,OAAOA,EAAEG,KAAK,MACzI,CAAC,KAAQ,sBAAuB,QAAW,CAAC,gCAAiC,YAAeT,GAC5F,CAAC,KAAQ,sBAAuB,QAAW,GAAI,YAAe,SAASM,GAAI,OAAO,OAClF,CAAC,KAAQ,eAAgB,QAAW,CAAC,sBAAuB,0BAA2B,YAAe,SAACK,GAAD,OAAUA,EAAKF,KAAK,MAC1H,CAAC,KAAQ,UAAW,QAAW,CAAC,iBAAkB,YAAeT,GACjE,CAAC,KAAQ,UAAW,QAAW,CAAC,YAAa,YAAeA,GAC5D,CAAC,KAAQ,kBAAmB,QAAW,CAAC,UACxC,CAAC,KAAQ,kBAAmB,QAAW,CAAC,kBAAmB,SAAU,YAAe,SAAiBM,GAAI,OAAOA,EAAE,GAAGC,OAAO,CAACD,EAAE,OAC/H,CAAC,KAAQ,WAAY,QAAW,CAAC,mBAAoB,YACjD,SAASK,EAAMC,EAAGC,GACd,IACMC,EAAQH,EAAK,GAAGF,KAAK,IAC3B,MAAc,MAAVK,EAAuBD,EAFT,CAAC,IAAK,KAAM,MAAO,OAGpBE,SAASD,GAAS,CAAC,WAAYA,GAAS,CAAC,WAAYA,KAG9E,CAAC,KAAQ,gBAAiB,QAAW,CAAC,WAAY,YAAe,SAACH,GAAD,MAAU,CAAC,SAAUA,EAAK,GAAI,KAC/F,CAAC,KAAQ,gBAAiB,QAAW,CAAC,UAAW,CAAC,QAAU,MAAO,YAAe,SAACA,GAAD,MAAU,CAAC,SAAU,EAAGA,EAAK,MAC/G,CAAC,KAAQ,gBAAiB,QAAW,CAAC,CAAC,QAAU,MAAO,YAAe,iBAAM,CAAC,SAAU,EAAG,MAE3FK,YAAa,OAE6C,qBAAnBC,EAAOC,QAC/CD,EAAOC,QAAUhB,EAEjBiB,OAAOjB,QAAUA,EA9PpB,I,4eCOekB,EANDC,IAAe,CAC3BC,QAAS,CACPC,QAASC,O,+DC4CEC,G,gMAnCIC,GACfC,KAAKC,MAAMC,SAASH,EAAMI,OAAOC,S,+BAGzB,IAAD,SACwDJ,KAAKC,MAA3DI,EADF,EACEA,SAAUC,EADZ,EACYA,aAAcC,EAD1B,EAC0BA,aAAcC,EADxC,EACwCA,MAAOJ,EAD/C,EAC+CA,MACpD,OACE,kBAACK,EAAA,EAAD,CAAQpC,GAAG,WACT,kBAACqC,EAAA,EAAD,CAASC,gBAAc,GACrB,kBAACC,EAAA,EAAD,CACEC,QAASP,GAET,kBAAC,IAAD,OAEF,yBAAKjC,GAAG,kBACN,kBAACyC,EAAA,EAAD,CACIzC,GAAG,iBACH0C,YAAavB,OAAOwB,WAAa,IAAM,gCAAkC,OACzEZ,MAAOA,EACPF,SAAU,SAACH,GAAD,OAAW,EAAKkB,iBAAiBlB,IAC3CS,MAAOA,EACPU,WAAS,EACTC,WAAS,EACTd,SAAUA,KAGhB,yBAAKhC,GAAG,eACJ,kBAAC+C,EAAA,EAAD,CAAQP,QAASN,GAAjB,e,GA5BWc,IAAMC,gB,2DCb3BC,EAAOC,EAAQ,KAEfC,EAAIF,EAAKG,QAAQ,EAAG,GAEpBC,EAAOJ,EAAKK,IACZC,EAAON,EAAKO,SACZC,EAAOR,EAAKS,OACZC,EAAOV,EAAKW,SACZC,EAAS,SAAAC,GAAC,OAAIb,EAAKW,SAASE,EAAGX,IAE/BY,EAAOd,EAAKe,IACZC,EAAOhB,EAAKiB,IACZC,EAAOlB,EAAKmB,IACZC,EAAQpB,EAAKqB,KACbC,EAAOtB,EAAKuB,IACZC,EAAU,SAAAX,GAAC,OAAIH,EAAKG,EAAGA,IAEvBY,EAAczB,EAAK0B,MAKnBA,EAAQ,SAAAb,GAAC,OAAIA,EAAEc,GAAK,GAJP,SAAAd,GAAC,OAAIb,EAAKS,OAAOT,EAAK4B,GAAI5B,EAAKW,SAC9CX,EAAKe,IAAIf,EAAKW,SAASE,EAAGb,EAAK4B,KAC/BH,EAAYzB,EAAKO,SAAS,EAAGM,MAEDgB,CAAWhB,GAAKY,EAAYZ,IAGtDiB,EAAmB,CACzB,CAAE,EAAwB,GAC1B,EAAE,EAAwB,mBAC1B,CAAE,EAAwB,oBAC1B,EAAE,EAAwB,oBAC1B,CAAE,kBAAwB,oBAC1B,EAAE,kBAAwB,mBAC1B,CAAE,kBAAwB,oBAC1B,EAAE,kBAAwB,oBAC1B,CAAE,kBAAwB,oBAC1B,EAAE,kBAAwB,mBAC1B,CAAE,kBAAwB,oBAC1B,EAAE,kBAAwB,oBAC1B,CAAE,kBAAwB,oBAC1B,EAAE,kBAAwB,oBAC1B,CAAE,kBAAwB,kBAC1B,EAAE,kBAAwB,mBAC1B,CAAE,iBAAwB,mBAC1B,EAAE,kBAAwB,oBAC1B,CAAE,kBAAwB,oBAC1B,EAAE,kBAAwB,mBAC1B,CAAE,iBAAwB,mBAC1B,EAAE,iBAAwB,mBAC1B,CAAE,kBAAwB,oBAC1B,EAAE,mBAAwB,oBAC1B,CAAE,mBAAwB,oBAC1B,EAAE,mBAAwB,mBAC1B,CAAE,mBAAwB,mBAC1B,EAAE,oBAAwB,mBAC1B,CAAE,oBAAwB,mBAC1B,EAAE,qBAAwB,oBAC1B,CAAE,qBAAwB,oBAC1B,EAAE,oBAAwB,qBAG1B,SAASC,EAAUlB,GACf,OAAOb,EAAKK,IAAL,MAAAL,EAAI,YAAQ8B,EAAiBE,KAChC,mCAAEC,EAAF,KAAKC,EAAL,YAAYxB,EAAKuB,EAAGjB,EAAKN,GAAMwB,EAAGrB,UAwC1C,IAAMsB,EAAM,SAAAtB,GAAC,OAAIA,EAAEc,GAAK,EApCxB,SAASS,EAASC,GACd,IAAMxB,EAAIwB,EAAEC,MACNC,EAAMvC,EAAKwC,IAAI3B,EAAG,GAExB,GAAIA,EAAE4B,GAAK,EAAI,OAAOzC,EAAK0C,KAAKN,EAASpC,EAAK0C,KAAKL,KAGnD,IAAIM,EAAcjC,EAAKgB,EAAMb,GAAIC,EAAKJ,EAAKG,EAAGb,EAAK4B,GAAG,KACtD,GAAIf,EAAE4B,GAAK,GAAI,CACX,IAAMG,EAAQ5C,EAAKmB,IAAInB,EAAK6C,IAAIhC,IAC1BiC,EAAQ9C,EAAK+C,IAAIlC,GAEvB8B,EAAcjC,EACVsC,KAAK3B,KAAK,EAAI2B,KAAKC,IAAM,EACzB/C,EACAc,EAAKZ,EACDM,EAAKoC,EAAQE,KAAKC,GAAG,EAAG/C,EAAGW,GAC3BH,EAAKkC,EAAQ,EAAG/B,GAChBH,GAAM,GAAKV,EAAKG,QAAQyC,EAAOE,OAI3C,IAAMI,EAAcxC,EAAKG,EAAGkB,EAAUQ,IAEhCY,EAAenC,EAAKN,GAAMV,EAAKmB,IAAInB,EAAK4B,IAAKW,IAC7Ca,EAAe5C,EACjBF,EAAK,EAAGU,EAAKN,GAAMsC,KAAKK,IAAKd,KAC7BjC,EAAK,EAAGU,EAAKN,GAAMsC,KAAKK,IAAKxC,MAG3ByC,EAAY5C,EAAKiC,EAAaO,GAC9BK,EAAa7C,EAAKyC,EAAcC,GAEtC,OAAO1C,EAAK,EAAGA,EAAK4C,EAAWC,IAGPnB,CAASvB,GAAKkB,EAAUlB,IAKpD,SAAS2C,EAAU3C,GACf,IAAM4C,EAAI7C,EAnGM,SAAAC,GAAC,OAAIb,EAAKS,OAAO,EAAGI,GAmGnB6C,CAAY7C,IACvB8C,EAAKnC,EAAQiC,GACbG,EAAcpD,EAChBE,EAAK+C,EAAGrD,EAAK,EAAGM,EAAKiD,EAAIvD,EAAK,GAAKM,EAAK,IAAMiD,OAC9C3D,EAAKqB,KAAK2B,KAAKC,KAEnB,OAAO7C,EAAK,EAAGQ,EAAOF,EAAKM,EAAKQ,EAAQZ,EAAOC,KAAM+C,KA4BzD,SAASC,GAAQhD,EAAGiD,GAEhB,IADA,IAAIC,EAAS,EACJC,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAMC,EAAIjE,EAAKG,QAAQ,EAAG6C,KAAKC,GAAKe,GAC9BE,EAAIxD,EAAKuD,EAAG,EAAGpD,GACfsD,EAAIzD,EAAKuD,EAAGD,EAAGF,GACrBC,EAAS3D,EACL2D,EACA/C,EAAKZ,EAAK+D,EAAGD,IACblD,EAAKV,EAAK6D,EAAGD,KAGrB,OAAOH,EAEX,IAAMK,GAAU,SAACvD,EAAGiD,GAAJ,OAAYD,GAAQzD,EAAKS,EAAG,IAAMiD,IAC5CO,GAAU,SAACxD,EAAGiD,GAAJ,OAAYpD,EACxBM,EAAKN,EAAKV,EAAKG,QAAQ,EAAG6C,KAAKC,GAAG,GAAI7C,EAAK0D,EAAKpD,EAAK,EAAGG,MACxDgD,GAAQzD,EAAKS,EAAGH,EAAK,GAAKoD,IAAOA,KAE/BQ,GAAU,SAACzD,EAAGiD,GAAJ,OAAYpD,EACxBM,EAAKN,EAAKV,EAAKG,QAAQ,EAAG6C,KAAKC,GAAG,GAAI7C,EAAK0D,EAAKpD,EAAK,EAAGG,GAAI,KAC5DgD,GAAQzD,EAAKS,EAAGH,EAAK,GAAKoD,GAAM,IAAMA,KAe1C,SAASS,GAAc1D,EAAG4C,GACtB,IAAMK,EAbV,SAAoBL,GAChB,IAAMe,EAASpD,EAAMA,EAAMd,EAAK,EAAGI,EAAK+C,EAAGA,MACrC/F,EAAIgD,EAAK,GAAKF,EAAKF,EAAK,EAAGkE,GAASpE,EAAK,EAAGoE,KAC5CC,EAAIrE,EACN1C,EACAgD,EAAK,EAAGY,EAAK5D,EAAG,IAChBgD,EAAK,GAAIY,EAAK5D,EAAG,IACjBgD,EAAK,IAAKY,EAAK5D,EAAG,MAEtB,OAAOgD,EAAKQ,EAAKuD,GAAIzE,EAAKG,QAAQ,GAAI,EAAE6C,KAAKC,KAIjCyB,CAAWjB,GACjBkB,EAAMd,GAAQ,EAAGC,GACjBc,EAAKpE,EAAKK,EAAGH,EAAKsC,KAAKC,GAAI0B,EAAKA,IAChCX,EAAI,EAAIhB,KAAK6B,MAAM,GAAMD,EAAGnC,GAAGqB,EAAIrB,IACzC,MAAO,CAACnC,EAAKsE,EAAIlE,EAAKsD,EAAGF,IAAOA,GAGpC,SAASgB,GAAOF,EAAId,GAChB,OAAOtD,EAAKE,GACP,EAAGmD,GAAQ,EAAGC,GAAMQ,GAAQM,EAAId,IAClCpD,EACC2D,GAAQ,EAAGP,GAAMM,GAAQQ,EAAId,KAIrC,SAASiB,GAAOH,EAAId,GAChB,OAAOtD,EAAKE,EACR0D,GAAQ,EAAGN,GAAMO,GAAQO,EAAId,IAC9BpD,EACC2D,GAAQ,EAAGP,GAAMM,GAAQQ,EAAId,KAIrC,SAASkB,GAAOJ,EAAId,GAChB,OAAOtD,EAAKE,EACR0D,GAAQ,EAAGN,GAAMD,GAAQe,EAAId,IAC9BpD,EACCmD,GAAQ,EAAGC,GAAMM,GAAQQ,EAAId,KAwBrC,SAASmB,GAAQL,EAAIX,EAAGH,GACpB,OAAOpD,GACF,EACDY,EAAKd,EAAKyD,EAAGa,GAAOF,EAAId,IAAO,GAC/BiB,GAAOH,EAAId,GAAMkB,GAAOJ,EAAId,IAyBpC,IAAMoB,GAAKlF,EAAKG,QAAQ,aAAe,GACjCgF,GAAKnF,EAAKG,SAAS,aAAe,cAClCiF,GAAKpF,EAAKG,SAAS,cAAgB,cAEnC8D,GAAI7C,EAAMd,EAAK6E,GAAIC,KACnBlB,GAAI9C,EAAMd,EAAK4E,GAAIE,KACnB3B,GAAIjD,EAAK0D,GAAGD,IAElB,SAASoB,GAAGxE,GACR,IADW,EAEO0D,GADR7D,EAAKG,EAAGoD,IACiBR,IAFxB,mBAEJmB,EAFI,KAEAd,EAFA,KAGX,OAAO1D,EAAK,EAAGI,EAAK,EAAGF,EAAKI,EAAK,EAAGuE,GAAQL,EAAIX,GAAGH,IAAO,KAO9D,SAASwB,GAAIzE,EAAGwB,GAAI,OAAOxB,EAAEc,GAAKU,EAAEV,GAAKd,EAAE4B,GAAKJ,EAAEI,GC5QlD,IAAMzC,GAAOC,EAAQ,KAEfsF,GAAY,CACd,EAAKvC,KAAKwC,EACV,GAAMxC,KAAKC,GACX,IAAO,EAAID,KAAKC,GAChB,KAAQ,EAAID,KAAK3B,KAAK,IAAI,GAGxBoE,GAAO,SAACxD,EAAGC,EAAGwD,EAAGtI,GAAV,OAAgB4C,GAAKwC,IAAIxC,GAAKwC,IAAIP,EAAGC,GAAIlC,GAAKwC,IAAIkD,EAAGtI,KAE5D8C,GAAIF,GAAKG,QAAQ,EAAG,GACpBwF,GAAM,CACRC,KAAM,SAAC3D,EAAGC,EAAGwD,EAAGtI,EAAGyI,EAAGC,EAAGC,EAAGC,GAAtB,OAA4BhG,GAAKwC,IAAIiD,GAAKxD,EAAGC,EAAGwD,EAAGtI,GAAIqI,GAAKI,EAAGC,EAAGC,EAAGC,KAC3EP,QACAQ,KAAM,SAAChE,EAAGC,EAAGwD,EAAGtI,GAAV,OAAgB4C,GAAKW,SAASX,GAAKW,SAASsB,EAAGC,GAAIlC,GAAKW,SAAS+E,EAAGtI,KAC1E8I,OAAQlG,GAAKuB,IACb4E,IAAKnG,GAAKO,SACV+B,IAAKtC,GAAKoG,WACVC,IAAKrG,GAAKW,SACV2F,IAAKtG,GAAKS,OACV8F,WAAY,SAAA1F,GAAC,OAAIb,GAAKS,OAAO,EAAGI,IAChC2F,cAAe,SAAC3F,EAAG4F,GAAJ,OAAczG,GAAKG,QAAQsG,EAAM5F,EAAEc,GAAI8E,EAAM5F,EAAE4B,KAC9DiE,qBAAsB,SAAC7F,EAAG4F,GAAJ,OAAczG,GAAKG,QAAQH,GAAKiB,IAAIwF,GAAO5F,EAAEc,GAAI3B,GAAKiB,IAAIwF,GAAO5F,EAAE4B,KACzFkE,KAAM3G,GAAK2B,GACXiF,KAAM5G,GAAKyC,GACXoE,KAAM,SAAAhG,GAAC,OAAKA,EAAEc,IAAM,EAAK,EAAI,GAE7BmF,OAAQ9G,GAAK+G,KACbC,OAAQhH,GAAKiH,KACbC,OAAQlH,GAAKmH,KACbC,OAAQpH,GAAKqH,KACbC,OAAQtH,GAAKuH,KACbC,OAAQxH,GAAKyH,KAEbC,OAAQ1H,GAAK2H,MACbC,OAAQ5H,GAAK6H,MACbC,OAAQ9H,GAAK+H,MACbC,OAAQhI,GAAKiI,MACbC,OAAQlI,GAAKmI,MACbC,OAAQpI,GAAKqI,MAEbC,IAAK,SAAAzH,GAAC,OAAIb,GAAKiB,IAAIjB,GAAKW,SAASE,EAAGX,MAEpCwB,QACAS,MACAoG,KDgDS,SAAA1H,GAAC,OAAIL,EAAK2B,EAAItB,GAAIP,EAAK,EAAGU,EAAKN,EAAKsC,KAAKK,IAAK/C,EAAK,EAAGO,QC/C/D2H,ID6DJ,SAAa3H,GACT,GAAImC,KAAKH,IAAIhC,EAAE4B,IAAM,IACjB,OAAOe,EAAU3C,GASrB,IANA,IAAM4H,EAAIzI,EAAKiB,KAAKJ,EAAEc,GAAGd,EAAEc,IAAIqB,KAAKC,GAC9BwB,EAAI,EAAE5D,EAAEc,GAAGd,EAAEc,GACbM,EAAIjC,EAAK0I,IAAI,EAAE7H,EAAEc,GAAGd,EAAE4B,IACtBP,EAAIlC,EAAKe,IAAI,EAAEF,EAAEc,GAAGd,EAAE4B,IAEtBkG,EAAS,CAAC3I,EAAKwI,IAAI3H,EAAEc,IAAKjB,EAAK+H,GAAG,EAAE5H,EAAEc,IAAK3B,EAAKG,QAAQ,EAAE8B,EAAGC,KAC1DuB,EAAI,EAAGA,EAAI,GAAIA,IAAK,CACzB,IAAMmF,EAAKnF,EAAEA,EAAE,EAAI5C,EAAEc,GAAGd,EAAEc,GACpBwD,EAAKnF,EAAKiB,IAAIwC,EAAE5C,EAAE4B,GAAKmG,GAAI,EAC3B1D,EAAKlF,EAAKiB,KAAKwC,EAAE5C,EAAE4B,GAAKmG,GAAI,EAC5BrF,EAAa,GAAGE,EAAEA,EAAEgB,GAAK,EAAEzB,KAAKC,GAChCtB,EAAK4B,GAAc,EAAE1C,EAAEc,IAAI3B,EAAKiB,KAAK2H,GAAI3G,GAAGkD,EAAGD,IAAOzB,EAAEvB,GAAGiD,EAAGD,IAC9DzC,EAAKc,GAAc,EAAE1C,EAAEc,GAAGO,GAAGiD,EAAGD,GAAMzB,EAAExB,GAAGkD,EAAGD,IACpDyD,EAAOE,KAAK7I,EAAKG,QAAQwB,EAAIc,IAGjC,OAAOzC,EAAKK,IAAIsI,IC9EhB9E,WAASO,WAASC,WAASC,WAC3BwE,GDqJO,SAACjI,EAAG4C,GAAJ,OAAUqB,GAAM,WAAN,cAAUP,GAAc1D,EAAG4C,MCrJxCsF,GDsJG,SAAClI,EAAG4C,GAAJ,OAAUsB,GAAM,WAAN,cAAUR,GAAc1D,EAAG4C,MCtJpCuF,GDuJD,SAACnI,EAAG4C,GAAJ,OAAUuB,GAAM,WAAN,cAAUT,GAAc1D,EAAG4C,MCtJ5CwF,GD0JJ,SAAYpI,EAAGiD,GACX,IAAME,EAAIhB,KAAK6B,MAAMhE,EAAE4B,GAAGqB,EAAIrB,IACxBmC,EAAKtE,EAAKO,EAAGH,EAAKsD,EAAGF,IAErBoF,EAAO1H,EAAQqC,GAAQ,EAAGC,IAC1BqF,EAAO3H,EAAQ6C,GAAQ,EAAGP,IAC1BoB,EAAKxE,GAAMsC,KAAKC,GAAGD,KAAKC,GAAG,EAAG7C,EAAKoB,EAAQ2H,GAAO3H,EAAQ0H,KAChE,OAAO9I,EAAKM,EACRsC,KAAKC,GAAGD,KAAKC,GACbiG,EAAMC,EACN3H,EAAQhB,EAAK4D,GAAQQ,EAAId,GAAMQ,GAAQM,EAAId,MAC5CoB,ICrKCkE,IDgLR,SAAavI,EAAGiD,GACZ,IAAMuF,EAAO7H,EAAQA,EAAQqC,GAAQ,EAAGC,KAClCwF,EAAO9H,EAAQA,EAAQ6C,GAAQ,EAAGP,KAClCyF,EAAO/H,EAAQA,EAAQ4C,GAAQ,EAAGN,KAElC0F,EAAQxG,KAAKC,GAAKD,KAAKC,GAAK,EAC5BkC,EAAKzE,EAAK8I,EAAOpJ,EAAKiJ,EAAME,IAC5BrE,EAAKxE,GAAM8I,EAAOpJ,EAAKkJ,EAAMD,IAC7BjE,EAAK1E,EAAK8I,EAAOlJ,EAAKgJ,EAAMC,IAC5BtF,EAAI7C,EAAMd,EAAK6E,EAAIC,IACnBlB,EAAI9C,EAAMd,EAAK4E,EAAIE,IAVR,EAcEb,GAFT7D,EAAKG,EAAGoD,GACRzD,EAAK0D,EAAGD,IAbD,mBAgBjB,OAAOgB,GAhBU,KAgBEhB,EAhBF,OC/KjBwF,GDkNJ,SAAY5I,GACR,OAAOwE,GAAG/E,EAAK,iBAAoBO,KCnN/BwE,MACJqE,ED4OJ,SAAW7I,GACPA,EAtBJ,SAAwBA,GACpB,GAAIA,EAAE4B,GAAK,EAAI,OAAOzC,EAAKG,QAAQ,EAAG,KAItC,IAHA,IAAMwJ,EAAS,CAAC3J,EAAKG,QAAQ,EAAG,GAAID,GAChC+B,EAAIpB,EACJqB,EAAIlC,EAAKG,QAAQ,EAAG,GACfyJ,EAAI,EAAGA,EAAI,GAAIA,IAAK,CACzB,IAAIC,EAAK7G,KAAK6B,MAAMS,GAAIrD,EAAGC,GAAGoD,GAAIpD,EAAGA,IACrCD,EAAI3B,EAAK2B,EAAGvB,EAAKmJ,EAAI3H,IACrByH,EAAO,GAAKrJ,EAAKqJ,EAAO,GAAIjJ,EAAKmJ,EAAIF,EAAO,KAE5CE,EAAK7G,KAAK6B,MAAMS,GAAIrD,EAAGC,GAAGoD,GAAIrD,EAAGA,IACjCC,EAAI5B,EAAK4B,EAAGxB,EAAKmJ,EAAI5H,IACrB0H,EAAO,GAAKrJ,EAAKqJ,EAAO,GAAIjJ,EAAKmJ,EAAIF,EAAO,KAEhD,IAAMG,EAAM1J,EAAKM,EAAKiJ,EAAO,GAAGhI,GAAId,GAAI8I,EAAO,GAAGlH,IAC5CsH,EAAQ3J,EAAKM,EAAKiJ,EAAO,GAAGhI,GAAId,GAAI8I,EAAO,GAAGlH,IAC9CuH,EAAMxJ,EAAKsJ,EAAKC,GACtB,OAAI/J,EAAK6C,IAAImH,GAAO,EAAWxJ,GAAM,EAAGwJ,GACjCA,EAIHC,CAAepJ,GACnB,IAAMoB,EAAIoC,GAAQ,EAAGxD,GACfqB,EAAI2B,GAAQ,EAAGhD,GACf6E,EAAItB,GAAQ,EAAGvD,GAErB,OAAOH,EAAK,GAAIF,EACZc,EAAKlB,EAAKA,EAAKkB,EAAKW,EAAG,GAAIX,EAAKY,EAAG,IAAKZ,EAAKoE,EAAG,IAAK,GACrDpE,EAAKZ,EAAKuB,EAAGvB,EAAKwB,EAAGwD,IAAK,OChMnBwE,OAtCf,SAASA,EAAKC,EAAKC,GACf,IAAMC,EAAa,CAACC,IAAKA,KACzB,GAAY,OAARH,EAAe,OAAO,SAAAtJ,GAAC,OAAIwJ,GAC/B,IAAKE,MAAMJ,GAAO,OAAO,SAAAtJ,GAAC,MAAI,CAACsJ,EAAK,IAHV,kBAMEA,GAArBK,EANmB,KAMNC,EANM,WAS1B,GAAiB,WAAbD,EAAwB,OAAO,SAAA3J,GAAC,OAAI4J,GAGxC,GAAiB,aAAbD,EAAyB,CAAC,IACnBE,EADkB,YACVD,EADU,MAEzB,MAAa,MAATC,EAAsB,SAAA7J,GAAC,OAAIA,GACxB,SAAAA,GAAC,MAAI,CAAC8J,cAAIP,EAAWM,EAAMJ,KAAM,IAI5C,GAAiB,aAAbE,EAAyB,CAAC,IACnBE,EADkB,YACVD,EADU,MAEzB,OAAO,SAAA5J,GAAC,MAAI,CAAC0E,GAAUmF,GAAO,IAIlC,IAAME,EAAOjF,GAAI6E,IAAaxK,GAAKwK,GACnC,IAAKK,gBAAMD,GAAO,CAEd,OAAO,SAAA/J,GAAC,OADY,SAAAA,GAAC,OAAIgK,gBAAMhK,EAAEc,IAAM,CAACd,EAAG,GAAK,CAACA,EAAEc,GAAId,EAAE4B,IAC7CqI,CAAYF,EAAI,WAAJ,cAAQH,EAAKzI,KAC7B,SAAA+I,GAAO,OAAI/K,GAAKG,QAAL,MAAAH,GAAI,YAAYkK,EAAKa,EAASX,EAAdF,CAAyBrJ,YAKhE,OAAO,SAAAA,GAAC,OAAIwJ,IC/GhB,SAASW,GAAWb,EAAKO,EAAM7L,GAC3B,OAAKoM,MAAMC,QAAQf,GACJ,aAAXA,EAAI,IAAqBA,EAAI,KAAOO,EAAc7L,EAC/CsL,EAAInI,KAAI,SAAAjF,GAAC,OAAIiO,GAAWjO,EAAG2N,EAAM7L,MAFPsL,EAWrC,IAAMgB,GAAO,CAAC,SAAU,EAAG,GACrBC,GAAM,CAAC,SAAU,EAAG,GAEpBC,GAAY,CACd,IAAO,SAAAtO,GAAC,MAAI,CAAC,MAAOA,IACpB,IAAO,SAAAA,GAAC,MAAI,CAAC,MAAO,CAAC,MAAOA,KAC5B,IAAO,SAAAA,GAAC,MAAI,CAAC,SAAU,CAAC,MAAOA,KAC/B,IAAO,SAAAA,GAAC,MAAI,CAAC,MAAO,CAAC,MAAOA,GAAI,CAAC,MAAOA,KACxC,IAAO,SAAAA,GAAC,MAAI,CAAC,MAAO,CAAC,MAAO,CAAC,MAAOA,GAAI,CAAC,MAAOA,MAChD,IAAO,SAAAA,GAAC,MAAI,CAAC,MAAO,CAAC,SAAU,CAAC,MAAOA,MACvC,OAAU,SAAAA,GAAC,MAAI,CAAC,aAAc,CAAC,OAAQ,CAAC,MAAOqO,GAAK,CAAC,SAAUrO,OAC/D,OAAU,SAAAA,GAAC,MAAI,CAAC,MAAO,CAAC,aAAc,CAAC,OAAQ,CAAC,MAAOqO,GAAK,CAAC,SAAUrO,QACvE,OAAU,SAAAA,GAAC,MAAI,CAAC,aAAc,CAAC,MAAOqO,GAAK,CAAC,SAAUrO,MACtD,OAAU,SAAAA,GAAC,MAAI,CAAC,aAAc,CAAC,MAAO,CAAC,SAAUA,GAAI,CAAC,OAAQ,CAAC,MAAOqO,GAAK,CAAC,aAAc,CAAC,SAAUrO,SACrG,OAAU,SAAAA,GAAC,MAAI,CAAC,MAAO,CAAC,aAAc,CAAC,MAAO,CAAC,SAAUA,GAAI,CAAC,OAAQ,CAAC,MAAOqO,GAAK,CAAC,aAAc,CAAC,SAAUrO,UAC7G,OAAU,SAAAA,GAAC,MAAI,CAAC,MAAO,CAAC,aAAc,CAAC,MAAOqO,GAAK,CAAC,SAAUrO,OAE9D,KAAQ,SAAAA,GAAC,MAAI,CAAC,OAAQA,IACtB,KAAQ,SAAAA,GAAC,MAAI,CAAC,OAAQA,IACtB,KAAQ,SAAAA,GAAC,MAAI,CAAC,SAAU,CAAC,OAAQA,KACjC,KAAQ,SAAAA,GAAC,MAAI,CAAC,MAAO,CAAC,MAAO,CAAC,OAAQA,GAAI,CAAC,OAAQA,MACnD,KAAQ,SAAAA,GAAC,MAAI,CAAC,MAAO,CAAC,MAAO,CAAC,OAAQA,GAAI,CAAC,OAAQA,MACnD,KAAQ,SAAAA,GAAC,MAAI,CAAC,MAAO,CAAC,SAAU,CAAC,OAAQA,MACzC,OAAU,SAAAA,GAAC,MAAI,CAAC,aAAc,CAAC,OAAQ,CAAC,MAAO,CAAC,SAAUA,GAAIqO,OAC9D,OAAU,SAAArO,GAAC,MAAI,CAAC,aAAc,CAAC,MAAO,CAAC,OAAQ,CAAC,MAAOA,EAAGqO,KAAO,CAAC,OAAQ,CAAC,MAAOrO,EAAGqO,QACrF,OAAU,SAAArO,GAAC,MAAI,CAAC,aAAc,CAAC,MAAOqO,GAAK,CAAC,SAAUrO,MAEtD,OAAU,SAAAA,GAAC,MAAI,CAAC,MAAO,CAAC,aAAc,CAAC,MAAO,CAAC,SAAUA,GAAI,CAAC,OAAQ,CAAC,MAAOqO,GAAK,CAAC,aAAc,CAAC,SAAUrO,UAC7G,OAAU,SAAAA,GAAC,MAAI,CAAC,aAAc,CAAC,MAAO,CAAC,SAAUA,GAAIqO,MAErD,IAAO,SAAArO,GAAC,MAAI,CAAC,MAAOA,IACpB,IAAO,SAAAA,GAAC,MAAI,CAAC,QAAS,CAAC,MAAOA,KAC9B,IAAO,SAAAA,GAAC,MAAI,CAAC,aAAcA,IAE3B,OAAU,SAAAA,GAAC,MAAI,CAAC,gBAAiBA,EAAG,IACpC,KAAQ,SAAAA,GAAC,MAAI,CAAC,aAAc,CAAC,gBAAiB,CAAC,OAAQA,GAAI,MAmEhDuO,OA9Df,SAASA,EAAKnB,EAAKpH,EAAKwI,GACpB,GAAY,OAARpB,EAAe,OAAO,KAC1B,GAAe,aAAXpH,EAAI,GAAoB,OAAO,KAEnC,IAAKkI,MAAMC,QAAQf,GAAO,OAAOgB,GACjC,GAAe,aAAXhB,EAAI,IAAgC,WAAXA,EAAI,GAAkB,OAAOgB,GAC1D,GAAe,aAAXhB,EAAI,GAAoB,OAAQA,EAAI,KAAOpH,EAAI,GAAMqI,GAAMD,GAE/D,IAtDJ,SAASK,EAASrB,EAAKO,GACnB,QAAKO,MAAMC,QAAQf,KACJ,aAAXA,EAAI,IAAqBA,EAAI,KAAOO,GACjCP,EAAIsB,MAAK,SAAA1O,GAAC,OAAIyO,EAASzO,EAAG2N,OAmD5Bc,CAASrB,EAAKpH,EAAI,IAAM,OAAOoI,GARP,kBAUDhB,GAArBK,EAVsB,KAUTC,EAVS,WAa7B,GAAiB,QAAbD,GAAmC,QAAbA,EACtB,OAAOe,EAAQ,CAACf,GAAF,mBAAeC,EAAKzI,KAAI,SAAAjF,GAAC,OAAIuO,EAAKvO,EAAGgG,EAAKwI,SAI5D,GAAiB,QAAbf,EACA,OAAOe,EAAQ,CAAC,MACZA,EAAQ,CAAC,MAAOd,EAAK,GAAIa,EAAKb,EAAK,GAAI1H,EAAKwI,KAC5CA,EAAQ,CAAC,MAAOd,EAAK,GAAIa,EAAKb,EAAK,GAAI1H,EAAKwI,OAIpD,GAAiB,kBAAbf,EACA,OAAOe,EAAQ,CAAC,gBAAiBD,EAAKb,EAAK,GAAI1H,EAAKwI,GAAUd,EAAK,KAIvE,GAAiB,QAAbD,EACA,OAAOe,EAAQ,CAAC,MACZA,EAAQ,CAAC,MACLA,EAAQ,CAAC,MAAOd,EAAK,GAAIa,EAAKb,EAAK,GAAI1H,EAAKwI,KAC5CA,EAAQ,CAAC,MAAOd,EAAK,GAAIa,EAAKb,EAAK,GAAI1H,EAAKwI,OAEhD,CAAC,SAAUA,EAAQd,EAAK,OApCH,MAyCI,CAACY,GAAUlB,EAAI,IAAKA,EAAI,IAAlDuB,EAzCsB,KAyCRC,EAzCQ,KA0C7B,YAAqBzO,IAAjBwO,EACOH,EAAQ,CAAC,MAAOD,EAAKK,EAAU5I,EAAKwI,GAAUA,EAAQG,EAAaC,OAI9EC,QAAQzK,IAAI,sBAAuBgJ,EAAKpH,GAI5C,SAAuBoH,EAAKpH,EAAKwI,GAE7B,GAAe,aAAXxI,EAAI,GAAoB,OAAO,KAEnC,IAAM8I,EAAON,EAAQP,GAAWb,EAAKpH,EAAI,GAAI,CAAC,MAAOA,EAAK,CAAC,SAHhD,IAG8D,MACnE+I,EAAMP,EAAQP,GAAWb,EAAKpH,EAAI,GAAI,CAAC,MAAOA,EAAK,CAAC,SAJ/C,IAI6D,MAExE,MAAO,CAAC,gBAAiB,CAAC,MAAO8I,EAAMC,GAAM,IAVtCC,CAAc5B,EAAKpH,EAAKwI,KC9F7BvL,GAAOC,EAAQ,KAKrB,SAAS+L,GAAQC,EAAOC,EAAIC,EAAKC,GAE7B,GAAqB,IAAjBH,EAAMI,OAAe,MAAe,QAAPH,EAAgB,CAAC,SAAU,EAAG,GAAK,CAAC,SAAU,EAAG,GAGlF,GAAqB,IAAjBD,EAAMI,OAAe,OAAOJ,EAAM,GAGtC,IAAMK,EAAItJ,KAAKuJ,MAAMN,EAAMI,OAAO,GAC5BG,EAAM,SAACvK,EAAGC,GAAJ,OAAU8J,GAAQC,EAAMQ,MAAMxK,EAAGC,GAAIgK,EAAIC,EAAKC,IAE1D,GAAIE,GAAK,QAAapP,IAARkP,EAAmB,CAC7B,IAAMM,EAAK1J,KAAKuJ,MAAMD,EAAE,GAClBK,EAAM3J,KAAKuJ,MAAMD,EAAE,GACzB,OAAOf,GAAQ,CAACa,EACZI,EAAI,EAAGG,GAAMH,EAAIG,EAAKD,GAAKF,EAAIE,EAAIA,EAAGC,GAAMH,EAAIE,EAAGC,EAAKL,GACxDE,EAAIF,EAAGA,EAAEK,GAAMH,EAAIF,EAAEK,EAAKL,EAAEI,GAAKF,EAAIF,EAAEI,EAAIJ,EAAEI,EAAGC,GAAMH,EAAIF,EAAEI,EAAGC,OAAKzP,KAGxE,GAAIoP,GAAK,QAAapP,IAARiP,EAAmB,CAC7B,IAAMO,EAAK1J,KAAKuJ,MAAMD,EAAE,GACxB,OAAOf,GAAQ,CAACY,EAAKK,EAAI,EAAGE,GAAKF,EAAIE,EAAIJ,GAAIE,EAAIF,EAAGA,EAAEI,GAAKF,EAAIF,EAAEI,OAAIxP,KAErE,OAAOqO,GAAQ,CAACW,EAAIF,GAAQC,EAAMQ,MAAM,EAAGH,GAAIJ,GAAKF,GAAQC,EAAMQ,MAAMH,GAAIJ,KA8BxF,SAASU,GAASC,GACd,IAAIlL,EAAK,KACLc,EAAK,KAMT,OAJK8H,MAAMsC,KAAOlL,EAAKkL,EAAKpK,EAAK,GAClB,WAAXoK,EAAI,KAAkBlL,EAAKkL,EAAI,GAAIpK,EAAKoK,EAAI,IACjC,aAAXA,EAAI,KAAoBlL,EAAK4D,GAAUsH,EAAI,IAAKpK,EAAK,GAElDzC,GAAKG,QAAQwB,EAAIc,GAQ5B,SAASqK,GAAQ3C,GACb,OAAQI,MAAMJ,IAAmB,WAAXA,EAAI,IAA8B,aAAXA,EAAI,GAGrD,SAAS4C,GAAO5C,GACZ,MAAkB,WAAXA,EAAI,IAA8B,IAAXA,EAAI,IAAuB,IAAXA,EAAI,GAKtD,SAASoB,GAAQpB,GACb,IAAKc,MAAMC,QAAQf,GAAO,OAAOA,EADf,kBAGQA,GAArBK,EAHa,KAGAC,EAHA,WAIlB,GAAiB,WAAbD,GAAsC,aAAbA,GAAwC,aAAbA,EACpD,OAAOL,EAIX,GAAiB,QAAbK,GAAmC,SAAbA,EACtB,OA5DR,SAAiBA,EAAUC,GAKvB,GAHAA,EAAK,GAAKc,GAAQd,EAAK,IACvBA,EAAK,GAAKc,GAAQd,EAAK,IAEJ,aAAfA,EAAK,GAAG,GAAoB,OAAO,KACvC,GAAmB,WAAfA,EAAK,GAAG,GAAkB,OAAO,KACrC,GAAmB,WAAfA,EAAK,GAAG,GAAkB,OAAO,KAQrC,IANA,IAAMuC,EAASvC,EAAK,GAAG,GACjBqB,EAAMrB,EAAK,GAAG,GACdoB,EAAOpB,EAAK,GAAG,GACfwC,EAAUxC,EAAK,GAEfwB,EAAQ,GACLrC,EAAIkC,EAAKlC,GAAKiC,EAAMjC,IACzBqC,EAAMpD,KAAK0C,GAAQP,GAAWiC,EAASD,EAAQ,CAAC,SAAUpD,EAAG,MAGjE,MAAiB,QAAbY,EAA4BwB,GAAQC,EAAO,MAAO,OAAQ,QAE7C,SAAbzB,EAA6BwB,GAAQC,EAAO,MAAO,aAAvD,EAuCWiB,CAAQ1C,EAAUC,GAI7B,GADAA,EAAOA,EAAKzI,IAAIuJ,IACC,SAAbf,EACA,OAAOc,GAAKb,EAAK,GAAIA,EAAK,GAAIc,IAIlC,GAAiB,cAAbf,EAA2B,OAAOe,GAAQ,CAAC,QAAS,CAAC,MAAOd,EAAK,GAAI,CAAC,SAAU,EAAG,MAIvF,GAAIA,EAAK0C,MAAML,IAEX,OAxCR,SAAqBD,GACjB,YAAe3P,IAAX2P,EAAIlL,GAA0B,CAAC,SAAUkL,EAAK,GAC3C,CAAC,SAAUA,EAAIlL,GAAIkL,EAAIpK,IAsCnBqI,EADInF,GAAI6E,IAAaxK,GAAKwK,IACZ,WAAF,cAAMC,EAAKzI,IAAI4K,OAItC,GAAiB,QAAbpC,EAAoB,CACpB,GAAIuC,GAAOtC,EAAK,IAAM,OAAOA,EAAK,GAClC,GAAIsC,GAAOtC,EAAK,IAAM,OAAOA,EAAK,GAGtC,GAAiB,QAAbD,EAAoB,CACpB,GAAIuC,GAAOtC,EAAK,IAAM,OAAOc,GAAQ,CAAC,MAAOd,EAAK,KAClD,GAAIsC,GAAOtC,EAAK,IAAM,OAAOA,EAAK,GAGtC,GAAiB,QAAbD,EAAoB,CACpB,GAAIsC,GAAQrC,EAAK,IACb,OAAOc,GAAQ,CAAC,MAAOA,GAAQ,CAAC,aAAcd,EAAK,KAAMA,EAAK,KAGlE,GAAIqC,GAAQrC,EAAK,IACb,OAAOc,GAAQ,CAAC,MAAOd,EAAK,GAAIc,GAAQ,CAAC,aAAcd,EAAK,OAIpE,GAAiB,QAAbD,IAEIsC,GAAQrC,EAAK,MAAMA,EAAO,CAACA,EAAK,GAAIA,EAAK,KAGzCqC,GAAQrC,EAAK,KAAK,CAClB,IAAMoC,EAAMD,GAASnC,EAAK,IAE1B,GAAe,IAAXoC,EAAIlL,IAAuB,IAAXkL,EAAIpK,GAAW,MAAO,CAAC,SAAU,EAAG,GAGxD,GAAe,IAAXoK,EAAIpK,GACJ,OAAe,IAAXoK,EAAIlL,GAAkB8I,EAAK,IACf,IAAZoC,EAAIlL,GAAmB,CAAC,MAAO8I,EAAK,IAEjCc,GAAQ,CAAC,uBAAwBd,EAAK,GAAIzK,GAAKmB,IAAI0L,EAAIlL,MAK1E,GAAiB,kBAAb6I,IACgB,IAAZC,EAAK,IAAYsC,GAAOtC,EAAK,KAAM,MAAO,CAAC,SAAU,EAAG,GAGhE,GAAiB,QAAbD,EAAoB,CACpB,GAAIsC,GAAQrC,EAAK,IACb,MAAO,CAAC,MAAOc,GAAQ,CAAC,MAAOA,GAAQ,CAAC,MAAOd,EAAK,KAAMA,EAAK,MAGnE,GAAIqC,GAAQrC,EAAK,IAAK,CAClB,IAAMoC,EAAMD,GAASnC,EAAK,IACpB2C,EAAS7B,GAAQd,EAAK,IAC5B,GAAe,IAAXoC,EAAIpK,GACJ,OAAgB,IAAZoK,EAAIlL,GAAmB,CAAC,aAAcyL,GAC3B,IAAXP,EAAIlL,GAAkB,CAAC,SAAU,EAAG,GACzB,KAAXkL,EAAIlL,GAAoB,CAAC,OAAQyL,GACtB,IAAXP,EAAIlL,GAAkByL,EACX,IAAXP,EAAIlL,GAAkB,CAAC,SAAUyL,GAG9B,CAAC,MAAO,CAAC,uBAAwB,CAAC,MAAOA,GAASpN,GAAKmB,IAAI0L,EAAIlL,OAOlF,MAAM,CAAE6I,GAAR,mBAAqBC,IAGVc,U,whCCzLf,IAAM8B,GAAkBC,IAAQC,QAAQC,aAAaxQ,KAE/CyQ,GAAiB,CAAC,IAAK,IAAK,KAAM,KAAM,KAAM,KAAM,KAAM,MAE1DC,G,WACF,WAAYhD,EAAMiD,EAAMC,EAAUC,EAAcC,EAASC,GAAW,qBAE5D9C,MAAMC,QAAQ0C,SAA0B1Q,IAAb0Q,KAC3BG,EAAWF,EACXA,EAAeD,EACfA,EAAWD,EACXG,EAAUD,QAGG3Q,IAAb6Q,IAAyBA,EAAW,GAExCtP,KAAKiM,KAAOA,EACZjM,KAAKkP,KAAOA,EACZlP,KAAKmP,SAAWA,EAChBnP,KAAKoP,aAAeA,GAAgB,GACpCpP,KAAKuP,iBAAmBF,GAAWrP,KAAKoP,aACxCpP,KAAKsP,SAAWA,E,oDAGE,IAAD,uBAAZE,EAAY,yBAAZA,EAAY,gBACjB,MAAM,GAAN,OAAUxP,KAAKiM,KAAf,YAAuBuD,EAAW1Q,KAAK,MAAvC,O,kCAIA,IAAM2Q,EAAQjD,MAAMxM,KAAKsP,UAEzB,OADAG,EAAMC,KAAK,YACL,YAAN,OAAmB1P,KAAKiM,KAAxB,YAAgCwD,EAAM3Q,KAAK,MAA3C,Q,6BAKA,IADA,IAAI0Q,EAAa,GACRrE,EAAI,EAAGA,EAAInL,KAAKsP,SAAUnE,IAC/BqE,EAAWpF,KAAX,mBAA4B4E,GAAe7D,KAE/C,OAAOqE,EAAW1Q,KAAK,Q,2BAIvB,MAAM,QAAN,OAAekB,KAAKiM,KAApB,YAA4BjM,KAAK2P,OAAjC,cAA6C3P,KAAKkP,KAAlD,O,+BAIA,OAAsB,OAAlBlP,KAAKmP,SAA2B,KAC9B,QAAN,OAAenP,KAAKiM,KAApB,YAA4BjM,KAAK2P,OAAjC,cAA6C3P,KAAKmP,SAAlD,S,KAeFS,G,oLACiB,MAAM,YAAN,OAAmB5P,KAAKiM,KAAxB,wB,2BACP,MAAM,QAAN,OAAejM,KAAKiM,KAApB,8BAA8CjM,KAAKkP,KAAnD,O,+BACI,MAAM,QAAN,OAAelP,KAAKiM,KAApB,8BAA8CjM,KAAKmP,SAAnD,S,GAHOF,IAKrBY,G,oLACiB,MAAM,QAAN,OAAe7P,KAAKiM,KAApB,6B,2BACP,MAAM,QAAN,OAAejM,KAAKiM,KAApB,8CAA8DjM,KAAKkP,KAAnE,O,+BACI,MAAM,QAAN,OAAelP,KAAKiM,KAApB,8CAA8DjM,KAAKmP,SAAnE,S,GAHKF,IAKnBa,G,oLACiB,MAAM,YAAN,OAAmB9P,KAAKiM,KAAxB,6B,2BACP,MAAM,QAAN,OAAejM,KAAKiM,KAApB,kDAAkEjM,KAAKkP,KAAvE,O,+BACI,MAAM,QAAN,OAAelP,KAAKiM,KAApB,kDAAkEjM,KAAKmP,SAAvE,S,GAHMF,IAKpBc,G,oLACiB,MAAM,YAAN,OAAmB/P,KAAKiM,KAAxB,a,2BACP,MAAM,YAAN,OAAmBjM,KAAKiM,KAAxB,qBAAyCjM,KAAKkP,KAA9C,O,+BACI,OAAOlP,KAAKgQ,S,GAHJf,IAStBgB,GAAQ,IAAIhB,GAAgB,SAAU,0BAA2B,gCACjEhK,GAAc,IAAIgK,GAAgB,cACxC,+BACA,kDACA,CAAC,QAAS,CAAC,SACLiB,GAAQ,IAAIjB,GAAgB,QAAS,0BAA2B,gCAChEkB,GAAO,IAAIlB,GAAgB,OAAQ,6BAA8B,sCACjEmB,GAAO,IAAInB,GAAgB,OAAQ,kCAAmC,sCACtEoB,GAAO,IAAIpB,GAAgB,OAAQ,uBAAwB,oCAC3DqB,GAAQ,IAAIrB,GAAgB,QAAS,uBAAwB,6BAC7DsB,GAAQ,IAAItB,GAAgB,QAAS,uBAAwB,6BAC7DuB,GAAS,IAAIvB,GAAgB,SAAU,mBAAoB,+EAC3DwB,GAAQ,IAAIxB,GAAgB,QAAS,gDAAiD,4GACtFyB,GAAS,IAAIzB,GAAgB,SAAU,oCAAqC,gGAC5E0B,GAAQ,IAAI1B,GAAgB,QAAS,iCAAkC,qCAGvE2B,GAAO,IAAI3B,GAAgB,OAAQ,0BAA2B,CAAC,MAAO,UACtE4B,GAAW,IAAI5B,GAAgB,WAApB,gGAGX1M,GAAO,IAAI0M,GAAgB,OAApB,uKAKPxM,GAAO,IAAIwM,GAAgB,OAApB,gKAKPtM,GAAQ,IAAIsM,GAAgB,QAApB,2QAORlM,GAAU,IAAIkM,GAAgB,UAApB,0RAUV5M,GAAO,IAAI4M,GAAgB,OAApB,iGAGb,CAAC,MAAO,MAAO,QAAS,MAAO,kBACzB6B,GAAO,IAAI7B,GAAgB,OAApB,wFAGb,CAAC,MAAO,MAAO,QAAS,MAAO,kBACzB8B,GAAO,IAAI9B,GAAgB,OAAQ,yCAA0C,CAAC,QAAS,OAAQ,QAC/F+B,GAAO,IAAI/B,GAAgB,OAAQ,+BACrC,CAAC,aAAc,QACbgC,GAAO,IAAIhC,GAAgB,OAAQ,+BACrC,CAAC,aAAc,QACbiC,GAAO,IAAIjC,GAAgB,OAAQ,+BACrC,CAAC,aAAc,QAGbkC,GAAU,IAAIlC,GAAgB,UAApB,yLAOhB,CAAC,OAAQ,SAAU,QAAS,MAAO,MAAO,MAAO,QAG3CmC,GAAU,IAAInC,GAAgB,UACpC,qCACA,CAAC,SAAU,QACLoC,GAAU,IAAIpC,GAAgB,UAApB,gHAGhB,CAAC,QAAS,MAAO,gBAAiB,MAAO,QAEnCqC,GAAU,IAAIrC,GAAgB,UAAW,kCAAmC,CAAC,SAAU,eACvFsC,GAAU,IAAItC,GAAgB,UAAW,kCAAmC,CAAC,SAAU,eACvFuC,GAAU,IAAIvC,GAAgB,UAAW,kCAAmC,CAAC,SAAU,eAIvFwC,GAAQ,IAAIxC,GAAgB,QAApB,yFAEd,CAAC,MAAO,MAAO,gBAAiB,eAC1ByC,GAAQ,IAAIzC,GAAgB,QAApB,yFAEd,CAAC,MAAO,MAAO,gBAAiB,eAC1B0C,GAAQ,IAAI1C,GAAgB,QAApB,mMAQd,CAAC,MAAO,gBAAiB,aAAc,MAAO,MAAO,QAC/C2C,GAAQ,IAAI3C,GAAgB,QAC9B,gCAAiC,CAAC,aAAc,SAC9C4C,GAAQ,IAAI5C,GAAgB,QAC9B,gCAAiC,CAAC,aAAc,SAC9C6C,GAAQ,IAAI7C,GAAgB,QAAS,gCAAiC,CAAC,aAAc,SAGrF8C,GAAU,IAAI9C,GAAgB,UACpC,2CACA,CAAC,QAAS,SAAU,QACd+C,GAAU,IAAI/C,GAAgB,UACpC,mCACA,CAAC,QAAS,SAAU,QACdgD,GAAU,IAAIhD,GAAgB,UACpC,2CACA,CAAC,QAAS,SAAU,QACdiD,GAAU,IAAIjD,GAAgB,UACpC,mCACA,CAAC,QAAS,SAAU,QACdkD,GAAU,IAAIlD,GAAgB,UACpC,iDACA,CAAC,QAAS,SAAU,QACdmD,GAAU,IAAInD,GAAgB,UACpC,iDACA,CAAC,QAAS,SAAU,QAIdoD,GAAO,IAAIpD,GAAgB,OAAQ,aAAc,4BACjDtN,GAAO,IAAIsN,GAAgB,OACjC,cADa,sKAOb,GAAI,GAAI,GACFpN,GAAO,IAAIoN,GAAgB,OAAQ,cAAe,2BAA4B,GAAI,CAAC,MAAO,OAAQ,GAClGhN,GAAO,IAAIgN,GAAgB,OACjC,iCACA,sDACA,GAAI,GAAI,GACFqD,GAAiB,IAAI1C,GAAa,iBACxC,cAAe,8BAA+B,GAAI,GAAI,GAChD2C,GAAwB,IAAI3C,GAAa,wBAC/C,mBAAoB,8BAA+B,GAAI,GAAI,GACrD7N,GAAO,IAAIkN,GAAgB,OAAQ,kCAAmC,CAAC,MAAO,cAAe,GAC7FpM,GAAO,IAAIoM,GAAgB,OAAQ,iCAAkC,CAAC,MAAO,MAAO,OAAQ,GAC5FuD,GAAQ,IAAIvD,GAAgB,QAAS,oBAA7B,uNAId,GAAI,GAAI,GACFwD,GAAQ,IAAIxD,GAAgB,QAAS,gCAA7B,wbAWd,GAAI,GAAI,GACFyD,GAAQ,IAAIzD,GAAgB,QAAS,yCAC3C,+DAAgE,CAAC,OAAQ,CAAC,OAAQ,GAG5E0D,GAAS,IAAI1D,GAAgB,SACnC,yEACA,oFACA,CAAC,cAAe,gBAAiB,CAAC,cAAe,iBAC3C2D,GAAc,IAAI3D,GAAgB,cACxC,2HACA,CAAC,MAAO,MAAO,eAAgB,uBAAwB,aAAc,QAC/D4D,GAAe,IAAI5D,GAAgB,eAApB,00CA4BrB,CAAC,aAAc,MAAO,MAAO,OAAQ,CAAC,OAAQ,aAAc,MAAO,MAAO,MAAO,MAAO,kBAClF6D,GAAQ,IAAI7D,GAAgB,QAAS,+BAAgC,CAAC,QAAS,QAG/E8D,GAAO,IAAI9D,GAAgB,OAApB,8RAcb,CAAC,OAAQ,YAAa,eAChB+D,GAAY,IAAI/D,GAAgB,YAApB,yzCAoClB,CAAC,QAAS,MAAO,MAAO,QAAS,MAAO,aAAc,OACtD,CAAC,MAAO,QAAS,gBAAiB,MAAO,aAAc,MAAO,QAGxDgE,GAAiB,IAAIhE,GAAgB,iBAApB,0WAYlB,CAAC,MAAO,MAAO,QACdiE,GAAa,IAAIjE,GAAgB,aACvC,qFACA,CAAC,MAAO,MAAO,MAAO,gBAChBkE,GAAe,IAAItD,GAAW,eAAf,ycAcfuD,GAAiB,IAAItD,GAAY,iBAAhB,0gBAqBjBuD,GAAc,IAAIpE,GAAgB,cAApB,stCAqBhB,CAAC,OAAQ,iBAAkB,eAAgB,QAEzCqE,GAAa,IAAIrE,GAAgB,aAApB,0yCASF,CAAC,aAAc,mBAG1BsE,GAAQ,IAAItE,GAAgB,QAClC,8EACA,CAAC,MAAO,MAAO,MAAO,QAQhBuE,GAAO,IAAIvE,GAAgB,OAApB,uPAUPwE,GAAa,IAAIxE,GAAgB,aAApB,+NAOnB,CAAC,aAAc,QAAS,uBAAwB,SAAU,MAAO,MAAO,QAClEyE,GAAa,IAAIzE,GAAgB,aAApB,kvBA0BgG,CAAC,SAC9G0E,GAAO,IAAI1E,GAAgB,OAApB,8PAaI,CAAC,aAAc,eAK1B2E,GAAW,IAAI3E,GAAgB,WAApB,qSAYA,CAAC,MAAO,gBAAiB,OAAQ,GAC5C4E,GAAW,IAAI5E,GAAgB,WAAY,6EAA8E,CAAC,WAAY,GACtI6E,GAAW,IAAI7E,GAAgB,WACrC,4GACA,CAAC,MAAO,MAAO,WAAY,GACrB8E,GAAW,IAAI9E,GAAgB,WACrC,sIAAuI,CAAC,MAAO,MAAO,WAAY,GAG5J+E,GAAW,IAAI/E,GAAgB,WAApB,+KAOG,CAAC,QAAS,YACxBgF,GAAW,IAAIhF,GAAgB,WAApB,0QAUA,CAAC,UAAW,SAAU,GACjCiF,GAAW,IAAIjF,GAAgB,WACrC,qCAAsC,CAAC,YAAa,GAC9CkF,GAAW,IAAIlF,GAAgB,WACrC,8EACA,CAAC,MAAO,QAAS,UAAW,YAAa,GACnCmF,GAAW,IAAInF,GAAgB,WACrC,wGAAyG,CAAC,MAAO,QAAS,UAAW,YAAa,GAG5IhJ,GAAa,IAAIgJ,GAAgB,aAApB,oOAMnB,CAAC,OAAQ,MAAO,UAAW,QAAS,MAAO,kBACrCnJ,GAAgB,IAAImJ,GAAgB,gBAApB,2IAID,CAAC,WAAY,MAAO,SAAU,iBAAkB,GAE/DoF,GAAW,+GAGXhO,GAAS,IAAI4I,GAAgB,SAApB,yGAKf,CAAC,MAAO,MAAO,WAAY,WAAY,WAAY,YAAa,GAC1D3I,GAAS,IAAI2I,GAAgB,SAApB,8GAKf,CAAC,MAAO,MAAO,WAAY,YAAa,GAClC1I,GAAS,IAAI0I,GAAgB,SAApB,wGAKf,CAAC,MAAO,MAAO,WAAY,WAAY,YAAa,GAC9CqF,GAAM,IAAIrF,GAAgB,MAApB,UACToF,GADS,6BAGZ,CAAC,aAAc,gBAAiB,UAAW,GACrCE,GAAM,IAAItF,GAAgB,MAApB,UACToF,GADS,6BAGZ,CAAC,aAAc,gBAAiB,UAAW,GACrCG,GAAM,IAAIvF,GAAgB,MAApB,UACToF,GADS,6BAGZ,CAAC,aAAc,gBAAiB,UAAW,GAIrCI,GAAM,IAAIxF,GAAgB,MAApB,oVAQZ,CAAC,SAAU,MAAO,MAAO,WAAY,WAAY,WAAY,YAAa,GA8EtEyF,GAAoB,CACpBzE,SACA,WAAchL,GACd,OAAUlC,GACV,cAAiBuP,GACjB,qBAAwBC,GAExB,KAAQjC,GACR,KAAQC,GAER,KAAQL,GACR,IAAOC,GACP,IAAOC,GACP,IAAOC,GACP,IAAOO,GACP,MAASJ,GACT,KAAQC,GACR,MAASC,GACT,KAAQC,GAER,IAAOpO,GACP,QAAWsO,GACX,IAAOpO,GAEP,KAAQE,GACR,IAAOE,GACP,IAAOR,GAAO,IAAOyO,GAAO,IAAOC,GACnC,IAAOC,GAAO,IAAOC,GAAO,IAAOC,GAEnC,OAAUC,GAAU,OAAUC,GAAU,OAAUC,GAClD,OAAUE,GAAU,OAAUC,GAAU,OAAUF,GAClD,KAAQG,GAAO,KAAQC,GAAO,KAAQC,GACtC,KAAQC,GAAO,KAAQC,GAAO,KAAQC,GACtC,OAAUC,GAAS,OAAUC,GAAS,OAAUC,GAChD,OAAUC,GAAS,OAAUC,GAAS,OAAUC,GAChD,IAAOC,GACP,IAAO1Q,GACP,KAAQ6Q,GACR,KAAQC,GACR,KAAQC,GACR,IAAO7Q,GACP,IAAOI,GACP,IAAOF,GACP,UAAa+Q,GAEbF,eAAaC,gBACb,MAASF,GAETK,aAAWE,cAAYI,cACvBL,kBAAgBI,eAAaF,gBAAcC,kBAC3CI,QAAME,cAAYD,cAClB,IAAOV,GACP,KAAQQ,GACR,IAAOI,GAEP1N,cAAYH,iBACZkO,YAAUC,YAAUC,YAAUC,YAAUC,YACxC,QAAWR,GACX,QAAWC,GACX,QAAWC,GACX,QAAWC,GAEX1N,UAAQC,UAAQC,UAChB,GAAM+N,GACN,GAAMC,GACN,GAAMC,GAENhO,QAhJY,IAAIyI,GAAgB,UAApB,oHAIX,CACD,MAAO,UAAW,MAAO,MACzB,SAAU,SAAU,UACrB,GA0IC,GAAMwF,GACN,IA1IS,IAAIxF,GAAgB,OAApB,mjBAmBiB,CAC1B,MAAO,MAAO,OAAQ,SACtB,WAAY,WAAY,WACxB,aAAc,gBACd,WACD,GAoHC,GAjHQ,IAAIA,GAAgB,MAAO,4DAA6D,CAAC,OAkHjG,GAjHQ,IAAIA,GAAgB,MAApB,wRAMZ,CAAC,aAAc,gBAAiB,YA6G5BzD,eA1GmB,IAAIuE,GAAc,iBAAlB,4lBAiBsD,CAAC,QA0F1E,EAzFO,IAAId,GAAgB,KAApB,kdAWX,CAAC,iBAAkB,UAAW,UAAW,UAAW,MAAO,MAAO,UAAW,MAAO,QAAS,YAiF7F,SAAS0F,GAAgBC,GACrB,IACI,IAAMC,EAAS,IAAIhG,IAAQiG,OAAOlG,IAClCiG,EAAOE,KAAKH,GACZ,IAAMtP,EAASuP,EAAOG,QAAQ,GAI9B,OAHe,OAAX1P,GACA6H,QAAQzK,IAAI,WAAY4C,GAErBwH,GAAQxH,GAAU,MAC3B,MAAO9E,GAEL,OADA2M,QAAQ3M,MAAMA,GACP,MAkBf,SAASyU,GAAoBvJ,EAAKwJ,GAC9B,IAAIC,EAAW,KAEf,GAAI3I,MAAMC,QAAQf,GAAM,CAEpByJ,EAnBR,SAASC,EAAgB1J,GACrB,IAAKc,MAAMC,QAAQf,GAAO,OAAO,IAAI2J,IACrC,GAAI,CAAC,SAAU,WAAY,YAAYjW,SAASsM,EAAI,IAAM,OAAO,IAAI2J,IACrE,IAH0B,EAGpBC,EAAe,IAAID,IAAI,CAAC3J,EAAI,KAHR,KAIPA,EAAIsC,MAAM,IAJH,IAI1B,2BAAiC,CAAC,IAAD,OACboH,EADa,cAC7B,2BAAyC,CAAC,IAAjCG,EAAgC,QACrCD,EAAavR,IAAIwR,IAFQ,gCAJP,8BAS1B,OAAOD,EAUQF,CAAgB1J,GAI3B,IADA,IAAM8J,EAAQhJ,MAAMiJ,KAAKN,GAClBK,EAAM5H,OAAS,GAAG,CACrB,IADqB,EACfvG,EAAImO,EAAME,MACVC,EAAOjB,GAAkBrN,GAFV,KAGA6N,EAAWS,EAAKpG,iBAAmBoG,EAAKvG,cAHxC,IAIrB,2BAA8B,CAAC,IAAtBwG,EAAqB,QACrBT,EAASU,IAAID,KACdT,EAASpR,IAAI6R,GACbJ,EAAMpL,KAAKwL,KAPE,oCAWtB,CACHT,EAAW,IAAIE,IACf,cAAiBS,OAAOC,KAAKrB,IAA7B,eAAiD,CAA5C,IAAIzI,EAAI,KACTkJ,EAASpR,IAAIkI,IAIrBkB,QAAQzK,IAAI,oBAAqByS,GAEjC,IAAMa,EAAWd,EAAW,OAAS,OAC/Be,EAAcf,EAAW,MAAQ,KAEjCgB,EAAY1J,MAAMiJ,KAAKN,GAAU5R,KAAI,SAAA0I,GAAI,OAAIyI,GAAkBzI,MAC/DkK,EAAeD,EAAU3S,KAAI,SAAA8D,GAAC,OAAIA,EAAE+O,YAAYC,WAAW,WAAYL,MACvEM,EAAcJ,EAAU3S,KAC1B,SAAA8D,GAAC,OAAK6N,EAAW7N,EAAEkP,SAAWlP,EAAE2I,MAAMqG,WAAW,WAAYL,GAAUK,WAAW,aAAcJ,MAG9FO,EAAoBL,EAAarX,KAAK,MACtC2X,EAAmBH,EAAYxX,KAAK,MAC1C,MAAM,GAAN,OAAU0X,EAAV,eAAkCC,GC/0BtC,IAAMlV,GAAOC,EAAQ,KAErB,SAASkV,GAAepY,GACpB,IAAMqY,EAAaC,OAAOC,UAAUvY,GAAK,IAAM,GAC/C,OAAOA,EAAEwY,WAAaH,EA+DXI,OA3Df,SAASA,EAAOrL,EAAKwJ,GACjB,IAAKpJ,MAAMJ,GAEP,MAAO,CAACgL,GAAehL,IAAM,GAEjC,IAAKc,MAAMC,QAAQf,GAAO,MAAO,CAACA,GAAK,GAEvC,IAAIsL,EAAiB,CACjB,IAAO,IACP,IAAO,IACP,cAAiB,KAEjB9B,IACA8B,EAAiB,IAbM,kBAgBCtL,GAArBK,EAhBoB,KAgBPC,EAhBO,WAkB3B,GAAiB,WAAbD,EAAuB,CAAC,IAAD,cACFC,EADE,GAChB9D,EADgB,KACVC,EADU,KAEvB,GAAI+M,EAAU,CACV,IAAItH,EAASrM,GAAK0V,MAAM/O,EAAMC,GAE9B,OADe,IAAXyF,IAAeA,EAAS,GACrB,CAAC,QAAD,OAAS1F,EAAK0F,EAAd,aAAyBzF,EAAKyF,EAA9B,aAAyCrM,GAAKmB,IAAIkL,GAAlD,MAA8D,GAErE,OAAa,IAAT1F,GAAuB,IAATC,EAAoB,CAAC,OAAO,GACjC,IAATD,GAAuB,IAATC,EAAoB,CAAC,KAAK,GACrC,CAAC,QAAD,OAASD,EAAT,aAAkBC,EAAlB,MAA2B,GAI1C,GAAiB,aAAb4D,EAA0B,MAAO,CAACC,EAAK,IAAI,GAC/C,GAAiB,aAAbD,EAA0B,MAAO,CAAC,KAAOC,EAAK,GAAGkL,eAAe,GACpE,GAAInL,KAAYiL,EAAgB,CAC5B,IAAMvJ,EAAKuJ,EAAejL,GACtBoL,EAAWnL,EAAKzI,KAAI,SAAAjF,GAAC,OAAIyY,EAAOzY,EAAG4W,MAYvC,MATW,MAAPzH,EACI0J,EAAS,GAAG,KACZA,EAAS,GAAG,GAAK,IAAMA,EAAS,GAAG,GAAK,KAGjC,MAAP1J,IACA0J,EAAWA,EAAS5T,KAAI,SAAAjF,GAAC,MAAI,CAACA,EAAE,GAAK,IAAMA,EAAE,GAAK,IAAMA,EAAE,IAAI,OAG/D,CAAC6Y,EAAS,GAAG,GAAK1J,EAAK0J,EAAS,GAAG,GAAiB,QAAbpL,GASlD,MAAO,CAFcG,cAHE,CACnB,UAAa,SAEwBH,EAAU,IAAMA,GAElC,IAAMC,EAAKzI,KAAI,SAAAjF,GAAC,OAAIyY,EAAOzY,EAAG4W,GAAU,MAAIpW,KAAK,MAAQ,KAAK,IC7DzF,SAASsY,GAAWC,EAAIC,EAAMC,GAE5B,IAAMC,EAASH,EAAGI,aAAaH,GAK/B,OAJAD,EAAGK,aAAaF,EAAQD,GACxBF,EAAGM,cAAcH,GAGZH,EAAGO,mBAAmBJ,EAAQH,EAAGQ,gBAO/BL,GANLrK,QAAQ3M,MAAM,6BACV6W,EAAGS,iBAAiBN,IACxBH,EAAGU,aAAaP,GACT,MAqDIQ,OA9Cf,SAA6BX,EAAIzC,EAAYqD,EAAcC,GACzD,GAAmB,OAAftD,EAAsB,OAAO,KAEjCyC,EAAGnC,UAAY+C,EACf,IAAME,EAsDR,SAAiCvD,EAAYqD,EAAcG,EAAOC,EAAQH,EAAehD,GACvF,IAAMoD,GAAYF,EAAM,GAAGG,QAAQ,GAC7BC,GAAYH,EAAO,GAAGE,QAAQ,GAC9BE,EAAMjZ,OAAOkZ,iBAAiBH,QAAQ,GAEtCI,EAAUzD,EAAW,OAAS,OAE9B0D,EAAuBV,EAAc3U,KACzC,SAAC0I,GAAD,wBAAqB0M,EAArB,YAAgC1M,EAAhC,QACAnN,KAAK,MAEH+Z,EAAc,GACdC,EAAkB,KAClBb,GACFY,EAAcjE,EACdkE,EAAkB,eAElBA,EAAkB/B,GAAOnC,EAAYM,GAAU,GAC3CA,IACA4D,EAAe,oBAAgBA,EAAhB,OAGrB,GAAwB,OAApBA,EAA2B,OAAO,KAKtC,OAHA3L,QAAQzK,IAAI,gBAAiBkS,GAC7BzH,QAAQzK,IAAR,uBAA4BwS,EAAW,WAAa,YAApD,MAAqE4D,GAE/D,ygBAAN,OAkBQH,EAlBR,mBAkB0BzD,EAAW,UAAY,UAlBjD,sBAmBQyD,EAnBR,kBAmByBzD,EAAW,iBAAmB,cAnBvD,oDAqBQyD,EArBR,mBAqB0BzD,EAAW,iBAAmB,cArBxD,wIA0BgByD,EA1BhB,4BA0B2CzD,EAAW,0BAA4B,iBA1BlF,iHA4BEA,EAAW,oEAAsE,wCA5BnF,wGA+BE0D,EA/BF,iBAiCE3D,GAAoBL,EAAYM,GAjClC,2OAyCiByD,EAzCjB,uLA6CazD,EAAW,wBAA0B,QA7ClD,iFAkDIA,EAAQ,wHACiC,GAnD7C,unBAyEAA,EAAW,mEAAqE,GAzEhF,0oBA6FE2D,EA7FF,iDA+FkCP,EA/FlC,aA+F+CE,EA/F/C,yIAkGsCC,EAlGtC,+EAsGEE,EAtGF,mFAwGMzD,EAAW,2BAA6B,kBAxG9C,0BAyGa4D,EAzGb,2NAmHIH,EAnHJ,gDAoHIA,EApHJ,gDAqHIA,EArHJ,gDAsHIA,EAtHJ,8FAyH6BzD,EAAW,sCAAwC,KAzHhF,qCA0HuBA,EAAW,yCAA2C,4CA1H7E,uXAjF6B6D,CAC3BnE,EACAqD,EACAZ,EAAG2B,mBAAoB3B,EAAG4B,oBAC1Bf,EACAb,EAAGnC,UAGL,GAA6B,OAAzBiD,EAAgC,OAAO,KAE3ChL,QAAQzK,IAAIyV,GAGZ,IAAMe,EAAe9B,GAAWC,EAC9BA,EAAG8B,cAAeC,IACdC,EAAiBjC,GAAWC,EAChCA,EAAGiC,gBAAiBnB,GAEtB,GAAqB,OAAjBe,EAA2C,OAAnBG,EAC1B,OAAO,KAQT,IAAME,EAAgBlC,EAAGmC,gBAMzB,OALAnC,EAAGoC,aAAaF,EAAeL,GAC/B7B,EAAGoC,aAAaF,EAAeF,GAC/BhC,EAAGqC,YAAYH,GAGVlC,EAAGsC,oBAAoBJ,EAAelC,EAAGuC,aAMvCL,GALLpM,QAAQ3M,MAAM,wCACV6W,EAAGwC,kBAAkBN,IAClB,OASLH,GAAkB,sG,whCC9CxB,SAASU,GAAgBzC,EAAIzC,EAAYqD,EAAcC,GACrD,GAAmB,OAAftD,EAAsB,OAAO,KAEjC,IAAM2E,EAAgBvB,GACpBX,EACAzC,EAAYqD,EACZC,GAGF,GAAsB,OAAlBqB,EAEF,OADApM,QAAQ3M,MAAM,6BAA8BoU,GACrC,MAlCX,SAAqByC,GACnB,IAAM0C,EAAe1C,EAAG2C,eACxB3C,EAAG4C,WAAW5C,EAAG6C,aAAcH,GAc/B1C,EAAG8C,WACD9C,EAAG6C,aACH,IAAIE,aAbW,EACd,GAAI,EACL,GAAI,GACH,EAAG,GAEH,EAAG,EACJ,GAAI,EACJ,EAAG,IAOH/C,EAAGgD,aAmBLC,CAAYjD,GACZA,EAAGkD,WAAWhB,GAGd,IAAMiB,EAAmBnD,EAAGoD,kBAAkBlB,EAAe,cAC7DlC,EAAGqD,wBAAwBF,GAC3BnD,EAAGsD,oBAAoBH,EAAkB,EAAGnD,EAAGuD,OAAO,EAAO,EAAG,GAGhE,IAxBoE,EAwB9DC,EAAoB,GAxB0C,KAyBjD3C,GAzBiD,IAyBpE,2BAAkC,CAAC,IAAxBjM,EAAuB,QAChC4O,EAAkB5O,GAAQoL,EAAGyD,mBAAmBvB,EAAetN,IA1BG,8BA4BpE,OAAO4O,EAGT,SAASE,GAAU1D,EAAI1L,EAAWqP,GAEhC,cAAkBlF,OAAOC,KAAKpK,GAA9B,eAA0C,CAArC,IAAMsP,EAAG,KAA4B,cACdtP,EAAUsP,GADI,GACjCC,EADiC,KACvB9a,EADuB,KAEpCiX,EAAGnC,SACHmC,EAAG8D,UAAUD,EAAU9a,EAAO,EAAG,GAEjCiX,EAAG+D,UAAUF,EAAU9a,EAAO,GAKpCiX,EAAGgE,WAAWhE,EAAGiE,UAAW,EAAG,GAMjC,SAAkBC,EAAK5P,GAEnB,IAAM8M,EAAMjZ,OAAOkZ,iBACZN,EAAkB5Y,OAAOwB,WAAayX,EAA/BJ,EAAoC7Y,OAAOgc,YAAc/C,EAEvE,GADA8C,EAAIE,UAAU,EAAG,EAAGrD,EAAOC,GACvB1M,EAAU+P,YAAY,GAAK,GAAM,OAGrC,IAAMC,EAAQpX,KAAK/B,IAAImJ,EAAUiQ,UAAU,IAAMnD,EAE7CoD,EAAmB,IAAMlQ,EAAUiQ,UAAU,GAAKrX,KAAK7B,IAAI,IAC/DmZ,GAAoB,IAAOtX,KAAKH,IAAIyX,GACpC,IAAIC,EAAgBvX,KAAK6B,MAAMyV,GAC3BE,EAAaxX,KAAKzB,IAAI,GAAIgZ,GAE1BA,EAAgBD,EAAmB,IACnCE,GAAc,EACdD,KACOA,EAAgBD,EAAmB,IAC1CE,GAAc,EACdD,KApB0B,IAwBvBE,EACH5D,EAAM,EAAIuD,EAAMhQ,EAAUsQ,SAAS,GAD5BC,EAEP7D,EAAO,EAAIsD,EAAMhQ,EAAUwQ,SAAS,GAIjCC,GAAkBJ,EAAGL,EAAdU,GAAsBjE,EAAQ4D,GAAIL,EACzCW,GAAkBJ,EAAG7D,GAAQsD,EAAtBY,EAA6BL,EAAGP,EAI9C,SAASa,EAAeC,GACpB,IAAMC,EAAKnY,KAAK6B,MAAM8V,EAAKP,EAAMc,GACjClB,EAAIoB,OAAO,EAAGD,GACdnB,EAAIqB,OAAOxE,EAAOsE,GAGtB,SAASG,EAAave,EAAGwe,GACrB,IAAMC,EAAKxY,KAAK6B,MAAM4V,EAAKL,EAAMrd,GACjCid,EAAIoB,OAAOI,EAAI,GACfxB,EAAIqB,OAAOG,EAAI1E,GAGnB,SAAS2E,EAAO1e,GACZ,IAAMye,EAAKf,EAAKL,EAAQrd,EACxB,KAAIye,EAAK3E,EAAQ,GAAGK,GAAOsE,EAAK,GAAGtE,GAAnC,CAEA,IAAMwE,EAAMf,EAAK7D,EAAO,EAAK,IAAM,GAC7BoE,EAAIlY,KAAK2Y,IAAI3Y,KAAK4Y,IAAIjB,EAAKe,EAAGxE,EAAK,GAAKA,GAAMJ,EAAO,GAAGI,GAE1D2E,EAAQ9e,EAAEia,QAAQhU,KAAK4Y,IAAI,GAAIrB,IAAgBuB,QAAQ,IAAK,UAC1DC,EAAY/B,EAAIgC,YAAYH,GAAOhF,MAAQ,EAAIK,EAErD8C,EAAIiC,UAAY,SAChBjC,EAAIE,UAAUsB,EAAKO,EAAU,EAAGb,EAAI,GAAGhE,EAAK6E,EAAW,GAAG7E,GAC1D8C,EAAIkC,WAAWL,EAAOL,EAAIN,GAC1BlB,EAAImC,SAASN,EAAOL,EAAIN,IAG5B,SAASkB,EAAOlB,EAAGmB,GACf,IAAMlB,EAAKR,EAAKP,EAAQc,EAAI,EAAIhE,EAChC,KAAIiE,EAAKrE,EAAS,GAAGI,GAAOiE,EAAK,IAAIjE,GAArC,CAEA,IAAMoF,EAAa7B,EAAK,EAAE5D,EAAM,EAC1B0F,EAAKD,EAAY,IAAK,GAC5BtC,EAAIiC,UAAYK,EAAY,OAAS,QAErC,IAAMvf,EAAIiG,KAAK2Y,IAAI3Y,KAAK4Y,IAAInB,EAAK8B,EAAGrF,EAAK,GAAKA,GAAML,EAAO,GAAGK,GAE1D2E,EAAQX,EAAElE,QAAQhU,KAAK4Y,IAAI,GAAIrB,IAAgBuB,QAAQ,IAAK,UAClD,MAAVD,IAAgBA,EAAQ,IACd,YAAVA,IAAiBA,EAAQ,UAE7B7B,EAAIwC,KAAJ,UAAc,GAAKtF,EAAnB,4BACA,IAAM6E,EAAY/B,EAAIgC,YAAYH,GAAOhF,MAEnC4F,EAAaV,EAAYM,EAAS,EAAEnF,EAC1C8C,EAAIE,UACAnd,GAAKuf,EAAY,EAAEpF,EAAMuF,EAAa,EAAEvF,GACxCiE,EAAK,GAAGjE,EACRuF,EACA,GAAGvF,GAGP,IAAMwF,EAAaJ,EAAY,GAAKD,EAASnF,EAC7C8C,EAAIkC,WAAWL,EAAO9e,EAAI2f,EAAYvB,GACtCnB,EAAImC,SAASN,EAAO9e,EAAI2f,EAAYvB,GAEpCnB,EAAIwC,KAAJ,iBAAqB,GAAKtF,EAA1B,4BACA,IAAMyF,EAAUL,EAAYP,EAAY7E,EAAM,EAC9C8C,EAAIkC,WAAW,IAAKnf,EAAI4f,EAASxB,GACjCnB,EAAImC,SAAS,IAAKpf,EAAI4f,EAASxB,IAKnCnB,EAAI4C,YAAc,GAClB5C,EAAI6C,YAAa,UAEjB7C,EAAIuB,UAAY,EAChBvB,EAAI8C,YACJ,IAAK,IAAIlT,EAAI5G,KAAK+Z,KAAKlC,EAAML,GAAa5Q,EAAIkR,EAAMN,EAAY5Q,IAClD,IAANA,GACJ0R,EAAa1R,EAAI4Q,GAErB,IAAK,IAAI5Q,EAAI5G,KAAK+Z,KAAKhC,EAAMP,GAAa5Q,EAAIoR,EAAMR,EAAY5Q,IAClD,IAANA,GACJqR,EAAerR,EAAI4Q,GAEvBR,EAAIgD,SAEJhD,EAAIuB,UAAY,EAChBvB,EAAI8C,YACJxB,EAAa,GACbL,EAAe,GACfjB,EAAIgD,SAGJhD,EAAIwC,KAAJ,UAAc,GAAKtF,EAAnB,4BACA8C,EAAI4C,YAAc,EAClB5C,EAAIiD,UAAY,UAChBjD,EAAIuB,UAAY,EAChBvB,EAAIkD,SAAW,QACflD,EAAI6C,YAAc,UAClB,IAAK,IAAIjT,EAAI5G,KAAK+Z,KAAKlC,EAAML,GAAa5Q,EAAIkR,EAAMN,EAAY5Q,IAClD,IAANA,GACJ6R,EAAO7R,EAAI4Q,GAIfR,EAAIwC,KAAJ,iBAAqB,GAAKtF,EAA1B,4BAEA,IADA,IAAMmF,EAASrC,EAAIgC,YAAY,KAAKnF,MAC3BjN,EAAI5G,KAAK+Z,KAAKhC,EAAMP,GAAa5Q,EAAIoR,EAAMR,EAAY5Q,IAClD,IAANA,GACJwS,EAAOxS,EAAI4Q,EAAY6B,GA7I7Bc,CAAS1D,EAAUrP,G,aCtErB,SAASgT,GAAcrgB,EAAGme,EAAGmC,GACzB,OAAU,IAANtgB,EACU,IAANme,EACOoC,GAAWvgB,GAAG,EAAOsgB,GAAaC,GAAWpC,GAAG,EAAMmC,GAAa,QAEnEC,GAAWvgB,GAAG,EAAOsgB,GAEnB,IAANnC,EACAoC,GAAWpC,GAAG,EAAOmC,GAAa,QAElC,IAIf,IAAME,GAAY,CACd,OAAQva,KAAKC,GACb,YAAaD,KAAK3B,KAAK,GACvB,EAAK2B,KAAKwC,GAGd,SAASgY,GAAczgB,GACnB,OAAOiG,KAAKH,IAAI9F,EAAIiG,KAAK6B,MAAM9H,IAAM,MA2BzC,SAASugB,GAAWvgB,EAAG0gB,EAAWJ,GAC9B,IAAMK,EAAY1a,KAAKH,IAAI9F,GACrB4gB,EAAO5gB,EAAI,EAAI,IACjB0gB,EAAY,IAAM,GAGtB,GAAIJ,EAAY,EAAG,CAEf,IAAMO,EA/Bd,SAAoB7gB,GAChB,cAA0BwX,OAAOsJ,QAAQN,IAAzC,eACI,IADkD,IAAD,0BAA3C7S,EAA2C,KAArC7L,EAAqC,KACjD,MAAwB,CAAC,EAAG,EAAG,EAAG,EAAG,IAArC,eAA0C,CAArC,IAAIif,EAAW,KACVC,EAAQD,EAAc/gB,EAAI8B,EAGhC,GAAIkf,EAAQ,IAAOP,GAAcO,GAAQ,CACrCnS,QAAQzK,IAAI4c,GACZ,IACMC,EADgB,SAAAjhB,GAAC,OAAU,IAANA,EAAU,GAAKA,EAAEwY,WAC1B0I,CAAcjb,KAAK6B,MAAMkZ,IAAU,IAAMrT,EAE3D,OAAoB,IAAhBoT,EACOE,EAEA,UAAYA,EAAY,KAAOF,EAAc,KAMpE,OAAO,KAWqBI,CAAWR,GACnC,IAAK7S,gBAAM+S,GAAmB,OAAOD,EAAOC,EAGhD,IAAIO,EAAWT,EAAY,EAAI1a,KAAKuJ,MAAMvJ,KAAKob,MAAMV,IAAc,EAQnE,OAPI1a,KAAKH,IAAIsb,GAAY,IAAIA,EAAW,GAOjCR,GALUD,EAAY1a,KAAKzB,IAAI,IAAK4c,IAEPnH,QAAQqG,IACL,IAAbc,EAAiB,GAAjB,sBAAqCA,EAArC,M,IC4BfE,G,YApFX,WAAY3f,GAAQ,IAAD,8BACf,4CAAMA,KALV4f,MAAQ,CACJC,OAAO,GAMP,EAAKC,UAAY,KACjB,EAAKC,MAAQ,KACb,EAAKC,MAAQ,KALE,E,0EAQL,IAAD,EACMjgB,KAAKC,MAAb3B,EADE,EACFA,EAAGme,EADD,EACCA,EACJyD,EAAWlgB,KAAKggB,QAAU1hB,GAAO0B,KAAKigB,QAAUxD,EAKtD,OAHAzc,KAAKggB,MAAQ1hB,EACb0B,KAAKigB,MAAQxD,EAENyD,I,0CAIPlgB,KAAKmgB,uB,2CAGa,IAAD,OACbngB,KAAKogB,eACkB,OAAnBpgB,KAAK+f,WACLM,aAAargB,KAAK+f,WAEtB/f,KAAK+f,UAAYO,YAAW,kBAAM,EAAKC,SAAS,CAACT,OAAO,MAAQ,KAChE9f,KAAKugB,SAAS,CAACT,OAAO,O,+BAIpB,IACCA,EAAS9f,KAAK6f,MAAdC,MADF,EAEmB9f,KAAKC,MAAtB3B,EAFF,EAEEA,EAAGme,EAFL,EAEKA,EAFL,GAIU+D,EAJV,EAEQA,SAEU,CAACliB,EAAGme,IAJtB,mBAIEgE,EAJF,KAIKC,EAJL,KAML,OAAO,yBAAKC,UAAU,wBAClB,kBAAC,cAAD,KAAa,OAAShC,GAAcrgB,EAAGme,EAAG,IACzCmE,SAASH,IAAMG,SAASF,GAAK,kBAAC,cAAD,KAAa,UAAY/B,GAAc8B,EAAGC,EAAG,IAAmB,KAC9F,w5BA2BmBZ,EAAQ,EAAI,EA3B/B,8CA4BsBA,EAAQ,EAAI,GA5BlC,2T,GA9CoBxe,iBCK5Buf,I,OAAa,IAEjB,SAASC,GAAYxiB,EAAGme,EAAG9Q,GACvB,IAAMgQ,EAAQpX,KAAK/B,IAAImJ,EAAUiQ,WAC3BmF,EAAWpV,EAAUsQ,SACrB+E,EAAWrV,EAAUwQ,SAI3B,MAAO,EAFS7d,EAAIuiB,GAAW,GAAG,GAAKlF,EAAQoF,GAC/BF,GAAW,GAAG,EAAIpE,GAAKd,EAAQqF,G,IAkRpCC,G,YA9PX,WAAYhhB,GAAQ,IAAD,8BACf,4CAAMA,KANV4f,MAAQ,CACJqB,SAAU,CAACrV,IAAKA,IAAK,GACrBsV,WAAW,GAMX,EAAK9J,GAAK,KAEV,EAAKwD,kBAAoB,GACzB,EAAKuG,aAAc,EAEnB,EAAKC,WAAa,KARH,E,iFAYf7hB,OAAO8hB,iBAAiB,SAAUthB,KAAKuhB,YAAYC,KAAKxhB,OAExDA,KAAKyhB,kBACLzhB,KAAKmgB,qBACLngB,KAAKuhB,gB,oCAIM,IACJG,EAAW1hB,KAAKC,MAAhByhB,QACP1hB,KAAK2hB,iBACL3hB,KAAK4hB,aACLF,GAAS1hB,KAAKohB,e,2CAGI,IACXxM,EAAc5U,KAAKC,MAAnB2U,WACH5U,KAAK6hB,iBAAmBjN,GACxB5U,KAAKuhB,cAETvhB,KAAK6hB,eAAiBjN,I,kCAIdkN,GACR,IAAMC,EAAcD,EAAWC,YAE/B,QAAkCtjB,IAA9BsjB,EAAYC,cAA6B,CACzC,IAAMC,EAAUF,EAAYC,cAC5B,GAAuB,IAAnBC,EAAQrU,OACR,MAAO,CAACqU,EAAQ,GAAGC,MAAOD,EAAQ,GAAGE,MAAO,GACxC,IAAD,EACc,CAACF,EAAQ,GAAGC,MAAOD,EAAQ,GAAGE,OAAxCnG,EADJ,KACQE,EADR,OAEc,CAAC+F,EAAQ,GAAGC,MAAOD,EAAQ,GAAGE,OAAxCC,EAFJ,KAEQC,EAFR,KAOH,MAAO,EAHUrG,EAAKoG,GAAM,GACXlG,EAAKmG,GAAM,EACR9d,KAAK7B,IAAI6B,KAAK0S,MAAMmL,EAAGpG,EAAIqG,EAAGnG,KAItD,MAAO,CAAC6F,EAAYG,MAAOH,EAAYI,MAAO,K,qCAIvCL,GACX9hB,KAAKugB,SAAS,CAACW,SAAUlhB,KAAKsiB,YAAYR,O,iCAGnCS,EAAYC,GAAgB,IAC5BtB,EAAYlhB,KAAK6f,MAAjBqB,SACAvV,EAAa3L,KAAKC,MAAlB0L,UAEP,GAAKuV,EAASxS,MAAMkS,UAApB,CAJkC,kBAKhBM,EALgB,GAK3B5iB,EAL2B,KAKxBme,EALwB,aAQCqE,GAAYxiB,EAAGme,EAAG9Q,IARnB,mBAQ3B8W,EAR2B,KAQdC,EARc,KASlC/W,EAAUsQ,SAAWwG,EACrB9W,EAAUwQ,SAAWuG,OAGCjkB,IAAlB+jB,IACAA,EAAiBD,EAAWI,OAAS,GAAM,IAAM,KAErDhX,EAAUiQ,WAAa4G,EAhBW,MAmBS1B,GAAYxiB,EAAGme,EAAG9Q,GAnB3B,mBAoB3BiX,EApB2B,KAoBYH,EAA9BI,EApBkB,KAoB2CH,EAC7E/W,EAAUsQ,UAAY2G,EACtBjX,EAAUwQ,UAAY0G,EAEtB7iB,KAAK4hB,gB,sCAGO7hB,GACZC,KAAK8iB,eAAe/iB,GACpBC,KAAKugB,SAAS,CAACY,WAAW,M,oCAGhBphB,GACVC,KAAKugB,SAAS,CAACY,WAAW,M,sCAGdphB,GAAQ,IACbohB,EAAanhB,KAAK6f,MAAlBsB,UACAxV,EAAa3L,KAAKC,MAAlB0L,UAGP,GAAIwV,EAAW,CAAC,IACLD,EAAYlhB,KAAK6f,MAAjBqB,SADI,EAEiBlhB,KAAKsiB,YAAYviB,GAFlC,mBAEJzB,EAFI,KAEDme,EAFC,KAEEsG,EAFF,KAILC,EAAgB,CAClB1kB,EAAI4iB,EAAS,GACbzE,EAAIyE,EAAS,GACb6B,EAAc7B,EAAS,IAGrBvF,EAAQpX,KAAK/B,IAAImJ,EAAUiQ,WACjCjQ,EAAUsQ,UAAY+G,EAAc,GAAKrH,EACzChQ,EAAUwQ,UAAY6G,EAAc,GAAKrH,EACzC3b,KAAKijB,WAAW,KAAMD,EAAc,IACpChjB,KAAK4hB,aAET5hB,KAAK8iB,eAAe/iB,K,uCAGPA,GACbC,KAAKkjB,gBAAgBnjB,K,sCAGTA,GACZC,KAAKmjB,gBAAgBpjB,K,qCAGVA,GACXC,KAAKojB,cAAcrjB,K,2CAGFsjB,GAGjB,IAH0B,IACnB1X,EAAa3L,KAAKC,MAAlB0L,UAEP,MAA4BmK,OAAOsJ,QAAQiE,GAA3C,eAAoD,CAAC,IAAD,0BAAxCpX,EAAwC,KAAlC7L,EAAkC,KAChDuL,EAAUM,GAAQ7L,EAGtBJ,KAAK4hB,e,wCAIL,IAAM0B,EAAStjB,KAAKujB,KAAKD,OACnBE,EAAOxjB,KAAKujB,KAAKC,KAIvB,GAHAxjB,KAAKqX,GAAKiM,EAAOG,WAAW,SAC5BzjB,KAAKwjB,KAAOA,EAAKC,WAAW,MAEZ,OAAZzjB,KAAKqX,GAEL,OADAlK,QAAQ3M,MAAM,+BACP,O,uCAIG,IAAD,EACmBR,KAAKC,MAA9B2U,EADM,EACNA,WAAYjJ,EADN,EACMA,UAEb2X,EAAStjB,KAAKujB,KAAKD,OACnBE,EAAOxjB,KAAKujB,KAAKC,KACnB/K,EAAMjZ,OAAOkZ,iBAGjB4K,EAAOlL,MAAQkL,EAAOI,YAAcjL,EACpC6K,EAAOjL,OAASiL,EAAOK,aAAelL,EAEtC+K,EAAKpL,MAAQoL,EAAKE,YAAcjL,EAChC+K,EAAKnL,OAASmL,EAAKG,aAAelL,EAGlCoI,GAAa,CAACyC,EAAOI,YAAaJ,EAAOK,cACzC3jB,KAAKqX,GAAGuM,SAAS,EAAG,EAAGN,EAAOlL,MAAOkL,EAAOjL,QAG5C,IAAMwC,EAAoBf,GACtB9Z,KAAKqX,GACLzC,EACAjJ,EAAUkY,gBAAkB,GAC5B/N,OAAOC,KAAKpK,IAIhB3L,KAAKohB,YAAqC,OAAtBvG,EAChB7a,KAAKohB,cACLphB,KAAK6a,kBAAoBA,K,mCAO7B,IAHU,IACHlP,EAAa3L,KAAKC,MAAlB0L,UACDmY,EAAsB,GAC5B,MAA4BhO,OAAOsJ,QAAQzT,GAA3C,eAAuD,CAAC,IAAD,0BAA3CM,EAA2C,KAArC7L,EAAqC,KACnD0jB,EAAoB7X,GAAQ,CAACjM,KAAK6a,kBAAkB5O,GAAO7L,GAI/D,IAAM2jB,GAAO,IAAIC,MACO,OAApBhkB,KAAKqhB,YAAuB0C,EAAM/jB,KAAKqhB,WAAa,IAnO9C,MAoONtG,GAAU/a,KAAKqX,GAAIyM,EAAqB9jB,KAAKwjB,MAC7CxjB,KAAKqhB,WAAa0C,K,+BAIhB,IAAD,SACyB/jB,KAAK6f,MAA5BqB,EADF,EACEA,SAAUC,EADZ,EACYA,UADZ,EAE2BnhB,KAAKC,MAA9B2U,EAFF,EAEEA,WAAYjJ,EAFd,EAEcA,UAFd,EAIUmV,GAAYI,EAAS,GAAIA,EAAS,GAAIvV,GAJhD,mBAIErN,EAJF,KAIKme,EAJL,KAKC+D,EAAU/U,GAAKmJ,EAAYjJ,GAEjC,OACI,yBAAKtN,GAAG,iBACJ,yBAAKA,GAAG,iBAAR,aAEI,yBAAKsiB,UAAU,SAAf,4EAEJ,4BACIsD,IAAI,SAEJC,YAAa,SAACnkB,GAAD,OAAW,EAAKmjB,gBAAgBnjB,IAC7CokB,YAAa,SAACpkB,GAAD,OAAW,EAAKojB,gBAAgBpjB,IAC7CqkB,UAAW,SAACrkB,GAAD,OAAW,EAAKqjB,cAAcrjB,IAEzCskB,aAAc,SAACtkB,GAAD,OAAW,EAAKojB,gBAAgBpjB,IAC9CukB,aAAc,SAACvkB,GAAD,OAAW,EAAKqjB,cAAcrjB,IAE5CwkB,aAAc,SAACxkB,GAAD,OAAW,EAAKykB,iBAAiBzkB,IAC/C0kB,YAAa,SAAC1kB,GAAD,OAAW,EAAK2kB,gBAAgB3kB,IAC7C4kB,WAAY,SAAC5kB,GAAD,OAAW,EAAK6kB,eAAe7kB,IAE3C8kB,QAAS,SAAC9kB,GAAD,OAAW,EAAKkjB,WAAWljB,IAEpC4gB,UAAU,0BAEd,4BACIsD,IAAI,OACJtD,UAAU,qBAGbC,SAAStiB,IAAMsiB,SAASnE,GACrB,kBAAC,GAAD,CAAmBne,EAAGA,EAAGme,EAAGA,EAAG+D,QAASA,IACtC,KAEN,2BAAOsE,KAAG,GAAV,oEAEU3D,EAAY,WAAa,OAFnC,oC,GAzPW7f,iB,wCCpBrByjB,I,mBACJ,WAAY9kB,GAAQ,IAAD,8BACjB,4CAAMA,KACD+kB,QAAU/kB,EAAM+kB,QACrB,EAAKnF,MAAQ,CACXzH,MAAO,MAJQ,E,iFASjBpY,KAAKilB,cACLzlB,OAAO8hB,iBAAiB,SAAUthB,KAAKilB,YAAYzD,KAAKxhB,S,oCAIxDA,KAAKugB,SAAS,CAACnI,MAAO5Y,OAAOwB,e,+BAI7B,OAAIhB,KAAK6f,MAAMzH,MAAQpY,KAAKC,MAAMilB,gBAErC,kBAACC,GAAA,EAAD,CACEC,OAAQplB,KAAKC,MAAMmlB,OACnBC,KAAMrlB,KAAKC,MAAMolB,KACjBC,QAAQ,aACRN,QAAS,CACPO,MAAOvlB,KAAKC,MAAM0gB,YAGpB,yBAAKA,UAAW3gB,KAAKglB,QAAQQ,UAC7B,yBAAK7E,UAAU,kBACZ3gB,KAAKC,MAAMwlB,WAMhB,kBAACC,GAAA,EAAD,CACEN,OAAQplB,KAAKC,MAAMmlB,OACnBC,KAAMrlB,KAAKC,MAAMolB,KACjBM,OAAQ3lB,KAAKC,MAAM2lB,SACnBC,QAAS7lB,KAAKC,MAAM2lB,SACpBZ,QAAS,CACPO,MAAOvlB,KAAKC,MAAM0gB,WAEpBmF,kBAAgB,EAChBC,oBAAkB,GAElB,yBAAKpF,UAAU,kBACZ3gB,KAAKC,MAAMwlB,e,GAjDOpkB,IAAMC,gBAyDf0kB,SA7DA,SAAAvmB,GAAK,MAAK,CACvB+lB,QAAS/lB,EAAMwmB,OAAOT,WA4DTQ,CAAmBjB,I,+CCrE5BmB,GAAsB,GAE5BA,GAAoB9b,KAApB,MAAA8b,GAAmB,YAASpQ,OAAOC,KAAKrB,MACxCwR,GAAoB9b,KAApB,MAAA8b,GAAmB,YAASpQ,OAAOqQ,OAAOzR,IAAmBnR,KAAI,SAAA8D,GAAC,OAAIA,EAAE4E,UACxEia,GAAoB9b,KAAK,IAAK,IAAK,IAAK,KAAM,MAAO,OAGrD8b,GAAoB9b,KAClB,YAAa,QAAS,UAAW,UACjC,SACA,WAAY,OAAQ,SAAU,gBAC9B,QAAS,WAAY,KAAM,MAAO,QAAS,SAAU,OAAQ,UAC7D,KAAM,OACN,KAAM,MAAO,QACb,QAAS,MAAO,OAAQ,OAAQ,OAAQ,QACxC,YAAa,UAAW,SACxB,OAAQ,UAAW,QAAS,YAC5B,SACA,SAAU,YAAa,SACvB,MAAO,QAAS,QAAS,OAAQ,UAAW,WAC5C,OAAQ,SACR,OAAQ,SAAU,WAAY,WAAY,SAAU,SACpD,SAAU,WAAY,YACtB,OAAQ,QAAS,SAAU,OAAQ,QAAS,WAAY,SACxD,QAAS,SACT,SACA,SAAU,OACV,YAAa,SAIf8b,GAAoB9b,KAClB,UAAW,UACX,MAAO,MAAO,MACd,OAAQ,OAAQ,OAChB,OAAQ,OAAQ,OAChB,QAAS,QAAS,QAClB,MAAO,MAAO,MAAO,OAAQ,OAC7B,OAAQ,cACR,MAAO,OAAQ,QAAS,QAAS,QACjC,OAAQ,QACR,MAAO,OAAQ,MAAO,MACtB,QAAS,MAAO,OAAQ,aACxB,QAAS,QACT,SAAU,WAAY,MACtB,QAAS,YAAa,aACtB,cACA,UAAW,UACX,YAAa,UACb,QAAS,MAAO,MAAO,MACvB,WAGF,I,MACegc,GADM,IAAI/Q,IAAI6Q,I,UC7CvBG,GAAYD,GA4DHE,G,YAzDX,WAAYrmB,GAAQ,IAAD,8BACf,4CAAMA,KACD4f,MAAQ,CACTzf,MAAO,GACPmmB,aAAc,IAJH,E,sEAQVnmB,GACLJ,KAAKugB,SAAS,CAACngB,MAAOA,EAAOmmB,aAAc,O,qCAGhCxmB,GACW,KAAlBA,EAAMymB,SACNxmB,KAAKymB,gB,oCAKT,IAAMxa,EAAOjM,KAAK6f,MAAMzf,MAAMsmB,cACjB,KAATza,EACAjM,KAAKugB,SAAS,CAACgG,aAAc,qBACK,OAA3Bta,EAAK0a,MAAM,YAClB3mB,KAAKugB,SAAS,CAACgG,aAAc,iBACtBF,GAAUxQ,IAAI5J,GACrBjM,KAAKugB,SAAS,CAACgG,aAAc,wBAE7BvmB,KAAK4mB,SAAS,IACd5mB,KAAKC,MAAMY,QAAQoL,M,+BAIjB,IAAD,OACL,OACI,kBAAC4a,GAAA,EAAD,CAAUlG,UAAS,yBAAoBmG,aAApB,+GAIf,kBAAChmB,EAAA,EAAD,CACIC,YAAY,OACZb,SAAU,SAAAH,GAAK,OAAI,EAAK6mB,SAAS7mB,EAAMI,OAAOC,QAC9C2mB,UAAW,SAAChnB,GAAD,OAAW,EAAKinB,eAAejnB,IAC1CS,MAAmC,KAA5BR,KAAK6f,MAAM0G,aAClBU,WAAYjnB,KAAK6f,MAAM0G,aACvBnmB,MAAOJ,KAAK6f,MAAMzf,MAClBugB,UAAWmG,aAAF,4FAIb,kBAAC1lB,EAAA,EAAD,CACIP,QAAS,kBAAM,EAAK4lB,gBADxB,Y,GAlDYplB,IAAMC,e,mHCAlC,I,YAIe4lB,GAJC,CACZC,OATJ,SAAsBC,GAClB,IAAMC,EAASzQ,OAAOwQ,GAEtB,IAAKxQ,OAAO9K,MAAMub,GACd,OAAOA,GAMXC,MAdJ,SAAqBF,GACjB,OAAOA,EAAKV,gBCmHDa,I,mBA5GX,aAAe,IAAD,8BACV,+CACK1H,MAAQ,CACT2H,SAAS,EACTJ,KAAM,IAEV,EAAKK,QAAUpmB,IAAMqmB,YANX,E,yEAWV,OAAI1nB,KAAKC,MAAM4U,UAAU8S,GACdA,GAAgB3nB,KAAKC,MAAM4U,QAE3B7U,KAAKC,MAAM4U,S,oCAKtB,OAAO7U,KAAK4nB,WAAL5nB,CAAiBA,KAAK6f,MAAMuH,Q,8BAInC,YAA8B3oB,IAAvBuB,KAAK6nB,gB,8BAKK7nB,KAAKC,MAAMG,MAAM0W,aACjB9W,KAAK6f,MAAMuH,MACxBpnB,KAAKugB,SAAS,CAAC6G,KAAMpnB,KAAKC,MAAMG,MAAM0W,e,0CAMzB,IAAD,OAEhBgR,SAASxG,iBAAiB,WAAW,SAAAla,GACnB,UAAVA,EAAE6T,KAAmB,EAAK4E,MAAM2H,SAChC,EAAKC,QAAQM,QAAQC,Y,kCAKrB5gB,GACRpH,KAAKugB,SAAS,CAACiH,SAAS,IACxBxnB,KAAKioB,U,mCAGI7gB,GACTpH,KAAKugB,SAAS,CAAC6G,KAAMhgB,EAAEjH,OAAOC,MAAM0W,e,iCAG7B1P,GACPpH,KAAKugB,SAAS,CAACiH,SAAS,IAEpBxnB,KAAKkoB,SACLloB,KAAKC,MAAMC,SAASF,KAAK6nB,iB,2CAIN7nB,KAAK6f,MAAM2H,SAAUxnB,KAAKioB,U,+BAGjD,IAAMjD,EAAU,CAAC,iBAAkBhlB,KAAKC,MAAMgM,MAE1CjM,KAAK6f,MAAM2H,UACXxC,EAAQ5a,KAAK,SACRpK,KAAKkoB,SACNlD,EAAQ5a,KAAK,YAIrB,IAAM+d,EAAcnD,EAAQlmB,KAAK,KAEjB,OADAkB,KAAKynB,QAAQM,SAEzB/nB,KAAKynB,QAAQM,QAAQK,aAAa,QAASD,GAG/C,IAAME,EAAcroB,KAAK6f,MAAM2H,QAAUxnB,KAAK6f,MAAMuH,KAAOpnB,KAAKC,MAAMG,MAAM0W,WAE5E,OAAI9W,KAAKC,MAAMI,SAEP,0BAAMsgB,UAAWwH,GACZE,GAKL,kBAAC,KAAD,CACIC,KAAMD,EAENE,QAASvoB,KAAKwoB,YAAYhH,KAAKxhB,MAC/BE,SAAUF,KAAKyoB,aAAajH,KAAKxhB,MACjC0oB,OAAQ1oB,KAAK2oB,WAAWnH,KAAKxhB,MAE7B2gB,UAAWwH,EAEXS,QAAQ,OAERC,SAAU7oB,KAAKynB,c,GAtGPnmB,kBCStBwnB,I,OAAS,CACX,GACA,GACA,EACA,EACA,EACA,IAGJ,SAASC,GAAT,GAAoE,IAA5CC,EAA2C,EAA3CA,KAAMC,EAAqC,EAArCA,MAAOC,EAA8B,EAA9BA,aAAcC,EAAgB,EAAhBA,cACzCC,EAAW,CACb,GAAI,SACJ,OAAU,OACV,KAAQ,IAONC,EALQ,CACV,GAAIC,KACJ,OAAUC,KACV,KAAQC,MAEOR,GAEnB,OAAO,yBAAKrI,UAAWmG,aAAF,0LAOjB,kBAACuC,EAAD,CAAM1I,UAAWmG,aAAF,6FACO,KAATkC,EAAc,qBAAuB,sBAGlDnoB,QAAS,WAELqoB,EADgBE,EAASJ,OAG7B,0BACInoB,QAAS,WACLsoB,GAAeF,EAAQ,GAAKH,GAAOlb,SAEvC+S,UAAWmG,aAAF,4OAQRgC,GAAOG,GAAO1Q,QAAQ,GAZ3B,S,gBAuMOkR,G,2MApLX5J,MAAQ,CACJ3C,IAAK,EACLC,IAAK,EACLuM,cAAe,GACfC,eAAgB,EAChBC,0BAA2B,EAC3BC,UAAU,G,EAEdC,SAAU,E,sEAGH5M,GAAM,IAAD,EACkBld,KAAKC,MAAxBG,EADC,EACDA,MAAOF,EADN,EACMA,SACdF,KAAKugB,SAAS,CAACrD,QACX9c,EAAQ8c,GAAMhd,EAASgd,K,6BAGxBC,GAAM,IAAD,EACkBnd,KAAKC,MAAxBG,EADC,EACDA,MAAOF,EADN,EACMA,SACdF,KAAKugB,SAAS,CAACpD,QACX/c,EAAQ+c,GAAMjd,EAASid,K,+BAGtB/c,GACLJ,KAAK+pB,oBACL/pB,KAAKC,MAAMC,SAASE,K,0CAKH,IAAD,EACU,CAACJ,KAAK6f,MAAM3C,IAAKld,KAAK6f,MAAM1C,IAAKnd,KAAKC,MAAMG,OAA1D+c,EADI,KACC/c,EADD,UAENA,GAAQJ,KAAKugB,SAAS,CAACrD,IAAK9c,IAClC+c,EAAM/c,GAAQJ,KAAKugB,SAAS,CAACpD,IAAK/c,M,uCAGzB4pB,GAAY,IAAD,EACEhqB,KAAKC,MAAxBC,EADiB,EACjBA,SAAUE,EADO,EACPA,MADO,EAKpBJ,KAAK6f,MAFL3C,EAHoB,EAGpBA,IAAKC,EAHe,EAGfA,IACLuM,EAJoB,EAIpBA,cAAeE,EAJK,EAILA,0BAA2BD,EAJtB,EAIsBA,eAG9C,IAAI3pB,KAAK8pB,QAAT,CAEA,IAAIG,EAAK,OACSxrB,IAAdurB,QAAsDvrB,IAA3BuB,KAAKkqB,oBAChCD,EAAKD,EAAYhqB,KAAKkqB,mBAE1BlqB,KAAKkqB,kBAAoBF,EAEzB,IACIG,EAAW/pB,GADA+c,EAAMD,GAAO4L,GAAOa,GAAkBC,EAA4BK,EAAG,IAG9D,WAAlBP,IACIS,EAAWhN,IACXgN,EAAWhN,EACXnd,KAAKugB,SAAS,CAACqJ,2BAA4B,KAE3CO,EAAWjN,IACXiN,EAAWjN,EACXld,KAAKugB,SAAS,CAACqJ,0BAA2B,MAI5B,SAAlBF,GACIS,EAAWhN,IAAMgN,EAAWjN,GAGpChd,EAASqE,KAAK6B,MAAM,IAAM+jB,GAAU,KAEd,KAAlBT,GACA1pB,KAAKoqB,UACPC,sBAAsBrqB,KAAKsqB,iBAAiB9I,KAAKxhB,U,0CAKnDA,KAAK+pB,oBACL/pB,KAAKoqB,UAAW,I,6CAIhBpqB,KAAKoqB,UAAW,EAChBpqB,KAAKC,MAAMsqB,aAAY,K,qCAIvBvqB,KAAKugB,SAAS,CAACsJ,UAAU,IACzB7pB,KAAKC,MAAMsqB,YAAyC,KAA7BvqB,KAAK6f,MAAM6J,iB,+BAG5B,IAAD,SACuD1pB,KAAK6f,MAA1D3C,EADF,EACEA,IAAKC,EADP,EACOA,IAAKuM,EADZ,EACYA,cAAeC,EAD3B,EAC2BA,eAD3B,EAC2CE,SAChD,OACI,yBAAKlJ,UAAS,yBAAoBmG,aAApB,mVAUV1C,UAAWpkB,KAAKwqB,aAAahJ,KAAKxhB,MAClC2kB,WAAY3kB,KAAKwqB,aAAahJ,KAAKxhB,OAEnC,kBAAC+oB,GAAD,CACIC,KAAMU,EACNT,MAAOU,EACPT,aACI,SAACF,GACG,EAAKnJ,MAAM6J,cAAgBV,EAC3B,EAAKzI,SAAS,CAACmJ,cAAeV,EAAMY,0BAA2B,IAC/D,EAAKU,mBACL,EAAKrqB,MAAMsqB,YAAqB,KAATvB,IAG/BG,cACI,SAACF,GACG,EAAK1I,SAAS,CAACoJ,eAAgBV,OAI3C,yBAAKtI,UAAU,UACX,yBAAKA,UAAU,YACX,kBAAC,GAAD,CACI1U,KAAM,QAAqC,IAA3BjM,KAAKC,MAAMgM,KAAK2B,OAAe,UAAY,IAC3DxN,MAAOJ,KAAKC,MAAMgM,KAClB4I,OAAO,QACP3U,SAAUF,KAAKC,MAAMwqB,aACrBpqB,UAAQ,IAEZ,mCACA,kBAAC,GAAD,CACI4L,KAAK,QACL7L,MAAOJ,KAAKC,MAAMG,MAClByU,OAAO,SACP3U,SAAUF,KAAK4mB,SAASpF,KAAKxhB,SAGrC,yBAAK2gB,UAAU,YACX,kBAAC,GAAD,CACI1U,KAAK,cACL7L,MAAO8c,EACPrI,OAAO,SACP3U,SAAUF,KAAK0qB,OAAOlJ,KAAKxhB,QAE/B,kBAAC,KAAD,CACI2gB,UAAU,cACVzD,IAAKA,EACLC,IAAKA,EACL/c,MAAOJ,KAAKC,MAAMG,MAClBgI,MAAO+U,EAAMD,GAAK,IAClBhd,SAAU,SAACkH,EAAGsZ,GACL,EAAKb,MAAMgK,UAAW,EAAK5pB,MAAMsqB,aAAY,GAClD,EAAK1K,MAAMgK,UAAW,EACtB,EAAKjD,SAASlG,MAGtB,kBAAC,GAAD,CACIzU,KAAK,cACL7L,MAAO+c,EACPtI,OAAO,SACP3U,SAAUF,KAAK2qB,OAAOnJ,KAAKxhB,UAIvC,kBAACY,EAAA,EAAD,CAAYC,QAAS,WACjB,EAAKipB,SAAU,EACf,EAAK7pB,MAAM2qB,YACZjK,UAAU,eACT,kBAAC,KAAD,Y,GA9KCrf,iBC3DfupB,I,OAAkB,IAAIxV,IAAI,CAC9B,YAAa,WAAY,WAEzB,sBACA,kBACA,sBACA,cAEA,qBAyDayV,G,YArDb,WAAY7qB,GAAQ,IAAD,8BACjB,4CAAMA,KACD8qB,UAAY1pB,IAAMqmB,YACvB,EAAKmC,SAAW,GAHC,E,0EAMN5d,EAAM7L,GACjBJ,KAAKC,MAAM0L,UAAUM,GAAQ7L,EAC7BJ,KAAKC,MAAM+qB,SAAX,eAAsB/e,EAAO7L,IAC7BJ,KAAKirB,gB,wCAGWhf,EAAMyU,GAAI,IAAD,OACzB1gB,KAAK6pB,SAAS5d,GAAQyU,EACtB1gB,KAAKC,MAAMsqB,YAAYzU,OAAOC,KAAK/V,KAAKC,MAAM0L,WAAWqB,MAAK,SAAC1O,GAAD,OAAO,EAAKurB,SAASvrB,S,yCAMnF,IAHkB,IAAD,OACVqN,EAAa3L,KAAKC,MAAlB0L,UACHuf,EAAa,GAFA,wBAGLjf,GAHK,uBAGC7L,EAHD,KAKf,GAAIyqB,GAAgBhV,IAAI5J,GAAQ,iBAGhCif,EAAW9gB,KAChB,kBAAC,GAAD,CACE6Q,IAAKhP,EACLA,KAAMA,EACN7L,MAAOA,EACPF,SAAU,SAACE,GAAD,OAAW,EAAKqoB,aAAaxc,EAAM7L,IAC7CwqB,SAAU,kBAAM,EAAK3qB,MAAMkrB,SAASlf,IAC3Bse,YAAa,SAAC7J,GAAD,OAAO,EAAK0K,kBAAkBnf,EAAMyU,QAZzD,MAA4B5K,OAAOsJ,QAAQzT,GAA3C,eAAwD,KAAD,MAiBvD,OAAOuf,I,+BAGC,IAAD,OACP,OAAQ,kBAACG,GAAA,EAAD,CAAM1K,UAAU,eAC3B,kBAAC2K,GAAA,EAAD,CAAeC,eAAa,GAA5B,aACCvrB,KAAKwrB,mBACN,kBAAC,GAAD,CACE3qB,QAAS,SAAAoL,GAAI,OAAI,EAAKhM,MAAMwrB,MAAMxf,EAAM,Y,GA9CjB5K,IAAMqqB,W,oBCd1BC,G,iLACM,IAAD,EAC2B3rB,KAAKC,MAAhCY,EADA,EACAA,QAAS+qB,EADT,EACSA,QAASxO,EADlB,EACkBA,MACzB,OACE,kBAACyJ,GAAA,EAAD,CACLgF,QAAM,EACNhrB,QAASA,GAET,kBAACirB,GAAA,EAAD,CACEF,QAASA,IAEX,kBAACG,GAAA,EAAD,KAAe3O,Q,GAXY/b,IAAMC,eA2CnB0qB,G,wLAvBX,IAFe,IAAD,OACRC,EAAU,GADF,wBAEFC,GAFE,uBAEQ9O,EAFR,KAGZ6O,EAAQ7hB,KACb,kBAAC,GAAD,CACE6Q,IAAKiR,EACLrrB,QAAS,kBAAM,EAAKZ,MAAM2lB,SAASsG,IACnCN,QAAS,EAAK3rB,MAAM0L,UAAUugB,GAAY,GAC1C9O,MAAOA,MANN,MAAgCtH,OAAOsJ,QAAQpf,KAAKC,MAAMgsB,SAA1D,eAAoE,CAAC,IAAD,MAUpE,OAAOA,I,+BAIP,OACE,kBAACZ,GAAA,EAAD,CAAMhtB,GAAG,iBACd,kBAACitB,GAAA,EAAD,CAAeC,eAAa,GAAEvrB,KAAKC,MAAMksB,SACxCnsB,KAAKosB,qB,GApBoB/qB,IAAMC,eCnB3B+qB,GAAS,2CAEA,eAAoB,IAAlB/tB,EAAiB,EAAjBA,EAAGme,EAAc,EAAdA,EAAG6P,EAAW,EAAXA,MACfC,EAAW,yBAAK5L,UAAWmG,aAAF,0HAAd,+CAkCf,OA1BIlG,SAAStiB,IAAMsiB,SAASnE,KAEpB8P,EADA/sB,OAAOwB,WAAa,IACT,yBAAK2f,UAAWmG,aAAF,iPAUrB,kBAAC,cAAD,KAAauF,IACb,kBAAC,cAAD,KAAa1N,GAAcrgB,EAAGme,EAAG,KAG1B,yBAAKkE,UAAWmG,aAAF,4IAKrB,kBAAC,aAAD,KAAYuF,GAAS1N,GAAcrgB,EAAGme,EAAG,MAK9C,yBAAKkE,UAAWmG,aAAF,wOAOlBwF,MAAOA,GAAS,IACf,yBAAK3L,UAAU,QAAQ4L,KCrBhBC,G,WA9BX,WAAYhM,EAAS8C,EAAQ7K,GAAM,oBAC/BzY,KAAKwgB,QAAUA,EACfxgB,KAAKsjB,OAASA,EACdtjB,KAAKyY,IAAMA,EAEXzY,KAAKysB,a,yDAILzsB,KAAKsjB,OAAOlF,YAAc,QAC1Bpe,KAAKsjB,OAAOxG,UAAY,EAAI9c,KAAKyY,M,6BAG9BzZ,GAAO,IACHV,EAA0BU,EAA1BV,EAAGme,EAAuBzd,EAAvByd,EAAGiQ,EAAoB1tB,EAApB0tB,QAASC,EAAW3tB,EAAX2tB,QACtB3sB,KAAK4sB,UAAUtuB,EAAGme,GAClBzc,KAAK6sB,KAAKH,EAASC,K,kEAKbruB,EAAGme,M,2BAERne,EAAGme,M,8BAGJ,MAAO,CAAC,EAAG,O,6hCC1BnB,IAAMqQ,GAAqB,CACvB,CAAC,kBAAqB,mBACtB,CAAC,kBAAqB,mBACtB,CAAC,kBAAqB,mBACtB,CAAC,kBAAqB,mBACtB,CAAC,kBAAqB,kBACtB,CAAC,kBAAqB,mBACtB,CAAC,kBAAqB,mBACtB,CAAC,kBAAqB,mBAEtB,CAAC,mBAAqB,mBACtB,CAAC,mBAAqB,mBACtB,CAAC,mBAAqB,mBACtB,CAAC,mBAAqB,mBACtB,CAAC,mBAAqB,kBACtB,CAAC,mBAAqB,mBACtB,CAAC,mBAAqB,mBACtB,CAAC,mBAAqB,oBAM1B,SAASC,GAAcC,EAAOC,EAAKzM,GAE/B,IAFwC,EAElC1C,EAAKmP,EAAMD,EAMX1nB,EAAS,CAAC,EAAG,GARqB,KASTwnB,IATS,IASxC,2BAAmD,CAAC,IAAD,6BAAzCI,EAAyC,KAAjCC,EAAiC,OAN/B3M,EAChBwM,EAAQ,GAAMlP,GAAM,EAMEqP,IADyB,mBACxC1M,EADwC,KACrCC,EADqC,KAE/Cpb,EAAO,IAAMmb,EAAI3C,EAAKoP,EAAS,EAC/B5nB,EAAO,IAAMob,EAAI5C,EAAKoP,EAAS,GAZK,8BAcxC,OAAO5nB,E,ICCI8nB,G,2MA/BXC,YAAc,CAAC,EAAG,G,EAElBC,UAAY,K,EACZC,cAAgB,K,yEAENjvB,EAAGme,GACT,IAAKrQ,gBAAMpM,KAAKstB,WAAY,CAExB,IAAME,ED8BlB,SAA0BR,EAAOC,EAAKzM,GAAU,IAAD,cAC1BwM,EAD0B,GACpChR,EADoC,KAChCE,EADgC,mBAE1B+Q,EAF0B,GAEpC7K,EAFoC,KAEhCC,EAFgC,KAKrCvE,EAAKsE,EAAKpG,EACViB,EAAKoF,EAAKnG,EAN2B,EAc5B6Q,GAAc,EAAG,GAJjB,SAAAU,GAAC,OAAIjN,EAAQ,CACxBxE,EAAKyR,EAAI3P,EACT5B,EAAKuR,EAAIxQ,OAZ8B,mBAcpCwD,EAdoC,KAcjCC,EAdiC,KAgB3C,MAAO,CACHD,EAAI3C,EAAK4C,EAAIzD,EACbyD,EAAI5C,EAAK2C,EAAIxD,GChDEyQ,CAAiB1tB,KAAKstB,UAAW,CAAChvB,EAAGme,GAAIzc,KAAKwgB,SACzDxgB,KAAKqtB,YAAY,IAAMG,EAAG,GAC1BxtB,KAAKqtB,YAAY,IAAMG,EAAG,GAE9BxtB,KAAKstB,UAAY,CAAChvB,EAAGme,K,2BAGpBne,EAAGme,GACJ,IAAKrQ,gBAAMpM,KAAKutB,eAAgB,CAAC,IAAD,cACLvtB,KAAKutB,cADA,GACrBvN,EADqB,KACdC,EADc,KAE5BjgB,KAAKsjB,OAAOjF,YACZre,KAAKsjB,OAAO3G,OAAOqD,EAAOC,GAC1BjgB,KAAKsjB,OAAO1G,OAAOte,EAAGme,GACtBzc,KAAKsjB,OAAO/E,SAEhBve,KAAKutB,cAAgB,CAACjvB,EAAGme,K,8BAIzB,OAAOzc,KAAKqtB,gB,GA5Bab,I,kiCCAjC,SAASmB,GAASC,GACd,IADoB,EAChBhsB,EAAM,EACNqF,EAAI,EAFY,KAIF2mB,GAJE,IAIpB,2BAAwB,CAAC,IACfnR,EADc,QACFxV,EACZwmB,EAAI7rB,EAAM6a,EAChBxV,EAAKwmB,EAAI7rB,EAAO6a,EAChB7a,EAAM6rB,GARU,8BAWpB,OAAO7rB,E,ICLLisB,GAAgB,CAClB,SAAYC,GACZ,kB,2MCVAC,WAAa,K,EACbC,eAAiB,K,yEAEP1vB,EAAGme,GACT,kEAAgBne,EAAGme,GACfrQ,gBAAMpM,KAAK+tB,cACX/tB,KAAK+tB,WAAa,CAACzvB,EAAGme,M,2BAIzBne,EAAGme,GACJ,6DAAWne,EAAGme,GACVrQ,gBAAMpM,KAAKguB,kBACXhuB,KAAKguB,eAAiB,CAAC1vB,EAAGme,M,+BAK9B,IAAIrQ,gBAAMpM,KAAK+tB,cAAe3hB,gBAAMpM,KAAKguB,gBAAzC,CADK,kBAIUhuB,KAAK+tB,WAJf,GAIEzvB,EAJF,KAIKme,EAJL,mBAKsBzc,KAAKguB,eAL3B,GAKEtB,EALF,KAKWC,EALX,KAML3sB,KAAKqjB,OAAO,CACR/kB,IAAGme,IACHiQ,UAASC,iB,GA1BQsB,IDYzB,O,2MDOAC,OAAS,K,EACTC,OAAS,K,EAETC,WAAa,K,EACbC,WAAa,K,yEAEH/vB,EAAGme,GACLrQ,gBAAMpM,KAAKkuB,UAAUluB,KAAKkuB,OAAS,CAAC5vB,EAAGme,IAC3Czc,KAAKmuB,OAAS5pB,KAAK0S,MAAM3Y,EAAI0B,KAAKkuB,OAAO,GAAIzR,EAAIzc,KAAKkuB,OAAO,M,2BAG5D5vB,EAAGme,GAAI,IAAD,EACHrQ,gBAAMpM,KAAKouB,cAAcpuB,KAAKouB,WAAa,CAAC9vB,EAAGme,IACnDzc,KAAKquB,WAAa9pB,KAAK0S,MAAM3Y,EAAI0B,KAAKouB,WAAW,GAAI3R,EAAIzc,KAAKouB,WAAW,IAEzEpuB,KAAKsjB,OAAO7H,UAAU,EAAG,EAAGzb,KAAKsjB,OAAOA,OAAOlL,MAAOpY,KAAKsjB,OAAOA,OAAOjL,QACzErY,KAAKsjB,OAAOjF,aACZ,EAAAre,KAAKsjB,QAAOgL,IAAZ,oBAAmBtuB,KAAKouB,YAAxB,QAAoCpuB,KAAKquB,WAAY,EAAG,EAAI9pB,KAAKC,MACjExE,KAAKsjB,OAAO/E,W,8BAGP,IAAD,OAEJ,GAAInS,gBAAMpM,KAAKkuB,QAAU,MAAO,CAAC,EAAG,GAsBpC,IAxBI,kBAGWluB,KAAKkuB,OAHhB,GAGG5vB,EAHH,KAGMme,EAHN,KAcE8R,EAAY,SAAAlqB,GAAU,IAAD,EACR,EAAKmc,QATV,SAAAnc,GAAK,MAAI,CACnB/F,EAAI,EAAK6vB,OAAS5pB,KAAK0F,IAAI5F,GAC3BoY,EAAI,EAAK0R,OAAS5pB,KAAKjC,IAAI+B,IAOCpB,CAAMoB,IADX,mBAChBoc,EADgB,KACbC,EADa,OAJR,SAAArc,GAAK,MAAI,EACvB,EAAK8pB,OAAS5pB,KAAKjC,IAAI+B,GACxB,EAAK8pB,OAAS5pB,KAAK0F,IAAI5F,IAINmqB,CAAWnqB,GAFL,mBAEhBoqB,EAFgB,KAEZC,EAFY,KAGvB,MAAO,CAACjO,EAAIgO,EAAK/N,EAAIgO,EAAIjO,EAAIiO,EAAKhO,EAAI+N,IAKpCE,EAAc,EAAIpqB,KAAKC,GADnB,GAEJoqB,EAAW,CAAC,GAAI,IACbzjB,EAAE,EAAGA,EAHJ,GAGWA,IAAK,CAAC,IAAD,EACP4hB,GACX5hB,EAAIwjB,GAAcxjB,EAAI,GAAKwjB,EAAaJ,GAFtB,mBACf9N,EADe,KACZC,EADY,KAItBkO,EAAS,GAAGxkB,KAAKqW,GACjBmO,EAAS,GAAGxkB,KAAKsW,GAGrB,MAAO,CAACiN,GAASiB,EAAS,IAAKjB,GAASiB,EAAS,S,GAtDpCpC,KCqLNqC,G,YA/KX,WAAY5uB,GAAQ,IAAD,8BACf,4CAAMA,KATV4f,MAAQ,CACJiP,MAAM,EAEN3N,WAAW,EACX4N,cAAe,KACfC,SAAU,MAOV,EAAK1L,OAASjiB,IAAMqmB,YAJL,E,4EAQf,IAAMpE,EAAStjB,KAAKsjB,OAAOyE,QACrBtP,EAAMjZ,OAAOkZ,iBACnB4K,EAAOlL,MAAQkL,EAAOI,YAAcjL,EACpC6K,EAAOjL,OAASiL,EAAOK,aAAelL,I,mCAMvBzY,KAAK6f,MAAbiP,MAEH9uB,KAAKugB,SAAS,CACVuO,MAAM,EACNC,cAAe,KACfC,SAAU,S,sCAKN5nB,GAAI,IAAD,EACsCpH,KAAKC,MAAnDgvB,EADQ,EACRA,WAAYra,EADJ,EACIA,WAAYjJ,EADhB,EACgBA,UAAWka,EAD3B,EAC2BA,QAG1C,GAFe7lB,KAAK6f,MAAbiP,KAIHjJ,QACG,CAEH,IAAMrF,EAAU/U,GAAKmJ,EAAYjJ,GAGjC3L,KAAKkvB,eACL,IAAMC,EAAUnvB,KAAKsjB,OAAOyE,QAAQtE,WAAW,MAC/C0L,EAAQ1T,UAAU,EAAG,EAAG0T,EAAQ7L,OAAOlL,MAAO+W,EAAQ7L,OAAOjL,QAG7DrY,KAAKugB,SAAS,CACVY,WAAW,EACX6N,SAAU,IAAInB,GAAcoB,GACxBzO,EAAS2O,EAAS3vB,OAAOkZ,uB,sCAMzBtR,GAAI,IAAD,EACepH,KAAK6f,MAA5BmP,EADQ,EACRA,SAAU7N,EADF,EACEA,UACVxV,EAAa3L,KAAKC,MAAlB0L,UAEP,GAAKwV,EAAL,CAJe,IAMRuL,EAAoBtlB,EAApBslB,QAASC,EAAWvlB,EAAXulB,QAND,EAOA7L,GAAY4L,EAASC,EAAShhB,GAP9B,mBAORrN,EAPQ,KAOLme,EAPK,KAWf,GAFAzc,KAAKugB,SAAS,CAACwO,cAAe,CAACrC,EAASC,MAEnCvgB,gBAAM4iB,GAAW,CAClB,IAAMvW,EAAMjZ,OAAOkZ,iBACnBsW,EAAS3L,OAAO,CACZ/kB,IAAGme,IACHiQ,QAASA,EAAUjU,EACnBkU,QAASA,EAAUlU,Q,oCAKjBrR,GACSpH,KAAK6f,MAAjBmP,SAGEI,SAGTpvB,KAAKugB,SAAS,CAACY,WAAW,EAAO2N,MAAM,M,+BAGjC,IAAD,OACEG,EAAcjvB,KAAKC,MAAnBgvB,WADF,EAE8CjvB,KAAK6f,MAAjDiP,EAFF,EAEEA,KAAM3N,EAFR,EAEQA,UAAW4N,EAFnB,EAEmBA,cAAeC,EAFlC,EAEkCA,SAEvC,GAAI5iB,gBAAM6iB,GAEN,OADAjvB,KAAKqvB,aACE,KAGX,IAAIC,EAAU,KACd,IAAMljB,gBAAM4iB,KAAa5iB,gBAAM2iB,GAAiB,CAAC,IAAD,EAC7BC,EAAS5uB,QADoB,mBACrC9B,EADqC,KAClCme,EADkC,KAGtC8S,EAAO,SAAAjxB,GAAC,OAAKiG,KAAKH,IAAI9F,GAAK,MAAQ,EAAIA,GAE7CgxB,EAAU,kBAACE,GAAD,CACNlxB,EAAGixB,EAAKjxB,GAAIme,EAAG8S,EAAK9S,GACpB6P,MAAO,CACHpL,SAAU,WACVuO,IAAKV,EAAc,GACnBW,KAAMX,EAAc,IAAMvvB,OAAOwB,WAAa,IAAM,GAAK,GACzD2uB,OAAQ,KAMpB,OAAO,yBAAKhP,UAAU,qBAClBuD,YAAalkB,KAAKkjB,gBAAgB1B,KAAKxhB,MACvCmkB,YAAankB,KAAKmjB,gBAAgB3B,KAAKxhB,MACvCokB,UAAWpkB,KAAKojB,cAAc5B,KAAKxhB,MAEnCukB,aAAcvkB,KAAKkjB,gBAAgB1B,KAAKxhB,MACxCykB,YAAa,SAAArd,GAAC,OAAI,EAAK+b,gBAAgB/b,EAAE6a,QAAQ,KACjD0C,WAAY3kB,KAAKojB,cAAc5B,KAAKxhB,OAEpC,4BACIikB,IAAKjkB,KAAKsjB,OACV3C,UAAU,WAEb2O,EACD,uBAAG3O,UAAU,gBAAb,oCAGA,uTAUkBmO,EAAO,UAAY,YAVrC,k0BAuCmB3N,GAAa2N,EAAO,OAAS,QAvChD,6E,GAzIqBxtB,iB,yEEN3BsuB,GAAc,CAChB,CACIZ,SAAU,WACV5R,MAAO,WACPyS,KAAM,kBAAC,KAAD,OAEV,CACIb,SAAU,kBACV5R,MAAO,yBACPyS,KAAM,kBAAC,KAAD,OAEV,CACIb,SAAU,SACV5R,MAAO,mBACPyS,KAAM,kBAAC,KAAD,QAmCCC,G,yLA9BMC,GAAQ,IACdf,EAAyBe,EAAzBf,SAAU5R,EAAe2S,EAAf3S,MAAOyS,EAAQE,EAARF,KADJ,EAEiB7vB,KAAKC,MAAnC+vB,EAFa,EAEbA,WAAYC,EAFC,EAEDA,eAcnB,OAAO,kBAACpJ,GAAA,EAAD,CAAUgF,QAAM,EAAC5Q,IAAK+T,EAAUnuB,QAZvB,WAERrB,OAAOwB,WAAa,KAAMgvB,IAG9BC,EAAe,MAIf3P,YAAW,kBAAM2P,EAAejB,KAAW,KAI3C,kBAACkB,GAAA,EAAD,KAAeL,GACf,kBAAC9D,GAAA,EAAD,CAAcO,MAAO,CAAC6D,YAAa,IAAK/S,M,+BAK5C,OAAO,kBAACiO,GAAA,EAAD,KACH,kBAACC,GAAA,EAAD,CAAeC,eAAa,GAA5B,qBACCqE,GAAYrsB,IAAIvD,KAAKowB,iBAAiB5O,KAAKxhB,Y,GA1B5BsB,iB,yCClBb,I,mCAAA,gBAAElB,EAAF,EAAEA,MAAOF,EAAT,EAASA,SAAT,EAAmBqmB,aAAnB,OAAqC,yBAAKloB,GAAG,mBACxD,kBAACgyB,GAAA,EAAD,CAAY/K,QAAQ,WAApB,mGAEE,6BAFF,qEAKA,kBAAC,KAAD,CACIllB,MAAOA,EACPkwB,cAAepwB,EACfqwB,UAAW,SAAAvgB,GAAS,IAAIxM,EAAI+sB,qBAAUvgB,EAAMwgB,aAAUC,MAAuB,OAAhBtjB,QAAQzK,IAAIc,GAAWA,GACpFktB,QAAS,GACTpE,MAAO,CACLqE,WAAY,sCACZC,SAAU,GACVC,gBAAiB,qBACjBC,MAAO,QACPC,UAAW,GACXC,aAAc,KAGpB,kBAACX,GAAA,EAAD,CAAY/K,QAAQ,WAChB,6BADJ,yE,0nCCbJ2L,KAAkBC,iBAAiB,OAAQC,MAG3C,IASMC,GAAqB,CACvB,CACInlB,KAAM,YACNmT,QAAS,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,MAEvC,CACInT,KAAM,eACNmT,QAAS,CACL,MAAO,MAAO,MAAO,MAAO,MAAO,MACnC,SAAU,SAAU,SAAU,SAAU,SAAU,SAClD,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxC,SAAU,SAAU,SAAU,SAAU,SAAU,WAG1D,CACInT,KAAM,cACNmT,QAAS,CAAC,MAAO,MAAO,OAE5B,CACInT,KAAM,YACNmT,QAAS,CAAC,IAAK,KAAM,MAAO,QAEhC,CACInT,KAAM,mBACNmT,QAAS,CACL,WACA,WACA,WACA,gBACA,iBACA,KAAM,KACN,qBACA,qBACA,qBACA,qBACA,cAGR,CACInT,KAAM,oBACNmT,QAAS,CACL,OACA,QAAS,MAAO,OAChB,QAGR,CACInT,KAAM,gBACNmT,QAAS,CACL,MAAO,MAAO,MAAO,MACrB,OACA,OAAQ,OACR,QAAS,OAAQ,QAAS,SAGlC,CACInT,KAAM,yBACNmT,QAAS,CACL,MAAO,UAAW,gBAMxBiS,GAAW,CACb,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,MACL,IAAK,gBACL,IAAK,KAEL,EAAK,KACL,GAAM,KACN,IAAO,KACP,IAAO,KAEP,WAAY,eACZ,WAAY,eACZ,WAAY,eACZ,gBAAY,eACZ,iBAAa,gBACb,qBAAiB,oBACjB,qBAAiB,oBACjB,qBAAiB,oBACjB,qBAAiB,oBACjB,YAAQ,OAER,IAAO,uBACP,QAAW,uBACX,WAAc,qBAIZC,G,YACF,WAAYrxB,GAAQ,IAAD,8BACf,4CAAMA,KACD+kB,QAAU/kB,EAAM+kB,QAFN,E,qFAMf,OAAO,I,kCAGC5F,GAAU,IAAD,SACkBpf,KAAKC,MAAjCsxB,EADU,EACVA,cAAeC,EADL,EACKA,UAItB,OAAOpS,EAAQ7b,KAAI,SAAA6Z,GAAK,OACpB,kBAACqU,GAAA,EAAD,CACIxW,IAAKmC,EACLA,MAAOA,EACPvc,QAA6B,OAApBwwB,GAASjU,QAAkB3e,EAAY,WACxCe,OAAOwB,YAAc,KAAMwwB,IARvB,SAACpU,GAAUmU,EAC3BF,GAASjU,IAAT,UAAsBA,EAAtB,QAQQsU,CAAYtU,IAEhBuD,UAAW,EAAKqE,QAAQ2M,Y,iDAMhC,IADuB,EACjBC,EAAW,GADM,KAEDR,IAFC,IAEvB,2BAA0C,CAAC,IAAhCS,EAA+B,QACtCD,EAASxnB,KACL,yBAAK6Q,IAAK4W,EAAQ5lB,MACd,4BAAK4lB,EAAQ5lB,MACZjM,KAAK8xB,YAAYD,EAAQzS,YANf,8BAUvB,OAAOwS,I,+BAIP,OACI,yBAAKvzB,GAAG,aACJ,4BACI,yBAAK0zB,IAAI,6BAA6BpR,UAAU,OAAOqR,IAAI,SAC3D,yBAAKrR,UAAU,QAAf,2BAEI,yBAAKA,UAAU,YAAf,aACe,KADf,sBAMR,4CACA,8FACA,yMAEA,2SAGA,2JACkC,uBAAGsR,KAAK,iDAAR,0CAElC,wCACA,4PACA,mKACA,iGAEA,mDACA,uEACA,yBAAKtR,UAAU,eACV3gB,KAAKkyB,2BACN,uBAAG5F,MAAO,CAACyE,UAAW,MACtB,kBAACV,GAAA,EAAD,CAAY/K,QAAQ,WAApB,qEAGJ,yCACA,wFACA,2CACiB,kBAAC,IAAD,CAAUgH,MAAO,CAACsE,SAAU,GAAIuB,cAAe,KADhE,+FAEoC,0BAAMxR,UAAW3gB,KAAKglB,QAAQoN,aAA9B,OAFpC,gCAEsH,kBAAC,KAAD,CAAY9F,MAAO,CAACsE,SAAU,GAAIuB,cAAe,KAFvK,YAIA,iIAIA,mJAAwH,gCAAxH,sBAAmJ,gCAAnJ,KAEA,iDACA,+MAGA,yBAAKxR,UAAU,eACX,wCACA,kMAEA,sDACA,yKAEA,gDACA,oOAGJ,oPAIA,gDACA,4FAEA,yBAAKA,UAAU,eACX,mDACA,0KAEA,+CACA,kNAEA,mDACA,0NACA,2CACA,4HAGJ,oCACA,kJAEA,iDACA,kBAAC0R,GAAA,EAAD,CAAW/F,MAAO,CAACgG,OAAQ,WACvB,kBAACC,GAAA,EAAD,CAAkBC,WAAY,kBAAC,KAAD,OAC1B,kBAACnC,GAAA,EAAD,CAAY/K,QAAQ,WAApB,+DAIJ,kBAACmN,GAAA,EAAD,KACI,6BACI,gDACA,mMACA,uDAA4B,uBAAGR,KAAK,yDAAR,QAA5B,iIACA,4BACI,sEAA2C,oCAA3C,8EAAmI,mCAAnI,8BAA0K,mCAA1K,KACA,oEAAyC,uCAAzC,uCAA6F,oCAA7F,iCAAwI,oCAAxI,KACA,uDAA4B,mCAA5B,yBAA6D,0CAA7D,8GAA4K,oCAA5K,uHAA6S,mCAA7S,QAA8T,iCAA9T,eACA,mEAAwC,iCAAxC,QAAuD,iCAAvD,uBAAqF,oCAArF,wLAAuR,oCAAvR,KAAsS,oCAAtS,SAAyT,oCAAzT,yEACA,iFAAsD,iCAAtD,mDAAgH,oCAAhH,+EACA,2EAAgD,kCAAhD,iBAAyE,oCAAzE,iCAAoH,oCAApH,WAGJ,2CACA,mIACA,4BACI,4IACA,wNACA,4BAAI,wEAAJ,kGACI,kBAAC,KAAD,CAAmBS,SAAS,OAAOpG,MAAOqG,MAA1C,iDADJ,yCAKI,kBAAC,KAAD,CAAmBD,SAAS,OAAOpG,MAAOqG,MAA1C,+EALJ,qSAgBJ,oCACA,0LACA,oFAAyD,uCAAzD,qDAEA,2BAAG,sEAAH,4EAAqH,oCAArH,UAEA,kDACA,0LAKZ,yCACA,6JACA,4BAAI,gGAA2D,uBAAGV,KAAK,gDAAR,gDAA3D,MACJ,4FAEA,gDACA,4BACI,4DAA4B,uBAAGA,KAAK,iCAAR,yBAA5B,KACA,iIACA,sHACA,wHACA,oGACA,iHAGJ,kBAAC5B,GAAA,EAAD,CAAY/K,QAAQ,WAApB,kEAAoG,6BACpG,kBAAC+K,GAAA,EAAD,CAAY/K,QAAQ,WAAU,uBAAG2M,KAAK,qDAAR,mBAA9B,cAAoI,6BACpI,kBAAC5B,GAAA,EAAD,CAAY/K,QAAQ,WAApB,uBAA6C,uBAAG2M,KAAK,gCAAR,+B,GAtMtC5wB,IAAMqqB,WA4Md1F,SAnTA,SAAAvmB,GAAK,MAAK,CACrB2yB,YAAY,eACL3yB,EAAMmzB,WAAW/G,QAExB8F,KAAM,CACFW,OAAQ,MA8SDtM,CAAmBsL,I,whCChTlC,IAAMuB,GAAa,+H,IAySJC,G,2MAhRXjT,MAAQ,CACJkT,eAAgB,MAChBne,WAAY,CAAC,MAAO,CAAC,WAAY,KAAM,CAAC,WAAY,MACpDoe,iBAAiB,EACjBC,YAAa,KAEbhb,aAAc4a,GACdK,aAAa,EAEbC,UAAU,EACVC,UAAU,EACVC,kBAAkB,EAElBC,oBAAqB,KAErB3nB,UAAW,CACPiQ,UAAW,EACXK,SAAU,EACVE,SAAU,EAEVsR,EAAG,GAEH8F,oBAAqB,EACrBC,gBAAiB,EACjBC,oBAAqB,EACrB/X,YAAa,EAEbmI,gBAAiB,I,mFAIJ,IAAD,OAChBrkB,OAAO8hB,iBAAiB,aAActhB,KAAK0zB,iBAAiBlS,KAAKxhB,OAEjE8nB,SAASxG,iBACL,gBACA,SAACvhB,GAAD,OAAW,EAAK4zB,eAAe5zB,KAC/B,CAAC6zB,SAAS,IAEd9L,SAASxG,iBACL,aACA,SAACvhB,GAAD,OAAW,EAAK4zB,eAAe5zB,KAC/B,CAAC6zB,SAAS,IAGd5zB,KAAK0zB,qB,qCAGM3zB,GAEX,GAAgB,WADAA,EAAMI,OAAOyoB,QAAQlC,cAIjC,OAAO3mB,EAFPA,EAAM4zB,mB,yCAQV3zB,KAAKugB,SAAS,CAAC4S,UAAWnzB,KAAK6f,MAAMsT,a,yCAIrCnzB,KAAKugB,SAAS,CAAC6S,UAAWpzB,KAAK6f,MAAMuT,a,2CAIpB/P,GACjBrjB,KAAKujB,KAAKsQ,KAAKC,qBAAqBzQ,K,wCAGtBpX,EAAM7L,GACpB,IAAMuL,EAAY3L,KAAK6f,MAAMlU,UAC7BA,EAAUM,GAAQ7L,EAClBJ,KAAKugB,SAAS,CAAC5U,UAAWA,M,2CAGTM,GACjB,IAAMN,EAAY3L,KAAK6f,MAAMlU,iBACtBA,EAAUM,GACjBjM,KAAKugB,SAAS,CAAC5U,UAAWA,M,yCAGXM,GACf,IAAMN,EAAY3L,KAAK6f,MAAMlU,UAC7BA,EAAUM,GAASN,EAAUM,GAAQ,GAAO,EAAI,EAChDjM,KAAK8zB,qBAAL,eAA4B7nB,EAAON,EAAUM,KAC7CjM,KAAKugB,SAAS,CAAC5U,gB,sCAGHooB,GAAU,IAAD,EAC6B/zB,KAAK6f,MAAhDlU,EADc,EACdA,UAAWqnB,EADG,EACHA,gBAAiBE,EADd,EACcA,YAE/BvnB,EAAUkY,gBAAkB,GACxBkQ,IAAYb,GACZlzB,KAAKugB,SAAS,CAAC2S,YAAaa,IAG5BA,IAAYf,GACZhzB,KAAKugB,SAAS,CAACyS,gBAAiBe,M,yCAMxC,IAAMC,EAAOx0B,OAAO0b,SAAS8Y,KAChB,KAATA,EACAh0B,KAAKuxB,cAAc,OAAO,GAE1BvxB,KAAKuxB,cAAc0C,mBAAmBD,EAAKhmB,MAAM,KAAK,K,oCAIhDoZ,EAAM8M,GAahB,GAZA9M,EAAOA,EAAKV,cAEZlnB,OAAO20B,QAAQC,kBACX31B,OAAWA,EACX,IAAM41B,mBAAmBjN,IAG7BpnB,KAAKugB,SAAS,CACVwS,eAAgB3L,EAChBkM,oBAAqB,OAGrBY,EAAU,CACV,IADU,EACJtf,EAAaD,GAAgByS,EAAKkN,QAClC3oB,EA/IlB,SAAS4oB,EAAiB3f,GACtB,IAAKpI,MAAMC,QAAQmI,GAAc,OAAO,IAAIS,IAC5C,GAAsB,aAAlBT,EAAW,IAAuC,MAAlBA,EAAW,GAC3C,OAAO,IAAIS,IAAI,CAACT,EAAW,KAG/B,IANkC,EAM9B4f,EAAS,IAAInf,IANiB,KAOhBT,GAPgB,IAOlC,2BAA8B,CAAC,IAAtBmb,EAAqB,QAC1ByE,EAAS,IAAInf,IAAJ,sBAAYmf,GAAZ,YAAuBD,EAAiBxE,OARnB,8BAUlC,OAAOyE,EAqImBD,CAAiB3f,GAC7B6f,EAAY,eAAOz0B,KAAK6f,MAAMlU,WAH1B,KAKQA,GALR,IAKV,2BAA6B,CACzB8oB,EADyB,SACH,IANhB,8BASVz0B,KAAKugB,SAAS,CAAC3L,aAAYjJ,UAAW8oB,SAEtCpU,aAAargB,KAAKizB,aAClBjzB,KAAKizB,YAAc3S,WAAWtgB,KAAK00B,mBAAmBlT,KAAKxhB,MAAO,O,2CAIpD,IAEZ4U,EAAaD,GADM3U,KAAK6f,MAAvBkT,eAC2CuB,QAClDt0B,KAAKugB,SAAS,CAAC3L,iB,sCAGHwS,GACZpnB,KAAKugB,SAAS,CAACtI,aAAcmP,M,6CAGT,IAAD,EAC4BpnB,KAAK6f,MAA7ClU,EADY,EACZA,UAAWsM,EADC,EACDA,aAAcib,EADb,EACaA,YAChC,OAAIvnB,EAAUkY,gBAAkB,GAExB,kBAAC8Q,GAAD,CACIz0B,SAAUF,KAAK40B,gBAAgBpT,KAAKxhB,MACpCumB,aAAc2M,EACd9yB,MAAO6X,SAIf,I,+BAIE,IAAD,SASDjY,KAAK6f,MAPLlU,EAFC,EAEDA,UACAsM,EAHC,EAGDA,aACArD,EAJC,EAIDA,WAAYme,EAJX,EAIWA,eACZI,EALC,EAKDA,SAAUC,EALT,EAKSA,SACVJ,EANC,EAMDA,gBACAM,EAPC,EAODA,oBACAD,EARC,EAQDA,iBAGEwB,EAAkBlpB,EAAUkY,gBAAkB,GAE9CnY,EAAMmpB,EAAkB5c,EAAerD,EAE7C,OACI,kBAAC,IAAD,CAAkBnV,MAAOA,GACrB,yBAAKpB,GAAG,OACJ,kBAACy2B,EAAD,CACI3B,SAAUA,EACVC,SAAUA,EACV9yB,aAAcN,KAAK+0B,iBAAiBvT,KAAKxhB,MACzCO,aAAcP,KAAKg1B,iBAAiBxT,KAAKxhB,MAEzCE,SAAUF,KAAKuxB,cAAc/P,KAAKxhB,MAClCI,MAAO2yB,EACPvyB,MAAOwyB,EACP3yB,SAAUw0B,IAEd,kBAAC,GAAD,CACIlU,UAAS,wBAAmB0S,EAAmB,WAAa,IAC5DhO,KAAM8N,EACNvN,SAAU5lB,KAAK+0B,iBAAiBvT,KAAKxhB,MACrColB,OAAO,OACPF,gBAAiB,KAEjB,kBAAC,GAAD,CACIvZ,UAAWA,EACXqf,SAAUhrB,KAAK8zB,qBAAqBtS,KAAKxhB,MACzCyrB,MAAOzrB,KAAKi1B,kBAAkBzT,KAAKxhB,MACnCmrB,SAAUnrB,KAAKk1B,qBAAqB1T,KAAKxhB,MACzCuqB,YAAa,SAACjsB,GAAD,OAAO,EAAKiiB,SAAS,CAAC8S,iBAAkB/0B,OAEzD,kBAAC,GAAD,CACIqN,UAAWA,EACXqkB,WAAY,kBAAM,EAAKzP,SAAS,CAAC6S,UAAU,EAAOD,UAAU,KAC5DlD,eAAgB,SAAAqD,GAAmB,OAAI,EAAK/S,SAAS,CAAC+S,2BAE1D,kBAAC,GAAD,CACInH,QAAQ,mBACRF,QAAS,CACLsH,oBAAqB,sBACrBC,gBAAiB,kBACjBC,oBAAqB,sBACrB/X,YAAa,eAEjBkK,SAAU5lB,KAAKm1B,mBAAmB3T,KAAKxhB,MACvC2L,UAAWA,IAEf,kBAAC,GAAD,CACIwgB,QAAQ,mBACRF,QAAS,CACLpI,gBAAiB,mBAErB+B,SAAU5lB,KAAKm1B,mBAAmB3T,KAAKxhB,MACvC2L,UAAWA,IAEd3L,KAAKo1B,wBAEV,kBAAC,GAAD,CACIxgB,WAAYlJ,EACZC,UAAWA,EACXsjB,WAAYqE,EACZzN,QAAS,kBAAM,EAAKtF,SAAS,CAAC+S,oBAAqB,UAEvD,kBAAC,GAAD,CACIrP,IAAI,OACJrP,WAAYlJ,EACZC,UAAWA,EACX+V,QAAS1hB,KAAKq1B,gBAAgB7T,KAAKxhB,QAEvC,kBAAC,GAAD,CACI2gB,UAAU,aACV0E,KAAM+N,EACNhO,OAAO,QACPQ,SAAU5lB,KAAKg1B,iBAAiBxT,KAAKxhB,MACrCklB,gBAAiB,KAEjB,kBAAC,GAAD,CACIqM,cAAe,SAAC3c,GACZ,EAAK2c,cAAc3c,GACnB,EAAKkf,qBAAL,eACO,EAAKjU,MAAMlU,UADlB,CAEIkY,gBAAiB,MAGzB2N,UAAW,kBAAM,EAAKjR,SAAS,CAAC6S,UAAU,c,GAxQpD/xB,IAAMqqB,WCxCJ4J,QACW,cAA7B91B,OAAO0b,SAASqa,UAEe,UAA7B/1B,OAAO0b,SAASqa,UAEhB/1B,OAAO0b,SAASqa,SAAS5O,MACvB,2DCLN6O,iBAAO,kBAAC,GAAD,MAAS1N,SAAS2N,eAAe,SDoGlC,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMC,MAAK,SAAAC,GACjCA,EAAaC,kB","file":"static/js/main.d86c8a7b.chunk.js","sourcesContent":["// Generated automatically by nearley, version 2.20.1\n// http://github.com/Hardmath123/nearley\n(function () {\nfunction id(x) { return x[0]; }\nvar grammar = {\n    Lexer: undefined,\n    ParserRules: [\n    {\"name\": \"_$ebnf$1\", \"symbols\": []},\n    {\"name\": \"_$ebnf$1\", \"symbols\": [\"_$ebnf$1\", \"wschar\"], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"_\", \"symbols\": [\"_$ebnf$1\"], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"__$ebnf$1\", \"symbols\": [\"wschar\"]},\n    {\"name\": \"__$ebnf$1\", \"symbols\": [\"__$ebnf$1\", \"wschar\"], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"__\", \"symbols\": [\"__$ebnf$1\"], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"wschar\", \"symbols\": [/[ \\t\\n\\v\\f]/], \"postprocess\": id},\n    {\"name\": \"unsigned_int$ebnf$1\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"unsigned_int$ebnf$1\", \"symbols\": [\"unsigned_int$ebnf$1\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"unsigned_int\", \"symbols\": [\"unsigned_int$ebnf$1\"], \"postprocess\": \n        function(d) {\n            return parseInt(d[0].join(\"\"));\n        }\n        },\n    {\"name\": \"int$ebnf$1$subexpression$1\", \"symbols\": [{\"literal\":\"-\"}]},\n    {\"name\": \"int$ebnf$1$subexpression$1\", \"symbols\": [{\"literal\":\"+\"}]},\n    {\"name\": \"int$ebnf$1\", \"symbols\": [\"int$ebnf$1$subexpression$1\"], \"postprocess\": id},\n    {\"name\": \"int$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"int$ebnf$2\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"int$ebnf$2\", \"symbols\": [\"int$ebnf$2\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"int\", \"symbols\": [\"int$ebnf$1\", \"int$ebnf$2\"], \"postprocess\": \n        function(d) {\n            if (d[0]) {\n                return parseInt(d[0][0]+d[1].join(\"\"));\n            } else {\n                return parseInt(d[1].join(\"\"));\n            }\n        }\n        },\n    {\"name\": \"unsigned_decimal$ebnf$1\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"unsigned_decimal$ebnf$1\", \"symbols\": [\"unsigned_decimal$ebnf$1\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"unsigned_decimal$ebnf$2$subexpression$1$ebnf$1\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"unsigned_decimal$ebnf$2$subexpression$1$ebnf$1\", \"symbols\": [\"unsigned_decimal$ebnf$2$subexpression$1$ebnf$1\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"unsigned_decimal$ebnf$2$subexpression$1\", \"symbols\": [{\"literal\":\".\"}, \"unsigned_decimal$ebnf$2$subexpression$1$ebnf$1\"]},\n    {\"name\": \"unsigned_decimal$ebnf$2\", \"symbols\": [\"unsigned_decimal$ebnf$2$subexpression$1\"], \"postprocess\": id},\n    {\"name\": \"unsigned_decimal$ebnf$2\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"unsigned_decimal\", \"symbols\": [\"unsigned_decimal$ebnf$1\", \"unsigned_decimal$ebnf$2\"], \"postprocess\": \n        function(d) {\n            return parseFloat(\n                d[0].join(\"\") +\n                (d[1] ? \".\"+d[1][1].join(\"\") : \"\")\n            );\n        }\n        },\n    {\"name\": \"decimal$ebnf$1\", \"symbols\": [{\"literal\":\"-\"}], \"postprocess\": id},\n    {\"name\": \"decimal$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"decimal$ebnf$2\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"decimal$ebnf$2\", \"symbols\": [\"decimal$ebnf$2\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"decimal$ebnf$3$subexpression$1$ebnf$1\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"decimal$ebnf$3$subexpression$1$ebnf$1\", \"symbols\": [\"decimal$ebnf$3$subexpression$1$ebnf$1\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"decimal$ebnf$3$subexpression$1\", \"symbols\": [{\"literal\":\".\"}, \"decimal$ebnf$3$subexpression$1$ebnf$1\"]},\n    {\"name\": \"decimal$ebnf$3\", \"symbols\": [\"decimal$ebnf$3$subexpression$1\"], \"postprocess\": id},\n    {\"name\": \"decimal$ebnf$3\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"decimal\", \"symbols\": [\"decimal$ebnf$1\", \"decimal$ebnf$2\", \"decimal$ebnf$3\"], \"postprocess\": \n        function(d) {\n            return parseFloat(\n                (d[0] || \"\") +\n                d[1].join(\"\") +\n                (d[2] ? \".\"+d[2][1].join(\"\") : \"\")\n            );\n        }\n        },\n    {\"name\": \"percentage\", \"symbols\": [\"decimal\", {\"literal\":\"%\"}], \"postprocess\": \n        function(d) {\n            return d[0]/100;\n        }\n        },\n    {\"name\": \"jsonfloat$ebnf$1\", \"symbols\": [{\"literal\":\"-\"}], \"postprocess\": id},\n    {\"name\": \"jsonfloat$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"jsonfloat$ebnf$2\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"jsonfloat$ebnf$2\", \"symbols\": [\"jsonfloat$ebnf$2\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"jsonfloat$ebnf$3$subexpression$1$ebnf$1\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"jsonfloat$ebnf$3$subexpression$1$ebnf$1\", \"symbols\": [\"jsonfloat$ebnf$3$subexpression$1$ebnf$1\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"jsonfloat$ebnf$3$subexpression$1\", \"symbols\": [{\"literal\":\".\"}, \"jsonfloat$ebnf$3$subexpression$1$ebnf$1\"]},\n    {\"name\": \"jsonfloat$ebnf$3\", \"symbols\": [\"jsonfloat$ebnf$3$subexpression$1\"], \"postprocess\": id},\n    {\"name\": \"jsonfloat$ebnf$3\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"jsonfloat$ebnf$4$subexpression$1$ebnf$1\", \"symbols\": [/[+-]/], \"postprocess\": id},\n    {\"name\": \"jsonfloat$ebnf$4$subexpression$1$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"jsonfloat$ebnf$4$subexpression$1$ebnf$2\", \"symbols\": [/[0-9]/]},\n    {\"name\": \"jsonfloat$ebnf$4$subexpression$1$ebnf$2\", \"symbols\": [\"jsonfloat$ebnf$4$subexpression$1$ebnf$2\", /[0-9]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"jsonfloat$ebnf$4$subexpression$1\", \"symbols\": [/[eE]/, \"jsonfloat$ebnf$4$subexpression$1$ebnf$1\", \"jsonfloat$ebnf$4$subexpression$1$ebnf$2\"]},\n    {\"name\": \"jsonfloat$ebnf$4\", \"symbols\": [\"jsonfloat$ebnf$4$subexpression$1\"], \"postprocess\": id},\n    {\"name\": \"jsonfloat$ebnf$4\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"jsonfloat\", \"symbols\": [\"jsonfloat$ebnf$1\", \"jsonfloat$ebnf$2\", \"jsonfloat$ebnf$3\", \"jsonfloat$ebnf$4\"], \"postprocess\": \n        function(d) {\n            return parseFloat(\n                (d[0] || \"\") +\n                d[1].join(\"\") +\n                (d[2] ? \".\"+d[2][1].join(\"\") : \"\") +\n                (d[3] ? \"e\" + (d[3][1] || \"+\") + d[3][2].join(\"\") : \"\")\n            );\n        }\n        },\n    {\"name\": \"sum\", \"symbols\": [\"sum\", \"_\", \"sumOperator\", \"_\", \"product\"], \"postprocess\": \n        (data) => [data[2], data[0], data[4]]\n            },\n    {\"name\": \"sum\", \"symbols\": [\"product\"], \"postprocess\": id},\n    {\"name\": \"product\", \"symbols\": [\"product\", \"_\", \"productOperator\", \"_\", \"power\"], \"postprocess\": \n        (data) => [data[2], data[0], data[4]]\n            },\n    {\"name\": \"product\", \"symbols\": [{\"literal\":\"-\"}, \"_\", \"power\"], \"postprocess\": data => ['neg', data[2]]},\n    {\"name\": \"product\", \"symbols\": [\"power\"], \"postprocess\": id},\n    {\"name\": \"power\", \"symbols\": [\"function\", \"_\", \"powerOperator\", \"_\", \"power\"], \"postprocess\": \n        (data) => ['pow', data[0], data[4]]\n            },\n    {\"name\": \"power\", \"symbols\": [\"function\"], \"postprocess\": id},\n    {\"name\": \"function\", \"symbols\": [\"unaryFunction\", {\"literal\":\"(\"}, \"_\", \"sum\", \"_\", {\"literal\":\")\"}], \"postprocess\": data => [data[0][0], data[3]]},\n    {\"name\": \"function\", \"symbols\": [\"unaryFunction\", {\"literal\":\"[\"}, \"_\", \"sum\", \"_\", {\"literal\":\"]\"}], \"postprocess\": data => [data[0][0], data[3]]},\n    {\"name\": \"function\", \"symbols\": [\"binaryFunction\", {\"literal\":\"(\"}, \"_\", \"sum\", {\"literal\":\",\"}, \"_\", \"sum\", \"_\", {\"literal\":\")\"}], \"postprocess\": data => [data[0][0], data[3], data[6]]},\n    {\"name\": \"function\", \"symbols\": [\"binaryFunction\", {\"literal\":\"[\"}, \"_\", \"sum\", {\"literal\":\",\"}, \"_\", \"sum\", \"_\", {\"literal\":\"]\"}], \"postprocess\": data => [data[0][0], data[3], data[6]]},\n    {\"name\": \"function\", \"symbols\": [\"fourFunction\", {\"literal\":\"(\"}, \"_\", \"sum\", {\"literal\":\",\"}, \"_\", \"sum\", {\"literal\":\",\"}, \"_\", \"sum\", {\"literal\":\",\"}, \"_\", \"sum\", \"_\", {\"literal\":\")\"}], \"postprocess\": data => [data[0][0], data[3], data[6], data[9], data[12]]},\n    {\"name\": \"function\", \"symbols\": [\"fourFunction\", {\"literal\":\"[\"}, \"_\", \"sum\", {\"literal\":\",\"}, \"_\", \"sum\", {\"literal\":\",\"}, \"_\", \"sum\", {\"literal\":\",\"}, \"_\", \"sum\", \"_\", {\"literal\":\"]\"}], \"postprocess\": data => [data[0][0], data[3], data[6], data[9], data[12]]},\n    {\"name\": \"function\", \"symbols\": [\"diffFunction\", {\"literal\":\"(\"}, \"_\", \"sum\", \"_\", {\"literal\":\")\"}], \"postprocess\": data => [data[0][0], data[3], ['variable', 'z']]},\n    {\"name\": \"function\", \"symbols\": [\"diffFunction\", {\"literal\":\"[\"}, \"_\", \"sum\", \"_\", {\"literal\":\"]\"}], \"postprocess\": data => [data[0][0], data[3], ['variable', 'z']]},\n    {\"name\": \"function\", \"symbols\": [\"parenthesis2\"], \"postprocess\": id},\n    {\"name\": \"parenthesis\", \"symbols\": [{\"literal\":\"(\"}, \"sum\", {\"literal\":\")\"}], \"postprocess\": (data) => data[1]},\n    {\"name\": \"parenthesis\", \"symbols\": [{\"literal\":\"[\"}, \"sum\", {\"literal\":\"]\"}], \"postprocess\": (data) => data[1]},\n    {\"name\": \"parenthesis\", \"symbols\": [\"literal\"], \"postprocess\": id},\n    {\"name\": \"parenthesis2\", \"symbols\": [\"parenthesis\"], \"postprocess\": id},\n    {\"name\": \"parenthesis2\", \"symbols\": [\"parenthesis\", {\"literal\":\"!\"}], \"postprocess\": (data) => ['factorial', data[0]]},\n    {\"name\": \"sumOperator\", \"symbols\": [{\"literal\":\"+\"}], \"postprocess\": () => 'add'},\n    {\"name\": \"sumOperator\", \"symbols\": [{\"literal\":\"-\"}], \"postprocess\": () => 'sub'},\n    {\"name\": \"sumOperator\", \"symbols\": [{\"literal\":\"\"}], \"postprocess\": () => 'sub'},\n    {\"name\": \"productOperator\", \"symbols\": [{\"literal\":\"*\"}], \"postprocess\": () => 'mul'},\n    {\"name\": \"productOperator\", \"symbols\": [{\"literal\":\"\"}], \"postprocess\": () => 'mul'},\n    {\"name\": \"productOperator\", \"symbols\": [{\"literal\":\"/\"}], \"postprocess\": () => 'div'},\n    {\"name\": \"powerOperator$string$1\", \"symbols\": [{\"literal\":\"*\"}, {\"literal\":\"*\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"powerOperator\", \"symbols\": [\"powerOperator$string$1\"]},\n    {\"name\": \"powerOperator\", \"symbols\": [{\"literal\":\"^\"}]},\n    {\"name\": \"fourFunction$string$1\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"u\"}, {\"literal\":\"m\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"fourFunction\", \"symbols\": [\"fourFunction$string$1\"]},\n    {\"name\": \"fourFunction$string$2\", \"symbols\": [{\"literal\":\"p\"}, {\"literal\":\"r\"}, {\"literal\":\"o\"}, {\"literal\":\"d\"}, {\"literal\":\"u\"}, {\"literal\":\"c\"}, {\"literal\":\"t\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"fourFunction\", \"symbols\": [\"fourFunction$string$2\"], \"postprocess\": () => ['prod']},\n    {\"name\": \"fourFunction$string$3\", \"symbols\": [{\"literal\":\"p\"}, {\"literal\":\"r\"}, {\"literal\":\"o\"}, {\"literal\":\"d\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"fourFunction\", \"symbols\": [\"fourFunction$string$3\"]},\n    {\"name\": \"binaryFunction$string$1\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"n\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$1\"]},\n    {\"name\": \"binaryFunction$string$2\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"n\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$2\"]},\n    {\"name\": \"binaryFunction$string$3\", \"symbols\": [{\"literal\":\"d\"}, {\"literal\":\"n\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$3\"]},\n    {\"name\": \"binaryFunction$string$4\", \"symbols\": [{\"literal\":\"w\"}, {\"literal\":\"p\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$4\"]},\n    {\"name\": \"binaryFunction$string$5\", \"symbols\": [{\"literal\":\"w\"}, {\"literal\":\"p\"}, {\"literal\":\"'\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$5\"], \"postprocess\": () => ['wpp']},\n    {\"name\": \"binaryFunction$string$6\", \"symbols\": [{\"literal\":\"t\"}, {\"literal\":\"h\"}, {\"literal\":\"e\"}, {\"literal\":\"t\"}, {\"literal\":\"a\"}, {\"literal\":\"0\"}, {\"literal\":\"0\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$6\"]},\n    {\"name\": \"binaryFunction$string$7\", \"symbols\": [{\"literal\":\"t\"}, {\"literal\":\"h\"}, {\"literal\":\"e\"}, {\"literal\":\"t\"}, {\"literal\":\"a\"}, {\"literal\":\"0\"}, {\"literal\":\"1\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$7\"]},\n    {\"name\": \"binaryFunction$string$8\", \"symbols\": [{\"literal\":\"t\"}, {\"literal\":\"h\"}, {\"literal\":\"e\"}, {\"literal\":\"t\"}, {\"literal\":\"a\"}, {\"literal\":\"1\"}, {\"literal\":\"0\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$8\"]},\n    {\"name\": \"binaryFunction$string$9\", \"symbols\": [{\"literal\":\"t\"}, {\"literal\":\"h\"}, {\"literal\":\"e\"}, {\"literal\":\"t\"}, {\"literal\":\"a\"}, {\"literal\":\"1\"}, {\"literal\":\"1\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"binaryFunction$string$9\"]},\n    {\"name\": \"binaryFunction\", \"symbols\": [\"diffFunction\"], \"postprocess\": x => x[0]},\n    {\"name\": \"diffFunction$string$1\", \"symbols\": [{\"literal\":\"d\"}, {\"literal\":\"e\"}, {\"literal\":\"r\"}, {\"literal\":\"i\"}, {\"literal\":\"v\"}, {\"literal\":\"a\"}, {\"literal\":\"t\"}, {\"literal\":\"i\"}, {\"literal\":\"v\"}, {\"literal\":\"e\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"diffFunction\", \"symbols\": [\"diffFunction$string$1\"], \"postprocess\": () => ['diff']},\n    {\"name\": \"diffFunction$string$2\", \"symbols\": [{\"literal\":\"d\"}, {\"literal\":\"i\"}, {\"literal\":\"f\"}, {\"literal\":\"f\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"diffFunction\", \"symbols\": [\"diffFunction$string$2\"]},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"trigFunction\"]},\n    {\"name\": \"unaryFunction$string$1\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"i\"}, {\"literal\":\"s\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$1\"]},\n    {\"name\": \"unaryFunction$string$2\", \"symbols\": [{\"literal\":\"e\"}, {\"literal\":\"x\"}, {\"literal\":\"p\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$2\"]},\n    {\"name\": \"unaryFunction$string$3\", \"symbols\": [{\"literal\":\"l\"}, {\"literal\":\"o\"}, {\"literal\":\"g\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$3\"]},\n    {\"name\": \"unaryFunction$string$4\", \"symbols\": [{\"literal\":\"l\"}, {\"literal\":\"n\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$4\"], \"postprocess\": () => ['log']},\n    {\"name\": \"unaryFunction$string$5\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"q\"}, {\"literal\":\"r\"}, {\"literal\":\"t\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$5\"]},\n    {\"name\": \"unaryFunction$string$6\", \"symbols\": [{\"literal\":\"g\"}, {\"literal\":\"a\"}, {\"literal\":\"m\"}, {\"literal\":\"m\"}, {\"literal\":\"a\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$6\"]},\n    {\"name\": \"unaryFunction$string$7\", \"symbols\": [{\"literal\":\"e\"}, {\"literal\":\"t\"}, {\"literal\":\"a\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$7\"]},\n    {\"name\": \"unaryFunction$string$8\", \"symbols\": [{\"literal\":\"z\"}, {\"literal\":\"e\"}, {\"literal\":\"t\"}, {\"literal\":\"a\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$8\"]},\n    {\"name\": \"unaryFunction$string$9\", \"symbols\": [{\"literal\":\"e\"}, {\"literal\":\"r\"}, {\"literal\":\"f\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$9\"]},\n    {\"name\": \"unaryFunction$string$10\", \"symbols\": [{\"literal\":\"a\"}, {\"literal\":\"b\"}, {\"literal\":\"s\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$10\"]},\n    {\"name\": \"unaryFunction$string$11\", \"symbols\": [{\"literal\":\"a\"}, {\"literal\":\"r\"}, {\"literal\":\"g\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$11\"]},\n    {\"name\": \"unaryFunction$string$12\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"g\"}, {\"literal\":\"n\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$12\"]},\n    {\"name\": \"unaryFunction$string$13\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"o\"}, {\"literal\":\"n\"}, {\"literal\":\"j\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$13\"]},\n    {\"name\": \"unaryFunction$string$14\", \"symbols\": [{\"literal\":\"r\"}, {\"literal\":\"e\"}, {\"literal\":\"a\"}, {\"literal\":\"l\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$14\"]},\n    {\"name\": \"unaryFunction$string$15\", \"symbols\": [{\"literal\":\"i\"}, {\"literal\":\"m\"}, {\"literal\":\"a\"}, {\"literal\":\"g\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$15\"]},\n    {\"name\": \"unaryFunction$string$16\", \"symbols\": [{\"literal\":\"f\"}, {\"literal\":\"l\"}, {\"literal\":\"o\"}, {\"literal\":\"o\"}, {\"literal\":\"r\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$16\"]},\n    {\"name\": \"unaryFunction$string$17\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"e\"}, {\"literal\":\"i\"}, {\"literal\":\"l\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$17\"]},\n    {\"name\": \"unaryFunction$string$18\", \"symbols\": [{\"literal\":\"r\"}, {\"literal\":\"o\"}, {\"literal\":\"u\"}, {\"literal\":\"n\"}, {\"literal\":\"d\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$18\"]},\n    {\"name\": \"unaryFunction$string$19\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"t\"}, {\"literal\":\"e\"}, {\"literal\":\"p\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$19\"]},\n    {\"name\": \"unaryFunction$string$20\", \"symbols\": [{\"literal\":\"r\"}, {\"literal\":\"e\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$20\"], \"postprocess\": () => ['real']},\n    {\"name\": \"unaryFunction$string$21\", \"symbols\": [{\"literal\":\"i\"}, {\"literal\":\"m\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$21\"], \"postprocess\": () => ['imag']},\n    {\"name\": \"unaryFunction$string$22\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"m\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$22\"]},\n    {\"name\": \"unaryFunction$string$23\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"m\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"unaryFunction\", \"symbols\": [\"unaryFunction$string$23\"]},\n    {\"name\": \"unaryFunction\", \"symbols\": [{\"literal\":\"j\"}]},\n    {\"name\": \"baseTrigFunction$string$1\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"i\"}, {\"literal\":\"n\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"baseTrigFunction\", \"symbols\": [\"baseTrigFunction$string$1\"]},\n    {\"name\": \"baseTrigFunction$string$2\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"o\"}, {\"literal\":\"s\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"baseTrigFunction\", \"symbols\": [\"baseTrigFunction$string$2\"]},\n    {\"name\": \"baseTrigFunction$string$3\", \"symbols\": [{\"literal\":\"t\"}, {\"literal\":\"a\"}, {\"literal\":\"n\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"baseTrigFunction\", \"symbols\": [\"baseTrigFunction$string$3\"]},\n    {\"name\": \"baseTrigFunction$string$4\", \"symbols\": [{\"literal\":\"s\"}, {\"literal\":\"e\"}, {\"literal\":\"c\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"baseTrigFunction\", \"symbols\": [\"baseTrigFunction$string$4\"]},\n    {\"name\": \"baseTrigFunction$string$5\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"s\"}, {\"literal\":\"c\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"baseTrigFunction\", \"symbols\": [\"baseTrigFunction$string$5\"]},\n    {\"name\": \"baseTrigFunction$string$6\", \"symbols\": [{\"literal\":\"c\"}, {\"literal\":\"o\"}, {\"literal\":\"t\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"baseTrigFunction\", \"symbols\": [\"baseTrigFunction$string$6\"]},\n    {\"name\": \"hyperbolicTrigFunction\", \"symbols\": [\"baseTrigFunction\", {\"literal\":\"h\"}], \"postprocess\": (data) => data.join('')},\n    {\"name\": \"trigFunction$ebnf$1$string$1\", \"symbols\": [{\"literal\":\"a\"}, {\"literal\":\"r\"}, {\"literal\":\"c\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"trigFunction$ebnf$1\", \"symbols\": [\"trigFunction$ebnf$1$string$1\"], \"postprocess\": id},\n    {\"name\": \"trigFunction$ebnf$1\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"trigFunction\", \"symbols\": [\"trigFunction$ebnf$1\", \"baseTrigFunction\"], \"postprocess\": (data) => data.join('')},\n    {\"name\": \"trigFunction\", \"symbols\": [{\"literal\":\"a\"}, \"baseTrigFunction\"], \"postprocess\": (data) => 'arc' + data[1]},\n    {\"name\": \"trigFunction$ebnf$2$string$1\", \"symbols\": [{\"literal\":\"a\"}, {\"literal\":\"r\"}], \"postprocess\": function joiner(d) {return d.join('');}},\n    {\"name\": \"trigFunction$ebnf$2\", \"symbols\": [\"trigFunction$ebnf$2$string$1\"], \"postprocess\": id},\n    {\"name\": \"trigFunction$ebnf$2\", \"symbols\": [], \"postprocess\": function(d) {return null;}},\n    {\"name\": \"trigFunction\", \"symbols\": [\"trigFunction$ebnf$2\", \"hyperbolicTrigFunction\"], \"postprocess\": (data) => data.join('')},\n    {\"name\": \"literal\", \"symbols\": [\"complexNumber\"], \"postprocess\": id},\n    {\"name\": \"literal\", \"symbols\": [\"variable\"], \"postprocess\": id},\n    {\"name\": \"variable$ebnf$1\", \"symbols\": [/[a-z]/]},\n    {\"name\": \"variable$ebnf$1\", \"symbols\": [\"variable$ebnf$1\", /[a-z]/], \"postprocess\": function arrpush(d) {return d[0].concat([d[1]]);}},\n    {\"name\": \"variable\", \"symbols\": [\"variable$ebnf$1\"], \"postprocess\": \n        function(data, l, reject) {\n            const constants = ['e', 'pi', 'tau', 'phi'];\n            const token = data[0].join('')\n            if (token === 'i') {return reject;}\n            return constants.includes(token) ? ['constant', token] : ['variable', token];\n        }\n        },\n    {\"name\": \"complexNumber\", \"symbols\": [\"decimal\"], \"postprocess\": (data) => ['number', data[0], 0]},\n    {\"name\": \"complexNumber\", \"symbols\": [\"decimal\", {\"literal\":\"i\"}], \"postprocess\": (data) => ['number', 0, data[0]]},\n    {\"name\": \"complexNumber\", \"symbols\": [{\"literal\":\"i\"}], \"postprocess\": () => ['number', 0, 1]}\n]\n  , ParserStart: \"sum\"\n}\nif (typeof module !== 'undefined'&& typeof module.exports !== 'undefined') {\n   module.exports = grammar;\n} else {\n   window.grammar = grammar;\n}\n})();\n","import createMuiTheme from '@material-ui/core/styles/createMuiTheme';\nimport blue from '@material-ui/core/colors/blue';\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: blue,\n  },\n});\n\nexport default theme;\n","import React from 'react';\n\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport IconButton from '@material-ui/core/IconButton';\n\nimport MenuIcon from '@material-ui/icons/Menu';\n\nimport './control-bar.css';\n\n\nclass ControlPanel extends React.PureComponent {\n  handleTextChange(event) {\n    this.props.onChange(event.target.value);\n  }\n\n  render() {\n      const {disabled, onMenuButton, onHelpButton, error, value} = this.props;\n      return (\n        <AppBar id='app-bar'>\n          <Toolbar disableGutters>\n            <IconButton\n              onClick={onMenuButton}\n            >\n              <MenuIcon/>\n            </IconButton>\n            <div id='function-input'>\n              <TextField\n                  id='function-input'\n                  placeholder={window.innerWidth > 480 ? 'Enter a complex function of z' : 'f(z)'}\n                  value={value}\n                  onChange={(event) => this.handleTextChange(event)}\n                  error={error}\n                  autoFocus\n                  fullWidth\n                  disabled={disabled}\n              />\n            </div>\n            <div id='help-button'>\n                <Button onClick={onHelpButton}>Help</Button>\n            </div>\n          </Toolbar>\n        </AppBar>\n      );\n  }\n}\n\nexport default ControlPanel;\n","const math = require('mathjs');\n\nconst I = math.complex(0, 1);\n\nconst cadd = math.sum;\nconst csub = math.subtract;\nconst cdiv = math.divide;\nconst cmul = math.multiply;\nconst cmul_i = z => math.multiply(z, I);\nconst creciprocal = z => math.divide(1, z);\nconst csin = math.sin;\nconst cexp = math.exp;\nconst clog = math.log;\nconst csqrt = math.sqrt;\nconst cpow = math.pow;\nconst csquare = z => cmul(z, z);\n\nconst gamma_right = math.gamma;\nconst gamma_left = z => math.divide(math.pi, math.multiply(\n    math.sin(math.multiply(z, math.pi)),\n    gamma_right(math.subtract(1, z))\n));\nconst gamma = z => z.re < 0.5 ? gamma_left(z) : gamma_right(z);\n\n\nconst ETA_COEFFICIENTS = [\n[ 1.00000000000000000000, 0.00000000000000000000],\n[-1.00000000000000000000, 0.69314718055994528623],\n[ 1.00000000000000000000, 1.09861228866810978211], \n[-1.00000000000000000000, 1.38629436111989057245], \n[ 0.99999999999999555911, 1.60943791243410028180], \n[-0.99999999999979938270, 1.79175946922805495731], \n[ 0.99999999999386091076, 1.94591014905531323187], \n[-0.99999999986491050485, 2.07944154167983574766], \n[ 0.99999999776946757457, 2.19722457733621956422], \n[-0.99999997147371189055, 2.30258509299404590109], \n[ 0.99999971045373836631, 2.39789527279837066942], \n[-0.99999762229395061652, 2.48490664978800035456], \n[ 0.99998395846577381452, 2.56494935746153673861], \n[-0.99990996358087780305, 2.63905732961525840707], \n[ 0.99957522481587246510, 2.70805020110221006391], \n[-0.99830090896564482872, 2.77258872223978114491], \n[ 0.99419535104495204703, 2.83321334405621616526], \n[-0.98295446518722640050, 2.89037175789616451738], \n[ 0.95672573151919981793, 2.94443897916644026225], \n[-0.90449212250748245445, 2.99573227355399085425], \n[ 0.81569498718756294764, 3.04452243772342301398], \n[-0.68698555062628596790, 3.09104245335831606667], \n[ 0.52834368695773525904, 3.13549421592914967505], \n[-0.36280435095576935023, 3.17805383034794575181], \n[ 0.21751716776255453079, 3.21887582486820056360], \n[-0.11124997091266028426, 3.25809653802148213586], \n[ 0.04729731398489586680, 3.29583686600432912428], \n[-0.01619245778522847637, 3.33220451017520380432], \n[ 0.00427566222821304867, 3.36729582998647414271], \n[-0.00081524972526846008, 3.40119738166215546116], \n[ 0.00009970680093076545, 3.43398720448514627179], \n[-0.00000586510593565794, 3.46573590279972654216], \n];\n\nfunction eta_right(z) {\n    return math.sum(...ETA_COEFFICIENTS.map(\n        ([a, b]) => cmul(a, cexp(cmul(-b, z)))\n    ));\n}\n\nfunction eta_left(w) {\n    const z = w.neg();\n    const zp1 = math.add(z, 1);\n\n    if (z.im < 0) {return math.conj(eta_left(math.conj(w)));}\n\n\n    let component_a = cmul(gamma(z), csin(cmul(z, math.pi/2)));\n    if (z.im > 50) {\n        const log_r = math.log(math.abs(z));\n        const theta = math.arg(z);\n\n        component_a = cmul(\n            Math.sqrt(2 * Math.PI) / 2,\n            I,\n            cexp(cadd(\n                cmul(theta - Math.PI/2, I, z),\n                cmul(log_r - 1, z),\n                cmul(-0.5, math.complex(log_r, theta))\n            )\n        ));\n    }\n    const component_b = cmul(z, eta_right(zp1));\n\n    const multiplier_a = cexp(cmul(-math.log(math.pi), zp1));\n    const multiplier_b = cdiv(\n        csub(1, cexp(cmul(-Math.LN2, zp1))),\n        csub(1, cexp(cmul(-Math.LN2, z)))\n    );\n\n    const component = cmul(component_a, component_b);\n    const multiplier = cmul(multiplier_a, multiplier_b);\n\n    return cmul(2, cmul(component, multiplier));\n}\n\nconst eta = z => z.re < 0 ? eta_left(z) : eta_right(z);\nconst zeta = z => cdiv(eta(z), csub(1, cexp(cmul(Math.LN2, csub(1, z)))));\n\n// Small z: https://math.stackexchange.com/questions/712434/erfaib-error-function-separate-into-real    -and-imaginary-part\n// Large z: Expansion around infinity.\nfunction erf_large(z) {\n    const k = cmul_i(creciprocal(z));\n    const k2 = csquare(k);\n    const corrections = cdiv(\n        cmul(k, cadd(1, cmul(k2, cadd(0.5, cmul(0.75, k2))))),\n        math.sqrt(Math.PI)\n    );\n    return cadd(1, cmul_i(cmul(cexp(csquare(cmul_i(z))), corrections)));\n}\n\nfunction erf(z) {\n    if (Math.abs(z.im) > 8.5) {\n        return erf_large(z);\n    }\n\n    const K = math.exp(-z.re*z.re)/Math.PI;\n    const q = 4*z.re*z.re;\n    const a = math.cos(2*z.re*z.im);\n    const b = math.sin(2*z.re*z.im);\n\n    const series = [math.erf(z.re), cmul(K/(2*z.re), math.complex(1-a, b))];\n    for (let k = 1; k < 65; k++) {\n        const kk = k*k/4 + z.re*z.re;\n        const e1 = math.exp(k*z.im - kk)/2;\n        const e2 = math.exp(-k*z.im - kk)/2;\n        const multiplier = 1/(k*k+q) * 2/Math.PI;\n        const re = multiplier * (2*z.re*(math.exp(-kk)-a*(e1+e2)) + k*b*(e1-e2));\n        const im = multiplier * (2*z.re*b*(e1+e2) + k*a*(e1-e2));\n        series.push(math.complex(re, im));\n    }\n\n    return math.sum(series);\n}\n\n/***** Elliptic Functions *****/\nfunction theta00(z, tau) {\n    let result = 1;\n    for (let n = 1; n < 8; n++) {\n        const A = math.complex(0, Math.PI * n);\n        const B = cmul(A, 2, z);\n        const C = cmul(A, n, tau);\n        result = cadd(\n            result,\n            cexp(cadd(C, B)),\n            cexp(csub(C, B))\n        );\n    }\n    return result;\n}\nconst theta01 = (z, tau) => theta00(cadd(z, 0.5), tau);\nconst theta10 = (z, tau) => cmul(\n    cexp(cmul(math.complex(0, Math.PI/4), cadd(tau, cmul(4, z)))),\n    theta00(cadd(z, cmul(0.5, tau)), tau)\n);\nconst theta11 = (z, tau) => cmul(\n    cexp(cmul(math.complex(0, Math.PI/4), cadd(tau, cmul(4, z), 2))),\n    theta00(cadd(z, cmul(0.5, tau), 0.5), tau)\n);\n\nfunction invert_tau(k) {\n    const root_k = csqrt(csqrt(csub(1, cmul(k, k))));\n    const l = cmul(0.5, cdiv(csub(1, root_k), cadd(1, root_k)));\n    const q = cadd(\n        l,\n        cmul(2, cpow(l, 5)),\n        cmul(15, cpow(l, 9)),\n        cmul(150, cpow(l, 13))\n    );\n    return cmul(clog(q), math.complex(0, -1/Math.PI));\n}\n\nfunction jacobi_reduce(z, k) {\n    const tau = invert_tau(k);\n    const t00 = theta00(0, tau);\n    const zz = cdiv(z, cmul(Math.PI, t00, t00));\n    const n = 2 * Math.round(0.5 * zz.im/tau.im);\n    return [csub(zz, cmul(n, tau)), tau];\n}\n\nfunction raw_sn(zz, tau) {\n    return cdiv(cmul(\n        -1, theta00(0, tau), theta11(zz, tau)\n    ), cmul(\n        theta10(0, tau), theta01(zz, tau)\n    ));\n}\n\nfunction raw_cn(zz, tau) {\n    return cdiv(cmul(\n        theta01(0, tau), theta10(zz, tau)\n    ), cmul(\n        theta10(0, tau), theta01(zz, tau)\n    ));\n}\n\nfunction raw_dn(zz, tau) {\n    return cdiv(cmul(\n        theta01(0, tau), theta00(zz, tau)\n    ), cmul(\n        theta00(0, tau), theta01(zz, tau)\n    ));\n}\n\nconst sn = (z, k) => raw_sn(...jacobi_reduce(z, k));\nconst cn = (z, k) => raw_cn(...jacobi_reduce(z, k));\nconst dn = (z, k) => raw_dn(...jacobi_reduce(z, k));\n\n\n// Weierstrass p-function\nfunction wp(z, tau) {\n    const n = Math.round(z.im/tau.im);\n    const zz = csub(z, cmul(n, tau));\n\n    const t002 = csquare(theta00(0, tau));\n    const t102 = csquare(theta10(0, tau));\n    const e2 = cmul(-Math.PI*Math.PI/3, cadd(csquare(t102), csquare(t002)));\n    return cadd(cmul(\n        Math.PI*Math.PI,\n        t002, t102,\n        csquare(cdiv(theta01(zz, tau), theta11(zz, tau)))\n    ), e2);\n}\n\nfunction raw_wpp(zz, A, tau) {\n    return cmul(\n        -2,\n        cpow(cdiv(A, raw_sn(zz, tau)), 3),\n        raw_cn(zz, tau), raw_dn(zz, tau)\n    );\n}\n\nfunction wpp(z, tau) {\n    const t004 = csquare(csquare(theta00(0, tau)));\n    const t104 = csquare(csquare(theta10(0, tau)));\n    const t014 = csquare(csquare(theta01(0, tau)));\n\n    const PI2_3 = Math.PI * Math.PI / 3;\n    const e1 = cmul(PI2_3, cadd(t004, t014));\n    const e2 = cmul(-PI2_3, cadd(t104, t004));\n    const e3 = cmul(PI2_3, csub(t104, t014));\n    const A = csqrt(csub(e1, e3));\n    const B = csqrt(csub(e2, e3));\n\n    const u = cmul(z, A);\n    const k = cdiv(B, A);\n    const [zz, tau2] = jacobi_reduce(u, k);\n\n    return raw_wpp(zz, A, tau2);\n}\n\n\n// Dixon elliptic functions\nconst e2 = math.complex(0.20998684165, 0);\nconst e1 = math.complex(-0.10499342083, 0.18185393933);\nconst e3 = math.complex(-0.10499342083, -0.18185393933);\n\nconst A = csqrt(csub(e1, e3));\nconst B = csqrt(csub(e2, e3));\nconst k = cdiv(B, A);\n\nfunction cm(z) {\n    const u = cmul(z, A);\n    const [zz, tau] = jacobi_reduce(u, k);\n    return cadd(1, cdiv(2, csub(cmul(3, raw_wpp(zz, A, tau)), 1)));\n}\n\nfunction sm(z) {\n    return cm(csub(1.7666387502854499, z));\n}\n\nfunction dot(z, w) {return z.re * w.re + z.im * w.im;}\n\nfunction lattice_reduce(z) {\n    if (z.im < 0) {return math.complex(0, 1/0);}\n    const coeffs = [math.complex(1, 0), I];\n    let a = z;\n    let b = math.complex(1, 0);\n    for (let i = 0; i < 16; i++) {\n        let mu = Math.round(dot(a, b)/dot(b, b));\n        a = csub(a, cmul(mu, b));\n        coeffs[0] = csub(coeffs[0], cmul(mu, coeffs[1]));\n\n        mu = Math.round(dot(a, b)/dot(a, a));\n        b = csub(b, cmul(mu, a));\n        coeffs[1] = csub(coeffs[1], cmul(mu, coeffs[0]));\n    }\n    const num = cadd(cmul(coeffs[0].re, z), coeffs[0].im);\n    const denom = cadd(cmul(coeffs[1].re, z), coeffs[1].im);\n    const res = cdiv(num, denom);\n    if (math.abs(res) < 1) {return cdiv(-1, res);}\n    return res;\n}\n\nfunction j(z) {\n    z = lattice_reduce(z);\n    const a = theta10(0, z);\n    const b = theta00(0, z);\n    const c = theta01(0, z);\n\n    return cmul(32, cdiv(\n        cpow(cadd(cadd(cpow(a, 8), cpow(b, 8)), cpow(c, 8)), 3),\n        cpow(cmul(a, cmul(b, c)), 8)\n    ));\n}\n\nexport {\n    zeta, eta, gamma, erf,\n    theta00, theta01, theta10, theta11,\n    sn, cn, dn,\n    wp, wpp,\n    sm, cm,\n    j\n};\n","import {get, isNil} from 'lodash';\nimport {\n    zeta, eta, gamma, erf,\n    theta00, theta01, theta10, theta11,\n    sn, cn, dn,\n    wp, wpp,\n    sm, cm,\n    j,\n} from './custom-functions.js'\nconst math = require('mathjs');\n\nconst constants = {\n    'e': Math.E,\n    'pi': Math.PI,\n    'tau': 2 * Math.PI,\n    'phi': (1 + Math.sqrt(5))/2,\n}\n\nconst add4 = (a, b, c, d) => math.add(math.add(a, b), math.add(c, d));\n\nconst I = math.complex(0, 1);\nconst fns = {\n    add8: (a, b, c, d, e, f, g, h) => math.add(add4(a, b, c, d), add4(e, f, g, h)),\n    add4,\n    mul4: (a, b, c, d) => math.multiply(math.multiply(a, b), math.multiply(c, d)),\n    rawpow: math.pow,\n    sub: math.subtract,\n    neg: math.unaryMinus,\n    mul: math.multiply,\n    div: math.divide,\n    reciprocal: z => math.divide(1, z),\n    component_mul: (z, alpha) => math.complex(alpha*z.re, alpha*z.im),\n    component_mul_prelog: (z, alpha) => math.complex(math.exp(alpha)*z.re, math.exp(alpha)*z.im),\n    real: math.re,\n    imag: math.im,\n    step: z => (z.re >= 0) ? 1 : 0,\n\n    arcsin: math.asin,\n    arccos: math.acos,\n    arctan: math.atan,\n    arcsec: math.asec,\n    arccsc: math.acsc,\n    arccot: math.acot,\n\n    arsinh: math.asinh,\n    arcosh: math.acosh,\n    artanh: math.atanh,\n    arsech: math.asech,\n    arcsch: math.acsch,\n    arcoth: math.acoth,\n\n    cis: z => math.exp(math.multiply(z, I)),\n\n    gamma,\n    eta,\n    zeta,\n    erf,\n\n//    factorial: z => gamma(math.add(z, 1)),\n\n    theta00, theta01, theta10, theta11,\n    sn, cn, dn,\n    wp, wpp,\n    sm, cm,\n    j,\n}\n\n/**\n * Returns a JS function that evaluates\n * the given AST.\n *\n * Inputs of the returned function\n * are [real, imag],\n * representing the complex input.\n * The returned function outputs a\n * 2-tuple [real, imag]\n * representing the complex output.\n */\nfunction toJS(ast, variables) {\n    const errorValue = [NaN, NaN];\n    if (ast === null) {return z => errorValue;}\n    if (!isNaN(ast)) {return z => [ast, 0];}\n\n    // Destructure this level of the AST\n    const [operator, ...args] = ast;\n\n    // Complex number literal\n    if (operator === 'number') {return z => args;}\n\n    // User-defined variable\n    if (operator === 'variable') {\n        const [name] = args;\n        if (name === 'z') {return z => z;}\n        return z => [get(variables, name, NaN), 0];\n    }\n\n    // Built-in constant\n    if (operator === 'constant') {\n        const [name] = args;\n        return z => [constants[name], 0];\n    }\n\n    // Built-in function\n    const func = fns[operator] || math[operator];\n    if (!isNil(func)) {\n        const destructure = z => isNil(z.re) ? [z, 0] : [z.re, z.im];\n        return z => destructure(func(...args.map(\n                subtree => math.complex(...toJS(subtree, variables)(z))\n        )));\n    }\n\n    // Fallback if no match\n    return z => errorValue;\n}\n\nexport {constants, fns};\nexport default toJS;\n","// Substitute bound variable with value in AST\nfunction substitute(ast, name, value) {\n    if (!Array.isArray(ast)) {return ast;}\n    if (ast[0] === 'variable' && ast[1] === name) {return value;}\n    return ast.map(x => substitute(x, name, value));\n}\n\nfunction contains(ast, name) {\n    if (!Array.isArray(ast)) {return false;}\n    if (ast[0] === 'variable' && ast[1] === name) {return true;}\n    return ast.some(x => contains(x, name));\n}\n\nconst ZERO = ['number', 0, 0];\nconst ONE = ['number', 1, 0];\n\nconst diffTable = {\n    'sin': x => ['cos', x],\n    'cos': x => ['neg', ['sin', x]],\n    'tan': x => ['square', ['sec', x]],\n    'sec': x => ['mul', ['sec', x], ['tan', x]],\n    'csc': x => ['neg', ['mul', ['csc', x], ['cot', x]]],\n    'cot': x => ['neg', ['square', ['csc', x]]],\n    'arcsin': x => ['reciprocal', ['sqrt', ['sub', ONE, ['square', x]]]],\n    'arccos': x => ['neg', ['reciprocal', ['sqrt', ['sub', ONE, ['square', x]]]]],\n    'arctan': x => ['reciprocal', ['add', ONE, ['square', x]]],\n    'arcsec': x => ['reciprocal', ['mul', ['square', x], ['sqrt', ['sub', ONE, ['reciprocal', ['square', x]]]]]],\n    'arccsc': x => ['neg', ['reciprocal', ['mul', ['square', x], ['sqrt', ['sub', ONE, ['reciprocal', ['square', x]]]]]]],\n    'arccot': x => ['neg', ['reciprocal', ['add', ONE, ['square', x]]]],\n\n    'sinh': x => ['cosh', x],\n    'cosh': x => ['sinh', x],\n    'tanh': x => ['square', ['sech', x]],\n    'sech': x => ['neg', ['mul', ['tanh', x], ['sech', x]]],\n    'csch': x => ['neg', ['mul', ['coth', x], ['csch', x]]],\n    'coth': x => ['neg', ['square', ['csch', x]]],\n    'arsinh': x => ['reciprocal', ['sqrt', ['add', ['square', x], ONE]]],\n    'arcosh': x => ['reciprocal', ['mul', ['sqrt', ['sub', x, ONE]], ['sqrt', ['add', x, ONE]]]],\n    'artanh': x => ['reciprocal', ['sub', ONE, ['square', x]]],\n//    'arsech': x => ['neg', ['reciprocal', ['mul', ['mul', ['sqrt', ['add', ['reciprocal', x], ONE]], ['sqrt', ['sub', ['reciprocal', x], ONE]]], ['square', x]]]],\n    'arcsch': x => ['neg', ['reciprocal', ['mul', ['square', x], ['sqrt', ['add', ONE, ['reciprocal', ['square', x]]]]]]],\n    'arcoth': x => ['reciprocal', ['sub', ['square', x], ONE]],\n\n    'exp': x => ['exp', x],\n    'cis': x => ['mul_i', ['cis', x]],\n    'log': x => ['reciprocal', x],\n\n    'square': x => ['component_mul', x, 2],\n    'sqrt': x => ['reciprocal', ['component_mul', ['sqrt', x], 2]],\n}\n\n// Analytically compute the derivative of the given AST\n// with respect to variable `arg`.\nfunction diff(ast, arg, compile) {\n    if (ast === null) {return null;}\n    if (arg[0] !== 'variable') {return null;}\n\n    if (!Array.isArray(ast)) {return ZERO;}\n    if (ast[0] === 'constant' || ast[0] === 'number') {return ZERO;}\n    if (ast[0] === 'variable') {return (ast[1] === arg[1]) ? ONE : ZERO;}\n\n    if (!contains(ast, arg[1])) {return ZERO;}\n\n    const [operator, ...args] = ast;\n\n    // Sum rule\n    if (operator === 'add' || operator === 'sub') {\n        return compile([operator, ...args.map(x => diff(x, arg, compile))]);\n    }\n    \n    // Product rule\n    if (operator === 'mul') {\n        return compile(['add',\n            compile(['mul', args[0], diff(args[1], arg, compile)]),\n            compile(['mul', args[1], diff(args[0], arg, compile)]),\n        ]);\n    }\n    \n    if (operator === 'component_mul') {\n        return compile(['component_mul', diff(args[0], arg, compile), args[1]]);\n    }\n\n    // Quotient rule\n    if (operator === 'div') {\n        return compile(['div',\n            compile(['sub',\n                compile(['mul', args[1], diff(args[0], arg, compile)]),\n                compile(['mul', args[0], diff(args[1], arg, compile)])\n            ]),\n            ['square', compile(args[1])],\n        ]);\n    }\n\n    // Chain rule (analytic derivative).\n    const [analyticDiff, internal] = [diffTable[ast[0]], ast[1]];\n    if (analyticDiff !== undefined) {\n        return compile(['mul', diff(internal, arg, compile), compile(analyticDiff(internal))]);\n    }\n\n    // Numerical fallback.\n    console.log('numerical fallback:', ast, arg);\n    return numericalDiff(ast, arg, compile);\n}\n\nfunction numericalDiff(ast, arg, compile) {\n    const dz = 1e-2; // Finite difference step\n    if (arg[0] !== 'variable') {return null;}\n\n    const high = compile(substitute(ast, arg[1], ['add', arg, ['number', dz, 0]]));\n    const low = compile(substitute(ast, arg[1], ['sub', arg, ['number', dz, 0]]));\n\n    return ['component_mul', ['sub', high, low], 1/(2*dz)];\n}\n\nexport {substitute};\nexport default diff;\n","/*****\n * Compile higher-order constructs in AST,\n * and perform some AST optimizations.\n */\nimport {constants, fns} from './to-js.js';\nimport diff, {substitute} from './derivative.js';\n\nconst math = require('mathjs');\n\n\n// Return AST where binary operation `op` is applied\n// between all given terms (AST).\nfunction compose(terms, op, op4, op8) {\n    // Empty sum/product\n    if (terms.length === 0) {return (op === 'sum') ? ['number', 0, 0] : ['number', 1, 0];}\n\n    // Trivial sum/product\n    if (terms.length === 1) {return terms[0]};\n\n    // Distribute evenly for faster computation\n    const N = Math.floor(terms.length/2);\n    const app = (a, b) => compose(terms.slice(a, b), op, op4, op8);\n\n    if (N >= 4 && op8 !== undefined) {\n        const NN = Math.floor(N/2);\n        const NNN = Math.floor(N/4);\n        return compile([op8,\n            app(0, NNN), app(NNN, NN), app(NN, NN+NNN), app(NN+NNN, N),\n            app(N, N+NNN), app(N+NNN, N+NN), app(N+NN, N+NN+NNN), app(N+NN+NNN, undefined)\n        ]);\n    } else {\n        if (N >= 2 && op4 !== undefined) {\n            const NN = Math.floor(N/2);\n            return compile([op4, app(0, NN), app(NN, N), app(N, N+NN), app(N+NN, undefined)]);\n        } else {\n            return compile([op, compose(terms.slice(0, N), op), compose(terms.slice(N), op)]);\n        }\n    }\n}\n\n// Apply sum or product operator.\nfunction sumProd(operator, args) {\n    // Evaluate lower/upper bounds\n    args[2] = compile(args[2]);\n    args[3] = compile(args[3]);\n    \n    if (args[1][0] !== 'variable') {return null;}\n    if (args[2][0] !== 'number') {return null;}\n    if (args[3][0] !== 'number') {return null;}\n\n    const idxVar = args[1][1];\n    const low = args[2][1];\n    const high = args[3][1];\n    const termAST = args[0];\n\n    const terms = [];\n    for (let i = low; i <= high; i++) {\n        terms.push(compile(substitute(termAST, idxVar, ['number', i, 0])));\n    }\n\n    if (operator === 'sum') {return compose(terms, 'add', 'add4', 'add8');} // Log-cartesian\n//    if (operator === 'sum') {return compose(terms, 'add');} // Cartesian\n    if (operator === 'prod') {return compose(terms, 'mul', 'mul4');}\n}\n\nfunction getConst(val) {\n    let re = null;\n    let im = null;\n\n    if (!isNaN(val)) {re = val; im = 0;}\n    if (val[0] === 'number') {re = val[1]; im = val[2];}\n    if (val[0] === 'constant') {re = constants[val[1]]; im = 0;}\n\n    return math.complex(re, im);\n}\n\nfunction destructure(val) {\n    if (val.re === undefined) {return ['number', val, 0];}\n    return ['number', val.re, val.im];\n}\n\nfunction isConst(ast) {\n    return !isNaN(ast) || ast[0] === 'number' || ast[0] === 'constant';\n}\n\nfunction isZero(ast) {\n    return ast[0] === 'number' && ast[1] === 0 && ast[2] === 0;\n}\n\n\n// Optimize AST, and expand any higher-order constructs.\nfunction compile(ast) {\n    if (!Array.isArray(ast)) {return ast;}\n\n    let [operator, ...args] = ast;\n    if (operator === 'number' || operator === 'variable' || operator === 'constant') {\n        return ast;\n    }\n\n    // Higher-order functions\n    if (operator === 'sum' || operator === 'prod') {\n        return sumProd(operator, args);\n    }\n\n    args = args.map(compile);\n    if (operator === 'diff') {\n        return diff(args[0], args[1], compile);\n    }\n\n    // Aliases\n    if (operator === 'factorial') {return compile(['gamma', ['add', args[0], ['number', 1, 0]]]);}\n\n\n    // Evaluate if all arguments are constant\n    if (args.every(isConst)) {\n        const fn = fns[operator] || math[operator];\n        return destructure(fn(...args.map(getConst)));\n    }\n\n    // Optimizations\n    if (operator === 'add') {\n        if (isZero(args[0])) {return args[1];}\n        if (isZero(args[1])) {return args[0];}\n    }\n\n    if (operator === 'sub') {\n        if (isZero(args[0])) {return compile(['neg', args[1]]);}\n        if (isZero(args[1])) {return args[0];}\n    }\n\n    if (operator === 'div') {\n        if (isConst(args[1])) {\n            return compile(['mul', compile(['reciprocal', args[1]]), args[0]]);\n        }\n\n        if (isConst(args[0])) {\n            return compile(['mul', args[0], compile(['reciprocal', args[1]])]);\n        }\n    }\n\n    if (operator === 'mul') {\n        // Place constant in front\n        if (isConst(args[1])) {args = [args[1], args[0]];}\n\n        // Deal with constant case\n        if (isConst(args[0])) {\n            const val = getConst(args[0]);\n\n            if (val.re === 0 && val.im === 0) {return ['number', 0, 0];}\n\n            // Real scale factor\n            if (val.im === 0) {\n                if (val.re === 1) {return args[1];}\n                if (val.re === -1) {return ['neg', args[1]];}\n//                return compile(['component_mul', args[1], val.re]);\n                return compile(['component_mul_prelog', args[1], math.log(val.re)]);\n            }\n        }\n    }\n\n    if (operator === 'component_mul') {\n        if (args[1] === 0 || isZero(args[0])) {return ['number', 0, 0];}\n    }\n\n    if (operator === 'pow') {\n        if (isConst(args[0])) {\n            return ['exp', compile(['mul', compile(['log', args[0]]), args[1]])];\n        }\n\n        if (isConst(args[1])) {\n            const val = getConst(args[1]);\n            const subAST = compile(args[0]);\n            if (val.im === 0) {\n                if (val.re === -1) {return ['reciprocal', subAST];}\n                if (val.re === 0) {return ['number', 1, 0];}\n                if (val.re === 0.5) {return ['sqrt', subAST];}\n                if (val.re === 1) {return subAST;}\n                if (val.re === 2) {return ['square', subAST];}\n//                if (Number.isInteger(val.re)) {return ['rawpow', subAST, val.re];} // LOG_MODE only\n//                return ['exp', ['component_mul', ['log', subAST], val.re]]; // Cartesian only\n                return ['exp', ['component_mul_prelog', ['log', subAST], math.log(val.re)]]; // Cartesian only\n            }\n        }\n\n//        return ['exp', ['mul', ['log', args[0]], args[1]]]; // Cartesian only\n    }\n\n    return [operator, ...args];\n}\n\nexport default compile;\n","import nearley from 'nearley';\nimport grammar from './grammar.js';\n\nimport compile from './translators/compiler.js';\n\nconst compiledGrammar = nearley.Grammar.fromCompiled(grammar);\n\nconst argument_names = ['z', 'w', 'w1', 'w2', 'w3', 'w4', 'w5', 'w6'];\n\nclass ComplexFunction {\n    constructor(name, body, log_body, dependencies, log_dep, num_args) {\n        // If no log_body defined, assume it's the same\n        if (Array.isArray(log_body) || log_body === undefined) {\n            num_args = dependencies;\n            dependencies = log_body;\n            log_body = body;\n            log_dep = dependencies;\n        }\n\n        if (num_args === undefined) {num_args = 1;}\n\n        this.name = name;\n        this.body = body;\n        this.log_body = log_body;\n        this.dependencies = dependencies || [];\n        this.log_dependencies = log_dep || this.dependencies;\n        this.num_args = num_args;\n    }\n\n    apply(...parameters) {\n        return `${this.name}(${parameters.join(', ')})`;\n    }\n\n    get declaration() {\n        const types = Array(this.num_args);\n        types.fill('VEC_TYPE');\n        return `VEC_TYPE ${this.name}(${types.join(', ')});`\n    }\n\n    get params() {\n        let parameters = [];\n        for (let i = 0; i < this.num_args; i++) {\n            parameters.push(`VEC_TYPE ${argument_names[i]}`);\n        }\n        return parameters.join(', ');\n    }\n\n    get code() {\n        return `vec2 ${this.name}(${this.params}) {${this.body}}`;\n    }\n\n    get log_code() {\n        if (this.log_body === null) {return null;}\n        return `vec3 ${this.name}(${this.params}) {${this.log_body}}`;\n    }\n}\n\nclass DummyFunction {\n    constructor(dependencies, log_dependencies) {\n        this.dependencies = dependencies || [];\n        this.log_dependencies = log_dependencies || [];\n    }\n    get declaration() {return '';}\n    get log_declaration() {return '';}\n    get code() {return '';}\n    get log_code() {return '';}\n}\n\nclass ComponentMul extends ComplexFunction {\n    get declaration() {return `VEC_TYPE ${this.name}(VEC_TYPE, float);`}\n    get code() {return `vec2 ${this.name}(vec2 z, float w) {${this.body}}`;}\n    get log_code() {return `vec3 ${this.name}(vec3 z, float w) {${this.log_body}}`;}\n}\nclass ZetaHelper extends ComplexFunction {\n    get declaration() {return `vec4 ${this.name}(VEC_TYPE, mat4, mat4);`}\n    get code() {return `vec4 ${this.name}(VEC_TYPE z, mat4 ns, mat4 bases) {${this.body}}`;}\n    get log_code() {return `vec4 ${this.name}(VEC_TYPE z, mat4 ns, mat4 bases) {${this.log_body}}`;}\n}\nclass ZetaHelper2 extends ComplexFunction {\n    get declaration() {return `VEC_TYPE ${this.name}(VEC_TYPE, mat4, mat4);`}\n    get code() {return `vec2 ${this.name}(VEC_TYPE z, mat4 bases, mat4 coeffs) {${this.body}}`;}\n    get log_code() {return `vec3 ${this.name}(VEC_TYPE z, mat4 bases, mat4 coeffs) {${this.log_body}}`;}\n}\nclass LatticeReduce extends ComplexFunction {\n    get declaration() {return `VEC_TYPE ${this.name}(vec2);`}\n    get code() {return `VEC_TYPE ${this.name}(vec2 z) {${this.body}}`;}\n    get log_code() {return this.code;}\n}\n\n/***** BEGIN FUNCTION DEFINITIONS *****/\n\n// Miscellaneous\nconst mul_i = new ComplexFunction('cmul_i', 'return vec2(-z.y, z.x);', 'return vec3(-z.y, z.x, z.z);');\nconst creciprocal = new ComplexFunction('creciprocal',\n'return cconj(z) / dot(z, z);',\n'return vec3(cconj(z).xy/dot(z.xy, z.xy), -z.z);',\n['conj'], ['conj']);\nconst cconj = new ComplexFunction('cconj', 'return vec2(z.x, -z.y);', 'return vec3(z.x, -z.y, z.z);');\nconst cabs = new ComplexFunction('cabs', 'return vec2(length(z), 0);', 'return vec3(length(z.xy), 0, z.z);');\nconst carg = new ComplexFunction('carg', 'return vec2(atan(z.y, z.x), 0);', 'return vec3(atan(z.y, z.x), 0, 0);');\nconst csgn = new ComplexFunction('csgn', 'return normalize(z);', 'return vec3(normalize(z.xy), 0);');\nconst creal = new ComplexFunction('creal', 'return vec2(z.x, 0);', 'return vec3(z.x, 0, z.z);');\nconst cimag = new ComplexFunction('cimag', 'return vec2(z.y, 0);', 'return vec3(z.y, 0, z.z);');\nconst cfloor = new ComplexFunction('cfloor', 'return floor(z);', 'if (z.z > 20.) {return z;} else {return vec3(floor(downconvert(z).xy), 0);}');\nconst cceil = new ComplexFunction('cceil', 'return floor(z + vec2(0.9999999, 0.9999999));', 'if (z.z > 20.) {return z;} else {return vec3(floor(downconvert(z).xy + vec2(0.9999999, 0.9999999)), 0);}'); // Built-in ceil fails on iOS\nconst cround = new ComplexFunction('cround', 'return floor(z + vec2(0.5, 0.5));', 'if (z.z > 20.) {return z;} else {return vec3(floor(downconvert(z).xy + vec2(0.5, 0.5)), 0);}');\nconst cstep = new ComplexFunction('cstep', 'return vec2(step(0., z.x), 0);', 'return vec3(step(0., z.x), 0, 0);')\n\n// Exponentials\nconst ccis = new ComplexFunction('ccis', 'return cexp(cmul_i(z));', ['exp', 'mul_i']);\nconst cexp_raw = new ComplexFunction('cexp_raw', // ASSUME DOWNCONVERTED\n`float phase = z.y;\nreturn exp(max(z.x, -50.)) * vec3(cos(phase), sin(phase), 0).COMPONENTS;`);\nconst cexp = new ComplexFunction('cexp',\n`float phase = z.y;\nreturn exp(z.x) * vec2(cos(phase), sin(phase));`,\n`float phase = mod(z.y * exp(z.z), TAU);\nreturn vec3(cos(phase), sin(phase), z.x * exp(z.z));`);\nconst clog = new ComplexFunction('clog',\n`float magnitude = log(length(z));\nfloat phase = atan(z.y, z.x);\nreturn vec2(magnitude, phase);`,\n`return vec3(log(length(z.xy)) + z.z, atan(z.y, z.x), 0.);`);\nconst csqrt = new ComplexFunction('csqrt',\n`float magnitude = length(z);\nfloat phase = 0.5 * atan(z.y, z.x);\nreturn sqrt(magnitude) * vec2(cos(phase), sin(phase));`,\n`float magnitude = length(z.xy);\nfloat phase = 0.5 * atan(z.y, z.x);\nreturn vec3(sqrt(magnitude) * vec2(cos(phase), sin(phase)), 0.5*z.z);`)\nconst csquare = new ComplexFunction('csquare',\n`float magnitude = length(z);\nfloat phase = atan(z.y, z.x) * 2.0;\nreturn (magnitude * magnitude) * vec2(cos(phase), sin(phase));`,\n`float magnitude = length(z.xy);\nfloat phase = atan(z.y, z.x) * 2.0;\nreturn vec3((magnitude * magnitude) * vec2(cos(phase), sin(phase)), 2.*z.z);`);\n\n// Trigonometry //\n// Basic Trigonometric Functions\nconst csin = new ComplexFunction('csin',\n`VEC_TYPE iz = cmul_i(z);\nreturn ccomponent_mul(cmul_i(csub(cexp(iz), cexp(cneg(iz)))), -0.5);`,\n['neg', 'sub', 'mul_i', 'exp', 'component_mul']);\nconst ccos = new ComplexFunction('ccos',\n`VEC_TYPE iz = cmul_i(z);\nreturn ccomponent_mul(cadd(cexp(iz), cexp(cneg(iz))), 0.5);`,\n['neg', 'add', 'mul_i', 'exp', 'component_mul']);\nconst ctan = new ComplexFunction('ctan', 'return cmul_i(ctanh(cneg(cmul_i(z))));', ['mul_i', 'tanh', 'neg']);\nconst csec = new ComplexFunction('csec', 'return creciprocal(ccos(z));',\n    ['reciprocal', 'cos']);\nconst ccsc = new ComplexFunction('ccsc', 'return creciprocal(csin(z));',\n    ['reciprocal', 'sin']);\nconst ccot = new ComplexFunction('ccot', 'return creciprocal(ctan(z));',\n    ['reciprocal', 'tan']);\n\n// Inverse Trigonomeric Functions\nconst carcsin = new ComplexFunction('carcsin',\n`VEC_TYPE a = csqrt(csub(ONE, csquare(z)));\nif (z.y < 0.) {\n    return cneg(cmul_i(clog(cadd(a, cmul_i(z)))));\n} else {\n    return cneg(cmul_i(cneg(clog(csub(a, cmul_i(z))))));\n}`,\n['sqrt', 'square', 'mul_i', 'log', 'add', 'sub', 'neg']);\n\n\nconst carccos = new ComplexFunction('carccos',\n'return csub(0.5*C_PI, carcsin(z));',\n['arcsin', 'sub']);\nconst carctan = new ComplexFunction('carctan',\n`VEC_TYPE iz = cmul_i(z);\nreturn ccomponent_mul(cmul_i(csub(clog(csub(ONE, iz)), clog(cadd(ONE, iz)))), 0.5);`,\n['mul_i', 'log', 'component_mul', 'add', 'sub']);\n\nconst carccot = new ComplexFunction('carccot', 'return carctan(creciprocal(z));', ['arctan', 'reciprocal']);\nconst carcsec = new ComplexFunction('carcsec', 'return carccos(creciprocal(z));', ['arccos', 'reciprocal']);\nconst carccsc = new ComplexFunction('carccsc', 'return carcsin(creciprocal(z));', ['arcsin', 'reciprocal']);\n\n\n// Hyperbolic Trigonometric Functions\nconst csinh = new ComplexFunction('csinh',\n`VEC_TYPE exp_z = cexp(z); return ccomponent_mul(csub(exp_z, creciprocal(exp_z)), 0.5);`,\n['exp', 'sub', 'component_mul', 'reciprocal']);\nconst ccosh = new ComplexFunction('ccosh',\n`VEC_TYPE exp_z = cexp(z); return ccomponent_mul(cadd(exp_z, creciprocal(exp_z)), 0.5);`,\n['exp', 'add', 'component_mul', 'reciprocal']);\nconst ctanh = new ComplexFunction('ctanh',\n`VEC_TYPE a = cexp(ccomponent_mul(z, 2.));\nVEC_TYPE b = creciprocal(a);\nif (z.x > 0.0) {\n   return cdiv(csub(ONE, b), cadd(ONE, b));\n} else {\n   return cdiv(csub(a, ONE), cadd(a, ONE));\n}`,\n['exp', 'component_mul', 'reciprocal', 'sub', 'add', 'div']);\nconst csech = new ComplexFunction('csech',\n    'return creciprocal(ccosh(z));', ['reciprocal', 'cosh']);\nconst ccsch = new ComplexFunction('ccsch',\n    'return creciprocal(csinh(z));', ['reciprocal', 'sinh']);\nconst ccoth = new ComplexFunction('ccoth', 'return creciprocal(ctanh(z));', ['reciprocal', 'tanh']);\n\n// Inverse hyperbolic trigonometric functions\nconst carsinh = new ComplexFunction('carsinh',\n'return cneg(cmul_i(carcsin(cmul_i(z))));',\n['mul_i', 'arcsin', 'neg']);\nconst carcosh = new ComplexFunction('carcosh',\n'return cneg(cmul_i(carccos(z)));',\n['mul_i', 'arccos', 'neg']);\nconst cartanh = new ComplexFunction('cartanh',\n'return cneg(cmul_i(carctan(cmul_i(z))));',\n['mul_i', 'arctan', 'neg']);\nconst carsech = new ComplexFunction('carsech',\n'return cneg(cmul_i(carcsec(z)));',\n['mul_i', 'arcsec', 'neg']);\nconst carcsch = new ComplexFunction('carcsch',\n'return cneg(cmul_i(carccsc(cneg(cmul_i(z)))));',\n['mul_i', 'arccsc', 'neg']);\nconst carcoth = new ComplexFunction('carcoth',\n'return cneg(cmul_i(carccot(cneg(cmul_i(z)))));',\n['mul_i', 'arccot', 'neg']);\n\n\n// Infix Operators //\nconst cneg = new ComplexFunction('cneg', 'return -z;', 'return vec3(-z.xy, z.z);');\nconst cadd = new ComplexFunction('cadd',\n'return z+w;',\n`float diff = z.z - w.z;\nfloat p = step(0., diff);\nvec3 maxarg = p*z + (1.-p)*w;\nvec3 minarg = w+z-maxarg;\nreturn maxarg + vec3(exp(-abs(diff)) * minarg.xy, 0);`,\n[], [], 2);\nconst csub = new ComplexFunction('csub', 'return z-w;', 'return cadd(z, cneg(w));', [], ['add', 'neg'], 2);\nconst cmul = new ComplexFunction('cmul',\n'return mat2(z, -z.y, z.x) * w;',\n'return vec3(mat2(z.xy, -z.y, z.x) * w.xy, z.z+w.z);',\n[], [], 2);\nconst ccomponent_mul = new ComponentMul('ccomponent_mul',\n'return z*w;', 'return vec3(z.xy * w, z.z);', [], [], 2);\nconst ccomponent_mul_prelog = new ComponentMul('ccomponent_mul_prelog',\n'return z*exp(w);', 'return vec3(z.xy, z.z + w);', [], [], 2);\nconst cdiv = new ComplexFunction('cdiv', 'return cmul(z, creciprocal(w));', ['mul', 'reciprocal'], 2);\nconst cpow = new ComplexFunction('cpow', 'return cexp(cmul(clog(z), w));', ['exp', 'mul', 'log'], 2);\nconst cadd4 = new ComplexFunction('cadd4', 'return z+w+w1+w2;',\n`float offset = max(max(z.z, w.z), max(w1.z, w2.z));\nvec4 scales = exp(vec4(z.z, w.z, w1.z, w2.z) - offset);\nreturn vec3(dot(scales, vec4(z.x, w.x, w1.x, w2.x)), dot(scales, vec4(z.y, w.y, w1.y, w2.y)), offset);`,\n[], [], 4);\nconst cadd8 = new ComplexFunction('cadd8', 'return z+w+w1+w2+w3+w4+w5+w6;',\n`float offset = max(max(max(z.z, w.z), max(w1.z, w2.z)), max(max(w3.z, w4.z), max(w5.z, w6.z)));\nvec4 scales1 = exp(vec4(z.z, w.z, w1.z, w2.z) - offset);\nvec4 scales2 = exp(vec4(w3.z, w4.z, w5.z, w6.z) - offset);\nreturn vec3(\n    dot(scales1, vec4(z.x, w.x, w1.x, w2.x))\n    + dot(scales2, vec4(w3.x, w4.x, w5.x, w6.x)),\n    dot(scales1, vec4(z.y, w.y, w1.y, w2.y))\n    + dot(scales2, vec4(w3.y, w4.y, w5.y, w6.y)),\n    offset\n);`,\n[], [], 8);\nconst cmul4 = new ComplexFunction('cmul4', 'return cmul(cmul(z, w), cmul(w1, w2));',\n'return cmul(upconvert(cmul(z, w)), upconvert(cmul(w1, w2)));', ['mul'], ['mul'], 4);\n\n// Gamma function\nconst cgamma = new ComplexFunction('cgamma',\n'if (z.x < 0.5) {return cgamma_left(z);} else {return cgamma_right(z);}',\n'if (z.x * exp(z.z) < 0.5) {return cgamma_left(z);} else {return cgamma_right(z);}',\n['cgamma_left', 'cgamma_right'], ['cgamma_left', 'cgamma_right']);\nconst cgamma_left = new ComplexFunction('cgamma_left',\n'return ccomponent_mul_prelog(creciprocal(cmul(csin(ccomponent_mul_prelog(z, LNPI)), cgamma_right(csub(ONE, z)))), LNPI);',\n['mul', 'sin', 'cgamma_right', 'component_mul_prelog', 'reciprocal', 'sub']);\nconst cgamma_right = new ComplexFunction('cgamma_right',\n`vec2 w = z - ONE;\nvec2 t = w + vec2(7.5, 0);\nvec2 x = vec2(0.99999999999980993, 0);\nx += 676.5203681218851 * creciprocal(w + vec2(1, 0));\nx -= 1259.1392167224028 * creciprocal(w + vec2(2, 0));\nx += 771.32342877765313 * creciprocal(w + vec2(3, 0));\nx -= 176.61502916214059 * creciprocal(w + vec2(4, 0));\nx += 12.507343278686905 * creciprocal(w + vec2(5, 0));\nx -= .13857109526572012 * creciprocal(w + vec2(6, 0));\nx += 9.9843695780195716e-6 * creciprocal(w + vec2(7, 0));\nx += 1.5056327351493116e-7 * creciprocal(w + vec2(8, 0));\nreturn sqrt(TAU) * cmul(x, cexp(cmul(clog(t), w + vec2(0.5, 0)) - t));`, // Lanczos approximation\n`vec3 scale_one = exp(-z.z) * ONE;\nvec3 w = z - scale_one;\nvec3 t = w + 7.5 * scale_one;\nvec3 ww = vec3(w.xy, 0);\nvec3 x = vec3(0.99999999999980993, 0, 0);\nx += 676.5203681218851 * creciprocal(ww + scale_one);\nx -= 1259.1392167224028 * creciprocal(ww + 2.*scale_one);\nx += 771.32342877765313 * creciprocal(ww + 3.*scale_one);\nx -= 176.61502916214059 * creciprocal(ww + 4.*scale_one);\nx += 12.507343278686905 * creciprocal(ww + 5.*scale_one);\nx -= .13857109526572012 * creciprocal(ww + 6.*scale_one);\nx += 9.9843695780195716e-6 * creciprocal(ww + 7.*scale_one);\nx += 1.5056327351493116e-7 * creciprocal(ww + 8.*scale_one);\nx.z -= w.z;\nreturn ccomponent_mul(cmul(x, cexp(csub(cmul(clog(t), w + 0.5*scale_one), t))), sqrt(TAU));`, // Lanczos approximation\n['reciprocal', 'mul', 'exp', 'log'], ['sqrt', 'reciprocal', 'sub', 'mul', 'exp', 'log', 'component_mul']);\nconst cfact = new ComplexFunction('cfact', 'return cgamma(cadd(z, ONE));', ['gamma', 'add']);\n\n// Dirichlet eta function\nconst ceta = new ComplexFunction('ceta',\n`z = downconvert(z);\nVEC_TYPE conjugate_mask = vec3(1., 1., 1.).COMPONENTS;\nif (z.y < 0.0) {\n    z = cconj(z);\n    conjugate_mask.y *= -1.;\n}\nVEC_TYPE result;\nif (z.x < 0.) {\n    result = ceta_left(z);\n} else {\n    result = ceta_right(z);\n}\nreturn result * conjugate_mask;`,\n['conj', 'ceta_left', 'ceta_right']);\nconst ceta_left = new ComplexFunction('ceta_left', // ASSUME DOWNCONVERTED\n`z.x *= -1.0;\nvec2 component_a;\nconst float SQ2PI2 = 1.2533141373155001;\nfloat log_r = log(length(z));\nif (z.y > 200.0) {\n    component_a = SQ2PI2 * cmul_i(cexp(\n        vec2(z.x, 0)\n        + (log_r - 1.0) * z\n        - vec2(log_r/2.0, PI/4.0)\n    ));\n} else if (z.y > 20.0) {\n    float theta = atan(z.y, z.x);\n    component_a = SQ2PI2 * cmul_i(cexp(\n        (theta - PI/2.0) * cmul_i(z)\n        + (log_r - 1.0) * z\n        - 0.5 * vec2(log_r, theta)\n    ));\n} else {\n    component_a = cmul(cgamma(z), csin(z * PI/2.0));\n}\nvec2 component_b = cmul(z, ceta_right(z + ONE));\nvec2 multiplier_a = cexp(-log(PI) * (z + ONE));\nvec2 multiplier_b = cdiv(ONE - cexp(-LN2 * (z + ONE)), ONE - cexp(-LN2 * z));\nvec2 component = cmul(component_a, component_b);\nvec2 multiplier = cmul(multiplier_a, multiplier_b);\nreturn 2.0 * cconj(cmul(component, multiplier));`,\n`z.x *= -1.;\nconst float SQ2PI2 = 1.2533141373155001;\nvec3 component_a = cmul(cgamma(z), csin(z * PI/2.));\nvec3 component_b = cmul(z, ceta_right(z + ONE));\nvec3 multiplier_a = cexp(-LNPI * (z + ONE));\nvec3 multiplier_b = cdiv(csub(ONE, cexp(-LN2 * (z + ONE))), csub(ONE, cexp(-LN2 * z)));\nvec3 component = cmul(component_a, component_b);\nvec3 multiplier = cmul(multiplier_a, multiplier_b);\nreturn ccomponent_mul(cconj(cmul(component, multiplier)), 2.);`,\n['mul_i', 'exp', 'mul', 'gamma', 'sin', 'ceta_right', 'div'],\n['mul', 'gamma', 'component_mul', 'sin', 'ceta_right', 'sub', 'div']);\n\n// Charater chi in zeta(z) = chi(1-z) zeta(1-z)\nconst zeta_character = new ComplexFunction('zeta_character', // ASSUME DOWNCONVERTED\n`const VEC_TYPE A = vec3(-1.0 - 2.0*LN2, PI/2.0, 0).COMPONENTS; // -1 + ln(i/4)\nconst VEC_TYPE B = vec3(1.0 + LN2, 0, 0).COMPONENTS;\n\n// Asymptotic approximation to\n// gamma(0.5 * z) / gamma((1-z)/2)\n// Good for Im(z) > 10\nVEC_TYPE zconj = ONE - 2.*z;\nreturn cexp(\n    cmul(z, A + clog(zconj))\n    + 0.5 * (B - clog(z))\n    + (0.5 * LNPI) * zconj\n);`, ['exp', 'mul', 'log']);\nconst ceta_strip = new ComplexFunction('ceta_strip',\n'z = downconvert(z); return cmul(csub(ONE, cexp(LN2 * (ONE - z))), czeta_strip(z));',\n['mul', 'exp', 'sub', 'czeta_strip']);\nconst czeta_helper = new ZetaHelper('czeta_helper', // ASSUME DOWNCONVERTED\n`mat4 phases = z.y*bases;\nfloat cutoff = sqrt(z.y/TAU) + 100. * step(z.y, 120.);\nvec4 res = vec4(0);\nfor (int row = 0; row < 4; row++) {\n  vec4 mags = exp(z.x*bases[row]);\n  vec4 cutoff = clamp(0.884*(cutoff-ns[row] + 0.5), 0., 1.);\n  vec4 mags2 = cutoff/(ns[row] * mags);\n  mags *= cutoff;\n  vec4 re = cos(phases[row]);\n  vec4 im = sin(phases[row]);\n  res += vec4(dot(mags, re), dot(mags, im), dot(mags2, re), -dot(mags2, im));\n}\nreturn res;`);\nconst czeta_helper_2 = new ZetaHelper2('czeta_helper_2', // ASSUME DOWNCONVERTED\n`mat4 phases = z.y*bases;\nvec2 res = vec2(0);\nfor (int row = 0; row < 4; row++) {\n  vec4 mags = exp(z.x*bases[row]) * coeffs[row];\n  vec4 re = cos(phases[row]);\n  vec4 im = sin(phases[row]);\n  res += vec2(dot(mags, re), dot(mags, im));\n}\nreturn res;`,\n`mat4 phases = z.y*bases;\nvec3 res = vec3(0);\nfor (int row = 0; row < 4; row++) {\n  vec4 mags = exp(z.x*bases[row]) * coeffs[row];\n  vec4 re = cos(phases[row]);\n  vec4 im = sin(phases[row]);\n  res += vec3(dot(mags, re), dot(mags, im), 0);\n}\nreturn res;`);\n\n// Riemann-Siegel Formula\nconst czeta_strip = new ComplexFunction('czeta_strip', // ASSUME DOWNCONVERTED\n`vec4 zeta_est = vec4(1., 0, 1., 0); // Estimate of zeta(z), zeta(1-z)\n\nzeta_est += czeta_helper(z,\nmat4(2.,3.,4.,5.,6.,7.,8.,9.,10.,11.,12.,13.,14.,15.,16.,17.),\nmat4(-0.693147180560,-1.098612288668,-1.386294361120,-1.609437912434,-1.791759469228,-1.945910149055,-2.079441541680,-2.197224577336,-2.302585092994,-2.397895272798,-2.484906649788,-2.564949357462,-2.639057329615,-2.708050201102,-2.772588722240,-2.833213344056));\nzeta_est += czeta_helper(z,\nmat4(18.,19.,20.,21.,22.,23.,24.,25.,26.,27.,28.,29.,30.,31.,32.,33.),\nmat4(-2.890371757896,-2.944438979166,-2.995732273554,-3.044522437723,-3.091042453358,-3.135494215929,-3.178053830348,-3.218875824868,-3.258096538021,-3.295836866004,-3.332204510175,-3.367295829986,-3.401197381662,-3.433987204485,-3.465735902800,-3.496507561466));\n\nVEC_TYPE zetaA = vec3(zeta_est.xy, 0).COMPONENTS;\nVEC_TYPE zetaB = vec3(zeta_est.zw, 0).COMPONENTS;\nzetaB = cmul(zetaB, cconj(zeta_character(ONE - cconj(z))));\n\nif (z.y < 120.) {\n    // Interpolate between the two estimates of zeta(z)\n    float t = 1.0 - min(z.x, 1.0);\n    float alpha = t*t * (3.0 - 2.0*t); // Hermite interpolation (smoothstep)\n    return mix(zetaA, zetaB, alpha);\n} else {\n    return cadd(zetaA, zetaB);\n}`, ['conj', 'zeta_character', 'czeta_helper', 'add']);\n\nconst ceta_right = new ComplexFunction('ceta_right', // ASSUME DOWNCONVERTED\n`if (z.x < 3.0 && z.y > 54.) {return ceta_strip(z);}\nVEC_TYPE result = ONE;\nresult += czeta_helper_2(z,\nmat4(-0.69314718055995,-1.09861228866811,-1.38629436111989,-1.60943791243410,-1.79175946922805,-1.94591014905531,-2.07944154167984,-2.19722457733622,-2.30258509299405,-2.39789527279837,-2.48490664978800,-2.56494935746154,-2.63905732961526,-2.70805020110221,-2.77258872223978,-2.83321334405622),\nmat4(-1.00000000000000,1.00000000000000,-1.00000000000000,1.00000000000000,-0.99999999999995,0.99999999999847,-0.99999999996425,0.99999999937104,-0.99999999142280,0.99999990708781,-0.99999918494666,0.99999411949279,-0.99996466193028,0.99982127062071,-0.99923254216349,0.99718148818347));\nresult += czeta_helper_2(z,\nmat4(-2.89037175789616,-2.94443897916644,-2.99573227355399,-3.04452243772342,-3.09104245335832,-3.13549421592915,-3.17805383034795,-3.21887582486820,-3.25809653802148,-3.29583686600433,-3.33220451017520,-3.36729582998647,-3.40119738166216,-3.43398720448515,-3.46573590279973,-3.49650756146648),\nmat4(-0.99109047939434,0.97562125072353,-0.94195422388664,0.87910910712444,-0.77852772396727,0.64073335549827,-0.47964042231228,0.31968999219853,-0.18572334624203,0.09196690020310,-0.03784892366350,0.01254701255408,-0.00320994916827,0.00059346134942,-0.00007044051625,0.00000402517236));\nreturn result;`, ['ceta_strip', 'czeta_helper_2']);\n\n// Riemann zeta function\nconst czeta = new ComplexFunction('czeta',\n'z = downconvert(z); return cdiv(ceta(z), csub(ONE, cexp(LN2 * (ONE - z))));',\n['div', 'eta', 'exp', 'sub']);\n\n\n/***** Special Functions *****/\n// Erf\n// Small z: https://math.stackexchange.com/questions/712434/erfaib-error-function-separate-into-real-and-imaginary-part\n// Large z: Custom expansion with Fresnel integral (centered around y=x).\n// See https://samuelj.li/blog/2021-05-05-erf-expansion\nconst rerf = new ComplexFunction('rerf',\n`float k = 1. - exp(-z.x*z.x);\nconst float K = 1.119;\n\nconst vec4 coeff = vec4(1./12., 7./480., 5./896., 787./276480.);\nfloat series = 1. - dot(coeff, vec4(k, k*k, k*k*k, k*k*k*k));\n\nreturn vec3(K * sqrt(k) * series, 0., 0.).COMPONENTS;\n`\n);\nconst cerf_large = new ComplexFunction('cerf_large', // ASSUME DOWNCONVERTED\n`VEC_TYPE k = cmul_i(creciprocal(z));\nVEC_TYPE k2 = csquare(k);\nVEC_TYPE corrections = ccomponent_mul_prelog(\ncmul(k, ONE + 0.5 * k2),\n-LNPI/2.);\nreturn cadd(ONE, cmul_i(cmul(cexp(csquare(cmul_i(z))), corrections)));`,\n['reciprocal', 'mul_i', 'component_mul_prelog', 'square', 'exp', 'mul', 'add']);\nconst cerf_small = new ComplexFunction('cerf_small', // ASSUME DOWNCONVERTED\n`float z2 = z.x*z.x;\nfloat xy = 2.*z.x*z.y;\nfloat K = exp(-z2)/PI;\nfloat q = 4.*z2;\nfloat a = cos(xy);\nfloat b = sin(xy);\n\nfloat offset = (z.y+z.x) * max(z.y-z.x, 0.);\nfloat scale = exp(-offset);\n\nvec2 series = vec2(0.0, 0.0);\nfor (int i = 0; i < 16; i += 4) {\n    vec4 k = float(i) + vec4(1., 2., 3., 4.);\n    vec4 kk = k*k/4.0 + z2 + offset;\n    vec4 kz = k*z.y;\n    vec4 e1 = exp(kz - kk);\n    vec4 e2 = exp(-kz - kk);\n\n    vec4 aa = z.x*(e1+e2);\n    vec4 bb = 0.5*k*(e1-e2);\n\n    vec4 denom = 1./(k*k + q);\n    series.x += dot(2.*z.x * exp(-kk) - a*aa + b*bb, denom);\n    series.y += dot(b*aa + a*bb, denom);\n}\nreturn scale * (rerf(z) + (K/(2. * z.x)) * vec3(1.-a, b, 0).COMPONENTS) + vec3(series*2./PI, offset).COMPONENTS;`, ['rerf']);\nconst cerf = new ComplexFunction('cerf',\n`z = downconvert(z);\nVEC_TYPE result;\n\nif (abs(z.y) > 5.5) {\n    result = cerf_large(abs(z));\n} else {\n    result = cerf_small(abs(z));\n}\n\nif (z.y < 0.0) {result.y *= -1.;}\nif (z.x < 0.0) {result.x *= -1.; result.x -= 1e-7;}\n\nreturn result;`, ['cerf_small', 'cerf_large']);\n\n\n/***** Elliptic Functions *****/\n// Jacobi Theta functions\nconst ctheta00 = new ComplexFunction('ctheta00',\n`z = downconvert(z); w = downconvert(w);\nVEC_TYPE result = ONE;\nVEC_TYPE A = 2.*z;\nfor (int i = 1; i < 8; i++) {\n    float n = float(i);\n    VEC_TYPE B = n * w;\n    result = cadd(result, cadd(\n        ccis(PI * n * (B + A)),\n        ccis(PI * n * (B - A))\n    ));\n}\nreturn result;`, ['cis', 'component_mul', 'add'], 2);\nconst ctheta01 = new ComplexFunction('ctheta01', 'z = downconvert(z); w = downconvert(w); return ctheta00(z + 0.5 * ONE, w);', ['theta00'], 2);\nconst ctheta10 = new ComplexFunction('ctheta10',\n'z = downconvert(z); w = downconvert(w); return cmul(ccis(PI * (z + 0.25 * w)), ctheta00(z + 0.5 * w, w));',\n['mul', 'cis', 'theta00'], 2);\nconst ctheta11 = new ComplexFunction('ctheta11',\n'z = downconvert(z); w = downconvert(w); return cmul(ccis(0.25 * PI * (w + 4.0 * z + 2.0 * ONE)), ctheta00(z + 0.5 * (w + ONE), w));', ['mul', 'cis', 'theta00'], 2);\n\n// Fast thetas for small arguments\nconst theta000 = new ComplexFunction('theta000', // ASSUME DOWNCONVERTED\n`VEC_TYPE result = 0.5*ONE;\nVEC_TYPE iz = cmul_i(z);\nfor (int i = 1; i < 8; i++) {\n    float n = float(i);\n    result += cexp_raw(PI * n * n * iz);\n}\nreturn 2.*result;`, ['mul_i', 'exp_raw']); // theta00(0, z);\nconst theta00f = new ComplexFunction('theta00f', // ASSUME DOWNCONVERTED\n`VEC_TYPE result = ONE;\nVEC_TYPE A = 2.*cmul_i(z);\nVEC_TYPE iw = cmul_i(w);\nfor (int i = 1; i < 4; i++) {\n    float n = float(i);\n    VEC_TYPE B = n * iw;\n    result += cexp_raw(PI * n * (B + A));\n    result += cexp_raw(PI * n * (B - A));\n}\nreturn result;`, ['exp_raw', 'mul_i'], 2);\nconst theta01f = new ComplexFunction('theta01f', // ASSUME DOWNCONVERTED\n'return theta00f(z + 0.5 * ONE, w);', ['theta00f'], 2);\nconst theta10f = new ComplexFunction('theta10f', // ASSUME DOWNCONVERTED\n'return cmul(cexp_raw(PI * cmul_i(z + 0.25 * w)), theta00f(z + 0.5 * w, w));',\n['mul', 'mul_i', 'exp_raw', 'theta00f'], 2);\nconst theta11f = new ComplexFunction('theta11f', // ASSUME DOWNCONVERTED\n'return cmul(cexp_raw(0.25 * PI * cmul_i(w + 4.0 * z + 2.0 * ONE)), theta00f(z + 0.5 * (w + ONE), w));', ['mul', 'mul_i', 'exp_raw', 'theta00f'], 2);\n\n// Jacobi elliptic functions\nconst invert_tau = new ComplexFunction('invert_tau', // ASSUME DOWNCONVERTED\n`VEC_TYPE rt_k = csqrt(csqrt(ONE - csquare(z)));\nVEC_TYPE ell = 0.5 * cdiv(ONE - rt_k, ONE + rt_k);\nVEC_TYPE log_l = clog(ell);\nVEC_TYPE q = ell + 2.*cexp_raw(5.*log_l) + 15.*cexp_raw(9.*log_l);\nreturn -cmul_i(clog(q))/PI;`,\n['sqrt', 'div', 'exp_raw', 'mul_i', 'log', 'component_mul']); // Computes tau from elliptic modulus k\nconst jacobi_reduce = new ComplexFunction('jacobi_reduce', // ASSUME DOWNCONVERTED\n`VEC_TYPE t00 = theta000(w);\nVEC_TYPE zz = cdiv(z, PI*csquare(t00));\nfloat n = 2.0 * floor(0.5 * zz.y / w.y + 0.5);\nreturn zz - n * w;`, ['theta000', 'div', 'square', 'component_mul'], 2); // Given (z, tau), reduce z to fundamental period\n\nconst invert_code = `z = downconvert(z); w = downconvert(w);\nVEC_TYPE tau = invert_tau(w);\nVEC_TYPE zz = jacobi_reduce(z, tau);`;\nconst raw_sn = new ComplexFunction('raw_sn', // ASSUME DOWNCONVERTED\n`return -cdiv(\n    cmul(theta000(w), theta11f(z, w)),\n    cmul(theta10f(ZERO, w), theta01f(z, w))\n);`,\n['div', 'mul', 'theta000', 'theta11f', 'theta10f', 'theta01f'], 2);\nconst raw_cn = new ComplexFunction('raw_cn',\n`return cdiv(\n    cmul(theta01f(ZERO, w), theta10f(z, w)),\n    cmul(theta10f(ZERO, w), theta01f(z, w))\n);`,\n['div', 'mul', 'theta01f', 'theta10f'], 2);\nconst raw_dn = new ComplexFunction('raw_dn',\n`return cdiv(\n    cmul(theta01f(ZERO, w), theta00f(z, w)),\n    cmul(theta000(w), theta01f(z, w))\n);`,\n['div', 'mul', 'theta01f', 'theta00f', 'theta000'], 2);\nconst csn = new ComplexFunction('csn',\n`${invert_code}\nreturn raw_sn(zz, tau);`,\n['invert_tau', 'jacobi_reduce', 'raw_sn'], 2);\nconst ccn = new ComplexFunction('ccn',\n`${invert_code}\nreturn raw_cn(zz, tau);`,\n['invert_tau', 'jacobi_reduce', 'raw_cn'], 2);\nconst cdn = new ComplexFunction('cdn',\n`${invert_code}\nreturn raw_dn(zz, tau);`,\n['invert_tau', 'jacobi_reduce', 'raw_dn'], 2);\n\n// Weierstrass p-function\n// Here e1, e2, e3 are roots of 4z^3 = 1/27.\nconst cwp = new ComplexFunction('cwp',\n`z = downconvert(z); w = downconvert(w);\nfloat n = floor(z.y/w.y + 0.5);\nVEC_TYPE zz = z - n * w;\nVEC_TYPE t002 = csquare(theta000(w));\nVEC_TYPE t102 = csquare(theta10f(ZERO, w));\nVEC_TYPE e2 = -(PI*PI/3.0) * (csquare(t102) + csquare(t002));\nreturn PI*PI*cmul(cmul(t002, t102), csquare(cdiv(theta01f(zz, w), theta11f(zz, w)))) + e2;` ,\n['square', 'div', 'mul', 'theta000', 'theta10f', 'theta01f', 'theta11f'], 2);\nconst raw_wpp = new ComplexFunction('raw_wpp',\n`return -2.0 * cmul(\n    cexp_raw(3. * clog(cdiv(w, raw_sn(z, w1)))),\n    cmul(raw_cn(z, w1), raw_dn(z, w1))\n);`, [\n    'mul', 'exp_raw', 'log', 'div',\n    'raw_sn', 'raw_cn', 'raw_dn',\n], 3); // wp'(zz, A, tau), post-reduction\nconst cwpp = new ComplexFunction('cwpp',\n`z = downconvert(z); w = downconvert(w);\nVEC_TYPE t004 = csquare(csquare(theta000(w)));\nVEC_TYPE t104 = csquare(csquare(theta10f(ZERO, w)));\nVEC_TYPE t014 = csquare(csquare(theta01f(ZERO, w)));\n\nconst float PI2_3 = PI*PI/3.0;\nVEC_TYPE e1 = PI2_3 * (t004 + t014);\nVEC_TYPE e2 = -PI2_3 * (t104 + t004);\nVEC_TYPE e3 = PI2_3 * (t104 - t014);\n\nVEC_TYPE A = csqrt(e1 - e3);\nVEC_TYPE B = csqrt(e2 - e3);\n\nVEC_TYPE u = cmul(z, A);\nVEC_TYPE k = cdiv(B, A);\nVEC_TYPE tau = invert_tau(k);\nVEC_TYPE zz = jacobi_reduce(u, tau);\n\nreturn raw_wpp(zz, A, tau);`, [\n    'mul', 'div', 'sqrt', 'square', \n    'theta000', 'theta10f', 'theta01f',\n    'invert_tau', 'jacobi_reduce',\n    'raw_wpp',\n], 2);\n\n// Dixon ellptic functions\nconst csm = new ComplexFunction('csm', 'z = downconvert(z); return ccm(1.7666387502854499*ONE-z);', ['cm']);\nconst ccm = new ComplexFunction('ccm', \n`const VEC_TYPE A = vec3(0.42644336004913946, 0.42644336004913946, 0).COMPONENTS;\nconst VEC_TYPE tau = vec3(-0.5, 0.8660254037844386, 0).COMPONENTS;\nVEC_TYPE u = cmul(z, A);\nVEC_TYPE zz = jacobi_reduce(u, tau);\nreturn ONE + 2.0 * creciprocal(3. * raw_wpp(zz, A, tau) - ONE);`,\n['reciprocal', 'jacobi_reduce', 'raw_wpp']);\n\n// Modular functions\nconst lattice_reduce = new LatticeReduce('lattice_reduce', // LLL basis reduction algorithm, ASSUME DOWNCONVERTED\n`if (z.y < 0.) {return -1./0. * ONE;}\nvec4 coeffs = vec4(1., 0, 0, 1.);\nvec2 a = z;\nvec2 b = vec2(1., 0);\nfor (int i = 0; i < 5; i++) {\nfloat mu = floor(dot(a, b)/dot(b, b) + 0.5);\na -= mu * b;\ncoeffs.xy -= mu * coeffs.zw;\nmu = floor(dot(a, b)/dot(a, a) + 0.5);\nb -= mu * a;\ncoeffs.zw -= mu * coeffs.xy;\n}\nvec4 res = vec4(coeffs.x*z, coeffs.z*z) + vec4(coeffs.y, 0, coeffs.w, 0);\nfloat p = step(length(res.xy), length(res.zw));\nvec2 num = res.xy * (1.-p) + res.zw * p;\nvec2 denom = res.xy * p + res.zw * (1.-p);\nreturn (1.-2.*p)*cdiv(vec3(num, 0).COMPONENTS, vec3(denom, 0).COMPONENTS);`, ['div']);\nconst cj = new ComplexFunction('cj',\n`z = downconvert(z);\nz = lattice_reduce(z.xy);\nVEC_TYPE q = cexp_raw(PI*cmul_i(z));\nVEC_TYPE q2 = csquare(q);\nVEC_TYPE a = 8.*LN2*ONE + 2.*PI*cmul_i(z) + 8.*cmul(q2, ONE - 0.5*q2); // log(theta10^8)\nVEC_TYPE even = -16.*cmul(q2, ONE + q2);\nVEC_TYPE odd = 16.*cmul(q, ONE + 4./3.*q2);\nVEC_TYPE b = even+odd; // log(theta00^8)\nVEC_TYPE c = even-odd; // log(theta01^8)\nreturn cexp(3.*clog(cexp_raw(a) + cexp_raw(b) + cexp_raw(c)) - (a+2.*even) + 5.*LN2*ONE);`,\n['lattice_reduce', 'theta00', 'theta10', 'theta01', 'log', 'exp', 'exp_raw', 'cis', 'mul_i', 'square']);\n\n/**** Function List ****/\nvar complex_functions = {\n    mul_i,\n    'reciprocal': creciprocal,\n    'square': csquare,\n    'component_mul': ccomponent_mul,\n    'component_mul_prelog': ccomponent_mul_prelog,\n\n    'real': creal,\n    'imag': cimag,\n\n    'conj': cconj,\n    'abs': cabs,\n    'arg': carg,\n    'sgn': csgn,\n    'cis': ccis,\n    'floor': cfloor,\n    'ceil': cceil,\n    'round': cround,\n    'step': cstep,\n\n    'exp': cexp,\n    'exp_raw': cexp_raw,\n    'log': clog,\n\n    'sqrt': csqrt,\n    'pow': cpow,\n    'sin': csin,  'cos': ccos,  'tan': ctan,\n    'sec': csec,  'csc': ccsc,  'cot': ccot,\n\n    'arcsin': carcsin,  'arccos': carccos,  'arctan': carctan,\n    'arcsec': carcsec,  'arccsc': carccsc,  'arccot': carccot,\n    'sinh': csinh, 'cosh': ccosh, 'tanh': ctanh,\n    'sech': csech, 'csch': ccsch, 'coth': ccoth,\n    'arsinh': carsinh, 'arcosh': carcosh, 'artanh': cartanh,\n    'arsech': carsech, 'arcsch': carcsch, 'arcoth': carcoth,\n    'neg': cneg,\n    'add': cadd,\n    'add4': cadd4,\n    'add8': cadd8,\n    'mul4': cmul4,\n    'sub': csub,\n    'mul': cmul,\n    'div': cdiv,\n    'factorial': cfact,\n\n    cgamma_left, cgamma_right,\n    'gamma': cgamma,\n\n    ceta_left, ceta_strip, ceta_right,\n    zeta_character, czeta_strip, czeta_helper, czeta_helper_2,\n    rerf, cerf_small, cerf_large,\n    'eta': ceta,\n    'zeta': czeta,\n    'erf': cerf,\n\n    invert_tau, jacobi_reduce, \n    theta000, theta00f, theta01f, theta10f, theta11f,\n    'theta00': ctheta00,\n    'theta01': ctheta01,\n    'theta10': ctheta10,\n    'theta11': ctheta11,\n\n    raw_sn, raw_cn, raw_dn,\n    'sn': csn,\n    'cn': ccn,\n    'dn': cdn,\n\n    raw_wpp,\n    'wp': cwp,\n    'wpp': cwpp,\n\n    'sm': csm,\n    'cm': ccm,\n\n    lattice_reduce,\n    'j': cj,\n};\n\nfunction parseExpression(expression) {\n    try {\n        const parser = new nearley.Parser(compiledGrammar);\n        parser.feed(expression)\n        const result = parser.results[0];\n        if (result !== null) {\n            console.log('Raw AST:', result);\n        }\n        return compile(result || null);\n    } catch (error) {\n        console.error(error);\n        return null;\n    }\n}\n\nfunction getRequirements(ast) {\n    if (!Array.isArray(ast)) {return new Set();}\n    if (['number', 'variable', 'constant'].includes(ast[0])) {return new Set();}\n    const requirements = new Set([ast[0]]);\n    for (let subast of ast.slice(1)) {\n        for (let req of getRequirements(subast)) {\n            requirements.add(req);\n        }\n    }\n    return requirements;\n}\n\n// Get function declarations and definitions.\n// Only loads used functions and their dependencies.\nfunction functionDefinitions(ast, LOG_MODE) {\n    let required = null;\n\n    if (Array.isArray(ast)) {\n        // Extract functions used\n        required = getRequirements(ast);\n\n        // Resolve dependencies\n        const stack = Array.from(required);\n        while (stack.length > 0) {\n            const f = stack.pop();\n            const fObj = complex_functions[f];\n            const dependencies = LOG_MODE ? fObj.log_dependencies : fObj.dependencies;\n            for (let dep of dependencies) {\n                if (!required.has(dep)) {\n                    required.add(dep);\n                    stack.push(dep);\n                }\n            }\n        }\n    } else {\n        required = new Set();\n        for (let name of Object.keys(complex_functions)) {\n            required.add(name);\n        }\n    }\n    \n    console.log('Functions loaded:', required);\n\n    const VEC_TYPE = LOG_MODE ? 'vec3' : 'vec2';\n    const comp_suffix = LOG_MODE ? 'xyz' : 'xy';\n\n    const functions = Array.from(required).map(name => complex_functions[name]);\n    const declarations = functions.map(f => f.declaration.replaceAll('VEC_TYPE', VEC_TYPE));\n    const definitions = functions.map(\n        f => (LOG_MODE ? f.log_code : f.code).replaceAll('VEC_TYPE', VEC_TYPE).replaceAll('COMPONENTS', comp_suffix)\n    );\n\n    const declarationString = declarations.join('\\n');\n    const definitionString = definitions.join('\\n');\n    return `${declarationString}\\n\\n${definitionString}`;\n}\n\nexport {complex_functions, parseExpression, functionDefinitions};\n","import {get} from 'lodash';\n\nconst math = require('mathjs');\n\nfunction terminateFloat(x) {\n    const terminator = Number.isInteger(x) ? '.' : '';\n    return x.toString() + terminator;\n}\n\n// Returns pair [ast_in_glsl, requires_parenthesis]\nfunction toGLSL(ast, LOG_MODE) {\n    if (!isNaN(ast)) {\n        // GLSL floats must end in decimal point\n        return [terminateFloat(ast), false];\n    }\n    if (!Array.isArray(ast)) {return [ast, false];}\n\n    let infixOperators = {\n        'add': '+',\n        'sub': '-',\n        'component_mul': '*',\n    };\n    if (LOG_MODE) {\n        infixOperators = {};\n    }\n\n    const [operator, ...args] = ast;\n\n    if (operator === 'number') {\n        const [real, imag] = args;\n        if (LOG_MODE) {\n            let length = math.hypot(real, imag)\n            if (length === 0) {length = 1;}\n            return [`vec3(${real/length}, ${imag/length}, ${math.log(length)})`, false];\n        } else {\n            if (real === 1 && imag === 0) {return ['ONE', false];}\n            if (real === 0 && imag === 1) {return ['I', false];}\n            return [`vec2(${real}, ${imag})`, false];\n        }\n    }\n\n    if (operator === 'variable') {return [args[0], false];}\n    if (operator === 'constant') {return ['C_' + args[0].toUpperCase(), false];} // TODO FIX\n    if (operator in infixOperators) {\n        const op = infixOperators[operator]\n        let operands = args.map(x => toGLSL(x, LOG_MODE));\n\n        // Add parentheses where possibly necessary\n        if (op === '-') {\n            if (operands[1][1]) {\n                operands[1][0] = '(' + operands[1][0] + ')';\n            };\n        } else {\n            if (op !== '+') {\n                operands = operands.map(x => [x[1] ? '(' + x[0] + ')' : x[0], false]);\n            }\n        }\n        return [operands[0][0] + op + operands[1][0], operator !== 'mul'];\n    }\n\n    // Unary function\n    const unaryFunctions = {\n        'factorial': 'cfact',\n    };\n    const internalName = get(unaryFunctions, operator, 'c' + operator);\n\n    return [internalName + '(' + args.map(x => toGLSL(x, LOG_MODE)[0]).join(', ') + ')', false];\n}\n\nexport default toGLSL;\n","import {\n  functionDefinitions,\n} from './complex-functions.js';\nimport toGLSL from './translators/to-glsl';\n\nfunction loadShader(gl, type, source) {\n  // Create and compile shader\n  const shader = gl.createShader(type);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n\n  // Test for successful compilation\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    console.error('Shader failed to compile: '\n      + gl.getShaderInfoLog(shader));\n    gl.deleteShader(shader);\n    return null;\n  }\n\n  return shader;\n}\n\n\nfunction createShaderProgram(gl, expression, customShader, variableNames) {\n  if (expression === null) {return null;}\n\n  gl.LOG_MODE = !customShader; // Whether to use (log-magnitude, phase) representation\n  const fragmentShaderSource = getFragmentShaderSource(\n    expression,\n    customShader, \n    gl.drawingBufferWidth, gl.drawingBufferHeight,\n    variableNames,\n    gl.LOG_MODE\n  );\n\n  if (fragmentShaderSource === null) {return null;}\n\n  console.log(fragmentShaderSource);\n\n  // Load vertex and fragment shaders\n  const vertexShader = loadShader(gl,\n    gl.VERTEX_SHADER, vertexShaderSource);\n  const fragmentShader = loadShader(gl,\n    gl.FRAGMENT_SHADER, fragmentShaderSource);\n\n  if (vertexShader === null | fragmentShader === null) {\n    return null;\n  }\n\n  // TODO Debug\n//  const ext = gl.getExtension('WEBGL_debug_shaders');\n//  console.log(ext.getTranslatedShaderSource(fragmentShader));\n\n  // Create shader program\n  const shaderProgram = gl.createProgram();\n  gl.attachShader(shaderProgram, vertexShader);\n  gl.attachShader(shaderProgram, fragmentShader);\n  gl.linkProgram(shaderProgram);\n\n  // Test for successful linkage\n  if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\n    console.error('Shader program failed to initialize: '\n      + gl.getProgramInfoLog(shaderProgram));\n    return null;\n  }\n\n  return shaderProgram;\n}\n\nexport default createShaderProgram;\n\n\nconst vertexShaderSource = `\n  attribute vec2 a_position;\n\n  void main() {\n    gl_Position = vec4(a_position, 0, 1);\n  }\n`;\n\n\nfunction getFragmentShaderSource(expression, customShader, width, height, variableNames, LOG_MODE) {\n  const x_offset = (width/2).toFixed(2);\n  const y_offset = (height/2).toFixed(2);\n  const dpr = window.devicePixelRatio.toFixed(4);\n\n  const vectype = LOG_MODE ? 'vec3' : 'vec2';\n\n  const variableDeclarations = variableNames.map(\n    (name) => `uniform ${vectype} ${name};`\n  ).join('\\n');\n\n  let custom_code = '';\n  let glsl_expression = null;\n  if (customShader) {\n    custom_code = expression;\n    glsl_expression = 'mapping(z)';\n  } else {\n    glsl_expression = toGLSL(expression, LOG_MODE)[0];\n    if (LOG_MODE) {\n        glsl_expression = `upconvert(${glsl_expression})`\n    }\n  }\n  if (glsl_expression === null) {return null;}\n\n  console.log('Compiled AST:', expression);\n  console.log(`Shader Code (${LOG_MODE ? 'log-cart' : 'cartesian'}):`, glsl_expression);\n\n  return `\n  #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n  #else\n    precision mediump float;\n  #endif\n\n  const float PI = 3.14159265358979323846264;\n  const float TAU = 2.0 * PI;\n  const float E = 2.718281845904523;\n  const float LN2 = 0.69314718055994531;\n  const float LN2_INV = 1.442695040889634;\n  const float LNPI = 1.1447298858494001741434;\n  const float PHI = 1.61803398874989484820459;\n  const float SQ2 = 1.41421356237309504880169;\n\n  const float checkerboard_scale = 0.25;\n\n  const ${vectype} ZERO = ${LOG_MODE ? 'vec3(0)' : 'vec2(0)'};\n  const ${vectype} ONE = ${LOG_MODE ? 'vec3(1., 0, 0)' : 'vec2(1., 0)'};\n  const vec2 I = vec2(0, 1);\n  const ${vectype} C_PI = ${LOG_MODE ? 'vec3(PI, 0, 0)' : 'vec2(PI, 0)'};\n  const vec2 C_TAU = vec2(TAU, 0);\n  const vec2 C_E = vec2(E, 0);\n  const vec2 C_PHI = vec2(PHI, 0);\n\n  vec2 clogcart(${vectype} z) {return vec2(${LOG_MODE ? 'log(length(z.xy)) + z.z' : 'log(length(z))'}, atan(z.y, z.x));}\n  vec2 encodereal(float a) {return vec2(log(abs(a)), 0.5*PI*(1. - sign(a)));}\n  ${LOG_MODE ? 'vec3 downconvert(vec3 z) {return vec3(vec2(z.xy) * exp(z.z), 0);}' : 'vec2 downconvert (vec2 z) {return z;}'}\n  vec3 upconvert(vec3 z) {float l = length(z.xy); return vec3(z.xy/l, z.z + log(l));}\n\n  ${variableDeclarations}\n\n  ${functionDefinitions(expression, LOG_MODE)}\n\n  vec3 hsv2rgb(vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n  }\n\n  vec3 get_color(${vectype} z_int, float derivative, float phase_derivative) {\n    vec2 magphase = clogcart(z_int);\n    magphase.x *= LN2_INV;\n    magphase.y = mod(magphase.y, TAU);\n    vec2 z = ${LOG_MODE ? 'downconvert(z_int).xy' : 'z_int'};\n\n    float color_value;\n    float color_saturation = 1.0;\n\n    ${LOG_MODE ? `float phase_decay_factor = 1./clamp(8. * phase_derivative, 1., 10000.0);\n    color_saturation *= phase_decay_factor;` : ''}\n\n    if (continuous_gradient.x > 0.5) {\n      float color_lightness = 0.5 + atan(0.35 * magphase.x)/PI;\n      color_saturation = 1.0;\n\n      if (invert_gradient.x > 0.5) {\n\tcolor_lightness = 1.0 - color_lightness;\n      }\n\n      /* HSL to HSV conversion */\n      color_lightness *= 2.0;\n      color_saturation *= 1.0 - abs(color_lightness - 1.0);\n      color_value = (color_lightness + color_saturation) / 2.0;\n      color_saturation /= color_value;\n    } else {\n      color_value = 0.5 * exp2(fract(magphase.x));\n\n      if (invert_gradient.x > 0.5) {\n\tcolor_value = 1.5 - color_value;\n      }\n\n${LOG_MODE ? 'color_value += (0.75 - color_value) * (1. - phase_decay_factor);' : ''}\n    }\n\n    if (enable_checkerboard.x > 0.5) {\n      vec2 checkerboard_components = floor(2.0 * fract(z/checkerboard_scale));\n      float checkerboard = floor(2.0 * fract((checkerboard_components.x + checkerboard_components.y)/2.0));\n\n      // Anti-Moire\n      float decay_factor = clamp(40. * derivative, 1., 10000.0) - 1.;\n      checkerboard = 0.5 + (checkerboard - 0.5) / (1. + 3. * decay_factor);\n\n      if (magphase.x > 15.) {checkerboard = 0.5;}\n\n      color_value *= 0.8 + 0.2 * checkerboard;\n    }\n\n    vec3 hsv_color = vec3(magphase.y/TAU, color_saturation, color_value);\n    return hsv2rgb(hsv_color);\n  }\n\n  ${custom_code}\n\n  const vec2 screen_offset = vec2(${x_offset}, ${y_offset});\n  vec2 from_pixel(vec2 xy) {\n    vec2 plot_center = vec2(center_x.x, center_y.x);\n    float scale = exp(-log_scale.x) / ${dpr};\n    return scale * (xy - screen_offset) + plot_center;\n  }\n\n  ${vectype} internal_mapping(vec2 xy) {\n      vec2 z_int = from_pixel(xy);\n      ${LOG_MODE ? 'vec3 z = vec3(z_int, 0);' : 'vec2 z = z_int;'}\n      return ${glsl_expression};\n  }\n\n  void main() {\n    // Set up for supersampling\n    const vec2 A = vec2(0.125, 0.375);\n    const vec2 B = vec2(0.375, -0.125);\n    vec2 xy = gl_FragCoord.xy;\n\n    // 4-Rook supersampling\n    ${vectype} w1 = internal_mapping(xy + A);\n    ${vectype} w2 = internal_mapping(xy - A);\n    ${vectype} w3 = internal_mapping(xy + B);\n    ${vectype} w4 = internal_mapping(xy - B);\n\n    // Anti-Moire\n    float phase_derivative = ${LOG_MODE ? '0.5*(length(w1-w2) + length(w3-w4))' : '0.'};\n    float derivative = ${LOG_MODE ? 'phase_derivative * exp(min(w1.z, 20.))' : '0.5 * (length(w1 - w2) + length(w3 - w4))'};\n\n    vec3 color1 = get_color(w1, derivative, phase_derivative);\n    vec3 color2 = get_color(w2, derivative, phase_derivative);\n    vec3 color3 = get_color(w3, derivative, phase_derivative);\n    vec3 color4 = get_color(w4, derivative, phase_derivative);\n\n    vec3 color =  0.25 * (color1 + color2 + color3 + color4);\n    gl_FragColor = vec4(color, 1.0);\n  }\n  `;\n}\n","import createShaderProgram from './shaders.js';\n\n\nfunction initBuffers(gl) {\n  const vertexBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n\n  // Positions of vertices (two triangles)\n  const vertices = [\n    -1, -1,\n    1, -1,\n    -1, 1,\n\n    -1, 1,\n    1, -1,\n    1, 1\n  ]\n\n  // Initialize buffer with position data\n  gl.bufferData(\n    gl.ARRAY_BUFFER,\n    new Float32Array(vertices),\n    gl.STATIC_DRAW\n  );\n}\n\nfunction initializeScene(gl, expression, customShader, variableNames) {\n  if (expression === null) {return null;}\n\n  const shaderProgram = createShaderProgram(\n    gl,\n    expression, customShader,\n    variableNames\n  );\n\n  if (shaderProgram === null) {\n    console.error('AST could not be compiled:', expression);\n    return null;\n  }\n\n  // Initialize shader program\n  initBuffers(gl);\n  gl.useProgram(shaderProgram);\n\n  // Initialize vertex array\n  const positionLocation = gl.getAttribLocation(shaderProgram, 'a_position');\n  gl.enableVertexAttribArray(positionLocation);\n  gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);\n\n  // Retrieve pointers to variables\n  const variableLocations = {};\n  for (const name of variableNames) {\n    variableLocations[name] = gl.getUniformLocation(shaderProgram, name);\n  }\n  return variableLocations;\n}\n\nfunction drawScene(gl, variables, axis_ctx) {\n  // Set variable values\n  for (const key of Object.keys(variables)) {\n    const [location, value] = variables[key];\n    if (gl.LOG_MODE) {\n        gl.uniform3f(location, value, 0, 0);\n    } else {\n        gl.uniform2f(location, value, 0);\n    }\n  }\n\n  // Draw scene\n  gl.drawArrays(gl.TRIANGLES, 0, 6);\n\n  // Draw coordinate axes\n  drawAxes(axis_ctx, variables);\n}\n\nfunction drawAxes(ctx, variables) {\n    // Clear canvas\n    const dpr = window.devicePixelRatio;\n    const [width, height] = [window.innerWidth * dpr, window.innerHeight * dpr];\n    ctx.clearRect(0, 0, width, height);\n    if (variables.enable_axes[1] < 0.5) {return;}\n\n    // Compute display scales\n    const scale = Math.exp(variables.log_scale[1]) * dpr;\n    \n    let rawLogLabelScale = 2.3 - variables.log_scale[1] / Math.log(10);\n    rawLogLabelScale += 3e-2 * Math.abs(rawLogLabelScale); // Make room for long labels\n    let logLabelScale = Math.round(rawLogLabelScale);\n    let labelScale = Math.pow(10, logLabelScale);\n\n    if (logLabelScale - rawLogLabelScale > 0.2) {\n        labelScale /= 5;\n        logLabelScale--;\n    } else if (logLabelScale - rawLogLabelScale > 0) {\n        labelScale /= 2;\n        logLabelScale--;\n    }\n\n    // Compute origin location in screen space\n    const [x0, y0] = [\n        width/2 - scale*variables.center_x[1],\n        height/2 + scale*variables.center_y[1],\n    ];\n\n    // Compute window bounds\n    const [x_min, x_max] = [-x0/scale, (width - x0)/scale];\n    const [y_min, y_max] = [(y0-height)/scale, y0/scale];\n\n\n    // Utility functions\n    function horizontalLine(y) {\n        const yy = Math.round(y0 - scale*y);\n        ctx.moveTo(0, yy);\n        ctx.lineTo(width, yy);\n    }\n\n    function verticalLine(x, lineWidth) {\n        const xx = Math.round(x0 + scale*x);\n        ctx.moveTo(xx, 0);\n        ctx.lineTo(xx, height);\n    }\n\n    function xLabel(x) {\n        const xx = x0 + scale * x;\n        if (xx > width - 30*dpr || xx < 30*dpr) {return;}\n\n        const dy = (y0 < height/3) ? 22 : -10;\n        const y = Math.min(Math.max(y0 + dy*dpr, 90 * dpr), height-20*dpr);\n\n        let label = x.toFixed(Math.max(0, -logLabelScale)).replace('-', '');\n        const textWidth = ctx.measureText(label).width + 6 * dpr;\n\n        ctx.textAlign = 'center'\n        ctx.clearRect(xx - textWidth/2, y - 18*dpr, textWidth, 24*dpr);\n        ctx.strokeText(label, xx, y);\n        ctx.fillText(label, xx, y);\n    }\n\n    function yLabel(y, iWidth) {\n        const yy = y0 - scale * y + 6 * dpr;\n        if (yy > height - 50*dpr || yy < 100*dpr) {return;}\n\n        const alignLeft = (x0 < 2*width/3);\n        const dx = alignLeft ? 10: -10;\n        ctx.textAlign = alignLeft ? 'left' : 'right';\n\n        const x = Math.min(Math.max(x0 + dx*dpr, 20 * dpr), width -20*dpr);\n\n        let label = y.toFixed(Math.max(0, -logLabelScale)).replace('-', '');\n        if (label === '1') {label = '';}\n        if (label === '1') {label = '';}\n\n        ctx.font = `${20 * dpr}px Computer Modern Serif`;\n        const textWidth = ctx.measureText(label).width;\n\n        const clearWidth = textWidth + iWidth + 8*dpr;\n        ctx.clearRect(\n            x - (alignLeft ? 3*dpr : clearWidth - 4*dpr),\n            yy - 18*dpr,\n            clearWidth,\n            24*dpr\n        );\n\n        const textOffset = alignLeft ? 0 : -iWidth - dpr;\n        ctx.strokeText(label, x + textOffset, yy);\n        ctx.fillText(label, x + textOffset, yy);\n\n        ctx.font = `italic ${20 * dpr}px Computer Modern Serif`;\n        const iOffset = alignLeft ? textWidth + dpr : 0;\n        ctx.strokeText('i', x + iOffset, yy);\n        ctx.fillText('i', x + iOffset, yy);\n    }\n\n\n    // Draw gridlines\n    ctx.globalAlpha = 0.8;\n    ctx.strokeStyle= '#ffffff';\n\n    ctx.lineWidth = 1;\n    ctx.beginPath();\n    for (let i = Math.ceil(x_min/labelScale); i < x_max/labelScale; i++) {\n        if (i === 0) {continue;}\n        verticalLine(i * labelScale);\n    }\n    for (let i = Math.ceil(y_min/labelScale); i < y_max/labelScale; i++) {\n        if (i === 0) {continue;}\n        horizontalLine(i * labelScale);\n    }\n    ctx.stroke();\n\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    verticalLine(0);\n    horizontalLine(0);\n    ctx.stroke();\n\n    // Draw labels\n    ctx.font = `${20 * dpr}px Computer Modern Serif`;\n    ctx.globalAlpha = 1;\n    ctx.fillStyle = '#ffffff';\n    ctx.lineWidth = 4;\n    ctx.lineJoin = 'round';\n    ctx.strokeStyle = '#444444';\n    for (let i = Math.ceil(x_min/labelScale); i < x_max/labelScale; i++) {\n        if (i === 0) {continue;}\n        xLabel(i * labelScale);\n    }\n\n\n    ctx.font = `italic ${20 * dpr}px Computer Modern Serif`;\n    const iWidth = ctx.measureText('i').width;\n    for (let i = Math.ceil(y_min/labelScale); i < y_max/labelScale; i++) {\n        if (i === 0) {continue;}\n        yLabel(i * labelScale, iWidth);\n    }\n}\n\nexport {initializeScene, drawScene};\n","import {isNil} from 'lodash';\n\nfunction formatComplex(x, y, precision) {\n    if (x !== 0) {\n        if (y !== 0) {\n            return formatReal(x, false, precision) + formatReal(y, true, precision) + '\\\\, i';\n        } else {\n            return formatReal(x, false, precision);\n        }\n    } else if (y !== 0) {\n        return formatReal(y, false, precision) + '\\\\, i';\n    } else {\n        return '0';\n    }\n}\n\nconst CONSTANTS = {\n    '\\\\pi': Math.PI,\n    '\\\\sqrt{2}': Math.sqrt(2),\n    'e': Math.E,\n}\n\nfunction almostInteger(x) {\n    return Math.abs(x - Math.round(x)) < 1e-10;\n}\n\n// Checks if the value is close to a nice multiple of known constants.\nfunction checkKnown(x) {\n    for (let [name, value] of Object.entries(CONSTANTS)) {\n        for (let denominator of [1, 2, 3, 6, 12]) {\n            const ratio = denominator * x / value;\n\n            // Check if ratio is almost integer\n            if (ratio > 0.5 && almostInteger(ratio)) {\n                console.log(ratio);\n                const formatInteger = x => x === 1 ? '' : x.toString()\n                const numerator = formatInteger(Math.round(ratio)) + ' ' + name;\n\n                if (denominator === 1) {\n                    return numerator;\n                } else {\n                    return '\\\\frac{' + numerator + '}{' + denominator + '}';\n                }\n            }\n        }\n    }\n\n    return null;\n}\n\nfunction formatReal(x, forceSign, precision) {\n    const magnitude = Math.abs(x);\n    const sign = x < 0 ? '-' : (\n        forceSign ? '+' : ''\n    );\n\n    if (precision > 3) {\n        // Try to see if value is a multiple of known constant\n        const prettyMagnitude = checkKnown(magnitude);\n        if (!isNil(prettyMagnitude)) {return sign + prettyMagnitude;}\n    }\n\n    let exponent = magnitude > 0 ? Math.floor(Math.log10(magnitude)) : 0;\n    if (Math.abs(exponent) < 3) {exponent = 0;}\n\n    const mantissa = magnitude * Math.pow(10, -exponent);\n\n    const formattedMagnitude = mantissa.toFixed(precision);\n    const formattedExponent = exponent === 0 ? '' : `\\\\times 10^{${exponent}}`;\n\n    return sign + formattedMagnitude + formattedExponent;\n}\n\nexport {formatComplex};\n","import React, {PureComponent} from 'react';\n\nimport {InlineMath} from 'react-katex';\n\nimport {formatComplex} from '../util';\n\n\nclass CoordinateOverlay extends PureComponent {\n    state = {\n        faded: false\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.fadeTimer = null;\n        this.lastX = null;\n        this.lastY = null;\n    }\n\n    hasChanged() {\n        const {x, y} = this.props;\n        const changed = (this.lastX !== x) || (this.lastY !== y);\n\n        this.lastX = x;\n        this.lastY = y;\n\n        return changed;\n    }\n\n    componentDidMount() {\n        this.componentDidUpdate();\n    }\n\n    componentDidUpdate() {\n        if (this.hasChanged()) {\n            if (this.fadeTimer !== null) {\n                clearTimeout(this.fadeTimer);\n            }\n            this.fadeTimer = setTimeout(() => this.setState({faded: true}), 2e3);\n            this.setState({faded: false});\n        }\n    }\n\n    render() {\n        const {faded} = this.state;\n        const {x, y, mapping} = this.props;\n\n        const [u, v] = mapping([x, y]);\n\n        return <div className='coordinate-container'>\n            <InlineMath>{'z = ' + formatComplex(x, y, 3)}</InlineMath>\n            {isFinite(u) && isFinite(v) ? <InlineMath>{'f(z) = ' + formatComplex(u, v, 3)}</InlineMath> : null}\n            <style>{`\n                .coordinate-container {\n                    position: absolute;\n                    bottom: 0;\n                    right: 0;\n                    z-index: 20;\n\n                    padding: 5px 20px;\n                    min-width: 180px;\n\n                    display: flex;\n                    flex-direction: column;\n                    align-items: center;\n                    justify-content: center;\n\n                    background-color: hsla(213, 5%, 15%, 0.3);\n                    border: 1px solid hsla(213, 5%, 90%, 0.1);\n                    box-shadow: -1px -1px 4px hsla(213, 10%, 10%, 0.1);\n\n                    border-radius: 8px 0 0 0;\n\n                    backdrop-filter: blur(6px);\n\n                    color: white;\n                    font-size: 22px;\n                    line-height: 1;\n\n                    opacity: ${faded ? 0 : 1};\n                    transition: ${faded ? 1 : 0.1}s opacity ease-out;\n                }\n\n                @media (max-width: 700px) {\n                    .coordinate-container {\n                        border-radius: 0;\n                        left: 0;\n                        font-size: 18px;\n                    }\n                }\n            `}</style>\n        </div>;\n   }\n}\n\nexport default CoordinateOverlay;\n","import React, {PureComponent} from 'react';\n\nimport {initializeScene, drawScene} from '../../gl-code/scene.js';\nimport toJS from '../../gl-code/translators/to-js';\n\nimport CoordinateOverlay from './CoordinateOverlay';\n\nimport './function-plot.css';\n\n\nconst FPS_LIMIT = 70;\n\nlet canvasSize = [];\n\nfunction pixelToPlot(x, y, variables) {\n    const scale = Math.exp(variables.log_scale);\n    const offset_x = variables.center_x;\n    const offset_y = variables.center_y;\n\n    const plot_x = (x - canvasSize[0]/2) / scale + offset_x;\n    const plot_y = (canvasSize[1]/2 - y) / scale + offset_y;\n    return [plot_x, plot_y];\n}\n\nfunction plotToPixel(plot_x, plot_y, variables) {\n    const scale = Math.exp(variables.log_scale);\n    const offset_x = variables.center_x;\n    const offset_y = variables.center_y;\n\n    const x = scale * (plot_x - offset_x) + canvasSize[0]/2;\n    const y = -scale * (plot_y - offset_y) - canvasSize[1]/2;\n    return [x, y];\n}\n\nclass FunctionPlot extends PureComponent {\n    state = {\n        position: [NaN, NaN, 0],\n        mouseDown: false,\n    }\n\n    constructor(props) {\n        super(props);\n\n        this.gl = null;\n\n        this.variableLocations = {};\n        this.initialized = false;\n\n        this.lastUpdate = null; // Timestamp of last update, for debouncing\n    }\n\n    componentDidMount() {\n        window.addEventListener('resize', this.compilePlot.bind(this));\n\n        this.initializeWebGL();\n        this.componentDidUpdate();\n        this.compilePlot();\n    }\n\n    // Perform a full update of the plot (expensive!)\n    compilePlot() {\n        const {onError} = this.props;\n        this.initializePlot();\n        this.updatePlot();\n        onError(!this.initialized);\n    }\n\n    componentDidUpdate() {\n        const {expression} = this.props;\n        if (this.lastExpression !== expression) {\n            this.compilePlot();\n        }\n        this.lastExpression = expression;\n            \n    }\n\n    getPosition(mouseEvent) {\n        const nativeEvent = mouseEvent.nativeEvent;\n\n        if (nativeEvent.targetTouches !== undefined) {\n            const touches = nativeEvent.targetTouches;\n            if (touches.length === 1) {\n                return [touches[0].pageX, touches[0].pageY, 1];\n            } else {\n                const [x0, y0] = [touches[0].pageX, touches[0].pageY];\n                const [x1, y1] = [touches[1].pageX, touches[1].pageY];\n\n                const centerX = (x0 + x1) / 2;\n                const centerY = (y0 + y1) / 2;\n                const logDistance = Math.log(Math.hypot(x1-x0, y1-y0));\n                return [centerX, centerY, logDistance];\n            }\n        } else {\n            return [nativeEvent.pageX, nativeEvent.pageY, 1];\n        }\n    }\n\n    updatePosition(mouseEvent) {\n        this.setState({position: this.getPosition(mouseEvent)});\n    }\n\n    handleZoom(wheelEvent, deltaLogScale) {\n        const {position} = this.state;\n        const {variables} = this.props;\n\n        if (!position.every(isFinite)) {return;}\n        const [x, y, _] = position;\n\n        // Recenter plot at scroll location\n        const [mouse_plotx, mouse_ploty] = pixelToPlot(x, y, variables);\n        variables.center_x = mouse_plotx;\n        variables.center_y = mouse_ploty;\n\n        // Change scale\n        if (deltaLogScale === undefined) {\n            deltaLogScale = (wheelEvent.deltaY > 0) ? -0.05: 0.05;\n        }\n        variables.log_scale += deltaLogScale;\n\n        // Move center back onto mouse\n        const [new_mouse_plotx, new_mouse_ploty] = pixelToPlot(x, y, variables);\n        const [x_shift, y_shift] = [new_mouse_plotx - mouse_plotx, new_mouse_ploty - mouse_ploty];\n        variables.center_x -= x_shift;\n        variables.center_y -= y_shift;\n\n        this.updatePlot();\n    }\n\n    handleMouseDown(event) {\n        this.updatePosition(event);\n        this.setState({mouseDown: true});\n    }\n\n    handleMouseUp(event) {\n        this.setState({mouseDown: false});\n    }\n\n    handleMouseMove(event) {\n        const {mouseDown} = this.state;\n        const {variables} = this.props;\n\n        // Handle dragging of plot\n        if (mouseDown) {\n            const {position} = this.state;\n            const [x, y, logDistance] = this.getPosition(event);\n\n            const deltaPosition = [\n                x - position[0],\n                y - position[1],\n                logDistance - position[2]\n            ];\n\n            const scale = Math.exp(variables.log_scale);\n            variables.center_x -= deltaPosition[0] / scale;\n            variables.center_y += deltaPosition[1] / scale;\n            this.handleZoom(null, deltaPosition[2]);\n            this.updatePlot();\n        }\n        this.updatePosition(event);\n    }\n\n    handleTouchStart(event) {\n        this.handleMouseDown(event);\n    }\n\n    handleTouchMove(event) {\n        this.handleMouseMove(event);\n    }\n\n    handleTouchEnd(event) {\n        this.handleMouseUp(event);\n    }\n\n    handleVariableUpdate(update) {\n        const {variables} = this.props;\n\n        for (const [name, value] of Object.entries(update)) {\n            variables[name] = value;\n        }\n\n        this.updatePlot();\n    }\n\n    initializeWebGL() {\n        const canvas = this.refs.canvas;\n        const axes = this.refs.axes;\n        this.gl = canvas.getContext('webgl');\n        this.axes = axes.getContext('2d');\n\n        if (this.gl === null) {\n            console.error('Unable to initialize WebGL.');\n            return null;\n        }\n    }\n\n    initializePlot() {\n        const {expression, variables} = this.props;\n\n        const canvas = this.refs.canvas;\n        const axes = this.refs.axes;\n        let dpr = window.devicePixelRatio;\n\n        // Resize canvas and WebGL viewport\n        canvas.width = canvas.offsetWidth * dpr;\n        canvas.height = canvas.offsetHeight * dpr;\n\n        axes.width = axes.offsetWidth * dpr;\n        axes.height = axes.offsetHeight * dpr;\n\n        // Record canvas size and update GL viewport\n        canvasSize = [canvas.offsetWidth, canvas.offsetHeight];\n        this.gl.viewport(0, 0, canvas.width, canvas.height);\n\n        // Initialize scene and obtain WebGL variable pointers\n        const variableLocations = initializeScene(\n            this.gl,\n            expression,\n            variables.custom_function > 0.5,\n            Object.keys(variables)\n        );\n\n        // Check if initialized\n        this.initialized = (variableLocations !== null);\n        if (this.initialized) {\n            this.variableLocations = variableLocations;\n        }\n    }\n\n    updatePlot() {\n        const {variables} = this.props;\n        const variableAssignments = {};\n        for (const [name, value] of Object.entries(variables)) {\n            variableAssignments[name] = [this.variableLocations[name], value];\n        }\n\n        // Debounce\n        const now = +new Date();\n        if (this.lastUpdate === null || now - this.lastUpdate > 1e3 / FPS_LIMIT) {\n            drawScene(this.gl, variableAssignments, this.axes);\n            this.lastUpdate = now;\n        }\n    }\n\n    render() {\n        const {position, mouseDown} = this.state;\n        const {expression, variables} = this.props;\n\n        const [x, y] = pixelToPlot(position[0], position[1], variables);\n        const mapping = toJS(expression, variables);\n\n        return (\n            <div id='function-plot'>\n                <div id='fallback-text'>\n                    Loading...\n                    <div className='small'>If nothing happens, please check that Javascript and WebGL are enabled.</div>\n                </div>\n                <canvas\n                    ref='canvas'\n\n                    onMouseDown={(event) => this.handleMouseDown(event)}\n                    onMouseMove={(event) => this.handleMouseMove(event)}\n                    onMouseUp={(event) => this.handleMouseUp(event)}\n\n                    onMouseEnter={(event) => this.handleMouseMove(event)}\n                    onMouseLeave={(event) => this.handleMouseUp(event)}\n\n                    onTouchStart={(event) => this.handleTouchStart(event)}\n                    onTouchMove={(event) => this.handleTouchMove(event)}\n                    onTouchEnd={(event) => this.handleTouchEnd(event)}\n\n                    onWheel={(event) => this.handleZoom(event)}\n\n                    className='full-canvas main-plot'\n                />\n                <canvas\n                    ref='axes'\n                    className='full-canvas axes'\n                />\n\n                {isFinite(x) && isFinite(y) ?\n                    <CoordinateOverlay x={x} y={y} mapping={mapping}/>\n                    : null}\n\n                <style jsx>{`\n            canvas.main-plot {\n                cursor: ${mouseDown ? 'grabbing' : 'grab'};\n            }\n        `}</style>\n            </div>\n        );\n    }\n}\n\nexport {pixelToPlot, plotToPixel};\nexport default FunctionPlot;\n","import React from 'react';\n\nimport withStyles from '@material-ui/core/styles/withStyles';\n\nimport Drawer from '@material-ui/core/Drawer';\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer';\n\nimport './side-panel.css';\n\n\nconst styles = theme => ({\n  toolbar: theme.mixins.toolbar\n});\n\nclass SidePanel extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.classes = props.classes;\n    this.state = {\n      width: null\n    }\n  }\n  \n  componentDidMount() {\n    this.updateWidth();\n    window.addEventListener('resize', this.updateWidth.bind(this));\n  }\n\n  updateWidth() {\n    this.setState({width: window.innerWidth});\n  }\n\n  render() {\n    if (this.state.width > this.props.transitionWidth) {\n      return (\n\t<Drawer\n\t  anchor={this.props.anchor}\n\t  open={this.props.open}\n\t  variant='persistent'\n\t  classes={{\n\t    paper: this.props.className\n\t  }}\n\t>\n\t  <div className={this.classes.toolbar}/>\n\t  <div className='drawer-content'>\n\t    {this.props.children}\n\t  </div>\n\t</Drawer>\n      );\n    } else {\n      return (\n\t<SwipeableDrawer\n\t  anchor={this.props.anchor}\n\t  open={this.props.open}\n\t  onOpen={this.props.onToggle}\n\t  onClose={this.props.onToggle}\n\t  classes={{\n\t    paper: this.props.className\n\t  }}\n\t  disableDiscovery\n\t  disableSwipeToOpen\n\t>\n\t  <div className='drawer-content'>\n\t    {this.props.children}\n\t  </div>\n\t</SwipeableDrawer>\n      );\n    }\n  }\n}\n\nexport default withStyles(styles)(SidePanel);\n","import {complex_functions} from './complex-functions.js';\n\nconst restrictedFunctions = [];\n\nrestrictedFunctions.push(...Object.keys(complex_functions));\nrestrictedFunctions.push(...Object.values(complex_functions).map(f => f.name));\nrestrictedFunctions.push('z', 'i', 'e', 'pi', 'tau', 'phi');\n\n/* GLSL Keywords */\nrestrictedFunctions.push(\n  'attribute', 'const', 'uniform', 'varying',\n  'layout',\n  'centroid', 'flat', 'smooth', 'noperspective',\n  'break', 'continue', 'do', 'for', 'while', 'switch', 'case', 'default',\n  'if', 'else',\n  'in', 'out', 'inout',\n  'float', 'int', 'void', 'bool', 'true', 'false',\n  'invariant', 'discard', 'return',\n  'lowp', 'mediump', 'highp', 'precision',\n  'struct',\n  'common', 'partition', 'active',\n  'asm', 'class', 'union', 'enum', 'typedef', 'template',\n  'this', 'packed',\n  'goto', 'inline', 'noinline', 'volatile', 'public', 'static',\n  'extern', 'external', 'interface',\n  'long', 'short', 'double', 'half', 'fixed', 'unsigned', 'superp',\n  'input', 'output',\n  'filter',\n  'sizeof', 'cast',\n  'namespace', 'using'\n);\n\n/* GLSL Built-In Functions */\nrestrictedFunctions.push(\n  'radians', 'degrees',\n  'sin', 'cos', 'tan',\n  'asin', 'acos', 'atan',\n  'sinh', 'cosh', 'tanh',\n  'asinh', 'acosh', 'atanh',\n  'pow', 'exp', 'log', 'exp2', 'log2',\n  'sqrt', 'inversesqrt',\n  'abs', 'sign', 'floor', 'trunc', 'round',\n  'ceil', 'fract',\n  'mod', 'modf', 'min', 'max',\n  'clamp', 'mix', 'step', 'smoothstep',\n  'isnan', 'isinf',\n  'length', 'distance', 'dot',\n  'cross', 'normalize', 'ftransform',\n  'faceforward',\n  'reflect', 'refract',\n  'transpose', 'inverse',\n  'equal', 'any', 'all', 'not',\n  'texture'\n);\n\nconst functionList = new Set(restrictedFunctions);\nexport default functionList;\n","import React from 'react';\nimport { css } from '@emotion/css';\n\nimport functionList from '../../gl-code/function-list.js';\n\nimport ListItem from '@material-ui/core/ListItem';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\n\n\nconst blacklist = functionList;\n\nclass VariableAdder extends React.PureComponent {\n    constructor(props) {\n        super(props);\n        this.state = {\n            value: '',\n            errorMessage: ''\n        };\n    }\n\n    setValue(value) {\n        this.setState({value: value, errorMessage: ''});\n    }\n\n    handleKeyPress(event) {\n        if (event.keyCode === 13) {\n            this.handleClick();\n        }\n    }\n\n    handleClick() {\n        const name = this.state.value.toLowerCase();\n        if (name === '') {\n            this.setState({errorMessage: 'Must be nonempty'});\n        } else if (name.match(/^[a-z]+$/) === null) {\n            this.setState({errorMessage: 'Letters only'});\n        } else if (blacklist.has(name)) {\n            this.setState({errorMessage: 'Restricted keyword'});\n        } else {\n            this.setValue('');\n            this.props.onClick(name);\n        }\n    }\n\n    render() {\n        return (\n            <ListItem className={`variable-adder ${css`\n                margin-left: 10px;\n                width: 100%;\n            `}`}>\n                <TextField\n                    placeholder='Name'\n                    onChange={event => this.setValue(event.target.value)}\n                    onKeyDown={(event) => this.handleKeyPress(event)}\n                    error={this.state.errorMessage !== ''}\n                    helperText={this.state.errorMessage}\n                    value={this.state.value}\n                    className={css`\n                        flex-grow: 1;\n                    `}\n                />\n                <Button\n                    onClick={() => this.handleClick()}\n                >Add</Button>\n            </ListItem>\n        );\n    }\n}\n\nexport default VariableAdder;\n","function lowerParser(text) {\n    return text.toLowerCase();\n}\n\nfunction numberParser(text) {\n    const parsed = Number(text);\n\n    if (!Number.isNaN(parsed)) {\n        return parsed;\n    }\n}\n\nconst parsers = {\n    number: numberParser,\n    lower: lowerParser\n};\nexport default parsers;\n","import React, {PureComponent} from 'react';\nimport ContentEditable from 'react-contenteditable';\n\nimport DEFAULT_PARSERS from './parsers.js';\nimport './EditableValue.css';\n\n\nclass EditableValue extends PureComponent {\n    constructor() {\n        super();\n        this.state = {\n            focused: false,\n            text: ''\n        };\n        this.element = React.createRef();\n    }\n\n    /*** Value Parsing ***/\n    getParser() {\n        if (this.props.parser in DEFAULT_PARSERS) {\n            return DEFAULT_PARSERS[this.props.parser];\n        } else {\n            return this.props.parser;\n        }\n    }\n\n    parsedValue() {\n        return this.getParser()(this.state.text);\n    }\n\n    valid() {\n        return this.parsedValue() !== undefined;\n    }\n\n    // Resets this.state.text to match this.props.value\n    reset() {\n        const propText = this.props.value.toString();\n        if (propText !== this.state.text) {\n            this.setState({text: this.props.value.toString()});\n        }\n    }\n\n\n    /*** Event Handlers ***/\n    componentDidMount() {\n        // Exit on Enter keypress\n        document.addEventListener('keydown', e => {\n            if (e.key === 'Enter' && this.state.focused) {\n                this.element.current.blur();\n            }\n        });\n    }\n\n    handleFocus(e) {\n        this.setState({focused: true});\n        this.reset();\n    }\n\n    handleChange(e) {\n        this.setState({text: e.target.value.toString()});\n    }\n\n    handleBlur(e) {\n        this.setState({focused: false});\n\n        if (this.valid()) {\n            this.props.onChange(this.parsedValue());\n        }\n    }\n\n    componentDidUpdate() {if (!this.state.focused) {this.reset();}}\n\n    render() {\n        const classes = ['editable-value', this.props.name];\n\n        if (this.state.focused) {\n            classes.push('focus')\n            if (!this.valid()) {\n                classes.push('invalid')\n            };\n        }\n\n        const classString = classes.join(' ');\n        const current = this.element.current;\n        if (current !== null) {\n            this.element.current.setAttribute('class', classString);\n        }\n\n        const displayText = this.state.focused ? this.state.text : this.props.value.toString();\n\n        if (this.props.disabled) {\n            return (\n                <span className={classString}>\n                    {displayText}\n                </span>\n            );\n        } else {\n            return (\n                <ContentEditable\n                    html={displayText}\n\n                    onFocus={this.handleFocus.bind(this)}\n                    onChange={this.handleChange.bind(this)}\n                    onBlur={this.handleBlur.bind(this)}\n\n                    className={classString}\n\n                    tagName='span'\n\n                    innerRef={this.element}\n                />\n            );\n        }\n    }\n}\n\nexport default EditableValue;\n","import React, { PureComponent } from 'react';\nimport { css } from '@emotion/css';\n\n\nimport BaseSlider from '@material-ui/core/Slider';\nimport IconButton from '@material-ui/core/IconButton';\nimport DeleteIcon from '@material-ui/icons/Delete';\n\nimport PlayIcon from '@material-ui/icons/PlayArrow';\nimport BounceIcon from '@material-ui/icons/SyncAlt';\nimport LoopIcon from '@material-ui/icons/ArrowRightAlt';\n\nimport EditableValue from '../editable-value/EditableValue.js';\n\nimport './Slider.css';\n\nconst SPEEDS = [\n    0.2,\n    0.5,\n    1,\n    2,\n    3,\n    4\n];\n\nfunction AnimationMode({mode, speed, onChangeMode, onChangeSpeed}) {\n    const nextMode = {\n        '': 'bounce',\n        'bounce': 'loop',\n        'loop': '',\n    };\n    const icons = {\n        '': PlayIcon,\n        'bounce': BounceIcon, \n        'loop': LoopIcon,\n    }\n    const Icon = icons[mode];\n\n    return <div className={css`\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        margin-right: 10px;\n    `}>\n        <Icon className={css`\n            color: ${mode === '' ? 'hsl(200, 10%, 80%)' : 'hsl(200, 60%, 50%)'};\n            cursor: pointer;\n        `}\n        onClick={() => {\n            const newMode = nextMode[mode];\n            onChangeMode(newMode) ;\n        }}/>\n        <span\n            onClick={() => {\n                onChangeSpeed((speed + 1) % SPEEDS.length);\n            }}\n            className={css`\n                font-size: 14px;\n                color: hsl(200, 20%, 40%);\n                cursor: pointer;\n                font-family: 'KaTeX_Main';\n                user-select: none;\n            `}\n        >\n            {SPEEDS[speed].toFixed(1)}\n        </span>\n    </div>;\n}\n\n\nclass Slider extends PureComponent {\n    state = {\n        min: 0,\n        max: 1,\n        animationMode: '',\n        animationSpeed: 2,\n        animationCurrentDirection: 1,\n        changing: false,\n    };\n    deleted = false;\n\n\n    setMin(min) {\n        const {value, onChange} = this.props;\n        this.setState({min});\n        if (value < min) {onChange(min);}\n    }\n\n    setMax(max) {\n        const {value, onChange} = this.props;\n        this.setState({max});\n        if (value > max) {onChange(max);}\n    }\n\n    setValue(value) {\n        this.ensureConsistency();\n        this.props.onChange(value);\n    }\n\n    // Adjust this.state.min and this.state.max\n    // if this.props.value is out of bounds.\n    ensureConsistency() {\n        const [min, max, value] = [this.state.min, this.state.max, this.props.value];\n        if (min > value) {this.setState({min: value});}\n        if (max < value) {this.setState({max: value});}\n    }\n\n    runAnimationTick(timestamp) {\n        const {onChange, value} = this.props;\n        const {\n            min, max,\n            animationMode, animationCurrentDirection, animationSpeed\n        } = this.state;\n\n        if (this.deleted) {return;}\n\n        let dt = 0;\n        if (timestamp !== undefined && this.lastAnimationTick !== undefined) {\n            dt = timestamp - this.lastAnimationTick;\n        }\n        this.lastAnimationTick = timestamp;\n\n        const delta = (max - min) * SPEEDS[animationSpeed] * animationCurrentDirection * dt/4e3;\n        let newValue = value + delta;\n\n        if (animationMode === 'bounce') {\n            if (newValue > max) {\n                newValue = max;\n                this.setState({animationCurrentDirection: -1});\n            }\n            if (newValue < min) {\n                newValue = min;\n                this.setState({animationCurrentDirection: 1});\n            }\n        }\n\n        if (animationMode === 'loop') {\n            if (newValue > max) {newValue = min;}\n        }\n\n        onChange(Math.round(1e3 * newValue)/1e3);\n\n        if (animationMode === '') {return;}\n        if (this._mounted) {\n          requestAnimationFrame(this.runAnimationTick.bind(this));\n        }\n    }\n\n    componentDidMount() {\n        this.ensureConsistency();\n        this._mounted = true;\n    }\n\n    componentWillUnmount() {\n        this._mounted = false;\n        this.props.setChanging(false);\n    }\n\n    handleCommit() {\n        this.setState({changing: false});\n        this.props.setChanging(this.state.animationMode !== '');\n    }\n\n    render() {\n        const {min, max, animationMode, animationSpeed, changing} = this.state;\n        return (\n            <div className={`slider-wrapper ${css`\n                display: flex;\n                flex-direction: row;\n                align-items: center;\n                padding: 5px 0;\n                margin: 8px 4px;\n                padding-left: 10px;\n                background-color: white;\n                border-radius: 8px;\n                `}`}\n                onMouseUp={this.handleCommit.bind(this)}\n                onTouchEnd={this.handleCommit.bind(this)}\n             >\n                <AnimationMode\n                    mode={animationMode}\n                    speed={animationSpeed}\n                    onChangeMode={\n                        (mode) => {\n                            this.state.animationMode = mode; // To avoid race conditions\n                            this.setState({animationMode: mode, animationCurrentDirection: 1});\n                            this.runAnimationTick();\n                            this.props.setChanging(mode !== '');\n                        }\n                    }\n                    onChangeSpeed={\n                        (speed) => {\n                            this.setState({animationSpeed: speed});\n                        }\n                    }\n                />\n                <div className='slider'>\n                    <div className='info-row'>\n                        <EditableValue\n                            name={'name' + (this.props.name.length === 1 ? '-italic' : '')}\n                            value={this.props.name}\n                            parser='lower'\n                            onChange={this.props.onNameChange}\n                            disabled\n                        />\n                        <span>=</span>\n                        <EditableValue\n                            name='value'\n                            value={this.props.value}\n                            parser='number'\n                            onChange={this.setValue.bind(this)}\n                        />\n                    </div>\n                    <div className='main-row'>\n                        <EditableValue\n                            name='lower-bound'\n                            value={min}\n                            parser='number'\n                            onChange={this.setMin.bind(this)}\n                        />\n                        <BaseSlider\n                            className='main-slider'\n                            min={min}\n                            max={max}\n                            value={this.props.value}\n                            step={(max - min)/1e3}\n                            onChange={(e, v) => {\n                                if (!this.state.changing) {this.props.setChanging(true);}\n                                this.state.changing = true;\n                                this.setValue(v);\n                            }}\n                        />\n                        <EditableValue\n                            name='upper-bound'\n                            value={max}\n                            parser='number'\n                            onChange={this.setMax.bind(this)}\n                        />\n                    </div>\n                </div>\n                <IconButton onClick={() => {\n                    this.deleted = true;\n                    this.props.onDelete();\n                }} className='delete-icon'>\n                    <DeleteIcon/>\n                </IconButton>\n            </div>\n        );\n    }\n}\n\nexport default Slider;\n","import React from 'react';\n\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\n\nimport VariableAdder from './VariableAdder.js';\n\nimport Slider from './slider/Slider.js';\n\nimport './slider-panel.css';\n\n\nconst hiddenVariables = new Set([\n  'log_scale', 'center_x', 'center_y',\n\n  'enable_checkerboard',\n  'invert_gradient',\n  'continuous_gradient',\n  'enable_axes',\n\n  'custom_function'\n]);\n\nclass SliderPanel extends React.Component {\n  constructor(props) {\n    super(props);\n    this.textField = React.createRef();\n    this.changing = {}\n  }\n\n  handleChange(name, value) {\n    this.props.variables[name] = value;\n    this.props.onUpdate({[name]: value});\n    this.forceUpdate();\n  }\n\n  handleSetChanging(name, v) {\n    this.changing[name] = v;\n    this.props.setChanging(Object.keys(this.props.variables).some((x) => this.changing[x]));\n  }\n\n  renderSliderList() {\n    const {variables} = this.props;\n    let sliderList = [];\n    for (const [name, value] of Object.entries(variables)) {\n      // Skip variables in hidden blacklist\n      if (hiddenVariables.has(name)) {continue;}\n\n      // Return slider component\n      sliderList.push(\n\t<Slider \n\t  key={name}\n\t  name={name}\n\t  value={value}\n\t  onChange={(value) => this.handleChange(name, value)}\n\t  onDelete={() => this.props.onRemove(name)}\n            setChanging={(v) => this.handleSetChanging(name, v)}\n\t/>\n      );\n    }\n\n    return sliderList;\n  }\n\n  render() {\n    return (<List className='slider-list'>\n\t<ListSubheader disableSticky>Variables</ListSubheader>\n\t{this.renderSliderList()}\n\t<VariableAdder\n\t  onClick={name => this.props.onAdd(name, 0.5)}\n\t/>\n      </List>\n    );\n  }\n}\n\nexport {hiddenVariables};\nexport default SliderPanel;\n","import React from 'react';\n\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Checkbox from '@material-ui/core/Checkbox';\n\n\nclass BooleanOption extends React.PureComponent {\n  render() {\n    const {onClick, checked, label} = this.props;\n    return (\n      <ListItem\n\tbutton\n\tonClick={onClick}\n      >\n\t<Checkbox\n\t  checked={checked}\n\t/>\n\t<ListItemText>{label}</ListItemText>\n      </ListItem>\n    );\n  }\n}\n\nclass OptionsPanel extends React.PureComponent {\n  renderOptions() {\n    const options = [];\n    for (const [variable, label] of Object.entries(this.props.options)) {\n      options.push(\n\t<BooleanOption\n\t  key={variable}\n\t  onClick={() => this.props.onToggle(variable)}\n\t  checked={this.props.variables[variable] > 0.5}\n\t  label={label}\n\t/>\n      );\n    }\n    return options;\n  }\n\n  render() {\n    return (\n      <List id='options-panel'>\n\t<ListSubheader disableSticky>{this.props.heading}</ListSubheader>\n\t{this.renderOptions()}\n      </List>\n    );\n  }\n}\n\nexport default OptionsPanel;\n","import React from 'react';\nimport { css } from '@emotion/css';\n\nimport {InlineMath, BlockMath} from 'react-katex';\n\nimport {formatComplex} from '../util';\n\nconst PREFIX = '\\\\int_{\\\\gamma} f(z) \\\\, \\\\mathrm{d}z = ';\n\nexport default ({x, y, style}) => {\n    let contents = <div className={css`\n        color: hsl(0, 100%, 30%);\n        font-size: 18px;\n        padding: 8px 0;\n    `}>\n        Custom functions are currently unsupported.\n    </div>;\n\n    if (isFinite(x) && isFinite(y)) {\n        if (window.innerWidth < 700) {\n            contents = <div className={css`\n            font-size: 16px;\n            color: hsl(213, 10%, 15%);\n\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n\n            margin: 5px 0;\n        `}>\n                <InlineMath>{PREFIX}</InlineMath>\n                <InlineMath>{formatComplex(x, y, 3)}</InlineMath>\n            </div>;\n        } else {\n            contents = <div className={css`\n            margin: -10px 0;\n            font-size: 20px;\n            color: hsl(213, 10%, 15%);\n        `}>\n                <BlockMath>{PREFIX + formatComplex(x, y, 5)}</BlockMath>\n            </div>;\n        }\n    }\n\n    return <div className={css`\n        background-color: white;\n        box-shadow: 3px 3px 8px hsla(213, 10%, 10%, 0.2);\n        border: 1px solid hsl(213, 10%, 85%);\n        border-radius: 8px;\n\n        padding: 0 15px;\n    `} style={style || {}}>\n        <div className='math'>{contents}</div>\n    </div>};\n","class Strategy {\n    constructor(mapping, canvas, dpr) {\n        this.mapping = mapping;\n        this.canvas = canvas;\n        this.dpr = dpr;\n\n        this.initialize();\n    }\n\n    initialize() {\n        this.canvas.strokeStyle = 'white';\n        this.canvas.lineWidth = 2 * this.dpr;\n    }\n    \n    update(data) {\n        const {x, y, clientX, clientY} = data;\n        this.integrate(x, y);\n        this.draw(clientX, clientY);\n    }\n\n    finish() {}\n\n    integrate(x, y) {}\n\n    draw(x, y) {}\n\n    value() {\n        return [0, 0];\n    }\n}\n\nexport default Strategy;\n","// 16-point Gaussian quadrature\nconst GAUSS_COEFFICIENTS = [\n    [0.1894506104550685,  0.0950125098376374],\n    [0.1826034150449236,  0.2816035507792589],\n    [0.1691565193950025,  0.4580167776572274],\n    [0.1495959888165767,  0.6178762444026438],\n    [0.1246289712555339,  0.7554044083550030],\n    [0.0951585116824928,  0.8656312023878318],\n    [0.0622535239386479,  0.9445750230732326],\n    [0.0271524594117541,  0.9894009349916499],\n\n    [0.1894506104550685, -0.0950125098376374],\n    [0.1826034150449236, -0.2816035507792589],\n    [0.1691565193950025, -0.4580167776572274],\n    [0.1495959888165767, -0.6178762444026438],\n    [0.1246289712555339, -0.7554044083550030],\n    [0.0951585116824928, -0.8656312023878318],\n    [0.0622535239386479, -0.9445750230732326],\n    [0.0271524594117541, -0.9894009349916499],\n];\n\n// Integrates a function R -> C\n// from start to end via\n// Gaussian quadrature.\nfunction integrateReal(start, end, mapping) {\n    // Reparameterize to [-1, 1]\n    const dx = end - start;\n    const submap = t => mapping(\n        start + 0.5 * dx * (1 + t)\n    );\n\n    // Estimate average value of f over the given interval\n    const result = [0, 0];\n    for (let [weight, abscissa] of GAUSS_COEFFICIENTS) {\n        const [u, v] = submap(abscissa);\n        result[0] += u * dx * weight / 2;\n        result[1] += v * dx * weight / 2;\n    }\n    return result;\n}\n\n// Integrates f(z) dz along the given line segment.\n// Start and end are 2-tuples representing\n// the start and end points in the complex plane.\n// Mapping is a function [x, y] -> [u, v]\n// representing f.\nfunction integrateSegment(start, end, mapping) {\n    const [x0, y0] = start;\n    const [x1, y1] = end;\n\n    // Compute dz\n    const dx = x1 - x0;\n    const dy = y1 - y0;\n\n    // Approximate average value of f(z)\n    // along the segment by Gaussian quadrature\n    const submap = t => mapping([\n        x0 + t * dx,\n        y0 + t * dy,\n    ]);\n    const [u, v] = integrateReal(0, 1, submap);\n\n    return [\n        u * dx - v * dy,\n        v * dx + u * dy,\n    ];\n}\n\nexport {integrateReal, integrateSegment};\n","import Strategy from './Strategy';\n\nimport {isNil} from 'lodash';\n\nimport {integrateSegment} from './util';\n\n\nclass FreeformIntegrator extends Strategy {\n    accumulator = [0, 0];\n\n    lastPoint = null;\n    lastPagePoint = null;\n\n    integrate(x, y) {\n        if (!isNil(this.lastPoint)) {\n            // Integrate along segment between last and current points\n            const df = integrateSegment(this.lastPoint, [x, y], this.mapping);\n            this.accumulator[0] += df[0]\n            this.accumulator[1] += df[1];\n        }\n        this.lastPoint = [x, y];\n    }\n\n    draw(x, y) {\n        if (!isNil(this.lastPagePoint)) {\n            const [lastX, lastY] = this.lastPagePoint;\n            this.canvas.beginPath();\n            this.canvas.moveTo(lastX, lastY);\n            this.canvas.lineTo(x, y);\n            this.canvas.stroke();\n        }\n        this.lastPagePoint = [x, y];\n    }\n\n    value() {\n        return this.accumulator;\n    }\n}\n\nexport default FreeformIntegrator;\n","import Strategy from './Strategy';\n\nimport {isNil} from 'lodash';\n\nimport {integrateReal} from './util';\n\n// Kahan summation algorithm\nfunction kahanSum(list) {\n    let sum = 0;\n    let c = 0;\n\n    for (let entry of list) {\n        const y = entry - c;\n        const t = sum + y;\n        c = (t - sum) - y;\n        sum = t;\n    }\n\n    return sum;\n}\n\n\nclass Circle extends Strategy {\n    center = null;\n    radius = null;\n\n    pageCenter = null;\n    pageRadius = null;\n\n    integrate(x, y) {\n        if (isNil(this.center)) {this.center = [x, y];}\n        this.radius = Math.hypot(x - this.center[0], y - this.center[1]);\n    }\n\n    draw(x, y) {\n        if (isNil(this.pageCenter)) {this.pageCenter = [x, y];}\n        this.pageRadius = Math.hypot(x - this.pageCenter[0], y - this.pageCenter[1]);\n\n        this.canvas.clearRect(0, 0, this.canvas.canvas.width, this.canvas.canvas.height);\n        this.canvas.beginPath();\n        this.canvas.arc(...this.pageCenter, this.pageRadius, 0, 2 * Math.PI);\n        this.canvas.stroke();\n    }\n\n    value() {\n        // Return 0 if not initialized\n        if (isNil(this.center)) {return [0, 0];}\n        const [x, y] = this.center;\n\n        // Parameterize circle and compute pullback of integrand\n        const gamma = theta => [\n            x + this.radius * Math.cos(theta),\n            y + this.radius * Math.sin(theta),\n        ];\n        const gammaPrime = theta => [\n            -this.radius * Math.sin(theta),\n            this.radius * Math.cos(theta),\n        ];\n        const integrand = theta => {\n            const [u, v] = this.mapping(gamma(theta));\n            const [up, vp] = gammaPrime(theta);\n            return [u * up - v * vp, u * vp + v * up];\n        }\n\n        // Divide circle into arcs and integrate along each\n        const N = 32;\n        const scaleFactor = 2 * Math.PI / N;\n        const summands = [[], []];\n        for (let i=0; i < N; i++) {\n            const [u, v] = integrateReal(\n                i * scaleFactor, (i + 1) * scaleFactor, integrand\n            );\n            summands[0].push(u);\n            summands[1].push(v);\n        }\n\n        return [kahanSum(summands[0]), kahanSum(summands[1])];\n    }\n}\n\nexport default Circle;\n","import React, {PureComponent} from 'react';\n\nimport {isNil} from 'lodash';\n\nimport {pixelToPlot} from '../FunctionPlot';\nimport toJS from '../../gl-code/translators/to-js';\n\nimport ResultTooltip from './ResultTooltip';\n\nimport FreeformStrategy from './strategies/Freeform';\nimport ClosedFreeformStrategy from './strategies/FreeformClosed';\nimport CircleStrategy from './strategies/Circle';\n\nconst STRATEGY_DICT = {\n    'freeform': FreeformStrategy,\n    'freeform-closed': ClosedFreeformStrategy,\n    'circle': CircleStrategy,\n}\n\nclass IntegralCalculator extends PureComponent {\n    state = {\n        done: false,\n\n        mouseDown: false,\n        mousePosition: null,\n        strategy: null,\n    }\n\n    constructor(props) {\n        super(props);\n\n        // Create canvas ref\n        this.canvas = React.createRef();\n    }\n\n    resizeCanvas() {\n        const canvas = this.canvas.current;\n        const dpr = window.devicePixelRatio;\n        canvas.width = canvas.offsetWidth * dpr;\n        canvas.height = canvas.offsetHeight * dpr;\n    }\n\n\n    // Re-initialized the state if dirty\n    resetState() {\n        const {done} = this.state;\n        if (done) {\n            this.setState({\n                done: false,\n                mousePosition: null,\n                strategy: null,\n           });\n        }\n    }\n\n    handleMouseDown(e) {\n        const {integrator, expression, variables, onClose} = this.props;\n        const {done} = this.state;\n\n        if (done) {\n            // Close if already integrated once\n            onClose();\n        } else {\n            // Compile plotted expression to JS\n            const mapping = toJS(expression, variables);\n\n            // Clear canvas\n            this.resizeCanvas();\n            const context = this.canvas.current.getContext('2d');\n            context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n\n            // Start integrating\n            this.setState({\n                mouseDown: true,\n                strategy: new STRATEGY_DICT[integrator](\n                    mapping, context, window.devicePixelRatio,\n                ),\n            });\n        }\n    }\n\n    handleMouseMove(e) {\n        const {strategy, mouseDown} = this.state;\n        const {variables} = this.props;\n\n        if (!mouseDown) {return;}\n\n        const {clientX, clientY} = e;\n        const [x, y] = pixelToPlot(clientX, clientY, variables);\n\n        this.setState({mousePosition: [clientX, clientY]});\n\n        if (!isNil(strategy)) {\n            const dpr = window.devicePixelRatio;\n            strategy.update({\n                x, y,\n                clientX: clientX * dpr,\n                clientY: clientY * dpr,\n            });\n        }\n    }\n\n    handleMouseUp(e) {\n        const {strategy} = this.state;\n\n        // Notify integrator\n        strategy.finish();\n\n        // Set finished state\n        this.setState({mouseDown: false, done: true});\n    }\n\n    render() {\n        const {integrator} = this.props;\n        const {done, mouseDown, mousePosition, strategy} = this.state;\n\n        if (isNil(integrator)) {\n            this.resetState();\n            return null;\n        }\n\n        let tooltip = null;\n        if (!(isNil(strategy) || isNil(mousePosition))) {\n            const [x, y] = strategy.value();\n\n            const snap = x => (Math.abs(x) < 1e-10 ? 0 : x);\n\n            tooltip = <ResultTooltip\n                x={snap(x)} y={snap(y)}\n                style={{\n                    position: 'absolute',\n                    top: mousePosition[1],\n                    left: mousePosition[0] - (window.innerWidth < 700 ? 80 : 0),\n                    zIndex: 3,\n                }}\n            />;\n        }\n\n\n        return <div className='integral container'\n            onMouseDown={this.handleMouseDown.bind(this)}\n            onMouseMove={this.handleMouseMove.bind(this)}\n            onMouseUp={this.handleMouseUp.bind(this)}\n\n            onTouchStart={this.handleMouseDown.bind(this)}\n            onTouchMove={e => this.handleMouseMove(e.touches[0])}\n            onTouchEnd={this.handleMouseUp.bind(this)}\n        >\n            <canvas\n                ref={this.canvas}\n                className='canvas'\n            />\n            {tooltip}\n            <p className='instructions'>\n                Click and drag to draw a contour\n            </p>\n            <style>{`\n                .integral.container {\n                    position: absolute;\n\n                    top: 0;\n                    bottom: 0;\n                    left: 0;\n                    right: 0;\n\n                    z-index: 15;\n                    cursor: ${done ? 'default' : 'crosshair'};\n\n                    overflow: hidden;\n\n                    background-color: hsla(213, 10%, 10%, 0.6);\n\n                    display: flex;\n                    flex-direction: row;\n                    align-items: center;\n                    justify-content: center;\n                }\n\n                .integral canvas.canvas {\n                    position: absolute;\n                    top: 0;\n                    left: 0;\n\n                    width: 100%;\n                    height: 100%;\n                    \n                    z-index: 1;\n                }\n\n                .integral .instructions {\n                    color: hsl(213, 10%, 85%);\n                    font-size: 20px;\n                    text-align: center;\n\n                    margin: 0;\n                    display: ${mouseDown || done ? 'none' : 'block'};\n                    z-index: 2;\n                }\n            `}</style>\n        </div>;\n    }\n}\n\nexport default IntegralCalculator;\n","import Freeform from './Freeform';\n\nimport {isNil} from 'lodash';\n\nclass FreeformClosed extends Freeform {\n    startPoint = null;\n    startPagePoint = null;\n\n    integrate(x, y) {\n        super.integrate(x, y);\n        if (isNil(this.startPoint)) {\n            this.startPoint = [x, y];\n        }\n    }\n\n    draw(x, y) {\n        super.draw(x, y);\n        if (isNil(this.startPagePoint)) {\n            this.startPagePoint = [x, y];\n        }\n    }\n\n    finish() {\n        if (isNil(this.startPoint) || isNil(this.startPagePoint)) {return;}\n\n        // Loop back to start\n        const [x, y] = this.startPoint;\n        const [clientX, clientY] = this.startPagePoint;\n        this.update({\n            x, y,\n            clientX, clientY\n        });\n    }\n}\n\nexport default FreeformClosed;\n","import React, {PureComponent} from 'react';\n\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\n\nimport FreeformIcon from '@material-ui/icons/Brush';\nimport ClosedLoopIcon from '@material-ui/icons/SettingsBackupRestore';\nimport CircleIcon from '@material-ui/icons/PanoramaFishEye';\n\n\nconst calculators = [\n    {\n        strategy: 'freeform',\n        label: 'Freeform',\n        icon: <FreeformIcon/>,\n    },\n    {\n        strategy: 'freeform-closed',\n        label: 'Freeform (Closed Loop)',\n        icon: <ClosedLoopIcon/>,\n    },\n    {\n        strategy: 'circle',\n        label: 'Circular Contour',\n        icon: <CircleIcon/>,\n    },\n];\n\nclass IntegralPanel extends PureComponent {\n    renderIntegrator(entry) {\n        const {strategy, label, icon} = entry;\n        const {hidePanels, openCalculator} = this.props;\n\n        const onClick = () => {\n            // Hide panels on mobile\n            if (window.innerWidth < 700) {hidePanels();}\n\n            // Close existing calculator, if present\n            openCalculator(null);\n\n            // Show desired integral calculator\n            // (setTimeout to ensure old calculator closes)\n            setTimeout(() => openCalculator(strategy), 0);\n        };\n\n        return <ListItem button key={strategy} onClick={onClick}>\n            <ListItemIcon>{icon}</ListItemIcon>\n            <ListItemText style={{paddingLeft: 0}}>{label}</ListItemText>\n        </ListItem>;\n    }\n\n    render() {\n        return <List>\n            <ListSubheader disableSticky>Contour Integrals</ListSubheader>\n            {calculators.map(this.renderIntegrator.bind(this))}\n        </List>;\n    }\n}\n\nexport default IntegralPanel;\n","import React from 'react';\n\nimport Typography from '@material-ui/core/Typography';\n\nimport Editor from 'react-simple-code-editor';\nimport { highlight, languages } from 'prismjs/components/prism-core';\nimport 'prismjs/components/prism-clike';\nimport 'prismjs/components/prism-c';\nimport 'prismjs/components/prism-glsl';\nimport 'prismjs/themes/prism-okaidia.css';\n\nimport './function-editor.css';\n\nexport default ({value, onChange, errorMessage}) => <div id='function-editor'>\n    <Typography variant='caption'>\n      Please read the Advanced Features documentation in the right pane before proceeding!\n      <br/>\n      Compilation errors are currently logged to the developer console.\n    </Typography>\n    <Editor\n        value={value}\n        onValueChange={onChange}\n        highlight={code => {var a = highlight(code, languages.glsl); console.log(a); return a;}}\n        padding={10}\n        style={{\n          fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n          fontSize: 14,\n          backgroundColor: 'hsl(200, 20%, 10%)',\n          color: 'white',\n          marginTop: 10,\n          borderRadius: 8,\n        }}\n    />\n    <Typography variant='caption'>\n        <br/>\n        This pane is resizable! Use the handle on the bottom-right corner.\n    </Typography>\n</div>;\n","import React from 'react';\n\nimport withStyles from '@material-ui/core/styles/withStyles';\n\nimport Typography from '@material-ui/core/Typography';\nimport Chip from '@material-ui/core/Chip';\nimport Accordion from '@material-ui/core/Accordion';\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\n\nimport MenuIcon from '@material-ui/icons/Menu';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\n\nimport {Light as SyntaxHighlighter} from 'react-syntax-highlighter';\nimport glslHighlighter from 'react-syntax-highlighter/dist/esm/languages/hljs/glsl';\nimport { docco } from 'react-syntax-highlighter/dist/esm/styles/hljs';\n\nimport './help-text.css';\n\nSyntaxHighlighter.registerLanguage('glsl', glslHighlighter);\n\n\nconst styles = theme => ({\n    buttonStyle: {\n        ...theme.typography.button\n    },\n    chip: {\n        margin: 3\n    }\n});\n\nconst supportedFunctions = [\n    {\n        name: 'Operators',\n        entries: ['+', '-', '*', '/', '^', '!']\n    },\n    {\n        name: 'Trigonometry',\n        entries: [\n            'sin', 'cos', 'tan', 'sec', 'csc', 'cot',\n            'arcsin', 'arccos', 'arctan', 'arcsec', 'arccsc', 'arccot',\n            'sinh', 'cosh', 'tanh', 'sech', 'csch', 'coth',\n            'arsinh', 'arcosh', 'artanh', 'arsech', 'arcsch', 'arcoth'\n        ]\n    },\n    {\n        name: 'Exponential',\n        entries: ['exp', 'log', 'ln']\n    },\n    {\n        name: 'Constants',\n        entries: ['e', 'pi', 'phi', 'tau'],\n    },\n    {\n        name: 'Elliptic/Modular',\n        entries: [\n            'sn(z, k)',\n            'cn(z, k)',\n            'dn(z, k)',\n            'wp(z, )',\n            \"wp'(z, )\",\n            'sm', 'cm',\n            'theta00(z, )',\n            'theta01(z, )',\n            'theta10(z, )',\n            'theta11(z, )',\n            'j()',\n        ]\n    },\n    {\n        name: 'Special Functions',\n        entries: [\n            'sqrt',\n            'gamma', 'eta', 'zeta',\n            'erf',\n        ]\n    },\n    {\n        name: 'Miscellaneous',\n        entries: [\n            'abs', 'arg', 'sgn', 'cis',\n            'conj',\n            'real', 'imag',\n            'floor', 'ceil', 'round', 'step',\n        ]\n    },\n    {\n        name: 'Higher-Order Functions',\n        entries: [\n            'sum', 'product', 'derivative'\n        ]\n    }\n];\n\n\nconst EXAMPLES = {\n    '+': 'z + t',\n    '-': 'z - t',\n    '*': 't * z',\n    '/': '1/z',\n    '^': 'z^z^z^z^z^z^z',\n    '!': 'z!',\n\n    'e': null,\n    'pi': null,\n    'tau': null,\n    'phi': null,\n\n    'sn(z, k)': 'sn(z, t + i)',\n    'cn(z, k)': 'cn(z, t + i)',\n    'dn(z, k)': 'dn(z, t + i)',\n    'wp(z, )': 'wp(z, t + i)',\n    \"wp'(z, )\": \"wp'(z, t + i)\",\n    'theta00(z, )': 'theta00(z, t + i)',\n    'theta01(z, )': 'theta01(z, t + i)',\n    'theta10(z, )': 'theta10(z, t + i)',\n    'theta11(z, )': 'theta11(z, t + i)',\n    'j()': 'j(z)',\n\n    'sum': 'sum(z^n/n!, n, 0, 5)',\n    'product': 'prod(1-z/n, n, 1, 5)',\n    'derivative': 'diff(cos(z*t), t)',\n};\n\n\nclass HelpText extends React.Component {\n    constructor(props) {\n        super(props);\n        this.classes = props.classes;\n    }\n\n    shouldComponentUpdate() {\n        return false;\n    }\n\n    renderChips(entries) {\n        const {setExpression, closeMenu} = this.props;\n        const showExample = (label) => setExpression(\n            EXAMPLES[label] || `${label}(z)`\n        );\n        return entries.map(label =>\n            <Chip \n                key={label}\n                label={label}\n                onClick={EXAMPLES[label] === null ? undefined : () => {\n                    if (window.innerWidth <= 900) {closeMenu();}\n                    showExample(label);\n                }}\n                className={this.classes.chip}\n            />\n        );\n    }\n\n    renderSupportedFunctions() {\n        const sections = []\n        for (const section of supportedFunctions) {\n            sections.push(\n                <div key={section.name}>\n                    <h3>{section.name}</h3>\n                    {this.renderChips(section.entries)}\n                </div>\n            );\n        }\n        return sections;\n    }\n\n    render() {\n        return (\n            <div id='help-text'>\n                <h1>\n                    <img src='android-chrome-192x192.png' className='logo' alt='logo'/>\n                    <div className='text'>\n                        Complex Function Plotter\n                        <div className='subtitle'>\n                            Made with {'<3'} by Samuel J. Li\n                        </div>\n                    </div>\n                </h1>\n\n                <h2>Introduction</h2>\n                <p>Creates interactive domain-coloring plots of complex functions.</p>\n                <p>Each point on the complex plane is colored according to the value of the function at that point.\n                    Hue and brightness are used to display phase and magnitude, respectively.</p>\n                <p>To increase the displayable range of values, brightness cycles from dark to light repeatedly with magnitude, jumping at every power of two.\n                    The edges of regions with different brightness correspond to curves along which the function has constant magnitude.\n                </p>\n                <p>This method allows for quick visualization of the locations and orders of any poles and zeros.\n                    For more information, see the <a href='https://en.wikipedia.org/wiki/Domain_coloring'>Wikipedia article on domain coloring.</a></p>\n\n                <h2>Controls</h2>\n                <p>To plot a complex function, enter its expression in the top bar. Parentheses (curved or square), complex number literals, and arbitrary variables (see Variables below) are supported. Input is case-insensitive.</p>\n                <p>A red underline will appear if the expression cannot be plotted. You might have made a syntax error or forgot to declare a variable.</p>\n                <p>Drag the plot to pan, and use the scroll wheel to zoom in and out.</p>\n\n                <h2>Supported Functions</h2>\n                <p>Click on any function to see an example.</p>\n                <div className='help-indent'>\n                    {this.renderSupportedFunctions()}\n                    <p style={{marginTop: 16}}></p>\n                    <Typography variant='caption'>Warning: Large sums or products may cause the plotter to freeze!</Typography>\n                </div>\n\n                <h2>Variables</h2>\n                <p>Expressions can contain arbitrary user-defined variables.</p>\n                <p>\n                    Click on the <MenuIcon style={{fontSize: 20, marginBottom: -5}}/> icon in the upper-left corner to open the variables panel.\n                    Variables can be added with the <span className={this.classes.buttonStyle}>Add</span> button and removed with the <DeleteIcon style={{fontSize: 20, marginBottom: -5}}/> button.</p>\n\n                <p>\n                    Click on the variables current value or the sliders upper & lower bounds to edit them.\n                </p>\n\n                <p>Any string of lowercase letters can be used as a variable name, except for reserved functions, the built-in variable <i>z</i>, and the constant <i>i</i>.</p>\n\n                <h2>Contour Integrals</h2>\n                <p>The calculator is able to compute arbitrary contour integrals and residues. The following options\n                    are available under the Contour Integral section of the left pane:</p>\n\n                <div className='help-indent'>\n                    <h3>Freeform</h3>\n                    <p>After selecting this option, click and drag to draw an arbitrary contour. The integral of the currently plotted function along the given contour will be displayed.</p>\n\n                    <h3>Freeform (Closed Loop)</h3>\n                    <p>Same as Freeform, except that the contour is closed with a line segment connecting the start and end points after it is drawn.</p>\n\n                    <h3>Circular Contour</h3>\n                    <p>After selecting this option, click and drag to draw a circular contour. The integral of the currently plotted function along the given circle (with counterclockwise orientation) will be displayed.</p>\n                </div>\n\n                <p>Note that custom functions and some of the more intricate built-in functions are not yet supported.\n                    The computed values are generally accurate to the displayed precision unless the function is highly pathological.</p>\n\n\n                <h2>Graphics Options</h2>\n                <p>The following options can be found below the variables panel:</p>\n\n                <div className='help-indent'>\n                    <h3>Enable Checkerboard</h3>\n                    <p>Overlays a checkerboard with eight squares per unit length, colored according to the real and imaginary parts of the functions value.</p>\n\n                    <h3>Invert Gradient</h3>\n                    <p>Reverses the direction of the magnitude gradient. When the gradient is inverted, the apparent height of the layers formed correlate with the magnitude of the function.</p>\n\n                    <h3>Continuous Gradient</h3>\n                    <p>Use a continuous magnitude gradient rather than the stepped default. Reduces the range of visually discernible magnitudes, but removes shading artifacts in certain situations.</p>\n                    <h3>Enable Axes</h3>\n                    <p>Overlay coordinate axes and gridlines on the plot. May decrease performance on some devices.</p>\n                </div>\n\n                <h2>Tips</h2>\n                <p>To share a graph, just copy and paste the URL! The address automatically changes to reflect the plotted expression.</p>\n\n                <h2>Advanced Features</h2>\n                <Accordion style={{margin: '0 -5px'}}>\n                    <AccordionSummary expandIcon={<ExpandMoreIcon/>}>\n                        <Typography variant='caption'>\n                            Please read thoroughly iff you are using advanced options.\n                        </Typography>\n                    </AccordionSummary>\n                    <AccordionDetails>\n                        <div>\n                            <h3>Custom Functions</h3>\n                            <p>This option can be found under the Advanced Options heading in the left pane. Overrides the main expression bar, allowing you to code your own function.</p>\n                            <p>Custom functions use the <a href='https://en.wikipedia.org/wiki/OpenGL_Shading_Language'>GLSL</a> programming language. If you've never worked with GLSL before, it's extremely similar to C. Here are a few tips and caveats:</p>\n                            <ul>\n                                <li>Complex numbers are represented by the <tt>vec2</tt> type, which represents a 2D vector. The real part can be accessed through <tt>z.x</tt> and the imaginary part by <tt>z.y</tt>.</li>\n                                <li>Your custom function should be named <tt>mapping</tt>, and should take one input of type <tt>vec2</tt> and return an output of type <tt>vec2</tt>.</li>\n                                <li>Complex number literals <i>a+bi</i> should be entered as <tt>vec2(a, b)</tt>, even if they are real. GLSL doesnt support addition or subtraction between the complex <tt>vec2</tt> type and floats. Scalar multiplication should work fine with floats, however. For convenience, there are constants <tt>ONE</tt> and <tt>I</tt> available.</li>\n                                <li>Addition and subtraction operators (<tt>+</tt> and <tt>-</tt>) work fine between <tt>vec2</tt> complex numbers. However, multiplication, division, and exponentiation operators act component-wise on the real and imaginary parts, which is probably not what you want. There are <tt>cmul</tt>, <tt>cdiv</tt>, and <tt>cpow</tt> functions available which will perform the proper complex operation.</li>\n                                <li>All supported functions are available, but with a <tt>c</tt> prefix. For example, the sin function is named <tt>csin</tt>. This is to avoid clashing with the built-in (real-valued) GLSL functions.</li>\n                                <li>Constants are available in uppercase with a <tt>C_</tt> prefix (e.g. <tt>C_PI</tt>), and are already in complex <tt>vec2</tt> form.</li>\n                            </ul>\n\n                            <h3>Limitations</h3>\n                            <p>There are currently a few limitations with the custom function feature which I hope to resolve soon:</p>\n                            <ul>\n                                <li>URL-based sharing doesnt currently work for custom functions. You may share the code directly instead.</li>\n                                <li>The editor will show a red underline if your code fails to compile, but currently does not show useful error information. For now, this information is visible in the developer console.</li>\n                                <li><i>(Thanks to Tim N. for pointing this out.)</i> Due to low-level limitations of GLSL, variable-length loops such as the following do not work:\n                                    <SyntaxHighlighter language='glsl' style={docco}>{`for (int i=0; i<x; i++) {\n    // do stuff\n}`}</SyntaxHighlighter>\n                                    The following workaround is available:\n                                    <SyntaxHighlighter language='glsl' style={docco}>{`for (int i=0; i<1000; i++) {\n    if (i<x) {\n        // do stuff\n    }\n}`}</SyntaxHighlighter>\n                                    This effectively requires setting an arbitrary but finite limit on the number of iterations you wish to do;\n                                    however, this may be acceptable in several applications.\n                                    Note that the loop will be unrolled during compilation, so setting an excessively high limit will lead to poor performance.\n                                </li>\n                            </ul>\n\n                            <h3>Tips</h3>\n                            <p>Most desktop browsers will display a small resize handle at the bottom-right corner of the left pane. This can be very useful when working on complex code.</p>\n                            <p>You can define arbitrary helper functions before your <tt>mapping</tt> function  you have the full power of GLSL!</p>\n\n                            <p><b>You can use all your declared variables</b> directly in your code! Theyve already been converted into complex <tt>vec2</tt> form.</p>\n\n                            <h3>Obligatory Warning</h3>\n                            <p>This is an advanced feature  you may break things! If anything freezes or crashes, a quick reload should resolve the issue (save your code first)!</p>\n                        </div>\n                    </AccordionDetails>\n                </Accordion>\n\n                <h2>Citations</h2>\n                <p>If you use this tool to produce images for a publication, I would greatly appreciate a citation! Something along the lines of:</p>\n                <ul><li>Li, Samuel Jinglian, 2018. Complex Function Plotter. <a href='https://samuelj.li/complex-function-plotter/'>https://samuelj.li/complex-function-plotter/</a>.</li></ul>\n                <p>or the equivalent in your journal's citation style is enough.</p>\n\n                <h2>Acknowledgements</h2>\n                <ul>\n                    <li>Inspired by David Baus <a href='http://davidbau.com/conformal'>Conformal Map Plotter</a>.</li>\n                    <li>Thanks to Tim N. for helping improve the custom function documentation for variable-length loops.</li>\n                    <li>Thanks to Liu Yi (Ireis, CAS) for requesting the implementation of elliptic functions.</li>\n                    <li>Thanks to Jason Poulin for requesting variable animation support and other improvements.</li>\n                    <li>Thanks to Marius Sarbach for requesting the coordinate axis overlay.</li>\n                    <li>Thanks to Ryan Solecki for requesting the sum, product, and derivative features.</li>\n                </ul>\n\n                <Typography variant='caption'>Complex Function Plotter  Made with love by Samuel J. Li</Typography><br/>\n                <Typography variant='caption'><a href='https://github.com/wgxli/complex-function-plotter'>View the source</a> on GitHub</Typography><br/>\n                <Typography variant='caption'>Found a bug?  <a href='mailto:bug.report@samuelj.li'>bug.report@samuelj.li</a></Typography>\n            </div>\n        );\n    }\n}\n\nexport default withStyles(styles)(HelpText);\n","import React from 'react';\nimport './App.css';\nimport 'katex/dist/katex.min.css';\n\nimport {ThemeProvider as MuiThemeProvider} from '@material-ui/core/styles';\nimport theme from './theme.js';\n\nimport ControlBar from './components/ControlBar/ControlBar.js';\nimport FunctionPlot from './components/FunctionPlot';\n\nimport SidePanel from './components/SidePanel/SidePanel.js';\nimport './components/control-panel.css';\n\nimport SliderPanel from './components/SliderPanel/SliderPanel.js';\nimport OptionsPanel from './components/OptionsPanel/OptionsPanel.js';\n\nimport IntegralCalculator from './components/IntegralCalculator';\nimport IntegralPanel from './components/IntegralCalculator/IntegralPanel';\n\nimport FunctionEditor from './components/FunctionEditor/FunctionEditor.js';\n\nimport HelpText from './components/HelpText/HelpText.js';\n\nimport {parseExpression} from './gl-code/complex-functions';\n\n\nconst defaultShader = `vec2 mapping(vec2 z) {\n  z += t;\n  vec2 c = z;\n  for (int i=0; i<64; i++) {\n    z = cmul(z, z) + c;\n  }\n  return z;\n}`;\n\n\nfunction extractVariables(expression) {\n    if (!Array.isArray(expression)) {return new Set();}\n    if (expression[0] === 'variable' && expression[1] !== 'z') {\n        return new Set([expression[1]]);\n    }\n\n    let output = new Set();\n    for (let entry of expression) {\n        output = new Set([...output, ...extractVariables(entry)]);\n    }\n    return output;\n}\n\n\nclass App extends React.Component {\n    state = {\n        expressionText: 'z-t',\n        expression: ['sub', ['variable', 'z'], ['variable', 't']],\n        expressionError: false,\n        typingTimer: null,\n\n        customShader: defaultShader,\n        shaderError: false,\n\n        menuOpen: false,\n        helpOpen: false,\n        variableChanging: false,\n\n        integrationStrategy: null,\n\n        variables: {\n            log_scale: 5,\n            center_x: 0,\n            center_y: 0,\n\n            t: 0.3,\n\n            enable_checkerboard: 1,\n            invert_gradient: 0,\n            continuous_gradient: 0,\n            enable_axes: 1,\n\n            custom_function: 0,\n        }\n    }\n\n    componentDidMount() {\n        window.addEventListener('hashchange', this.handleHashChange.bind(this));\n\n        document.addEventListener(\n            'gesturestart',\n            (event) => this.preventDefault(event),\n            {passive: false}\n        );\n        document.addEventListener(\n            'touchmove',\n            (event) => this.preventDefault(event),\n            {passive: false}\n        );\n\n        this.handleHashChange();\n    }\n\n    preventDefault(event) {\n        const tagName = event.target.tagName.toLowerCase();\n        if (tagName === 'canvas') {\n            event.preventDefault();\n        } else {\n            return event;\n        }\n    }\n\n    // Toolbar buttons\n    handleMenuButton() {\n        this.setState({menuOpen: !this.state.menuOpen});\n    }\n\n    handleHelpButton() {\n        this.setState({helpOpen: !this.state.helpOpen});\n    }\n\n    // Variable Sliders\n    handleVariableUpdate(update) {\n        this.refs.plot.handleVariableUpdate(update);\n    }\n\n    handleVariableAdd(name, value) {\n        const variables = this.state.variables;\n        variables[name] = value;\n        this.setState({variables: variables});\n    }\n\n    handleVariableRemove(name) {\n        const variables = this.state.variables;\n        delete variables[name];\n        this.setState({variables: variables});\n    }\n\n    handleOptionToggle(name) {\n        const variables = this.state.variables;\n        variables[name] = (variables[name] < 0.5) ? 1 : 0;\n        this.handleVariableUpdate({[name]: variables[name]});\n        this.setState({variables});\n    }\n\n    setErrorMessage(message) {\n        const {variables, expressionError, shaderError} = this.state;\n\n        if (variables.custom_function > 0.5) {\n            if (message !== shaderError) {\n                this.setState({shaderError: message});\n            }\n        } else {\n            if (message !== expressionError) {\n                this.setState({expressionError: message});\n            }\n        }\n    }\n\n    handleHashChange() {\n        const hash = window.location.hash;\n        if (hash === '') {\n            this.setExpression('z-t', true);\n        } else {\n            this.setExpression(decodeURIComponent(hash.slice(1)), true);\n        }\n    }\n\n    setExpression(text, fromHash) {\n        text = text.toLowerCase();\n\n        window.history.replaceState(\n            undefined, undefined,\n            '#' + encodeURIComponent(text)\n        );\n\n        this.setState({\n            expressionText: text,\n            integrationStrategy: null,\n        });\n\n        if (fromHash) {\n            const expression = parseExpression(text.trim());\n            const variables = extractVariables(expression);\n            const newVariables = {...this.state.variables};\n            \n            for (let entry of variables) {\n                newVariables[entry] = 0.3;\n            }\n\n            this.setState({expression, variables: newVariables});\n        } else {\n            clearTimeout(this.typingTimer);\n            this.typingTimer = setTimeout(this.finalizeExpression.bind(this), 100);\n        }\n    }\n\n    finalizeExpression() {\n        const {expressionText} = this.state;\n        const expression = parseExpression(expressionText.trim());\n        this.setState({expression});\n    }\n\n    setCustomShader(text) {\n        this.setState({customShader: text});\n    }\n\n    renderFunctionEditor() {\n        const {variables, customShader, shaderError} = this.state;\n        if (variables.custom_function > 0.5) {\n            return (\n                <FunctionEditor\n                    onChange={this.setCustomShader.bind(this)}\n                    errorMessage={shaderError}\n                    value={customShader}\n                />\n            );\n        } else {\n            return; \n        }\n    }\n\n    render() {\n        const {\n            variables,\n            customShader,\n            expression, expressionText,\n            menuOpen, helpOpen,\n            expressionError,\n            integrationStrategy,\n            variableChanging,\n        } = this.state;\n\n        const useCustomShader = variables.custom_function > 0.5;\n\n        const ast = useCustomShader ? customShader : expression;\n\n        return (\n            <MuiThemeProvider theme={theme}>\n                <div id='app'>\n                    <ControlBar\n                        menuOpen={menuOpen}\n                        helpOpen={helpOpen}\n                        onMenuButton={this.handleMenuButton.bind(this)}\n                        onHelpButton={this.handleHelpButton.bind(this)}\n\n                        onChange={this.setExpression.bind(this)}\n                        value={expressionText}\n                        error={expressionError}\n                        disabled={useCustomShader}\n                    />\n                    <SidePanel\n                        className={`control-panel ${variableChanging ? 'changing' : ''}`}\n                        open={menuOpen} \n                        onToggle={this.handleMenuButton.bind(this)}\n                        anchor='left'\n                        transitionWidth={480}\n                    >\n                        <SliderPanel\n                            variables={variables}\n                            onUpdate={this.handleVariableUpdate.bind(this)}\n                            onAdd={this.handleVariableAdd.bind(this)}\n                            onRemove={this.handleVariableRemove.bind(this)}\n                            setChanging={(x) => this.setState({variableChanging: x})}\n                        />\n                        <IntegralPanel\n                            variables={variables}\n                            hidePanels={() => this.setState({helpOpen: false, menuOpen: false})}\n                            openCalculator={integrationStrategy => this.setState({integrationStrategy})}\n                        />\n                        <OptionsPanel\n                            heading='Graphics Options'\n                            options={{\n                                enable_checkerboard: 'Enable Checkerboard',\n                                invert_gradient: 'Invert Gradient',\n                                continuous_gradient: 'Continuous Gradient',\n                                enable_axes: 'Enable Axes',\n                            }}\n                            onToggle={this.handleOptionToggle.bind(this)}\n                            variables={variables}\n                        />\n                        <OptionsPanel\n                            heading='Advanced Options'\n                            options={{\n                                custom_function: 'Custom Function'\n                            }}\n                            onToggle={this.handleOptionToggle.bind(this)}\n                            variables={variables}\n                        />\n                        {this.renderFunctionEditor()}\n                    </SidePanel>\n                    <IntegralCalculator\n                        expression={ast}\n                        variables={variables}\n                        integrator={integrationStrategy}\n                        onClose={() => this.setState({integrationStrategy: null})}\n                    />\n                    <FunctionPlot\n                        ref='plot'\n                        expression={ast}\n                        variables={variables}\n                        onError={this.setErrorMessage.bind(this)}\n                    />\n                    <SidePanel\n                        className='help-panel'\n                        open={helpOpen}\n                        anchor='right'\n                        onToggle={this.handleHelpButton.bind(this)}\n                        transitionWidth={900}\n                    >\n                        <HelpText\n                            setExpression={(expression) => {\n                                this.setExpression(expression);\n                                this.handleVariableUpdate({\n                                    ...this.state.variables,\n                                    custom_function: 0,\n                                });\n                            }}\n                            closeMenu={() => this.setState({helpOpen: false})}\n                        />\n                    </SidePanel>\n                </div>\n            </MuiThemeProvider>\n        );\n    }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import 'babel-polyfill';\n\nimport React from 'react';\nimport {render} from 'react-snapshot';\n\nimport './index.css';\n\nimport App from './App';\nimport {unregister} from './registerServiceWorker';\n\n\nrender(<App />, document.getElementById('root'));\n//registerServiceWorker();\nunregister();\n"],"sourceRoot":""}