(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{262:function(e,n,t){!function(){function n(e){return e[0]}var t={Lexer:void 0,ParserRules:[{name:"_$ebnf$1",symbols:[]},{name:"_$ebnf$1",symbols:["_$ebnf$1","wschar"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"_",symbols:["_$ebnf$1"],postprocess:function(e){return null}},{name:"__$ebnf$1",symbols:["wschar"]},{name:"__$ebnf$1",symbols:["__$ebnf$1","wschar"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"__",symbols:["__$ebnf$1"],postprocess:function(e){return null}},{name:"wschar",symbols:[/[ \t\n\v\f]/],postprocess:n},{name:"unsigned_int$ebnf$1",symbols:[/[0-9]/]},{name:"unsigned_int$ebnf$1",symbols:["unsigned_int$ebnf$1",/[0-9]/],postprocess:function(e){return e[0].concat([e[1]])}},{name:"unsigned_int",symbols:["unsigned_int$ebnf$1"],postprocess:function(e){return parseInt(e[0].join(""))}},{name:"int$ebnf$1$subexpression$1",symbols:[{literal:"-"}]},{name:"int$ebnf$1$subexpression$1",symbols:[{literal:"+"}]},{name:"int$ebnf$1",symbols:["int$ebnf$1$subexpression$1"],postprocess:n},{name:"int$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"int$ebnf$2",symbols:[/[0-9]/]},{name:"int$ebnf$2",symbols:["int$ebnf$2",/[0-9]/],postprocess:function(e){return e[0].concat([e[1]])}},{name:"int",symbols:["int$ebnf$1","int$ebnf$2"],postprocess:function(e){return e[0]?parseInt(e[0][0]+e[1].join("")):parseInt(e[1].join(""))}},{name:"unsigned_decimal$ebnf$1",symbols:[/[0-9]/]},{name:"unsigned_decimal$ebnf$1",symbols:["unsigned_decimal$ebnf$1",/[0-9]/],postprocess:function(e){return e[0].concat([e[1]])}},{name:"unsigned_decimal$ebnf$2$subexpression$1$ebnf$1",symbols:[/[0-9]/]},{name:"unsigned_decimal$ebnf$2$subexpression$1$ebnf$1",symbols:["unsigned_decimal$ebnf$2$subexpression$1$ebnf$1",/[0-9]/],postprocess:function(e){return e[0].concat([e[1]])}},{name:"unsigned_decimal$ebnf$2$subexpression$1",symbols:[{literal:"."},"unsigned_decimal$ebnf$2$subexpression$1$ebnf$1"]},{name:"unsigned_decimal$ebnf$2",symbols:["unsigned_decimal$ebnf$2$subexpression$1"],postprocess:n},{name:"unsigned_decimal$ebnf$2",symbols:[],postprocess:function(e){return null}},{name:"unsigned_decimal",symbols:["unsigned_decimal$ebnf$1","unsigned_decimal$ebnf$2"],postprocess:function(e){return parseFloat(e[0].join("")+(e[1]?"."+e[1][1].join(""):""))}},{name:"decimal$ebnf$1",symbols:[{literal:"-"}],postprocess:n},{name:"decimal$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"decimal$ebnf$2",symbols:[/[0-9]/]},{name:"decimal$ebnf$2",symbols:["decimal$ebnf$2",/[0-9]/],postprocess:function(e){return e[0].concat([e[1]])}},{name:"decimal$ebnf$3$subexpression$1$ebnf$1",symbols:[/[0-9]/]},{name:"decimal$ebnf$3$subexpression$1$ebnf$1",symbols:["decimal$ebnf$3$subexpression$1$ebnf$1",/[0-9]/],postprocess:function(e){return e[0].concat([e[1]])}},{name:"decimal$ebnf$3$subexpression$1",symbols:[{literal:"."},"decimal$ebnf$3$subexpression$1$ebnf$1"]},{name:"decimal$ebnf$3",symbols:["decimal$ebnf$3$subexpression$1"],postprocess:n},{name:"decimal$ebnf$3",symbols:[],postprocess:function(e){return null}},{name:"decimal",symbols:["decimal$ebnf$1","decimal$ebnf$2","decimal$ebnf$3"],postprocess:function(e){return parseFloat((e[0]||"")+e[1].join("")+(e[2]?"."+e[2][1].join(""):""))}},{name:"percentage",symbols:["decimal",{literal:"%"}],postprocess:function(e){return e[0]/100}},{name:"jsonfloat$ebnf$1",symbols:[{literal:"-"}],postprocess:n},{name:"jsonfloat$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"jsonfloat$ebnf$2",symbols:[/[0-9]/]},{name:"jsonfloat$ebnf$2",symbols:["jsonfloat$ebnf$2",/[0-9]/],postprocess:function(e){return e[0].concat([e[1]])}},{name:"jsonfloat$ebnf$3$subexpression$1$ebnf$1",symbols:[/[0-9]/]},{name:"jsonfloat$ebnf$3$subexpression$1$ebnf$1",symbols:["jsonfloat$ebnf$3$subexpression$1$ebnf$1",/[0-9]/],postprocess:function(e){return e[0].concat([e[1]])}},{name:"jsonfloat$ebnf$3$subexpression$1",symbols:[{literal:"."},"jsonfloat$ebnf$3$subexpression$1$ebnf$1"]},{name:"jsonfloat$ebnf$3",symbols:["jsonfloat$ebnf$3$subexpression$1"],postprocess:n},{name:"jsonfloat$ebnf$3",symbols:[],postprocess:function(e){return null}},{name:"jsonfloat$ebnf$4$subexpression$1$ebnf$1",symbols:[/[+-]/],postprocess:n},{name:"jsonfloat$ebnf$4$subexpression$1$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"jsonfloat$ebnf$4$subexpression$1$ebnf$2",symbols:[/[0-9]/]},{name:"jsonfloat$ebnf$4$subexpression$1$ebnf$2",symbols:["jsonfloat$ebnf$4$subexpression$1$ebnf$2",/[0-9]/],postprocess:function(e){return e[0].concat([e[1]])}},{name:"jsonfloat$ebnf$4$subexpression$1",symbols:[/[eE]/,"jsonfloat$ebnf$4$subexpression$1$ebnf$1","jsonfloat$ebnf$4$subexpression$1$ebnf$2"]},{name:"jsonfloat$ebnf$4",symbols:["jsonfloat$ebnf$4$subexpression$1"],postprocess:n},{name:"jsonfloat$ebnf$4",symbols:[],postprocess:function(e){return null}},{name:"jsonfloat",symbols:["jsonfloat$ebnf$1","jsonfloat$ebnf$2","jsonfloat$ebnf$3","jsonfloat$ebnf$4"],postprocess:function(e){return parseFloat((e[0]||"")+e[1].join("")+(e[2]?"."+e[2][1].join(""):"")+(e[3]?"e"+(e[3][1]||"+")+e[3][2].join(""):""))}},{name:"sum",symbols:["sum","_","sumOperator","_","product"],postprocess:function(e){return[e[2],e[0],e[4]]}},{name:"sum",symbols:["product"],postprocess:n},{name:"product",symbols:["product","_","productOperator","_","power"],postprocess:function(e){return[e[2],e[0],e[4]]}},{name:"product",symbols:[{literal:"-"},"_","power"],postprocess:function(e){return["neg",e[2]]}},{name:"product",symbols:["power"],postprocess:n},{name:"power",symbols:["function","_","powerOperator","_","power"],postprocess:function(e){return["pow",e[0],e[4]]}},{name:"power",symbols:["function"],postprocess:n},{name:"function",symbols:["unaryFunction",{literal:"("},"_","sum","_",{literal:")"}],postprocess:function(e){return[e[0][0],e[3]]}},{name:"function",symbols:["unaryFunction",{literal:"["},"_","sum","_",{literal:"]"}],postprocess:function(e){return[e[0][0],e[3]]}},{name:"function",symbols:["binaryFunction",{literal:"("},"_","sum",{literal:","},"_","sum","_",{literal:")"}],postprocess:function(e){return[e[0][0],e[3],e[6]]}},{name:"function",symbols:["binaryFunction",{literal:"["},"_","sum",{literal:","},"_","sum","_",{literal:"]"}],postprocess:function(e){return[e[0][0],e[3],e[6]]}},{name:"function",symbols:["fourFunction",{literal:"("},"_","sum",{literal:","},"_","sum",{literal:","},"_","sum",{literal:","},"_","sum","_",{literal:")"}],postprocess:function(e){return[e[0][0],e[3],e[6],e[9],e[12]]}},{name:"function",symbols:["fourFunction",{literal:"["},"_","sum",{literal:","},"_","sum",{literal:","},"_","sum",{literal:","},"_","sum","_",{literal:"]"}],postprocess:function(e){return[e[0][0],e[3],e[6],e[9],e[12]]}},{name:"function",symbols:["diffFunction",{literal:"("},"_","sum","_",{literal:")"}],postprocess:function(e){return[e[0][0],e[3],["variable","z"]]}},{name:"function",symbols:["diffFunction",{literal:"["},"_","sum","_",{literal:"]"}],postprocess:function(e){return[e[0][0],e[3],["variable","z"]]}},{name:"function",symbols:["parenthesis2"],postprocess:n},{name:"parenthesis",symbols:[{literal:"("},"sum",{literal:")"}],postprocess:function(e){return e[1]}},{name:"parenthesis",symbols:[{literal:"["},"sum",{literal:"]"}],postprocess:function(e){return e[1]}},{name:"parenthesis",symbols:["literal"],postprocess:n},{name:"parenthesis2",symbols:["parenthesis"],postprocess:n},{name:"parenthesis2",symbols:["parenthesis",{literal:"!"}],postprocess:function(e){return["factorial",e[0]]}},{name:"sumOperator",symbols:[{literal:"+"}],postprocess:function(){return"add"}},{name:"sumOperator",symbols:[{literal:"-"}],postprocess:function(){return"sub"}},{name:"sumOperator",symbols:[{literal:"\u2212"}],postprocess:function(){return"sub"}},{name:"productOperator",symbols:[{literal:"*"}],postprocess:function(){return"mul"}},{name:"productOperator",symbols:[{literal:"\xd7"}],postprocess:function(){return"mul"}},{name:"productOperator",symbols:[{literal:"/"}],postprocess:function(){return"div"}},{name:"productOperator",symbols:[{literal:"%"}],postprocess:function(){return"mod"}},{name:"powerOperator$string$1",symbols:[{literal:"*"},{literal:"*"}],postprocess:function(e){return e.join("")}},{name:"powerOperator",symbols:["powerOperator$string$1"]},{name:"powerOperator",symbols:[{literal:"^"}]},{name:"fourFunction$string$1",symbols:[{literal:"s"},{literal:"u"},{literal:"m"}],postprocess:function(e){return e.join("")}},{name:"fourFunction",symbols:["fourFunction$string$1"]},{name:"fourFunction$string$2",symbols:[{literal:"p"},{literal:"r"},{literal:"o"},{literal:"d"},{literal:"u"},{literal:"c"},{literal:"t"}],postprocess:function(e){return e.join("")}},{name:"fourFunction",symbols:["fourFunction$string$2"],postprocess:function(){return["prod"]}},{name:"fourFunction$string$3",symbols:[{literal:"p"},{literal:"r"},{literal:"o"},{literal:"d"}],postprocess:function(e){return e.join("")}},{name:"fourFunction",symbols:["fourFunction$string$3"]},{name:"binaryFunction$string$1",symbols:[{literal:"b"},{literal:"e"},{literal:"t"},{literal:"a"}],postprocess:function(e){return e.join("")}},{name:"binaryFunction",symbols:["binaryFunction$string$1"]},{name:"binaryFunction$string$2",symbols:[{literal:"b"},{literal:"i"},{literal:"n"},{literal:"o"},{literal:"m"}],postprocess:function(e){return e.join("")}},{name:"binaryFunction",symbols:["binaryFunction$string$2"]},{name:"binaryFunction$string$3",symbols:[{literal:"b"},{literal:"i"},{literal:"n"},{literal:"o"},{literal:"m"},{literal:"i"},{literal:"a"},{literal:"l"}],postprocess:function(e){return e.join("")}},{name:"binaryFunction",symbols:["binaryFunction$string$3"],postprocess:function(){return["binom"]}},{name:"binaryFunction$string$4",symbols:[{literal:"c"},{literal:"h"},{literal:"o"},{literal:"o"},{literal:"s"},{literal:"e"}],postprocess:function(e){return e.join("")}},{name:"binaryFunction",symbols:["binaryFunction$string$4"],postprocess:function(){return["binom"]}},{name:"binaryFunction$string$5",symbols:[{literal:"s"},{literal:"n"}],postprocess:function(e){return e.join("")}},{name:"binaryFunction",symbols:["binaryFunction$string$5"]},{name:"binaryFunction$string$6",symbols:[{literal:"c"},{literal:"n"}],postprocess:function(e){return e.join("")}},{name:"binaryFunction",symbols:["binaryFunction$string$6"]},{name:"binaryFunction$string$7",symbols:[{literal:"d"},{literal:"n"}],postprocess:function(e){return e.join("")}},{name:"binaryFunction",symbols:["binaryFunction$string$7"]},{name:"binaryFunction$string$8",symbols:[{literal:"w"},{literal:"p"}],postprocess:function(e){return e.join("")}},{name:"binaryFunction",symbols:["binaryFunction$string$8"]},{name:"binaryFunction$string$9",symbols:[{literal:"w"},{literal:"p"},{literal:"'"}],postprocess:function(e){return e.join("")}},{name:"binaryFunction",symbols:["binaryFunction$string$9"],postprocess:function(){return["wpp"]}},{name:"binaryFunction$string$10",symbols:[{literal:"t"},{literal:"h"},{literal:"e"},{literal:"t"},{literal:"a"},{literal:"0"},{literal:"0"}],postprocess:function(e){return e.join("")}},{name:"binaryFunction",symbols:["binaryFunction$string$10"]},{name:"binaryFunction$string$11",symbols:[{literal:"t"},{literal:"h"},{literal:"e"},{literal:"t"},{literal:"a"},{literal:"0"},{literal:"1"}],postprocess:function(e){return e.join("")}},{name:"binaryFunction",symbols:["binaryFunction$string$11"]},{name:"binaryFunction$string$12",symbols:[{literal:"t"},{literal:"h"},{literal:"e"},{literal:"t"},{literal:"a"},{literal:"1"},{literal:"0"}],postprocess:function(e){return e.join("")}},{name:"binaryFunction",symbols:["binaryFunction$string$12"]},{name:"binaryFunction$string$13",symbols:[{literal:"t"},{literal:"h"},{literal:"e"},{literal:"t"},{literal:"a"},{literal:"1"},{literal:"1"}],postprocess:function(e){return e.join("")}},{name:"binaryFunction",symbols:["binaryFunction$string$13"]},{name:"binaryFunction",symbols:["diffFunction"],postprocess:function(e){return e[0]}},{name:"diffFunction$string$1",symbols:[{literal:"d"},{literal:"e"},{literal:"r"},{literal:"i"},{literal:"v"},{literal:"a"},{literal:"t"},{literal:"i"},{literal:"v"},{literal:"e"}],postprocess:function(e){return e.join("")}},{name:"diffFunction",symbols:["diffFunction$string$1"],postprocess:function(){return["diff"]}},{name:"diffFunction$string$2",symbols:[{literal:"d"},{literal:"i"},{literal:"f"},{literal:"f"}],postprocess:function(e){return e.join("")}},{name:"diffFunction",symbols:["diffFunction$string$2"]},{name:"unaryFunction",symbols:["trigFunction"]},{name:"unaryFunction$string$1",symbols:[{literal:"c"},{literal:"i"},{literal:"s"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$1"]},{name:"unaryFunction$string$2",symbols:[{literal:"e"},{literal:"x"},{literal:"p"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$2"]},{name:"unaryFunction$string$3",symbols:[{literal:"l"},{literal:"o"},{literal:"g"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$3"]},{name:"unaryFunction$string$4",symbols:[{literal:"l"},{literal:"n"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$4"],postprocess:function(){return["log"]}},{name:"unaryFunction$string$5",symbols:[{literal:"s"},{literal:"q"},{literal:"r"},{literal:"t"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$5"]},{name:"unaryFunction$string$6",symbols:[{literal:"g"},{literal:"a"},{literal:"m"},{literal:"m"},{literal:"a"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$6"]},{name:"unaryFunction$string$7",symbols:[{literal:"e"},{literal:"t"},{literal:"a"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$7"]},{name:"unaryFunction$string$8",symbols:[{literal:"z"},{literal:"e"},{literal:"t"},{literal:"a"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$8"]},{name:"unaryFunction$string$9",symbols:[{literal:"e"},{literal:"r"},{literal:"f"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$9"]},{name:"unaryFunction$string$10",symbols:[{literal:"a"},{literal:"b"},{literal:"s"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$10"]},{name:"unaryFunction$string$11",symbols:[{literal:"a"},{literal:"r"},{literal:"g"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$11"]},{name:"unaryFunction$string$12",symbols:[{literal:"s"},{literal:"g"},{literal:"n"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$12"]},{name:"unaryFunction$string$13",symbols:[{literal:"c"},{literal:"o"},{literal:"n"},{literal:"j"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$13"]},{name:"unaryFunction$string$14",symbols:[{literal:"r"},{literal:"e"},{literal:"a"},{literal:"l"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$14"]},{name:"unaryFunction$string$15",symbols:[{literal:"i"},{literal:"m"},{literal:"a"},{literal:"g"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$15"]},{name:"unaryFunction$string$16",symbols:[{literal:"f"},{literal:"l"},{literal:"o"},{literal:"o"},{literal:"r"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$16"]},{name:"unaryFunction$string$17",symbols:[{literal:"c"},{literal:"e"},{literal:"i"},{literal:"l"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$17"]},{name:"unaryFunction$string$18",symbols:[{literal:"r"},{literal:"o"},{literal:"u"},{literal:"n"},{literal:"d"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$18"]},{name:"unaryFunction$string$19",symbols:[{literal:"s"},{literal:"t"},{literal:"e"},{literal:"p"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$19"]},{name:"unaryFunction$string$20",symbols:[{literal:"r"},{literal:"e"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$20"],postprocess:function(){return["real"]}},{name:"unaryFunction$string$21",symbols:[{literal:"i"},{literal:"m"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$21"],postprocess:function(){return["imag"]}},{name:"unaryFunction$string$22",symbols:[{literal:"n"},{literal:"o"},{literal:"m"},{literal:"e"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$22"]},{name:"unaryFunction$string$23",symbols:[{literal:"s"},{literal:"m"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$23"]},{name:"unaryFunction$string$24",symbols:[{literal:"c"},{literal:"m"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$24"]},{name:"unaryFunction",symbols:[{literal:"j"}]},{name:"unaryFunction$string$25",symbols:[{literal:"e"},{literal:"4"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$25"]},{name:"unaryFunction$string$26",symbols:[{literal:"e"},{literal:"6"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$26"]},{name:"unaryFunction$string$27",symbols:[{literal:"e"},{literal:"8"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$27"]},{name:"unaryFunction$string$28",symbols:[{literal:"e"},{literal:"1"},{literal:"0"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$28"]},{name:"unaryFunction$string$29",symbols:[{literal:"e"},{literal:"1"},{literal:"2"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$29"]},{name:"unaryFunction$string$30",symbols:[{literal:"e"},{literal:"1"},{literal:"4"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$30"]},{name:"unaryFunction$string$31",symbols:[{literal:"e"},{literal:"1"},{literal:"6"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$31"]},{name:"unaryFunction$string$32",symbols:[{literal:"l"},{literal:"a"},{literal:"m"},{literal:"b"},{literal:"e"},{literal:"r"},{literal:"t"},{literal:"w"}],postprocess:function(e){return e.join("")}},{name:"unaryFunction",symbols:["unaryFunction$string$32"]},{name:"baseTrigFunction$string$1",symbols:[{literal:"s"},{literal:"i"},{literal:"n"}],postprocess:function(e){return e.join("")}},{name:"baseTrigFunction",symbols:["baseTrigFunction$string$1"]},{name:"baseTrigFunction$string$2",symbols:[{literal:"c"},{literal:"o"},{literal:"s"}],postprocess:function(e){return e.join("")}},{name:"baseTrigFunction",symbols:["baseTrigFunction$string$2"]},{name:"baseTrigFunction$string$3",symbols:[{literal:"t"},{literal:"a"},{literal:"n"}],postprocess:function(e){return e.join("")}},{name:"baseTrigFunction",symbols:["baseTrigFunction$string$3"]},{name:"baseTrigFunction$string$4",symbols:[{literal:"s"},{literal:"e"},{literal:"c"}],postprocess:function(e){return e.join("")}},{name:"baseTrigFunction",symbols:["baseTrigFunction$string$4"]},{name:"baseTrigFunction$string$5",symbols:[{literal:"c"},{literal:"s"},{literal:"c"}],postprocess:function(e){return e.join("")}},{name:"baseTrigFunction",symbols:["baseTrigFunction$string$5"]},{name:"baseTrigFunction$string$6",symbols:[{literal:"c"},{literal:"o"},{literal:"t"}],postprocess:function(e){return e.join("")}},{name:"baseTrigFunction",symbols:["baseTrigFunction$string$6"]},{name:"hyperbolicTrigFunction",symbols:["baseTrigFunction",{literal:"h"}],postprocess:function(e){return e.join("")}},{name:"trigFunction$ebnf$1$string$1",symbols:[{literal:"a"},{literal:"r"},{literal:"c"}],postprocess:function(e){return e.join("")}},{name:"trigFunction$ebnf$1",symbols:["trigFunction$ebnf$1$string$1"],postprocess:n},{name:"trigFunction$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"trigFunction",symbols:["trigFunction$ebnf$1","baseTrigFunction"],postprocess:function(e){return e.join("")}},{name:"trigFunction",symbols:[{literal:"a"},"baseTrigFunction"],postprocess:function(e){return"arc"+e[1]}},{name:"trigFunction$ebnf$2$string$1",symbols:[{literal:"a"},{literal:"r"}],postprocess:function(e){return e.join("")}},{name:"trigFunction$ebnf$2",symbols:["trigFunction$ebnf$2$string$1"],postprocess:n},{name:"trigFunction$ebnf$2",symbols:[],postprocess:function(e){return null}},{name:"trigFunction",symbols:["trigFunction$ebnf$2","hyperbolicTrigFunction"],postprocess:function(e){return e.join("")}},{name:"literal",symbols:["complexNumber"],postprocess:n},{name:"literal",symbols:["variable"],postprocess:n},{name:"variable$ebnf$1",symbols:[/[a-z]/]},{name:"variable$ebnf$1",symbols:["variable$ebnf$1",/[a-z]/],postprocess:function(e){return e[0].concat([e[1]])}},{name:"variable",symbols:["variable$ebnf$1"],postprocess:function(e,n,t){var r=e[0].join("");return"i"===r?t:["e","pi","tau","phi"].includes(r)?["constant",r]:["variable",r]}},{name:"complexNumber",symbols:["decimal"],postprocess:function(e){return["number",e[0],0]}},{name:"complexNumber",symbols:["decimal",{literal:"i"}],postprocess:function(e){return["number",0,e[0]]}},{name:"complexNumber",symbols:[{literal:"i"}],postprocess:function(){return["number",0,1]}}],ParserStart:"sum"};"undefined"!==typeof e.exports?e.exports=t:window.grammar=t}()},284:function(e,n,t){e.exports=t(538)},493:function(e,n,t){},494:function(e,n,t){},517:function(e,n,t){},521:function(e,n,t){},522:function(e,n,t){},524:function(e,n,t){},526:function(e,n,t){},527:function(e,n,t){},528:function(e,n,t){},533:function(e,n,t){},534:function(e,n,t){},538:function(e,n,t){"use strict";t.r(n);t(285);var r=t(0),a=t.n(r),o=t(261),i=(t(493),t(123)),c=t(111),s=t(12),l=t(13),u=t(16),m=t(10),p=t(17),h=t(30),f=(t(494),t(495),t(584)),d=t(203),b=t.n(d),v=t(205),g=t.n(v),y=b()({palette:{primary:g.a}}),w=t(579),_=t(581),z=t(592),E=t(583),x=t(543),$=t(155),O=t.n($),j=(t(517),function(e){function n(){return Object(s.a)(this,n),Object(u.a)(this,Object(m.a)(n).apply(this,arguments))}return Object(p.a)(n,e),Object(l.a)(n,[{key:"handleTextChange",value:function(e){this.props.onChange(e.target.value)}},{key:"render",value:function(){var e=this,n=this.props,t=n.disabled,r=n.onMenuButton,o=n.onHelpButton,i=n.error,c=n.value;return a.a.createElement(w.a,{id:"app-bar"},a.a.createElement(_.a,{disableGutters:!0},a.a.createElement(x.a,{onClick:r},a.a.createElement(O.a,null)),a.a.createElement("div",{id:"function-input"},a.a.createElement(z.a,{id:"function-input",placeholder:window.innerWidth>480?"Enter a complex function of z":"f(z)",value:c,onChange:function(n){return e.handleTextChange(n)},error:i,autoFocus:!0,fullWidth:!0,disabled:t})),a.a.createElement("div",{id:"help-button"},a.a.createElement(E.a,{onClick:o},"Help"))))}}]),n}(a.a.PureComponent)),P=t(9),C=t(206),k=t.n(C),T=t(262),F=t.n(T),N=t(80),M=t(26),S=t(145),q=S.complex(0,1),A=function(e){return 0===e||0===e.re&&0===e.im},I=S.sum,V=S.subtract,Y=S.divide,L=S.multiply,U=function(e){return S.multiply(e,q)},R=S.sin,D=S.exp,B=S.log,W=S.sqrt,H=S.pow,G=function(e){return L(e,e)},K=S.gamma,X=function(e){return e.re<.5?function(e){return S.divide(S.pi,S.multiply(S.sin(S.multiply(e,S.pi)),K(S.subtract(1,e))))}(e):K(e)},Z=function(e,n){return Y(L(X(e),X(n)),X(I(e,n)))},J=[[1,0],[-1,.6931471805599453],[1,1.0986122886681098],[-1,1.3862943611198906],[.9999999999999956,1.6094379124341003],[-.9999999999997994,1.791759469228055],[.9999999999938609,1.9459101490553132],[-.9999999998649105,2.0794415416798357],[.9999999977694676,2.1972245773362196],[-.9999999714737119,2.302585092994046],[.9999997104537384,2.3978952727983707],[-.9999976222939506,2.4849066497880004],[.9999839584657738,2.5649493574615367],[-.9999099635808778,2.6390573296152584],[.9995752248158725,2.70805020110221],[-.9983009089656448,2.772588722239781],[.994195351044952,2.833213344056216],[-.9829544651872264,2.8903717578961645],[.9567257315191998,2.9444389791664403],[-.9044921225074825,2.995732273553991],[.815694987187563,3.044522437723423],[-.686985550626286,3.091042453358316],[.5283436869577353,3.1354942159291497],[-.36280435095576935,3.1780538303479458],[.21751716776255453,3.2188758248682006],[-.11124997091266028,3.258096538021482],[.04729731398489587,3.295836866004329],[-.016192457785228476,3.332204510175204],[.004275662228213049,3.367295829986474],[-.0008152497252684601,3.4011973816621555],[9970680093076545e-20,3.4339872044851463],[-586510593565794e-20,3.4657359027997265]];function Q(e){return S.sum.apply(S,Object(h.a)(J.map((function(n){var t=Object(P.a)(n,2),r=t[0],a=t[1];return L(r,D(L(-a,e)))}))))}var ee=function(e){return e.re<0?function e(n){var t=n.neg(),r=S.add(t,1);if(t.im<0)return S.conj(e(S.conj(n)));var a=L(X(t),R(L(t,S.pi/2)));if(t.im>50){var o=S.log(S.abs(t)),i=S.arg(t);a=L(Math.sqrt(2*Math.PI)/2,q,D(I(L(i-Math.PI/2,q,t),L(o-1,t),L(-.5,S.complex(o,i)))))}var c=L(t,Q(r)),s=D(L(-S.log(S.pi),r)),l=Y(V(1,D(L(-Math.LN2,r))),V(1,D(L(-Math.LN2,t)))),u=L(a,c),m=L(s,l);return L(2,L(u,m))}(e):Q(e)};function ne(e){var n=U(function(e){return S.divide(1,e)}(e)),t=G(n),r=Y(L(n,I(1,L(t,I(.5,L(.75,t))))),S.sqrt(Math.PI));return I(1,U(L(D(G(U(e))),r)))}function te(e,n){for(var t=1,r=1;r<8;r++){var a=S.complex(0,Math.PI*r),o=L(a,2,e),i=L(a,r,n);t=I(t,D(I(i,o)),D(V(i,o)))}return t}var re=function(e,n){return te(I(e,.5),n)},ae=function(e,n){return L(D(L(S.complex(0,Math.PI/4),I(n,L(4,e)))),te(I(e,L(.5,n)),n))},oe=function(e,n){return L(D(L(S.complex(0,Math.PI/4),I(n,L(4,e),2))),te(I(e,L(.5,n),.5),n))};function ie(e,n){var t=function(e){var n=W(W(V(1,L(e,e)))),t=L(.5,Y(V(1,n),I(1,n))),r=I(t,L(2,H(t,5)),L(15,H(t,9)),L(150,H(t,13)));return L(B(r),S.complex(0,-1/Math.PI))}(n),r=te(0,t),a=Y(e,L(Math.PI,r,r)),o=2*Math.round(.5*a.im/t.im);return[V(a,L(o,t)),t]}function ce(e,n){return Y(L(-1,te(0,n),oe(e,n)),L(ae(0,n),re(e,n)))}function se(e,n){return Y(L(re(0,n),ae(e,n)),L(ae(0,n),re(e,n)))}function le(e,n){return Y(L(re(0,n),te(e,n)),L(te(0,n),re(e,n)))}function ue(e,n,t){return L(-2,H(Y(n,ce(e,t)),3),se(e,t),le(e,t))}var me=S.complex(.20998684165,0),pe=S.complex(-.10499342083,.18185393933),he=S.complex(-.10499342083,-.18185393933),fe=W(V(pe,he)),de=W(V(me,he)),be=Y(de,fe);function ve(e){var n=ie(L(e,fe),be),t=Object(P.a)(n,2),r=t[0],a=t[1];return I(1,Y(2,V(L(3,ue(r,fe,a)),1)))}function ge(e,n){return e.re*n.re+e.im*n.im}function ye(e){if(e.im<0)return[S.complex(0,1/0),0];for(var n=[S.complex(1,0),q],t=e,r=S.complex(1,0),a=0;a<16;a++){var o=Math.round(ge(t,r)/ge(r,r));t=V(t,L(o,r)),n[0]=V(n[0],L(o,n[1])),o=Math.round(ge(t,r)/ge(t,t)),r=V(r,L(o,t)),n[1]=V(n[1],L(o,n[0]))}var i=I(L(n[0].re,e),n[0].im),c=I(L(n[1].re,e),n[1].im),s=Y(i,c);return S.abs(s)<1?[Y(-1,s),i]:[s,c]}function we(e,n,t){var r=S.pow(e,n);return L(S.pow(n,t),Y(r,V(1,r)))}function _e(e,n,t){for(var r=ye(e),a=Object(P.a)(r,2),o=a[0],i=a[1],c=function(e){return D(U(e))}(L(2*Math.PI,o)),s=0,l=1;l<8;l++)s=I(s,we(c,l,t));return L(I(1,L(n,s)),H(i,-2*t))}function ze(e){return _e(e,240,3)}function Ee(e){return _e(e,-504,5)}function xe(e){return G(ze(e))}var $e=t(145),Oe={e:Math.E,pi:Math.PI,tau:2*Math.PI,phi:(1+Math.sqrt(5))/2};var je=function(e,n,t,r){return $e.add($e.add(e,n),$e.add(t,r))},Pe=$e.complex(0,1),Ce={add8:function(e,n,t,r,a,o,i,c){return $e.add(je(e,n,t,r),je(a,o,i,c))},add4:je,mul4:function(e,n,t,r){return $e.multiply($e.multiply(e,n),$e.multiply(t,r))},rawpow:$e.pow,log:function(e){return $e.log($e.add(e,$e.complex(0,1e-16)))},sub:$e.subtract,neg:$e.unaryMinus,mul:$e.multiply,div:$e.divide,mod:function(e,n){return $e.multiply(n,function(e){return $e.complex(e.re-Math.floor(e.re),e.im-Math.floor(e.im))}($e.divide(e,n)))},reciprocal:function(e){return $e.divide(1,e)},component_mul:function(e,n){return $e.complex(n*e.re,n*e.im)},component_mul_prelog:function(e,n){return $e.complex($e.exp(n)*e.re,$e.exp(n)*e.im)},real:$e.re,imag:$e.im,step:function(e){return e.re>=0?1:0},arcsin:$e.asin,arccos:$e.acos,arctan:$e.atan,arcsec:$e.asec,arccsc:$e.acsc,arccot:$e.acot,arsinh:$e.asinh,arcosh:$e.acosh,artanh:$e.atanh,arsech:$e.asech,arcsch:$e.acsch,arcoth:$e.acoth,cis:function(e){return $e.exp($e.multiply(e,Pe))},gamma:X,beta:Z,binom:function(e,n){return A(n)||A(V(e,n))?1:A(e)?0:Y(e,L(L(n,V(e,n)),Z(n,V(e,n))))},eta:ee,zeta:function(e){return Y(ee(e),V(1,D(L(Math.LN2,V(1,e)))))},erf:function(e){if(Math.abs(e.im)>8.5)return ne(e);for(var n=S.exp(-e.re*e.re)/Math.PI,t=4*e.re*e.re,r=S.cos(2*e.re*e.im),a=S.sin(2*e.re*e.im),o=[S.erf(e.re),L(n/(2*e.re),S.complex(1-r,a))],i=1;i<65;i++){var c=i*i/4+e.re*e.re,s=S.exp(i*e.im-c)/2,l=S.exp(-i*e.im-c)/2,u=1/(i*i+t)*2/Math.PI,m=u*(2*e.re*(S.exp(-c)-r*(s+l))+i*a*(s-l)),p=u*(2*e.re*a*(s+l)+i*r*(s-l));o.push(S.complex(m,p))}return S.sum(o)},lambertw:function(e){var n=S.log(e),t=S.subtract(n,S.log(n));S.abs(e)<3&&(t=S.subtract(S.sqrt(S.add(1,S.multiply(Math.E,e))),1));for(var r=0;r<6;r++)t=S.subtract(t,S.divide(S.multiply(t,S.subtract(S.add(t,S.log(t)),n)),S.add(1,t)));return t},nome:function(e){return L(U(B(e)),-.5/Math.PI)},theta00:te,theta01:re,theta10:ae,theta11:oe,sn:function(e,n){return ce.apply(void 0,Object(h.a)(ie(e,n)))},cn:function(e,n){return se.apply(void 0,Object(h.a)(ie(e,n)))},dn:function(e,n){return le.apply(void 0,Object(h.a)(ie(e,n)))},wp:function(e,n){var t=Math.round(e.im/n.im),r=V(e,L(t,n)),a=G(te(0,n)),o=G(ae(0,n)),i=L(-Math.PI*Math.PI/3,I(G(o),G(a)));return I(L(Math.PI*Math.PI,a,o,G(Y(re(r,n),oe(r,n)))),i)},wpp:function(e,n){var t=G(G(te(0,n))),r=G(G(ae(0,n))),a=G(G(re(0,n))),o=Math.PI*Math.PI/3,i=L(o,I(t,a)),c=L(-o,I(r,t)),s=L(o,V(r,a)),l=W(V(i,s)),u=W(V(c,s)),m=ie(L(e,l),Y(u,l)),p=Object(P.a)(m,2);return ue(p[0],l,p[1])},sm:function(e){return ve(V(1.76663875028545,e))},cm:ve,j:function(e){e=ye(e)[0];var n=ae(0,e),t=te(0,e),r=re(0,e);return L(32,Y(H(I(I(H(n,8),H(t,8)),H(r,8)),3),H(L(n,L(t,r)),8)))},e2:function(e){return _e(e,-24,1)},e4:ze,e6:Ee,e8:xe,e10:function(e){return L(ze(e),Ee(e))},e12:function(e){return I(L(441/691,H(ze(e),3)),L(250/691,G(Ee(e))))},e14:function(e){return L(xe(e),Ee(e))},e16:function(e){var n=ze(e),t=Ee(e);return I(L(1617/3617,G(G(n))),L(2e3/3617,L(n,G(t))))}};var ke=function e(n,t){var r=[NaN,NaN];if(null===n)return function(e){return r};if(!isNaN(n))return function(e){return[n,0]};var a=Object(N.a)(n),o=a[0],i=a.slice(1);if("number"===o)return function(e){return i};if("variable"===o){var c=Object(P.a)(i,1)[0];return"z"===c?function(e){return e}:function(e){return[Object(M.get)(t,c,NaN),0]}}if("constant"===o){var s=Object(P.a)(i,1)[0];return function(e){return[Oe[s],0]}}var l=Ce[o]||$e[o];if(!Object(M.isNil)(l)){return function(n){return function(e){return Object(M.isNil)(e.re)?[e,0]:[e.re,e.im]}(l.apply(void 0,Object(h.a)(i.map((function(r){return $e.complex.apply($e,Object(h.a)(e(r,t)(n)))})))))}}return function(e){return r}};function Te(e,n,t){return Array.isArray(e)?"variable"===e[0]&&e[1]===n?t:e.map((function(e){return Te(e,n,t)})):e}var Fe=["number",0,0],Ne=["number",1,0],Me={sin:function(e){return["cos",e]},cos:function(e){return["neg",["sin",e]]},tan:function(e){return["square",["sec",e]]},sec:function(e){return["mul",["sec",e],["tan",e]]},csc:function(e){return["neg",["mul",["csc",e],["cot",e]]]},cot:function(e){return["neg",["square",["csc",e]]]},arcsin:function(e){return["reciprocal",["sqrt",["sub",Ne,["square",e]]]]},arccos:function(e){return["neg",["reciprocal",["sqrt",["sub",Ne,["square",e]]]]]},arctan:function(e){return["reciprocal",["add",Ne,["square",e]]]},arcsec:function(e){return["reciprocal",["mul",["square",e],["sqrt",["sub",Ne,["reciprocal",["square",e]]]]]]},arccsc:function(e){return["neg",["reciprocal",["mul",["square",e],["sqrt",["sub",Ne,["reciprocal",["square",e]]]]]]]},arccot:function(e){return["neg",["reciprocal",["add",Ne,["square",e]]]]},sinh:function(e){return["cosh",e]},cosh:function(e){return["sinh",e]},tanh:function(e){return["square",["sech",e]]},sech:function(e){return["neg",["mul",["tanh",e],["sech",e]]]},csch:function(e){return["neg",["mul",["coth",e],["csch",e]]]},coth:function(e){return["neg",["square",["csch",e]]]},arsinh:function(e){return["reciprocal",["sqrt",["add",["square",e],Ne]]]},arcosh:function(e){return["reciprocal",["mul",["sqrt",["sub",e,Ne]],["sqrt",["add",e,Ne]]]]},artanh:function(e){return["reciprocal",["sub",Ne,["square",e]]]},arcsch:function(e){return["neg",["reciprocal",["mul",["square",e],["sqrt",["add",Ne,["reciprocal",["square",e]]]]]]]},arcoth:function(e){return["reciprocal",["sub",["square",e],Ne]]},exp:function(e){return["exp",e]},cis:function(e){return["mul_i",["cis",e]]},log:function(e){return["reciprocal",e]},square:function(e){return["component_mul",e,2]},sqrt:function(e){return["reciprocal",["component_mul",["sqrt",e],2]]},erf:function(e){return["component_mul",["exp",["neg",["square",e]]],2/Math.sqrt(Math.PI)]},lambertw:function(e){return["reciprocal",["add",e,["exp",["lambertw",e]]]]}};var Se=function e(n,t,r){if(null===n)return null;if("variable"!==t[0])return null;if(!Array.isArray(n))return Fe;if("constant"===n[0]||"number"===n[0])return Fe;if("variable"===n[0])return n[1]===t[1]?Ne:Fe;if(!function e(n,t){return!!Array.isArray(n)&&("variable"===n[0]&&n[1]===t||n.some((function(n){return e(n,t)})))}(n,t[1]))return Fe;var a=Object(N.a)(n),o=a[0],i=a.slice(1);if("add"===o||"sub"===o)return r([o].concat(Object(h.a)(i.map((function(n){return e(n,t,r)})))));if("mul"===o)return r(["add",r(["mul",i[0],e(i[1],t,r)]),r(["mul",i[1],e(i[0],t,r)])]);if("component_mul"===o)return r(["component_mul",e(i[0],t,r),i[1]]);if("div"===o)return r(["div",r(["sub",r(["mul",i[1],e(i[0],t,r)]),r(["mul",i[0],e(i[1],t,r)])]),["square",r(i[1])]]);var c=[Me[n[0]],n[1]],s=c[0],l=c[1];return void 0!==s?r(["mul",e(l,t,r),r(s(l))]):(console.log("numerical fallback:",n,t),function(e,n,t){if("variable"!==n[0])return null;var r=Te(e,n[1],["add",n,["number",.01,0]]),a=Te(e,n[1],["sub",n,["number",.01,0]]);return t(["component_mul",["sub",r,a],50])}(n,t,r))},qe=t(145);function Ae(e,n,t,r){if(0===e.length)return"sum"===n?["number",0,0]:["number",1,0];if(1===e.length)return e[0];var a=Math.floor(e.length/2),o=function(a,o){return Ae(e.slice(a,o),n,t,r)};if(a>=4&&void 0!==r){var i=Math.floor(a/2),c=Math.floor(a/4);return Ue([r,o(0,c),o(c,i),o(i,i+c),o(i+c,a),o(a,a+c),o(a+c,a+i),o(a+i,a+i+c),o(a+i+c,void 0)])}if(a>=2&&void 0!==t){var s=Math.floor(a/2);return Ue([t,o(0,s),o(s,a),o(a,a+s),o(a+s,void 0)])}return Ue([n,Ae(e.slice(0,a),n),Ae(e.slice(a),n)])}function Ie(e){var n=null,t=null;return isNaN(e)||(n=e,t=0),"number"===e[0]&&(n=e[1],t=e[2]),"constant"===e[0]&&(n=Oe[e[1]],t=0),qe.complex(n,t)}function Ve(e){return!isNaN(e)||"number"===e[0]||"constant"===e[0]}function Ye(e){return"number"===e[0]&&0===e[1]&&0===e[2]}var Le={neg:"neg",reciprocal:"reciprocal",conj:"conj",exp:"log",sin:"arcsin",cos:"arccos",tan:"arctan",sec:"arcsec",csc:"arccsc",cot:"arccot",sinh:"arsinh",cosh:"arcosh",tanh:"artanh",sech:"arsech",csch:"arcsch",coth:"arcoth",square:"sqrt"};function Ue(e){if(!Array.isArray(e))return e;var n=Object(N.a)(e),t=n[0],r=n.slice(1);if("number"===t||"variable"===t||"constant"===t)return e;if("sum"===t||"prod"===t)return function(e,n){if(n[2]=Ue(n[2]),n[3]=Ue(n[3]),"variable"!==n[1][0])return null;if("number"!==n[2][0])return null;if("number"!==n[3][0])return null;for(var t=n[1][1],r=n[2][1],a=n[3][1],o=n[0],i=[],c=r;c<=a;c++)i.push(Ue(Te(o,t,["number",c,0])));return"sum"===e?Ae(i,"add","add4","add8"):"prod"===e?Ae(i,"mul","mul4"):void 0}(t,r);if(r=r.map(Ue),"diff"===t)return Se(r[0],r[1],Ue);if("factorial"===t)return Ue(["gamma",["add",r[0],["number",1,0]]]);if(r.every(Ve))return function(e){return void 0===e.re?["number",e,0]:["number",e.re,e.im]}((Ce[t]||qe[t]).apply(void 0,Object(h.a)(r.map(Ie))));if(void 0!==Le[t]&&Array.isArray(r[0])&&r[0][0]===Le[t])return r[0][1];if("add"===t){if(Ye(r[0]))return r[1];if(Ye(r[1]))return r[0]}if("sub"===t){if(Ye(r[0]))return Ue(["neg",r[1]]);if(Ye(r[1]))return r[0]}if("div"===t){if(Ve(r[1]))return Ue(["mul",Ue(["reciprocal",r[1]]),r[0]]);if(Ve(r[0]))return Ue(["mul",r[0],Ue(["reciprocal",r[1]])])}if("mul"===t&&(Ve(r[1])&&(r=[r[1],r[0]]),Ve(r[0]))){var a=Ie(r[0]);if(0===a.im)return Ue(["component_mul",r[1],a.re])}if("component_mul"===t)return 0===r[1]?["number",0,0]:1===r[1]?r[0]:-1===r[1]?["neg",r[0]]:r[1]>0?["component_mul_prelog",r[0],qe.log(r[1])]:["component_mul_prelog",Ue(["neg",r[0]]),qe.log(-r[1])];if("pow"===t){if(Ve(r[0]))return["exp",Ue(["mul",Ue(["log",r[0]]),r[1]])];if(Ve(r[1])){var o=Ie(r[1]),i=r[0];if(0===o.im)return-1===o.re?Ue(["reciprocal",i]):0===o.re?["number",1,0]:.5===o.re?["sqrt",i]:1===o.re?i:2===o.re?Ue(["square",i]):["exp",Ue(["component_mul",["log",i],o.re])]}}if("beta"===t&&(Ve(r[0])&&(r=[r[1],r[0]]),Ve(r[1]))){var c=Ie(r[1]);if(0===c.im&&Number.isInteger(c.re)&&c.re>0&&c.re<20){for(var s=[Ue(["component_mul",r[0],qe.factorial(c.re)/c.re])],l=1;l<c.re;l++)s.push(["add",r[0],["number",l,0]]);return["reciprocal",Ae(s,"mul","mul4")]}}if("binom"===t){if(Ve(r[1])){var u=Ie(r[1]);if(0===u.im){if(0===u.re)return["number",1,0];if(Number.isInteger(u.re)&&u.re>0&&u.re<20){for(var m=[],p=0;p<u.re;p++)m.push(["sub",r[0],["number",p,0]]);return Ue(["component_mul",Ae(m,"mul","mul4"),1/qe.factorial(u.re)])}}}if(Ye(r[0]))return["number",0,0]}return[t].concat(Object(h.a)(r))}var Re=Ue;function De(e,n){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return Be(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Be(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw o}}}}function Be(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var We=k.a.Grammar.fromCompiled(F.a),He=["z","w","w1","w2","w3","w4","w5","w6"],Ge=function(){function e(n,t,r,a,o,i){Object(s.a)(this,e),(Array.isArray(r)||void 0===r)&&(i=a,a=r,r=t,o=a),void 0===i&&(i=1),this.name=n,this.body=t,this.log_body=r,this.dependencies=a||[],this.log_dependencies=o||this.dependencies,this.num_args=i}return Object(l.a)(e,[{key:"apply",value:function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return"".concat(this.name,"(").concat(n.join(", "),")")}},{key:"declaration",get:function(){var e=Array(this.num_args);return e.fill("VEC_TYPE"),"VEC_TYPE ".concat(this.name,"(").concat(e.join(", "),");")}},{key:"params",get:function(){for(var e=[],n=0;n<this.num_args;n++)e.push("VEC_TYPE ".concat(He[n]));return e.join(", ")}},{key:"code",get:function(){return"vec2 ".concat(this.name,"(").concat(this.params,") {").concat(this.body,"}")}},{key:"log_code",get:function(){return null===this.log_body?null:"vec3 ".concat(this.name,"(").concat(this.params,") {").concat(this.log_body,"}")}}]),e}(),Ke=function(e){function n(){return Object(s.a)(this,n),Object(u.a)(this,Object(m.a)(n).apply(this,arguments))}return Object(p.a)(n,e),Object(l.a)(n,[{key:"declaration",get:function(){return"VEC_TYPE ".concat(this.name,"(VEC_TYPE, float);")}},{key:"code",get:function(){return"vec2 ".concat(this.name,"(vec2 z, float w) {").concat(this.body,"}")}},{key:"log_code",get:function(){return"vec3 ".concat(this.name,"(vec3 z, float w) {").concat(this.log_body,"}")}}]),n}(Ge),Xe=function(e){function n(){return Object(s.a)(this,n),Object(u.a)(this,Object(m.a)(n).apply(this,arguments))}return Object(p.a)(n,e),Object(l.a)(n,[{key:"declaration",get:function(){return"vec4 ".concat(this.name,"(VEC_TYPE, mat4, mat4);")}},{key:"code",get:function(){return"vec4 ".concat(this.name,"(VEC_TYPE z, mat4 ns, mat4 bases) {").concat(this.body,"}")}},{key:"log_code",get:function(){return"vec4 ".concat(this.name,"(VEC_TYPE z, mat4 ns, mat4 bases) {").concat(this.log_body,"}")}}]),n}(Ge),Ze=function(e){function n(){return Object(s.a)(this,n),Object(u.a)(this,Object(m.a)(n).apply(this,arguments))}return Object(p.a)(n,e),Object(l.a)(n,[{key:"declaration",get:function(){return"VEC_TYPE ".concat(this.name,"(VEC_TYPE, mat4, mat4);")}},{key:"code",get:function(){return"vec2 ".concat(this.name,"(VEC_TYPE z, mat4 bases, mat4 coeffs) {").concat(this.body,"}")}},{key:"log_code",get:function(){return"vec3 ".concat(this.name,"(VEC_TYPE z, mat4 bases, mat4 coeffs) {").concat(this.log_body,"}")}}]),n}(Ge),Je=function(e){function n(){return Object(s.a)(this,n),Object(u.a)(this,Object(m.a)(n).apply(this,arguments))}return Object(p.a)(n,e),Object(l.a)(n,[{key:"declaration",get:function(){return"vec4 ".concat(this.name,"(vec2);")}},{key:"code",get:function(){return"vec4 ".concat(this.name,"(vec2 z) {").concat(this.body,"}")}},{key:"log_code",get:function(){return this.code}}]),n}(Ge),Qe=function(e){function n(){return Object(s.a)(this,n),Object(u.a)(this,Object(m.a)(n).apply(this,arguments))}return Object(p.a)(n,e),Object(l.a)(n,[{key:"declaration",get:function(){return"vec4 ".concat(this.name,"(VEC_TYPE);")}},{key:"code",get:function(){return"vec4 ".concat(this.name,"(VEC_TYPE z) {").concat(this.body,"}")}},{key:"log_code",get:function(){return this.code}}]),n}(Ge),en=function(e){function n(){return Object(s.a)(this,n),Object(u.a)(this,Object(m.a)(n).apply(this,arguments))}return Object(p.a)(n,e),Object(l.a)(n,[{key:"declaration",get:function(){return"VEC_TYPE ".concat(this.name,"(vec4);")}},{key:"code",get:function(){return"VEC_TYPE ".concat(this.name,"(vec4 h) {").concat(this.body,"}")}},{key:"log_code",get:function(){return this.code}}]),n}(Ge),nn=new Ge("cmul_i","return vec2(-z.y, z.x);","return vec3(-z.y, z.x, z.z);"),tn=new Ge("creciprocal","return cconj(z) / dot(z, z);","return vec3(cconj(z).xy/dot(z.xy, z.xy), -z.z);",["conj"],["conj"]),rn=new Ge("cconj","return vec2(z.x, -z.y);","return vec3(z.x, -z.y, z.z);"),an=new Ge("cabs","return vec2(length(z), 0);","return vec3(length(z.xy), 0, z.z);"),on=new Ge("carg","return vec2(atan(z.y, z.x), 0);","return vec3(atan(z.y, z.x), 0, 0);"),cn=new Ge("csgn","return normalize(z);","return vec3(normalize(z.xy), 0);"),sn=new Ge("creal","return vec2(z.x, 0);","return vec3(z.x, 0, z.z);"),ln=new Ge("cimag","return vec2(z.y, 0);","return vec3(z.y, 0, z.z);"),un=new Ge("cfloor","return floor(z);","if (z.z > 20.) {return z;} else {return vec3(floor(downconvert(z).xy), 0);}"),mn=new Ge("cceil","return floor(z + 0.9999999);","if (z.z > 20.) {return z;} else {return vec3(floor(downconvert(z).xy + 0.9999999), 0);}"),pn=new Ge("cround","return floor(z + 0.5);","if (z.z > 20.) {return z;} else {return vec3(floor(downconvert(z).xy + 0.5), 0);}"),hn=new Ge("cstep","return vec2(step(0., z.x), 0);","return vec3(step(0., z.x), 0, 0);"),fn=new Ge("ccis","return cexp(cmul_i(z));",["exp","mul_i"]),dn=new Ge("cexp_raw","float phase = z.y;\nreturn exp(max(z.x, -40.)) * vec3(cos(phase), sin(phase), 0).COMPONENTS;"),bn=new Ge("cexp","float phase = z.y;\nreturn exp(z.x) * vec2(cos(phase), sin(phase));","float phase = mod(z.y * exp(z.z), TAU);\nreturn vec3(cos(phase), sin(phase), z.x * exp(z.z));"),vn=new Ge("clog","float magnitude = log(length(z));\nfloat phase = atan(z.y, z.x);\nreturn vec2(magnitude, phase);","return vec3(log(length(z.xy)) + z.z, atan(z.y, z.x), 0.);"),gn=new Ge("csqrt","float magnitude = length(z);\nfloat phase = 0.5 * atan(z.y, z.x);\nreturn sqrt(magnitude) * vec2(cos(phase), sin(phase));","float magnitude = length(z.xy);\nfloat phase = 0.5 * atan(z.y, z.x);\nreturn vec3(sqrt(magnitude) * vec2(cos(phase), sin(phase)), 0.5*z.z);"),yn=new Ge("csquare","float magnitude = length(z);\nfloat phase = atan(z.y, z.x) * 2.0;\nreturn (magnitude * magnitude) * vec2(cos(phase), sin(phase));","float magnitude = length(z.xy);\nfloat phase = atan(z.y, z.x) * 2.0;\nreturn vec3((magnitude * magnitude) * vec2(cos(phase), sin(phase)), 2.*z.z);"),wn=new Ge("csin","VEC_TYPE iz = cmul_i(z);\nreturn ccomponent_mul(cmul_i(csub(cexp(iz), cexp(cneg(iz)))), -0.5);",["neg","sub","mul_i","exp","component_mul"]),_n=new Ge("ccos","VEC_TYPE iz = cmul_i(z);\nreturn ccomponent_mul(cadd(cexp(iz), cexp(cneg(iz))), 0.5);",["neg","add","mul_i","exp","component_mul"]),zn=new Ge("ctan","return cmul_i(ctanh(cneg(cmul_i(z))));",["mul_i","tanh","neg"]),En=new Ge("csec","return creciprocal(ccos(z));",["reciprocal","cos"]),xn=new Ge("ccsc","return creciprocal(csin(z));",["reciprocal","sin"]),$n=new Ge("ccot","return creciprocal(ctan(z));",["reciprocal","tan"]),On=new Ge("carcsin","VEC_TYPE a = csqrt(csub(ONE, csquare(z)));\nif (z.y < 0.) {\n    return cneg(cmul_i(clog(cadd(a, cmul_i(z)))));\n} else {\n    return cneg(cmul_i(cneg(clog(csub(a, cmul_i(z))))));\n}",["sqrt","square","mul_i","log","add","sub","neg"]),jn=new Ge("carccos","return csub(0.5*C_PI, carcsin(z));",["arcsin","sub"]),Pn=new Ge("carctan","VEC_TYPE iz = cmul_i(z);\nreturn ccomponent_mul(cmul_i(csub(clog(csub(ONE, iz)), clog(cadd(ONE, iz)))), 0.5);",["mul_i","log","component_mul","add","sub"]),Cn=new Ge("carccot","return carctan(creciprocal(z));",["arctan","reciprocal"]),kn=new Ge("carcsec","return carccos(creciprocal(z));",["arccos","reciprocal"]),Tn=new Ge("carccsc","return carcsin(creciprocal(z));",["arcsin","reciprocal"]),Fn=new Ge("csinh","VEC_TYPE exp_z = cexp(z); return ccomponent_mul(csub(exp_z, creciprocal(exp_z)), 0.5);",["exp","sub","component_mul","reciprocal"]),Nn=new Ge("ccosh","VEC_TYPE exp_z = cexp(z); return ccomponent_mul(cadd(exp_z, creciprocal(exp_z)), 0.5);",["exp","add","component_mul","reciprocal"]),Mn=new Ge("ctanh","VEC_TYPE a = cexp(ccomponent_mul(z, 2.));\nVEC_TYPE b = creciprocal(a);\nif (z.x > 0.0) {\n   return cdiv(csub(ONE, b), cadd(ONE, b));\n} else {\n   return cdiv(csub(a, ONE), cadd(a, ONE));\n}",["exp","component_mul","reciprocal","sub","add","div"]),Sn=new Ge("csech","return creciprocal(ccosh(z));",["reciprocal","cosh"]),qn=new Ge("ccsch","return creciprocal(csinh(z));",["reciprocal","sinh"]),An=new Ge("ccoth","return creciprocal(ctanh(z));",["reciprocal","tanh"]),In=new Ge("carsinh","return cneg(cmul_i(carcsin(cmul_i(z))));",["mul_i","arcsin","neg"]),Vn=new Ge("carcosh","return cneg(cmul_i(carccos(z)));",["mul_i","arccos","neg"]),Yn=new Ge("cartanh","return cneg(cmul_i(carctan(cmul_i(z))));",["mul_i","arctan","neg"]),Ln=new Ge("carsech","return cneg(cmul_i(carcsec(z)));",["mul_i","arcsec","neg"]),Un=new Ge("carcsch","return cneg(cmul_i(carccsc(cneg(cmul_i(z)))));",["mul_i","arccsc","neg"]),Rn=new Ge("carcoth","return cneg(cmul_i(carccot(cneg(cmul_i(z)))));",["mul_i","arccot","neg"]),Dn=new Ge("cneg","return -z;","return vec3(-z.xy, z.z);"),Bn=new Ge("cadd","return z+w;","float diff = z.z - w.z;\nfloat p = step(0., diff);\nvec3 maxarg = p*z + (1.-p)*w;\nvec3 minarg = w+z-maxarg;\nreturn maxarg + vec3(exp(-abs(diff)) * minarg.xy, 0);",[],[],2),Wn=new Ge("csub","return z-w;","return cadd(z, cneg(w));",[],["add","neg"],2),Hn=new Ge("cmul","return mat2(z, -z.y, z.x) * w;","return vec3(mat2(z.xy, -z.y, z.x) * w.xy, z.z+w.z);",[],[],2),Gn=new Ke("ccomponent_mul","return z*w;","return vec3(z.xy * w, z.z);",[],[],2),Kn=new Ke("ccomponent_mul_prelog","return z*exp(w);","return vec3(z.xy, z.z + w);",[],[],2),Xn=new Ge("cdiv","return cmul(z, creciprocal(w));",["mul","reciprocal"],2),Zn=new Ge("cmod","return cmul(w, fract(downconvert(cdiv(z, w))));",["mul","div"],2),Jn=new Ge("cpow","return cexp(cmul(clog(z), w));",["exp","mul","log"],2),Qn=new Ge("cadd4","return z+w+w1+w2;","float offset = max(max(z.z, w.z), max(w1.z, w2.z));\nvec4 scales = exp(vec4(z.z, w.z, w1.z, w2.z) - offset);\nreturn vec3(dot(scales, vec4(z.x, w.x, w1.x, w2.x)), dot(scales, vec4(z.y, w.y, w1.y, w2.y)), offset);",[],[],4),et=new Ge("cadd8","return z+w+w1+w2+w3+w4+w5+w6;","float offset = max(max(max(z.z, w.z), max(w1.z, w2.z)), max(max(w3.z, w4.z), max(w5.z, w6.z)));\nvec4 scales1 = exp(vec4(z.z, w.z, w1.z, w2.z) - offset);\nvec4 scales2 = exp(vec4(w3.z, w4.z, w5.z, w6.z) - offset);\nreturn vec3(\n    dot(scales1, vec4(z.x, w.x, w1.x, w2.x))\n    + dot(scales2, vec4(w3.x, w4.x, w5.x, w6.x)),\n    dot(scales1, vec4(z.y, w.y, w1.y, w2.y))\n    + dot(scales2, vec4(w3.y, w4.y, w5.y, w6.y)),\n    offset\n);",[],[],8),nt=new Ge("cmul4","return cmul(cmul(z, w), cmul(w1, w2));","return cmul(upconvert(cmul(z, w)), upconvert(cmul(w1, w2)));",["mul"],["mul"],4),tt=new Ge("cgamma","if (z.x < 0.5) {return cgamma_left(z);} else {return cgamma_right(z);}","if (z.x * exp(z.z) < 0.5) {return cgamma_left(z);} else {return cgamma_right(z);}",["cgamma_left","cgamma_right"],["cgamma_left","cgamma_right"]),rt=new Ge("cgamma_left","return ccomponent_mul_prelog(creciprocal(cmul(csin(ccomponent_mul_prelog(z, LNPI)), cgamma_right(csub(ONE, z)))), LNPI);",["mul","sin","cgamma_right","component_mul_prelog","reciprocal","sub"]),at=new Ge("cgamma_right","vec2 w = z - ONE;\nvec2 t = w + vec2(7.5, 0);\nvec2 x = vec2(0.99999999999980993, 0);\nx += 676.5203681218851 * creciprocal(w + vec2(1, 0));\nx -= 1259.1392167224028 * creciprocal(w + vec2(2, 0));\nx += 771.32342877765313 * creciprocal(w + vec2(3, 0));\nx -= 176.61502916214059 * creciprocal(w + vec2(4, 0));\nx += 12.507343278686905 * creciprocal(w + vec2(5, 0));\nx -= .13857109526572012 * creciprocal(w + vec2(6, 0));\nx += 9.9843695780195716e-6 * creciprocal(w + vec2(7, 0));\nx += 1.5056327351493116e-7 * creciprocal(w + vec2(8, 0));\nreturn sqrt(TAU) * cmul(x, cexp(cmul(clog(t), w + vec2(0.5, 0)) - t));","vec3 scale_one = exp(-z.z) * ONE;\nvec3 w = z - scale_one;\nvec3 t = w + 7.5 * scale_one;\nvec3 ww = vec3(w.xy, 0);\nvec3 x = vec3(0.99999999999980993, 0, 0);\nx += 676.5203681218851 * creciprocal(ww + scale_one);\nx -= 1259.1392167224028 * creciprocal(ww + 2.*scale_one);\nx += 771.32342877765313 * creciprocal(ww + 3.*scale_one);\nx -= 176.61502916214059 * creciprocal(ww + 4.*scale_one);\nx += 12.507343278686905 * creciprocal(ww + 5.*scale_one);\nx -= .13857109526572012 * creciprocal(ww + 6.*scale_one);\nx += 9.9843695780195716e-6 * creciprocal(ww + 7.*scale_one);\nx += 1.5056327351493116e-7 * creciprocal(ww + 8.*scale_one);\nx.z -= w.z;\nreturn ccomponent_mul(cmul(x, cexp(csub(cmul(clog(t), w + 0.5*scale_one), t))), sqrt(TAU));",["reciprocal","mul","exp","log"],["sqrt","reciprocal","sub","mul","exp","log","component_mul"]),ot=new Ge("cfact","return cgamma(cadd(z, ONE));",["gamma","add"]),it=new Ge("cbeta","return cdiv(cmul(cgamma(z), cgamma(w)), cgamma(cadd(z, w)));",["add","gamma","div","mul"],2),ct=new Ge("cbinom","VEC_TYPE zz = csub(z, w);\nreturn cdiv(z, cmul(cmul(w, zz), cbeta(zz, w)));",["sub","mul","div","beta"],2),st=new Ge("clambertw","VEC_TYPE L1 = clog(z);\nif (ordinate(z) < -8.) {return z;}\nz = downconvert(z);\nVEC_TYPE est = (length(z.xy) > 3.) ? L1 - clog(L1) : csqrt(C_E.x*z+ONE)-ONE;\nfor (int i = 0; i < 3; i++) {\n    est -= cdiv(cmul(est, est + clog(est) - L1), ONE + est);\n}\nreturn est;",["component_mul","log","mul","div","add","sub","sqrt"]),lt=new Ge("ceta","z = downconvert(z);\nVEC_TYPE conjugate_mask = vec3(1., 1., 1.).COMPONENTS;\nif (z.y < 0.0) {\n    z = cconj(z);\n    conjugate_mask.y *= -1.;\n}\nVEC_TYPE result;\nif (z.x < 0.) {\n    result = ceta_left(z);\n} else {\n    result = ceta_right(z);\n}\nreturn result * conjugate_mask;",["conj","ceta_left","ceta_right"]),ut=new Ge("ceta_left","z.x *= -1.0;\nvec2 component_a;\nconst float SQ2PI2 = 1.2533141373155001;\nfloat log_r = log(length(z));\nif (z.y > 200.0) {\n    component_a = SQ2PI2 * cmul_i(cexp(\n        vec2(z.x, 0)\n        + (log_r - 1.0) * z\n        - vec2(log_r/2.0, PI/4.0)\n    ));\n} else if (z.y > 20.0) {\n    float theta = atan(z.y, z.x);\n    component_a = SQ2PI2 * cmul_i(cexp(\n        (theta - PI/2.0) * cmul_i(z)\n        + (log_r - 1.0) * z\n        - 0.5 * vec2(log_r, theta)\n    ));\n} else {\n    component_a = cmul(cgamma(z), csin(z * PI/2.0));\n}\nvec2 component_b = cmul(z, ceta_right(z + ONE));\nvec2 multiplier_a = cexp(-log(PI) * (z + ONE));\nvec2 multiplier_b = cdiv(ONE - cexp(-LN2 * (z + ONE)), ONE - cexp(-LN2 * z));\nvec2 component = cmul(component_a, component_b);\nvec2 multiplier = cmul(multiplier_a, multiplier_b);\nreturn 2.0 * cconj(cmul(component, multiplier));","z.x *= -1.;\nconst float SQ2PI2 = 1.2533141373155001;\nvec3 component_a = cmul(cgamma(z), csin(z * PI/2.));\nvec3 component_b = cmul(z, ceta_right(z + ONE));\nvec3 multiplier_a = cexp(-LNPI * (z + ONE));\nvec3 multiplier_b = cdiv(csub(ONE, cexp(-LN2 * (z + ONE))), csub(ONE, cexp(-LN2 * z)));\nvec3 component = cmul(component_a, component_b);\nvec3 multiplier = cmul(multiplier_a, multiplier_b);\nreturn ccomponent_mul(cconj(cmul(component, multiplier)), 2.);",["mul_i","exp","mul","gamma","sin","ceta_right","div"],["mul","gamma","component_mul","sin","ceta_right","sub","div"]),mt=new Ge("zeta_character","const VEC_TYPE A = vec3(-1.0 - 2.0*LN2, PI/2.0, 0).COMPONENTS; // -1 + ln(i/4)\nconst VEC_TYPE B = vec3(1.0 + LN2, 0, 0).COMPONENTS;\n\n// Asymptotic approximation to\n// gamma(0.5 * z) / gamma((1-z)/2)\n// Good for Im(z) > 10\nVEC_TYPE zconj = ONE - 2.*z;\nreturn cexp(\n    cmul(z, A + clog(zconj))\n    + 0.5 * (B - clog(z))\n    + (0.5 * LNPI) * zconj\n);",["exp","mul","log"]),pt=new Ge("ceta_strip","z = downconvert(z); return cmul(csub(ONE, cexp(LN2 * (ONE - z))), czeta_strip(z));",["mul","exp","sub","czeta_strip"]),ht=new Xe("czeta_helper","mat4 phases = z.y*bases;\nfloat cutoff = sqrt(z.y/TAU) + 100. * step(z.y, 120.);\nvec4 res = vec4(0);\nfor (int row = 0; row < 4; row++) {\n  vec4 mags = exp(z.x*bases[row]);\n  vec4 cutoff = clamp(0.884*(cutoff-ns[row] + 0.5), 0., 1.);\n  vec4 mags2 = cutoff/(ns[row] * mags);\n  mags *= cutoff;\n  vec4 re = cos(phases[row]);\n  vec4 im = sin(phases[row]);\n  res += vec4(dot(mags, re), dot(mags, im), dot(mags2, re), -dot(mags2, im));\n}\nreturn res;"),ft=new Ze("czeta_helper_2","mat4 phases = z.y*bases;\nvec2 res = vec2(0);\nfor (int row = 0; row < 4; row++) {\n  vec4 mags = exp(z.x*bases[row]) * coeffs[row];\n  vec4 re = cos(phases[row]);\n  vec4 im = sin(phases[row]);\n  res += vec2(dot(mags, re), dot(mags, im));\n}\nreturn res;","mat4 phases = z.y*bases;\nvec3 res = vec3(0);\nfor (int row = 0; row < 4; row++) {\n  vec4 mags = exp(z.x*bases[row]) * coeffs[row];\n  vec4 re = cos(phases[row]);\n  vec4 im = sin(phases[row]);\n  res += vec3(dot(mags, re), dot(mags, im), 0);\n}\nreturn res;"),dt=new Ge("czeta_strip","vec4 zeta_est = vec4(1., 0, 1., 0); // Estimate of zeta(z), zeta(1-z)\n\nzeta_est += czeta_helper(z,\nmat4(2.,3.,4.,5.,6.,7.,8.,9.,10.,11.,12.,13.,14.,15.,16.,17.),\nmat4(-0.693147180560,-1.098612288668,-1.386294361120,-1.609437912434,-1.791759469228,-1.945910149055,-2.079441541680,-2.197224577336,-2.302585092994,-2.397895272798,-2.484906649788,-2.564949357462,-2.639057329615,-2.708050201102,-2.772588722240,-2.833213344056));\nzeta_est += czeta_helper(z,\nmat4(18.,19.,20.,21.,22.,23.,24.,25.,26.,27.,28.,29.,30.,31.,32.,33.),\nmat4(-2.890371757896,-2.944438979166,-2.995732273554,-3.044522437723,-3.091042453358,-3.135494215929,-3.178053830348,-3.218875824868,-3.258096538021,-3.295836866004,-3.332204510175,-3.367295829986,-3.401197381662,-3.433987204485,-3.465735902800,-3.496507561466));\n\nVEC_TYPE zetaA = vec3(zeta_est.xy, 0).COMPONENTS;\nVEC_TYPE zetaB = vec3(zeta_est.zw, 0).COMPONENTS;\nzetaB = cmul(zetaB, cconj(zeta_character(ONE - cconj(z))));\n\nif (z.y < 120.) {\n    // Interpolate between the two estimates of zeta(z)\n    float t = 1.0 - min(z.x, 1.0);\n    float alpha = t*t * (3.0 - 2.0*t); // Hermite interpolation (smoothstep)\n    return mix(zetaA, zetaB, alpha);\n} else {\n    return cadd(zetaA, zetaB);\n}",["conj","zeta_character","czeta_helper","add"]),bt=new Ge("ceta_right","if (z.x < 3.0 && z.y > 54.) {return ceta_strip(z);}\nVEC_TYPE result = ONE;\nresult += czeta_helper_2(z,\nmat4(-0.69314718055995,-1.09861228866811,-1.38629436111989,-1.60943791243410,-1.79175946922805,-1.94591014905531,-2.07944154167984,-2.19722457733622,-2.30258509299405,-2.39789527279837,-2.48490664978800,-2.56494935746154,-2.63905732961526,-2.70805020110221,-2.77258872223978,-2.83321334405622),\nmat4(-1.00000000000000,1.00000000000000,-1.00000000000000,1.00000000000000,-0.99999999999995,0.99999999999847,-0.99999999996425,0.99999999937104,-0.99999999142280,0.99999990708781,-0.99999918494666,0.99999411949279,-0.99996466193028,0.99982127062071,-0.99923254216349,0.99718148818347));\nresult += czeta_helper_2(z,\nmat4(-2.89037175789616,-2.94443897916644,-2.99573227355399,-3.04452243772342,-3.09104245335832,-3.13549421592915,-3.17805383034795,-3.21887582486820,-3.25809653802148,-3.29583686600433,-3.33220451017520,-3.36729582998647,-3.40119738166216,-3.43398720448515,-3.46573590279973,-3.49650756146648),\nmat4(-0.99109047939434,0.97562125072353,-0.94195422388664,0.87910910712444,-0.77852772396727,0.64073335549827,-0.47964042231228,0.31968999219853,-0.18572334624203,0.09196690020310,-0.03784892366350,0.01254701255408,-0.00320994916827,0.00059346134942,-0.00007044051625,0.00000402517236));\nreturn result;",["ceta_strip","czeta_helper_2"]),vt=new Ge("czeta","z = downconvert(z); return cdiv(ceta(z), csub(ONE, cexp(LN2 * (ONE - z))));",["div","eta","exp","sub"]),gt=new Ge("rerf","float k = 1. - exp(-z.x*z.x);\nconst float K = 1.119;\n\nconst vec4 coeff = vec4(1./12., 7./480., 5./896., 787./276480.);\nfloat series = 1. - dot(coeff, vec4(k, k*k, k*k*k, k*k*k*k));\n\nreturn vec3(K * sqrt(k) * series, 0., 0.).COMPONENTS;\n"),yt=new Ge("cerf_large","VEC_TYPE k = cmul_i(creciprocal(z));\nVEC_TYPE k2 = csquare(k);\nVEC_TYPE corrections = ccomponent_mul_prelog(\ncmul(k, ONE + 0.5 * k2),\n-LNPI/2.);\nreturn cadd(ONE, cmul_i(cmul(cexp(csquare(cmul_i(z))), corrections)));",["reciprocal","mul_i","component_mul_prelog","square","exp","mul","add"]),wt=new Ge("cerf_small","float z2 = z.x*z.x;\nfloat xy = 2.*z.x*z.y;\nfloat K = exp(-z2)/PI;\nfloat q = 4.*z2;\nfloat a = cos(xy);\nfloat b = sin(xy);\n\nfloat offset = (z.y+z.x) * max(z.y-z.x, 0.);\nfloat scale = exp(-offset);\n\nvec2 series = vec2(0.0, 0.0);\nfor (int i = 0; i < 16; i += 4) {\n    vec4 k = float(i) + vec4(1., 2., 3., 4.);\n    vec4 kk = k*k/4.0 + z2 + offset;\n    vec4 kz = k*z.y;\n    vec4 e1 = exp(kz - kk);\n    vec4 e2 = exp(-kz - kk);\n\n    vec4 aa = z.x*(e1+e2);\n    vec4 bb = 0.5*k*(e1-e2);\n\n    vec4 denom = 1./(k*k + q);\n    series.x += dot(2.*z.x * exp(-kk) - a*aa + b*bb, denom);\n    series.y += dot(b*aa + a*bb, denom);\n}\nreturn scale * (rerf(z) + (K/(2. * z.x)) * vec3(1.-a, b, 0).COMPONENTS) + vec3(series*2./PI, offset).COMPONENTS;",["rerf"]),_t=new Ge("cerf","z = downconvert(z);\nVEC_TYPE result;\n\nif (abs(z.y) > 5.5) {\n    result = cerf_large(abs(z));\n} else {\n    result = cerf_small(abs(z));\n}\n\nif (z.y < 0.0) {result.y *= -1.;}\nif (z.x < 0.0) {result.x *= -1.; result.x -= 1e-7;}\n\nreturn result;",["cerf_small","cerf_large"]),zt=new Ge("cnome","return ccomponent_mul(cmul_i(clog(z)), -0.5/PI);",["log","mul_i","component_mul"]),Et=new Ge("ctheta00","z = downconvert(z); w = downconvert(w);\nVEC_TYPE result = ONE;\nVEC_TYPE A = 2.*z;\nfor (int i = 2; i < 10; i += 4) {\n    float n = float(i);\n    VEC_TYPE B = n*w;\n    result = cadd(result, cadd8(\n        ccis(PI*(n-1.)*(B-w+A)),\n        ccis(PI*(n-1.)*(B-w-A)),\n        ccis(PI*n*(B+A)),\n        ccis(PI*n*(B-A)),\n        ccis(PI*(n+1.)*(B+w+A)),\n        ccis(PI*(n+1.)*(B+w-A)),\n        ccis(PI*(n+2.)*(B+2.*w+A)),\n        ccis(PI*(n+2.)*(B+2.*w-A))\n    ));\n}\nreturn result;",["cis","component_mul","add","add8"],2),xt=new Ge("ctheta01","z = downconvert(z); w = downconvert(w); return ctheta00(z + 0.5 * ONE, w);",["theta00"],2),$t=new Ge("ctheta10","z = downconvert(z); w = downconvert(w); return cmul(ccis(PI * (z + 0.25 * w)), ctheta00(z + 0.5 * w, w));",["mul","cis","theta00"],2),Ot=new Ge("ctheta11","z = downconvert(z); w = downconvert(w); return cmul(ccis(0.25 * PI * (w + 4.0 * z + 2.0 * ONE)), ctheta00(z + 0.5 * (w + ONE), w));",["mul","cis","theta00"],2),jt=new Ge("theta000","VEC_TYPE result = 0.5*ONE;\nVEC_TYPE iz = cmul_i(z);\nfor (int i = 1; i < 8; i++) {\n    float n = float(i);\n    result += cexp_raw(PI * n * n * iz);\n}\nreturn 2.*result;",["mul_i","exp_raw"]),Pt=new Ge("theta00f","VEC_TYPE result = ONE;\nVEC_TYPE A = 2.*cmul_i(z);\nVEC_TYPE iw = cmul_i(w);\nfor (int i = 1; i < 4; i++) {\n    float n = float(i);\n    VEC_TYPE B = n * iw;\n    result += cexp_raw(PI * n * (B + A));\n    result += cexp_raw(PI * n * (B - A));\n}\nreturn result;",["exp_raw","mul_i"],2),Ct=new Ge("theta01f","return theta00f(z + 0.5 * ONE, w);",["theta00f"],2),kt=new Ge("theta10f","return cmul(cexp_raw(PI * cmul_i(z + 0.25 * w)), theta00f(z + 0.5 * w, w));",["mul","mul_i","exp_raw","theta00f"],2),Tt=new Ge("theta11f","return cmul(cexp_raw(0.25 * PI * cmul_i(w + 4.0 * z + 2.0 * ONE)), theta00f(z + 0.5 * (w + ONE), w));",["mul","mul_i","exp_raw","theta00f"],2),Ft=new Ge("invert_tau","VEC_TYPE rt_k = csqrt(csqrt(ONE - csquare(z)));\nVEC_TYPE ell = 0.5 * cdiv(ONE - rt_k, ONE + rt_k);\nVEC_TYPE log_l = clog(ell);\nVEC_TYPE q = ell + 2.*cexp_raw(5.*log_l) + 15.*cexp_raw(9.*log_l);\nreturn -cmul_i(clog(q))/PI;",["sqrt","div","exp_raw","mul_i","log","component_mul"]),Nt=new Ge("jacobi_reduce","VEC_TYPE t00 = theta000(w);\nVEC_TYPE zz = cdiv(z, PI*csquare(t00));\nfloat n = 2.0 * floor(0.5 * zz.y / w.y + 0.5);\nreturn zz - n * w;",["theta000","div","square","component_mul"],2),Mt="z = downconvert(z); w = downconvert(w);\nVEC_TYPE tau = invert_tau(w);\nVEC_TYPE zz = jacobi_reduce(z, tau);",St=new Ge("raw_sn","return -cdiv(\n    cmul(theta000(w), theta11f(z, w)),\n    cmul(theta10f(ZERO, w), theta01f(z, w))\n);",["div","mul","theta000","theta11f","theta10f","theta01f"],2),qt=new Ge("raw_cn","return cdiv(\n    cmul(theta01f(ZERO, w), theta10f(z, w)),\n    cmul(theta10f(ZERO, w), theta01f(z, w))\n);",["div","mul","theta01f","theta10f"],2),At=new Ge("raw_dn","return cdiv(\n    cmul(theta01f(ZERO, w), theta00f(z, w)),\n    cmul(theta000(w), theta01f(z, w))\n);",["div","mul","theta01f","theta00f","theta000"],2),It=new Ge("csn","".concat(Mt,"\nreturn raw_sn(zz, tau);"),["invert_tau","jacobi_reduce","raw_sn"],2),Vt=new Ge("ccn","".concat(Mt,"\nreturn raw_cn(zz, tau);"),["invert_tau","jacobi_reduce","raw_cn"],2),Yt=new Ge("cdn","".concat(Mt,"\nreturn raw_dn(zz, tau);"),["invert_tau","jacobi_reduce","raw_dn"],2),Lt=new Ge("cwp","z = downconvert(z); w = downconvert(w);\nfloat n = floor(z.y/w.y + 0.5);\nVEC_TYPE zz = z - n * w;\nVEC_TYPE t002 = csquare(theta000(w));\nVEC_TYPE t102 = csquare(theta10f(ZERO, w));\nVEC_TYPE e2 = -(PI*PI/3.0) * (csquare(t102) + csquare(t002));\nreturn PI*PI*cmul(cmul(t002, t102), csquare(cdiv(theta01f(zz, w), theta11f(zz, w)))) + e2;",["square","div","mul","theta000","theta10f","theta01f","theta11f"],2),Ut=new Ge("raw_wpp","return -2. * cmul(\n    cexp_raw(3. * clog(cdiv(w, raw_sn(z, w1)))),\n    cmul(raw_cn(z, w1), raw_dn(z, w1))\n);",["mul","exp_raw","log","div","raw_sn","raw_cn","raw_dn"],3),Rt=new Ge("cwpp","z = downconvert(z); w = downconvert(w);\nVEC_TYPE t004 = csquare(csquare(theta000(w)));\nVEC_TYPE t104 = csquare(csquare(theta10f(ZERO, w)));\nVEC_TYPE t014 = csquare(csquare(theta01f(ZERO, w)));\n\nconst float PI2_3 = PI*PI/3.0;\nVEC_TYPE e1 = PI2_3 * (t004 + t014);\nVEC_TYPE e2 = -PI2_3 * (t104 + t004);\nVEC_TYPE e3 = PI2_3 * (t104 - t014);\n\nVEC_TYPE A = csqrt(e1 - e3);\nVEC_TYPE B = csqrt(e2 - e3);\n\nVEC_TYPE u = cmul(z, A);\nVEC_TYPE k = cdiv(B, A);\nVEC_TYPE tau = invert_tau(k);\nVEC_TYPE zz = jacobi_reduce(u, tau);\n\nreturn raw_wpp(zz, A, tau);",["mul","div","sqrt","square","theta000","theta10f","theta01f","invert_tau","jacobi_reduce","raw_wpp"],2),Dt=new Ge("csm","z = downconvert(z); return ccm(1.7666387502854499*ONE-z);",["cm"]),Bt=new Ge("ccm","z = downconvert(z);\nconst VEC_TYPE A = vec3(0.42644336004913946, 0.42644336004913946, 0).COMPONENTS;\nconst VEC_TYPE tau = vec3(-0.5, 0.8660254037844386, 0).COMPONENTS;\nVEC_TYPE u = cmul(z, A);\nVEC_TYPE zz = jacobi_reduce(u, tau);\nreturn ONE + 2. * creciprocal(3. * raw_wpp(zz, A, tau) - ONE);",["reciprocal","jacobi_reduce","raw_wpp"]),Wt=new Je("lattice_reduce","if (z.y < 0.) {return -1./0. * vec4(1);}\nvec4 coeffs = vec4(1., 0, 0, 1.);\nvec2 a = z;\nvec2 b = vec2(1., 0);\nfor (int i = 0; i < 5; i++) {\nfloat mu = floor(dot(a, b)/dot(b, b) + 0.5);\na -= mu * b;\ncoeffs.xy -= mu * coeffs.zw;\nmu = floor(dot(a, b)/dot(a, a) + 0.5);\nb -= mu * a;\ncoeffs.zw -= mu * coeffs.xy;\n}\nvec4 res = vec4(coeffs.x*z, coeffs.z*z) + vec4(coeffs.y, 0, coeffs.w, 0);\nfloat p = step(length(res.xy), length(res.zw));\nvec2 num = res.xy * (1.-p) + res.zw * p;\nvec2 denom = res.xy * p + res.zw * (1.-p);\nvec2 representative = (1.-2.*p)*cdiv(vec3(num, 0).COMPONENTS, vec3(denom, 0).COMPONENTS).xy;\nreturn vec4(representative, denom);",["div"]),Ht=new Qe("nred","z = downconvert(z);\nvec4 reduced = lattice_reduce(z.xy);\nz = vec3(reduced.xy, 0).COMPONENTS;\nVEC_TYPE weight = vec3(reduced.zw, 0).COMPONENTS;\nVEC_TYPE q = cexp_raw(2.*PI*cmul_i(z));\nreturn vec4(q.xy, clog(weight).xy);",["lattice_reduce","log","exp_raw","mul_i"]),Gt=new Ge("cj","z = downconvert(z);\nz = vec3(lattice_reduce(z.xy).xy, 0).COMPONENTS;\nVEC_TYPE q = cexp_raw(PI*cmul_i(z));\nVEC_TYPE q2 = csquare(q);\nVEC_TYPE a = 8.*LN2*ONE + 2.*PI*cmul_i(z) + 8.*cmul(q2, ONE - 0.5*q2); // log(theta10^8)\nVEC_TYPE even = -16.*cmul(q2, ONE + q2);\nVEC_TYPE odd = 16.*cmul(q, ONE + 4./3.*q2);\nVEC_TYPE b = even+odd; // log(theta00^8)\nVEC_TYPE c = even-odd; // log(theta01^8)\nreturn cexp(3.*clog(cexp_raw(a) + cexp_raw(b) + cexp_raw(c)) - (a+2.*even) + 5.*LN2*ONE);",["lattice_reduce","theta00","theta10","theta01","log","exp","exp_raw","cis","mul_i","square"]),Kt=new Ge("ce2","vec4 h = nred(z);\nVEC_TYPE q = vec3(h.xy, 0).COMPONENTS;\nVEC_TYPE log_weight = vec3(h.zw, 0).COMPONENTS;\nVEC_TYPE q2 = csquare(q);\nVEC_TYPE q3 = cmul(q, q2);\nVEC_TYPE q4 = csquare(q2);\nVEC_TYPE q5 = cmul(q, q4);\nVEC_TYPE q6 = cmul(q2, q4);\nVEC_TYPE q7 = cmul(q3, q4);\nVEC_TYPE q8 = csquare(q4);\nVEC_TYPE series = ONE - 24.*(\n    cdiv(q, ONE-q) + 2.*cdiv(q2, ONE-q2) + 3.*cdiv(q3, ONE-q3) + 4.*cdiv(q4, ONE-q4)\n    +5. * cdiv(q5, ONE-q5) + 6.*cdiv(q6, ONE-q6) + 7.*cdiv(q7, ONE-q7) + 8.*cdiv(q8, ONE-q8)\n);\nreturn cmul(series, cexp(log_weight * -2.));",["nred","square","exp"]),Xt={mul_i:nn,reciprocal:tn,square:yn,component_mul:Gn,component_mul_prelog:Kn,real:sn,imag:ln,conj:rn,abs:an,arg:on,sgn:cn,cis:fn,floor:un,ceil:mn,round:pn,step:hn,exp:bn,exp_raw:dn,log:vn,sqrt:gn,pow:Jn,sin:wn,cos:_n,tan:zn,sec:En,csc:xn,cot:$n,arcsin:On,arccos:jn,arctan:Pn,arcsec:kn,arccsc:Tn,arccot:Cn,sinh:Fn,cosh:Nn,tanh:Mn,sech:Sn,csch:qn,coth:An,arsinh:In,arcosh:Vn,artanh:Yn,arsech:Ln,arcsch:Un,arcoth:Rn,neg:Dn,add:Bn,add4:Qn,add8:et,mul4:nt,sub:Wn,mul:Hn,div:Xn,mod:Zn,factorial:ot,cgamma_left:rt,cgamma_right:at,gamma:tt,beta:it,binom:ct,lambertw:st,ceta_left:ut,ceta_strip:pt,ceta_right:bt,zeta_character:mt,czeta_strip:dt,czeta_helper:ht,czeta_helper_2:ft,rerf:gt,cerf_small:wt,cerf_large:yt,eta:lt,zeta:vt,erf:_t,invert_tau:Ft,jacobi_reduce:Nt,theta000:jt,theta00f:Pt,theta01f:Ct,theta10f:kt,theta11f:Tt,nome:zt,theta00:Et,theta01:xt,theta10:$t,theta11:Ot,raw_sn:St,raw_cn:qt,raw_dn:At,sn:It,cn:Vt,dn:Yt,raw_wpp:Ut,wp:Lt,wpp:Rt,sm:Dt,cm:Bt,lattice_reduce:Wt,nred:Ht,e4_helper:new en("e4_helper","VEC_TYPE q = vec3(h.xy, 0).COMPONENTS;\nVEC_TYPE log_weight = vec3(h.zw, 0).COMPONENTS;\nVEC_TYPE q2_chr = csquare(2.8284271247*q); // 8q^2\nVEC_TYPE q3_chr = cmul(3.375*q, q2_chr); // 27q^3\nVEC_TYPE series = ONE + 240.*(cdiv(q, ONE-q) + q2_chr + q3_chr);\nreturn cmul(series, cexp(log_weight * -4.));",["exp","log","square","mul","div"]),e6_helper:new en("e6_helper","VEC_TYPE q = vec3(h.xy, 0).COMPONENTS;\nVEC_TYPE log_weight = vec3(h.zw, 0).COMPONENTS;\nVEC_TYPE q2_chr = csquare(5.65685425*q); // 32q^2\nVEC_TYPE q3_chr = cmul(7.59375*q, q2_chr); // 243q^3\nVEC_TYPE q4_chr = csquare(q2_chr); // 1024q^5\nVEC_TYPE series = ONE - 504.* (cdiv(q, ONE-q) + cdiv(q2_chr, ONE-0.03125*q2_chr) + q3_chr + q4_chr);\nreturn cmul(series, cexp(log_weight * -6.));",["exp","log","square","mul","div","exp_raw","sub","component_mul_prelog"]),j:Gt,e2:Kt,e4:new Ge("ce4","vec4 h = nred(z); return e4_helper(h);",["nred","e4_helper"]),e6:new Ge("ce6","vec4 h = nred(z); return e6_helper(h);",["nred","e6_helper"]),e8:new Ge("ce8","return csquare(ce4(z));",["square","e4"]),e10:new Ge("ce10","vec4 h = nred(z); return cmul(e4_helper(h), e6_helper(h));",["mul","nred","e4_helper","e6_helper"]),e12:new Ge("ce12","vec4 h = nred(z); VEC_TYPE a = e4_helper(h); VEC_TYPE b = e6_helper(h);\nreturn cadd(ccomponent_mul(cexp(3.*clog(a)), 441./691.), ccomponent_mul(csquare(b), 250./691.));",["add","nred","e4_helper","e6_helper","component_mul","square"]),e14:new Ge("ce14","vec4 h = nred(z); return cmul(csquare(e4_helper(h)), e6_helper(h));",["nred","e4_helper","e6_helper","mul","square"]),e16:new Ge("ce16","vec4 h = nred(z); VEC_TYPE a = e4_helper(h); VEC_TYPE b = e6_helper(h);\nreturn cadd(ccomponent_mul(cexp(4.*clog(a)), 1617./3617.), ccomponent_mul(csquare(b), 2000./3617.));",["add","nred","e4_helper","e6_helper","component_mul","square"])};function Zt(e){try{var n=new k.a.Parser(We);n.feed(e);var t=n.results[0];return null!==t&&console.log("Raw AST:",t),Re(t||null)}catch(r){return console.error(r),null}}function Jt(e,n){var t=null;if(Array.isArray(e))t=function e(n){if(!Array.isArray(n))return new Set;if(["number","variable","constant"].includes(n[0]))return new Set;var t,r=new Set([n[0]]),a=De(n.slice(1));try{for(a.s();!(t=a.n()).done;){var o,i=De(e(t.value));try{for(i.s();!(o=i.n()).done;){var c=o.value;r.add(c)}}catch(s){i.e(s)}finally{i.f()}}}catch(s){a.e(s)}finally{a.f()}return r}(e);else{t=new Set;for(var r=0,a=Object.keys(Xt);r<a.length;r++){var o=a[r];e.includes(o+"(")&&t.add(o)}}for(var i=Array.from(t);i.length>0;){var c,s=i.pop(),l=Xt[s],u=De(n?l.log_dependencies:l.dependencies);try{for(u.s();!(c=u.n()).done;){var m=c.value;t.has(m)||(t.add(m),i.push(m))}}catch(y){u.e(y)}finally{u.f()}}console.log("Functions loaded:",t);var p=n?"vec3":"vec2",h=n?"xyz":"xy",f=Array.from(t).map((function(e){return Xt[e]})),d=f.map((function(e){return e.declaration.replaceAll("VEC_TYPE",p)})),b=f.map((function(e){return(n?e.log_code:e.code).replaceAll("VEC_TYPE",p).replaceAll("COMPONENTS",h)})),v=d.join("\n"),g=b.join("\n");return"".concat(v,"\n\n").concat(g)}var Qt=t(145);function er(e){var n=Number.isInteger(e)?".":"";return e.toString()+n}var nr=function e(n,t){if(!isNaN(n))return[er(n),!1];if(!Array.isArray(n))return[n,!1];var r={add:"+",sub:"-",component_mul:"*"};t&&(r={});var a=Object(N.a)(n),o=a[0],i=a.slice(1);if("number"===o){var c=Object(P.a)(i,2),s=c[0],l=c[1];if(t){var u=Qt.hypot(s,l);return 0===u&&(u=1),["vec3(".concat(s/u,", ").concat(l/u,", ").concat(Qt.log(u),")"),!1]}return 1===s&&0===l?["ONE",!1]:0===s&&1===l?["I",!1]:["vec2(".concat(s,", ").concat(l,")"),!1]}if("variable"===o)return[i[0],!1];if("constant"===o)return["C_"+i[0].toUpperCase(),!1];if(o in r){var m=r[o],p=i.map((function(n){return e(n,t)}));return"-"===m?p[1][1]&&(p[1][0]="("+p[1][0]+")"):"+"!==m&&(p=p.map((function(e){return[e[1]?"("+e[0]+")":e[0],!1]}))),[p[0][0]+m+p[1][0],"mul"!==o]}return[Object(M.get)({factorial:"cfact"},o,"c"+o)+"("+i.map((function(n){return e(n,t)[0]})).join(", ")+")",!1]};function tr(e,n,t){var r=e.createShader(n);return e.shaderSource(r,t),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)?r:(console.error("Shader failed to compile: "+e.getShaderInfoLog(r)),e.deleteShader(r),null)}var rr=function(e,n,t,r){if(null===n)return null;e.LOG_MODE=!t;var a=function(e,n,t,r,a,o){var i=(t/2).toFixed(2),c=(r/2).toFixed(2),s=window.devicePixelRatio.toFixed(4),l=o?"vec3":"vec2",u=a.map((function(e){return"uniform ".concat(l," ").concat(e,";")})).join("\n"),m="",p=null;n?(m=e,p="mapping(z)"):(p=nr(e,o)[0],o&&(p="upconvert(".concat(p,")")));if(null===p)return null;return console.log("Compiled AST:",e),console.log("Shader Code (".concat(o?"log-cart":"cartesian","):"),p),"\n  #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n  #else\n    precision mediump float;\n  #endif\n\n  const float PI = 3.14159265358979323846264;\n  const float TAU = 2.*PI;\n  const float E = 2.718281845904523;\n  const float LN2 = 0.69314718055994531;\n  const float LN2_INV = 1.442695040889634;\n  const float LNPI = 1.1447298858494001741434;\n  const float PHI = 1.61803398874989484820459;\n  const float SQ2 = 1.41421356237309504880169;\n\n  const float checkerboard_scale = 0.25;\n\n  const ".concat(l," ZERO = ").concat(o?"vec3(0)":"vec2(0)",";\n  const ").concat(l," ONE = ").concat(o?"vec3(1., 0, 0)":"vec2(1., 0)",";\n  const ").concat(l," I = ").concat(o?"vec3(0, 1., 0)":"vec2(0, 1.)",";\n  const ").concat(l," C_PI = ").concat(o?"vec3(PI, 0, 0)":"vec2(PI, 0)",";\n  const ").concat(l," C_TAU = ").concat(o?"vec3(TAU, 0, 0)":"vec2(TAU, 0)",";\n  const ").concat(l," C_E = ").concat(o?"vec3(E, 0, 0)":"vec2(E, 0)",";\n  const ").concat(l," C_PHI = ").concat(o?"vec3(PHI, 0, 0)":"vec2(PHI, 0)",";\n\n  ").concat(u,"\n\n  vec2 clogcart(").concat(l," z) {return vec2(").concat(o?"log(length(z.xy)) + z.z":"log(length(z))",", atan(z.y, z.x+1e-20));}\n  vec2 encodereal(float a) {return vec2(log(abs(a)), 0.5*PI*(1. - sign(a)));}\n  ").concat(o?"vec3 downconvert(vec3 z) {return vec3(vec2(z.xy) * exp(z.z), 0);}":"vec2 downconvert (vec2 z) {return z;}","\n  vec3 upconvert(vec3 z) {float l = length(z.xy); return vec3(z.xy/l, z.z + log(l));}\n  float ordinate(").concat(l," z) {return ").concat(o?"z.z":"0.",";}\n\n  ").concat(Jt(e,o),"\n\n  vec3 hsv2rgb(vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n  }\n\n  vec3 get_color(").concat(l," z_int, float derivative, float phase_derivative) {\n    vec2 magphase = clogcart(z_int);\n    magphase.x *= LN2_INV;\n    magphase.y = mod(magphase.y, TAU);\n    vec2 z = ").concat(o?"downconvert(z_int).xy":"z_int",";\n\n    float color_value;\n    float color_saturation = 1.0;\n\n    ").concat(o?"float phase_decay_factor = 1./clamp(8. * phase_derivative, 1., 10000.0);\n    color_saturation *= phase_decay_factor;":"","\n\n    if (continuous_gradient.x > 0.5) {\n      float color_lightness = 0.5 + atan(0.35 * magphase.x)/PI;\n      color_saturation = 1.0;\n\n      if (invert_gradient.x > 0.5) {\n\tcolor_lightness = 1.0 - color_lightness;\n      }\n\n      /* HSL to HSV conversion */\n      color_lightness *= 2.0;\n      color_saturation *= 1.0 - abs(color_lightness - 1.0);\n      color_value = (color_lightness + color_saturation) / 2.0;\n      color_saturation /= color_value;\n    } else {\n      color_value = 0.5 * exp2(fract(magphase.x));\n\n      if (invert_gradient.x > 0.5) {\n\tcolor_value = 1.5 - color_value;\n      }\n\n").concat(o?"color_value += (0.75 - color_value) * (1. - phase_decay_factor);":"","\n    }\n\n    if (enable_checkerboard.x > 0.5) {\n      vec2 checkerboard_components = floor(2.0 * fract(z/checkerboard_scale));\n      float checkerboard = floor(2.0 * fract((checkerboard_components.x + checkerboard_components.y)/2.0));\n\n      // Anti-Moire\n      float decay_factor = clamp(40. * derivative, 1., 10000.0) - 1.;\n      checkerboard = 0.5 + (checkerboard - 0.5) / (1. + 3. * decay_factor);\n\n      if (magphase.x > 15.) {checkerboard = 0.5;}\n\n      color_value *= 0.8 + 0.2 * checkerboard;\n    }\n\n    vec3 hsv_color = vec3(magphase.y/TAU, color_saturation, color_value);\n    return hsv2rgb(hsv_color);\n  }\n\n  ").concat(m,"\n\n  const vec2 screen_offset = vec2(").concat(i,", ").concat(c,");\n  vec2 from_pixel(vec2 xy) {\n    vec2 plot_center = vec2(center_x.x, center_y.x);\n    float scale = exp(-log_scale.x) / ").concat(s,";\n    return scale * (xy - screen_offset) + plot_center;\n  }\n\n  ").concat(l," internal_mapping(vec2 xy) {\n      vec2 z_int = from_pixel(xy);\n      ").concat(o?"vec3 z = vec3(z_int, 0);":"vec2 z = z_int;","\n      return ").concat(p,";\n  }\n\n  void main() {\n    // Set up for supersampling\n    const vec2 A = vec2(0.125, 0.375);\n    const vec2 B = vec2(0.375, -0.125);\n    vec2 xy = gl_FragCoord.xy;\n\n    // 4-Rook supersampling\n    ").concat(l," w1 = internal_mapping(xy + A);\n    ").concat(l," w2 = internal_mapping(xy - A);\n    ").concat(l," w3 = internal_mapping(xy + B);\n    ").concat(l," w4 = internal_mapping(xy - B);\n\n    // Anti-Moire\n    float phase_derivative = ").concat(o?"0.5*(length(w1-w2) + length(w3-w4))":"0.",";\n    float derivative = ").concat(o?"phase_derivative * exp(min(w1.z, 20.))":"0.5 * (length(w1 - w2) + length(w3 - w4))",";\n\n    vec3 color1 = get_color(w1, derivative, phase_derivative);\n    vec3 color2 = get_color(w2, derivative, phase_derivative);\n    vec3 color3 = get_color(w3, derivative, phase_derivative);\n    vec3 color4 = get_color(w4, derivative, phase_derivative);\n\n    vec3 color =  0.25 * (color1 + color2 + color3 + color4);\n    gl_FragColor = vec4(color, 1.0);\n  }\n  ")}(n,t,e.drawingBufferWidth,e.drawingBufferHeight,r,e.LOG_MODE);if(null===a)return null;var o=tr(e,e.VERTEX_SHADER,ar),i=tr(e,e.FRAGMENT_SHADER,a);if(null===o|null===i)return null;var c=e.createProgram();return e.attachShader(c,o),e.attachShader(c,i),e.linkProgram(c),e.getProgramParameter(c,e.LINK_STATUS)?c:(console.error("Shader program failed to initialize: "+e.getProgramInfoLog(c)),null)},ar="\n  attribute vec2 a_position;\n\n  void main() {\n    gl_Position = vec4(a_position, 0, 1);\n  }\n";function or(e,n){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return ir(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ir(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw o}}}}function ir(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function cr(e,n,t,r){if(null===n)return null;var a=rr(e,n,t,r);if(null===a)return console.error("AST could not be compiled:",n),null;!function(e){var n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),e.STATIC_DRAW)}(e),e.useProgram(a);var o=e.getAttribLocation(a,"a_position");e.enableVertexAttribArray(o),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0);var i,c={},s=or(r);try{for(s.s();!(i=s.n()).done;){var l=i.value;c[l]=e.getUniformLocation(a,l)}}catch(u){s.e(u)}finally{s.f()}return c}function sr(e,n,t){for(var r=0,a=Object.keys(n);r<a.length;r++){var o=a[r],i=Object(P.a)(n[o],2),c=i[0],s=i[1];e.LOG_MODE?e.uniform3f(c,s,0,0):e.uniform2f(c,s,0)}e.drawArrays(e.TRIANGLES,0,6),function(e,n){var t=window.devicePixelRatio,r=window.innerWidth*t,a=window.innerHeight*t;if(e.clearRect(0,0,r,a),n.enable_axes[1]<.5)return;var o=Math.exp(n.log_scale[1])*t,i=2.3-n.log_scale[1]/Math.log(10);i+=.03*Math.abs(i);var c=Math.round(i),s=Math.pow(10,c);c-i>.2?(s/=5,c--):c-i>0&&(s/=2,c--);var l=r/2-o*n.center_x[1],u=a/2+o*n.center_y[1],m=-l/o,p=(r-l)/o,h=(u-a)/o,f=u/o;function d(n){var t=Math.round(u-o*n);e.moveTo(0,t),e.lineTo(r,t)}function b(n,t){var r=Math.round(l+o*n);e.moveTo(r,0),e.lineTo(r,a)}function v(n){var i=l+o*n;if(!(i>r-30*t||i<30*t)){var s=u<a/3?22:-10,m=Math.min(Math.max(u+s*t,90*t),a-20*t),p=n.toFixed(Math.max(0,-c)).replace("-","\u2212"),h=e.measureText(p).width+6*t;e.textAlign="center",e.clearRect(i-h/2,m-18*t,h,24*t),e.strokeText(p,i,m),e.fillText(p,i,m)}}function g(n,i){var s=u-o*n+6*t;if(!(s>a-50*t||s<100*t)){var m=l<2*r/3,p=m?10:-10;e.textAlign=m?"left":"right";var h=Math.min(Math.max(l+p*t,20*t),r-20*t),f=n.toFixed(Math.max(0,-c)).replace("-","\u2212");"1"===f&&(f=""),"\u22121"===f&&(f="\u2212"),e.font="".concat(20*t,"px Computer Modern Serif");var d=e.measureText(f).width,b=d+i+8*t;e.clearRect(h-(m?3*t:b-4*t),s-18*t,b,24*t);var v=m?0:-i-t;e.strokeText(f,h+v,s),e.fillText(f,h+v,s),e.font="italic ".concat(20*t,"px Computer Modern Serif");var g=m?d+t:0;e.strokeText("i",h+g,s),e.fillText("i",h+g,s)}}e.globalAlpha=.8,e.strokeStyle="#ffffff",e.lineWidth=1,e.beginPath();for(var y=Math.ceil(m/s);y<p/s;y++)0!==y&&b(y*s);for(var w=Math.ceil(h/s);w<f/s;w++)0!==w&&d(w*s);e.stroke(),e.lineWidth=2,e.beginPath(),b(0),d(0),e.stroke(),e.font="".concat(20*t,"px Computer Modern Serif"),e.globalAlpha=1,e.fillStyle="#ffffff",e.lineWidth=4,e.lineJoin="round",e.strokeStyle="#444444";for(var _=Math.ceil(m/s);_<p/s;_++)0!==_&&v(_*s);e.font="italic ".concat(20*t,"px Computer Modern Serif");for(var z=e.measureText("i").width,E=Math.ceil(h/s);E<f/s;E++)0!==E&&g(E*s,z)}(t,n)}var lr=t(98);function ur(e,n,t){return 0!==e?0!==n?hr(e,!1,t)+hr(n,!0,t)+"\\, i":hr(e,!1,t):0!==n?hr(n,!1,t)+"\\, i":"0"}var mr={"\\pi":Math.PI,"\\sqrt{2}":Math.sqrt(2),e:Math.E};function pr(e){return Math.abs(e-Math.round(e))<1e-10}function hr(e,n,t){var r=Math.abs(e),a=e<0?"-":n?"+":"";if(t>3){var o=function(e){for(var n=0,t=Object.entries(mr);n<t.length;n++)for(var r=t[n],a=Object(P.a)(r,2),o=a[0],i=a[1],c=0,s=[1,2,3,6,12];c<s.length;c++){var l=s[c],u=l*e/i;if(u>.5&&pr(u)){console.log(u);var m=function(e){return 1===e?"":e.toString()}(Math.round(u))+" "+o;return 1===l?m:"\\frac{"+m+"}{"+l+"}"}}return null}(r);if(!Object(M.isNil)(o))return a+o}var i=r>0?Math.floor(Math.log10(r)):0;return Math.abs(i)<3&&(i=0),a+(r*Math.pow(10,-i)).toFixed(t)+(0===i?"":"\\times 10^{".concat(i,"}"))}var fr=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(u.a)(this,Object(m.a)(n).call(this,e))).state={faded:!1},t.fadeTimer=null,t.lastX=null,t.lastY=null,t}return Object(p.a)(n,e),Object(l.a)(n,[{key:"hasChanged",value:function(){var e=this.props,n=e.x,t=e.y,r=this.lastX!==n||this.lastY!==t;return this.lastX=n,this.lastY=t,r}},{key:"componentDidMount",value:function(){this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){var e=this;this.hasChanged()&&(null!==this.fadeTimer&&clearTimeout(this.fadeTimer),this.fadeTimer=setTimeout((function(){return e.setState({faded:!0})}),2e3),this.setState({faded:!1}))}},{key:"render",value:function(){var e=this.state.faded,n=this.props,t=n.x,r=n.y,o=(0,n.mapping)([t,r]),i=Object(P.a)(o,2),c=i[0],s=i[1];return a.a.createElement("div",{className:"coordinate-container"},a.a.createElement(lr.InlineMath,null,"z = "+ur(t,r,3)),isFinite(c)&&isFinite(s)?a.a.createElement(lr.InlineMath,null,"f(z) = "+ur(c,s,3)):null,a.a.createElement("style",null,"\n                .coordinate-container {\n                    position: absolute;\n                    bottom: 0;\n                    right: 0;\n                    z-index: 20;\n\n                    padding: 5px 20px;\n                    min-width: 180px;\n\n                    display: flex;\n                    flex-direction: column;\n                    align-items: center;\n                    justify-content: center;\n\n                    background-color: hsla(213, 5%, 15%, 0.3);\n                    border: 1px solid hsla(213, 5%, 90%, 0.1);\n                    box-shadow: -1px -1px 4px hsla(213, 10%, 10%, 0.1);\n\n                    border-radius: 8px 0 0 0;\n\n                    backdrop-filter: blur(6px);\n\n                    color: white;\n                    font-size: 22px;\n                    line-height: 1;\n\n                    opacity: ".concat(e?0:1,";\n                    transition: ").concat(e?1:.1,"s opacity ease-out;\n                }\n\n                @media (max-width: 700px) {\n                    .coordinate-container {\n                        border-radius: 0;\n                        left: 0;\n                        font-size: 18px;\n                    }\n                }\n            ")))}}]),n}(r.PureComponent),dr=(t(521),[]);function br(e,n,t){var r=Math.exp(t.log_scale),a=t.center_x,o=t.center_y;return[(e-dr[0]/2)/r+a,(dr[1]/2-n)/r+o]}var vr=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(u.a)(this,Object(m.a)(n).call(this,e))).state={position:[NaN,NaN,0],mouseDown:!1},t.gl=null,t.variableLocations={},t.initialized=!1,t.lastUpdate=null,t}return Object(p.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.compilePlot.bind(this)),this.initializeWebGL(),this.componentDidUpdate(),this.compilePlot()}},{key:"compilePlot",value:function(){var e=this.props.onError;this.initializePlot(),this.updatePlot(),e(!this.initialized)}},{key:"componentDidUpdate",value:function(){var e=this.props,n=e.expression,t=e.variables,r=Object.keys(t).toString();this.lastExpression===n&&r===this.lastKeys||this.compilePlot(),this.lastExpression=n,this.lastKeys=r}},{key:"getPosition",value:function(e){var n=e.nativeEvent;if(void 0!==n.targetTouches){var t=n.targetTouches;if(1===t.length)return[t[0].pageX,t[0].pageY,1];var r=[t[0].pageX,t[0].pageY],a=r[0],o=r[1],i=[t[1].pageX,t[1].pageY],c=i[0],s=i[1];return[(a+c)/2,(o+s)/2,Math.log(Math.hypot(c-a,s-o))]}return[n.pageX,n.pageY,1]}},{key:"updatePosition",value:function(e){this.setState({position:this.getPosition(e)})}},{key:"handleZoom",value:function(e,n){var t=this.state.position,r=this.props.variables;if(t.every(isFinite)){var a=Object(P.a)(t,3),o=a[0],i=a[1],c=(a[2],br(o,i,r)),s=Object(P.a)(c,2),l=s[0],u=s[1];r.center_x=l,r.center_y=u,void 0===n&&(n=e.deltaY>0?-.05:.05),r.log_scale+=n;var m=br(o,i,r),p=Object(P.a)(m,2),h=p[0]-l,f=p[1]-u;r.center_x-=h,r.center_y-=f,this.updatePlot()}}},{key:"handleMouseDown",value:function(e){this.updatePosition(e),this.setState({mouseDown:!0})}},{key:"handleMouseUp",value:function(e){this.setState({mouseDown:!1})}},{key:"handleMouseMove",value:function(e){var n=this.state.mouseDown,t=this.props.variables;if(n){var r=this.state.position,a=this.getPosition(e),o=Object(P.a)(a,3),i=o[0],c=o[1],s=o[2],l=[i-r[0],c-r[1],s-r[2]],u=Math.exp(t.log_scale);t.center_x-=l[0]/u,t.center_y+=l[1]/u,this.handleZoom(null,l[2]),this.updatePlot()}this.updatePosition(e)}},{key:"handleTouchStart",value:function(e){this.handleMouseDown(e)}},{key:"handleTouchMove",value:function(e){this.handleMouseMove(e)}},{key:"handleTouchEnd",value:function(e){this.handleMouseUp(e)}},{key:"handleVariableUpdate",value:function(e){for(var n=this.props.variables,t=0,r=Object.entries(e);t<r.length;t++){var a=r[t],o=Object(P.a)(a,2),i=o[0],c=o[1];n[i]=c}this.updatePlot()}},{key:"initializeWebGL",value:function(){var e=this.refs.canvas,n=this.refs.axes;if(this.gl=e.getContext("webgl"),this.axes=n.getContext("2d"),null===this.gl)return console.error("Unable to initialize WebGL."),null}},{key:"initializePlot",value:function(){var e=this.props,n=e.expression,t=e.variables,r=this.refs.canvas,a=this.refs.axes,o=window.devicePixelRatio;r.width=r.offsetWidth*o,r.height=r.offsetHeight*o,a.width=a.offsetWidth*o,a.height=a.offsetHeight*o,dr=[r.offsetWidth,r.offsetHeight],this.gl.viewport(0,0,r.width,r.height);var i=cr(this.gl,n,t.custom_function>.5,Object.keys(t));this.initialized=null!==i,this.initialized&&(this.variableLocations=i)}},{key:"updatePlot",value:function(){for(var e=this.props.variables,n={},t=0,r=Object.entries(e);t<r.length;t++){var a=r[t],o=Object(P.a)(a,2),i=o[0],c=o[1];n[i]=[this.variableLocations[i],c]}var s=+new Date;(null===this.lastUpdate||s-this.lastUpdate>1e3/70)&&(sr(this.gl,n,this.axes),this.lastUpdate=s)}},{key:"render",value:function(){var e=this,n=this.state,t=n.position,r=n.mouseDown,o=this.props,i=o.expression,c=o.variables,s=br(t[0],t[1],c),l=Object(P.a)(s,2),u=l[0],m=l[1],p=ke(i,c);return a.a.createElement("div",{id:"function-plot"},a.a.createElement("div",{id:"fallback-text"},"Loading...",a.a.createElement("div",{className:"small"},"If nothing happens, please check that Javascript and WebGL are enabled.")),a.a.createElement("canvas",{ref:"canvas",onMouseDown:function(n){return e.handleMouseDown(n)},onMouseMove:function(n){return e.handleMouseMove(n)},onMouseUp:function(n){return e.handleMouseUp(n)},onMouseEnter:function(n){return e.handleMouseMove(n)},onMouseLeave:function(n){return e.handleMouseUp(n)},onTouchStart:function(n){return e.handleTouchStart(n)},onTouchMove:function(n){return e.handleTouchMove(n)},onTouchEnd:function(n){return e.handleTouchEnd(n)},onWheel:function(n){return e.handleZoom(n)},className:"full-canvas main-plot"}),a.a.createElement("canvas",{ref:"axes",className:"full-canvas axes"}),isFinite(u)&&isFinite(m)?a.a.createElement(fr,{x:u,y:m,mapping:p}):null,a.a.createElement("style",{jsx:!0},"\n            canvas.main-plot {\n                cursor: ".concat(r?"grabbing":"grab",";\n            }\n        ")))}}]),n}(r.PureComponent),gr=t(160),yr=t.n(gr),wr=t(53),_r=t(595),zr=(t(522),function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(u.a)(this,Object(m.a)(n).call(this,e))).classes=e.classes,t.state={width:null},t}return Object(p.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){this.updateWidth(),window.addEventListener("resize",this.updateWidth.bind(this))}},{key:"updateWidth",value:function(){this.setState({width:window.innerWidth})}},{key:"render",value:function(){return this.state.width>this.props.transitionWidth?a.a.createElement(wr.a,{anchor:this.props.anchor,open:this.props.open,variant:"persistent",classes:{paper:this.props.className}},a.a.createElement("div",{className:this.classes.toolbar}),a.a.createElement("div",{className:"drawer-content"},this.props.children)):a.a.createElement(_r.a,{anchor:this.props.anchor,open:this.props.open,onOpen:this.props.onToggle,onClose:this.props.onToggle,classes:{paper:this.props.className},disableDiscovery:!0,disableSwipeToOpen:!0},a.a.createElement("div",{className:"drawer-content"},this.props.children))}}]),n}(a.a.PureComponent)),Er=yr()((function(e){return{toolbar:e.mixins.toolbar}}))(zr),xr=(t(524),t(582)),$r=t(586),Or=t(44),jr=t(45),Pr=[];Pr.push.apply(Pr,Object(h.a)(Object.keys(Xt))),Pr.push.apply(Pr,Object(h.a)(Object.values(Xt).map((function(e){return e.name})))),Pr.push("z","i","e","pi","tau","phi"),Pr.push("attribute","const","uniform","varying","layout","centroid","flat","smooth","noperspective","break","continue","do","for","while","switch","case","default","if","else","in","out","inout","float","int","void","bool","true","false","invariant","discard","return","lowp","mediump","highp","precision","struct","common","partition","active","asm","class","union","enum","typedef","template","this","packed","goto","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","superp","input","output","filter","sizeof","cast","namespace","using"),Pr.push("radians","degrees","sin","cos","tan","asin","acos","atan","sinh","cosh","tanh","asinh","acosh","atanh","pow","exp","log","exp2","log2","sqrt","inversesqrt","abs","sign","floor","trunc","round","ceil","fract","mod","modf","min","max","clamp","mix","step","smoothstep","isnan","isinf","length","distance","dot","cross","normalize","ftransform","faceforward","reflect","refract","transpose","inverse","equal","any","all","not","texture");var Cr,kr,Tr=new Set(Pr),Fr=t(585),Nr=Tr,Mr=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(u.a)(this,Object(m.a)(n).call(this,e))).state={value:"",errorMessage:""},t}return Object(p.a)(n,e),Object(l.a)(n,[{key:"setValue",value:function(e){this.setState({value:e,errorMessage:""})}},{key:"handleKeyPress",value:function(e){13===e.keyCode&&this.handleClick()}},{key:"handleClick",value:function(){var e=this.state.value.toLowerCase();""===e?this.setState({errorMessage:"Must be nonempty"}):null===e.match(/^[a-z]+$/)?this.setState({errorMessage:"Letters only"}):Nr.has(e)?this.setState({errorMessage:"Restricted keyword"}):(this.setValue(""),this.props.onClick(e))}},{key:"render",value:function(){var e=this;return a.a.createElement(Fr.a,{className:"variable-adder ".concat(Object(jr.a)(Cr||(Cr=Object(Or.a)(["\n                margin-left: 10px;\n                width: 100%;\n            "]))))},a.a.createElement(z.a,{placeholder:"Name",onChange:function(n){return e.setValue(n.target.value)},onKeyDown:function(n){return e.handleKeyPress(n)},error:""!==this.state.errorMessage,helperText:this.state.errorMessage,value:this.state.value,className:Object(jr.a)(kr||(kr=Object(Or.a)(["\n                        flex-grow: 1;\n                    "])))}),a.a.createElement(E.a,{onClick:function(){return e.handleClick()}},"Add"))}}]),n}(a.a.PureComponent),Sr=t(599),qr=t(161),Ar=t.n(qr),Ir=t(266),Vr=t.n(Ir),Yr=t(267),Lr=t.n(Yr),Ur=t(268),Rr=t.n(Ur),Dr=t(265),Br=t.n(Dr);var Wr,Hr,Gr,Kr,Xr={number:function(e){var n=Number(e);if(!Number.isNaN(n))return n},lower:function(e){return e.toLowerCase()}},Zr=(t(526),function(e){function n(){var e;return Object(s.a)(this,n),(e=Object(u.a)(this,Object(m.a)(n).call(this))).state={focused:!1,text:""},e.element=a.a.createRef(),e}return Object(p.a)(n,e),Object(l.a)(n,[{key:"getParser",value:function(){return this.props.parser in Xr?Xr[this.props.parser]:this.props.parser}},{key:"parsedValue",value:function(){return this.getParser()(this.state.text)}},{key:"valid",value:function(){return void 0!==this.parsedValue()}},{key:"reset",value:function(){this.props.value.toString()!==this.state.text&&this.setState({text:this.props.value.toString()})}},{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",(function(n){"Enter"===n.key&&e.state.focused&&e.element.current.blur()}))}},{key:"handleFocus",value:function(e){this.setState({focused:!0}),this.reset()}},{key:"handleChange",value:function(e){this.setState({text:e.target.value.toString()})}},{key:"handleBlur",value:function(e){this.setState({focused:!1}),this.valid()&&this.props.onChange(this.parsedValue())}},{key:"componentDidUpdate",value:function(){this.state.focused||this.reset()}},{key:"render",value:function(){var e=["editable-value",this.props.name];this.state.focused&&(e.push("focus"),this.valid()||e.push("invalid"));var n=e.join(" ");null!==this.element.current&&this.element.current.setAttribute("class",n);var t=this.state.focused?this.state.text:this.props.value.toString();return this.props.disabled?a.a.createElement("span",{className:n},t):a.a.createElement(Br.a,{html:t,onFocus:this.handleFocus.bind(this),onChange:this.handleChange.bind(this),onBlur:this.handleBlur.bind(this),className:n,tagName:"span",innerRef:this.element})}}]),n}(r.PureComponent)),Jr=(t(527),[.2,.5,1,2,3,4]);function Qr(e){var n=e.mode,t=e.speed,r=e.onChangeMode,o=e.onChangeSpeed,i={"":"bounce",bounce:"loop",loop:""},c={"":Vr.a,bounce:Lr.a,loop:Rr.a}[n];return a.a.createElement("div",{className:Object(jr.a)(Wr||(Wr=Object(Or.a)(["\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        margin-right: 10px;\n    "])))},a.a.createElement(c,{className:Object(jr.a)(Hr||(Hr=Object(Or.a)(["\n            color: ",";\n            cursor: pointer;\n        "])),""===n?"hsl(200, 10%, 80%)":"hsl(200, 60%, 50%)"),onClick:function(){r(i[n])}}),a.a.createElement("span",{onClick:function(){o((t+1)%Jr.length)},className:Object(jr.a)(Gr||(Gr=Object(Or.a)(["\n                font-size: 15px;\n                color: hsl(200, 20%, 40%);\n                cursor: pointer;\n                font-family: 'KaTeX_Main';\n                user-select: none;\n\n                @media (max-width: 480px) {\n                  font-size: 14px;\n                }\n            "])))},Jr[t].toFixed(1),"\xd7"))}var ea,na,ta,ra,aa=function(e){function n(){var e,t;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=Object(u.a)(this,(e=Object(m.a)(n)).call.apply(e,[this].concat(a)))).state={min:0,max:1,animationMode:"",animationSpeed:2,animationCurrentDirection:1,changing:!1},t.deleted=!1,t}return Object(p.a)(n,e),Object(l.a)(n,[{key:"setMin",value:function(e){var n=this.props,t=n.value,r=n.onChange;this.setState({min:e}),t<e&&r(e)}},{key:"setMax",value:function(e){var n=this.props,t=n.value,r=n.onChange;this.setState({max:e}),t>e&&r(e)}},{key:"setValue",value:function(e){this.ensureConsistency(),this.props.onChange(e)}},{key:"ensureConsistency",value:function(){var e=[this.state.min,this.state.max,this.props.value],n=e[1],t=e[2];e[0]>t&&this.setState({min:t}),n<t&&this.setState({max:t})}},{key:"runAnimationTick",value:function(e){var n=this.props,t=n.onChange,r=n.value,a=this.state,o=a.min,i=a.max,c=a.animationMode,s=a.animationCurrentDirection,l=a.animationSpeed;if(!this.deleted){var u=0;void 0!==e&&void 0!==this.lastAnimationTick&&(u=e-this.lastAnimationTick),this.lastAnimationTick=e;var m=r+(i-o)*Jr[l]*s*u/4e3;"bounce"===c&&(m>i&&(m=i,this.setState({animationCurrentDirection:-1})),m<o&&(m=o,this.setState({animationCurrentDirection:1}))),"loop"===c&&m>i&&(m=o);var p=Math.max(3-Math.floor(Math.log10(i-o)),3),h=Math.pow(10,p);t(Math.round(h*m)/h),""!==c&&this._mounted&&requestAnimationFrame(this.runAnimationTick.bind(this))}}},{key:"componentDidMount",value:function(){this.ensureConsistency(),this._mounted=!0}},{key:"componentWillUnmount",value:function(){this._mounted=!1,this.props.setChanging(!1)}},{key:"handleCommit",value:function(){this.setState({changing:!1}),this.props.setChanging(""!==this.state.animationMode)}},{key:"render",value:function(){var e=this,n=this.state,t=n.min,r=n.max,o=n.animationMode,i=n.animationSpeed;n.changing;return a.a.createElement("div",{className:"slider-wrapper ".concat(Object(jr.a)(Kr||(Kr=Object(Or.a)(["\n                display: flex;\n                flex-direction: row;\n                align-items: center;\n                padding: 5px 0;\n                margin: 8px 4px;\n                padding-left: 10px;\n                background-color: white;\n                border-radius: 8px;\n                "])))),onMouseUp:this.handleCommit.bind(this),onTouchEnd:this.handleCommit.bind(this)},a.a.createElement(Qr,{mode:o,speed:i,onChangeMode:function(n){e.state.animationMode=n,e.setState({animationMode:n,animationCurrentDirection:1}),e.runAnimationTick(),e.props.setChanging(""!==n)},onChangeSpeed:function(n){e.setState({animationSpeed:n})}}),a.a.createElement("div",{className:"slider"},a.a.createElement("div",{className:"info-row"},a.a.createElement(Zr,{name:"name"+(1===this.props.name.length?"-italic":""),value:this.props.name,parser:"lower",onChange:this.props.onNameChange,disabled:!0}),a.a.createElement("span",null,"="),a.a.createElement(Zr,{name:"value",value:this.props.value,parser:"number",onChange:this.setValue.bind(this)})),a.a.createElement("div",{className:"main-row"},a.a.createElement(Zr,{name:"lower-bound",value:t,parser:"number",onChange:this.setMin.bind(this)}),a.a.createElement(Sr.a,{className:"main-slider",min:t,max:r,value:this.props.value,step:(r-t)/1e3,onChange:function(n,t){e.state.changing||e.props.setChanging(!0),e.state.changing=!0,e.setValue(t)}}),a.a.createElement(Zr,{name:"upper-bound",value:r,parser:"number",onChange:this.setMax.bind(this)}))),a.a.createElement(x.a,{onClick:function(){e.deleted=!0,e.props.onDelete()},className:"delete-icon"},a.a.createElement(Ar.a,null)))}}]),n}(r.PureComponent),oa=(t(528),new Set(["log_scale","center_x","center_y","enable_checkerboard","invert_gradient","continuous_gradient","enable_axes","custom_function"])),ia=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(u.a)(this,Object(m.a)(n).call(this,e))).textField=a.a.createRef(),t.changing={},t}return Object(p.a)(n,e),Object(l.a)(n,[{key:"handleChange",value:function(e,n){this.props.variables[e]=n,this.props.onUpdate(Object(c.a)({},e,n)),this.forceUpdate()}},{key:"handleSetChanging",value:function(e,n){var t=this;this.changing[e]=n,this.props.setChanging(Object.keys(this.props.variables).some((function(e){return t.changing[e]})))}},{key:"renderSliderList",value:function(){for(var e=this,n=this.props.variables,t=[],r=function(){var n=i[o],r=(c=Object(P.a)(n,2))[0],s=c[1];if(oa.has(r))return"continue";t.push(a.a.createElement(aa,{key:r,name:r,value:s,onChange:function(n){return e.handleChange(r,n)},onDelete:function(){return e.props.onRemove(r)},setChanging:function(n){return e.handleSetChanging(r,n)}}))},o=0,i=Object.entries(n);o<i.length;o++){var c;r()}return t}},{key:"render",value:function(){var e=this;return a.a.createElement(xr.a,{className:"slider-list"},a.a.createElement($r.a,{disableSticky:!0},"Variables"),this.renderSliderList(),a.a.createElement(Mr,{onClick:function(n){return e.props.onAdd(n,.5)}}))}}]),n}(a.a.Component),ca=t(587),sa=t(593),la=function(e){function n(){return Object(s.a)(this,n),Object(u.a)(this,Object(m.a)(n).apply(this,arguments))}return Object(p.a)(n,e),Object(l.a)(n,[{key:"render",value:function(){var e=this.props,n=e.onClick,t=e.checked,r=e.label;return a.a.createElement(Fr.a,{button:!0,onClick:n},a.a.createElement(sa.a,{checked:t}),a.a.createElement(ca.a,null,r))}}]),n}(a.a.PureComponent),ua=function(e){function n(){return Object(s.a)(this,n),Object(u.a)(this,Object(m.a)(n).apply(this,arguments))}return Object(p.a)(n,e),Object(l.a)(n,[{key:"renderOptions",value:function(){for(var e=this,n=[],t=function(){var t=o[r],c=(i=Object(P.a)(t,2))[0],s=i[1];n.push(a.a.createElement(la,{key:c,onClick:function(){return e.props.onToggle(c)},checked:e.props.variables[c]>.5,label:s}))},r=0,o=Object.entries(this.props.options);r<o.length;r++){var i;t()}return n}},{key:"render",value:function(){return a.a.createElement(xr.a,{id:"options-panel"},a.a.createElement($r.a,{disableSticky:!0},this.props.heading),this.renderOptions())}}]),n}(a.a.PureComponent),ma="\\int_{\\gamma} f(z) \\, \\mathrm{d}z = ",pa=function(e){var n=e.x,t=e.y,r=e.style,o=a.a.createElement("div",{className:Object(jr.a)(ea||(ea=Object(Or.a)(["\n        color: hsl(0, 100%, 30%);\n        font-size: 18px;\n        padding: 8px 0;\n    "])))},"Custom functions are currently unsupported.");return isFinite(n)&&isFinite(t)&&(o=window.innerWidth<700?a.a.createElement("div",{className:Object(jr.a)(na||(na=Object(Or.a)(["\n            font-size: 16px;\n            color: hsl(213, 10%, 15%);\n\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n\n            margin: 5px 0;\n        "])))},a.a.createElement(lr.InlineMath,null,ma),a.a.createElement(lr.InlineMath,null,ur(n,t,3))):a.a.createElement("div",{className:Object(jr.a)(ta||(ta=Object(Or.a)(["\n            margin: -10px 0;\n            font-size: 20px;\n            color: hsl(213, 10%, 15%);\n        "])))},a.a.createElement(lr.BlockMath,null,ma+ur(n,t,5)))),a.a.createElement("div",{className:Object(jr.a)(ra||(ra=Object(Or.a)(["\n        background-color: white;\n        box-shadow: 3px 3px 8px hsla(213, 10%, 10%, 0.2);\n        border: 1px solid hsl(213, 10%, 85%);\n        border-radius: 8px;\n\n        padding: 0 15px;\n    "]))),style:r||{}},a.a.createElement("div",{className:"math"},o))},ha=function(){function e(n,t,r){Object(s.a)(this,e),this.mapping=n,this.canvas=t,this.dpr=r,this.initialize()}return Object(l.a)(e,[{key:"initialize",value:function(){this.canvas.strokeStyle="white",this.canvas.lineWidth=2*this.dpr}},{key:"update",value:function(e){var n=e.x,t=e.y,r=e.clientX,a=e.clientY;this.integrate(n,t),this.draw(r,a)}},{key:"finish",value:function(){}},{key:"integrate",value:function(e,n){}},{key:"draw",value:function(e,n){}},{key:"value",value:function(){return[0,0]}}]),e}();function fa(e,n){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return da(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return da(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw o}}}}function da(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var ba=[[.1894506104550685,.0950125098376374],[.1826034150449236,.2816035507792589],[.1691565193950025,.4580167776572274],[.1495959888165767,.6178762444026438],[.1246289712555339,.755404408355003],[.0951585116824928,.8656312023878318],[.0622535239386479,.9445750230732326],[.0271524594117541,.9894009349916499],[.1894506104550685,-.0950125098376374],[.1826034150449236,-.2816035507792589],[.1691565193950025,-.4580167776572274],[.1495959888165767,-.6178762444026438],[.1246289712555339,-.755404408355003],[.0951585116824928,-.8656312023878318],[.0622535239386479,-.9445750230732326],[.0271524594117541,-.9894009349916499]];function va(e,n,t){var r,a=n-e,o=[0,0],i=fa(ba);try{for(i.s();!(r=i.n()).done;){var c=r.value,s=Object(P.a)(c,2),l=s[0],u=s[1],m=t(e+.5*a*(1+u)),p=Object(P.a)(m,2),h=p[0],f=p[1];o[0]+=h*a*l/2,o[1]+=f*a*l/2}}catch(d){i.e(d)}finally{i.f()}return o}var ga=function(e){function n(){var e,t;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=Object(u.a)(this,(e=Object(m.a)(n)).call.apply(e,[this].concat(a)))).accumulator=[0,0],t.lastPoint=null,t.lastPagePoint=null,t}return Object(p.a)(n,e),Object(l.a)(n,[{key:"integrate",value:function(e,n){if(!Object(M.isNil)(this.lastPoint)){var t=function(e,n,t){var r=Object(P.a)(e,2),a=r[0],o=r[1],i=Object(P.a)(n,2),c=i[0],s=i[1],l=c-a,u=s-o,m=va(0,1,(function(e){return t([a+e*l,o+e*u])})),p=Object(P.a)(m,2),h=p[0],f=p[1];return[h*l-f*u,f*l+h*u]}(this.lastPoint,[e,n],this.mapping);this.accumulator[0]+=t[0],this.accumulator[1]+=t[1]}this.lastPoint=[e,n]}},{key:"draw",value:function(e,n){if(!Object(M.isNil)(this.lastPagePoint)){var t=Object(P.a)(this.lastPagePoint,2),r=t[0],a=t[1];this.canvas.beginPath(),this.canvas.moveTo(r,a),this.canvas.lineTo(e,n),this.canvas.stroke()}this.lastPagePoint=[e,n]}},{key:"value",value:function(){return this.accumulator}}]),n}(ha),ya=t(211);function wa(e,n){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return _a(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _a(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw o}}}}function _a(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function za(e){var n,t=0,r=0,a=wa(e);try{for(a.s();!(n=a.n()).done;){var o=n.value-r,i=t+o;r=i-t-o,t=i}}catch(c){a.e(c)}finally{a.f()}return t}var Ea={freeform:ga,"freeform-closed":function(e){function n(){var e,t;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=Object(u.a)(this,(e=Object(m.a)(n)).call.apply(e,[this].concat(a)))).startPoint=null,t.startPagePoint=null,t}return Object(p.a)(n,e),Object(l.a)(n,[{key:"integrate",value:function(e,t){Object(ya.a)(Object(m.a)(n.prototype),"integrate",this).call(this,e,t),Object(M.isNil)(this.startPoint)&&(this.startPoint=[e,t])}},{key:"draw",value:function(e,t){Object(ya.a)(Object(m.a)(n.prototype),"draw",this).call(this,e,t),Object(M.isNil)(this.startPagePoint)&&(this.startPagePoint=[e,t])}},{key:"finish",value:function(){if(!Object(M.isNil)(this.startPoint)&&!Object(M.isNil)(this.startPagePoint)){var e=Object(P.a)(this.startPoint,2),n=e[0],t=e[1],r=Object(P.a)(this.startPagePoint,2),a=r[0],o=r[1];this.update({x:n,y:t,clientX:a,clientY:o})}}}]),n}(ga),circle:function(e){function n(){var e,t;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=Object(u.a)(this,(e=Object(m.a)(n)).call.apply(e,[this].concat(a)))).center=null,t.radius=null,t.pageCenter=null,t.pageRadius=null,t}return Object(p.a)(n,e),Object(l.a)(n,[{key:"integrate",value:function(e,n){Object(M.isNil)(this.center)&&(this.center=[e,n]),this.radius=Math.hypot(e-this.center[0],n-this.center[1])}},{key:"draw",value:function(e,n){var t;Object(M.isNil)(this.pageCenter)&&(this.pageCenter=[e,n]),this.pageRadius=Math.hypot(e-this.pageCenter[0],n-this.pageCenter[1]),this.canvas.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.canvas.beginPath(),(t=this.canvas).arc.apply(t,Object(h.a)(this.pageCenter).concat([this.pageRadius,0,2*Math.PI])),this.canvas.stroke()}},{key:"value",value:function(){var e=this;if(Object(M.isNil)(this.center))return[0,0];for(var n=Object(P.a)(this.center,2),t=n[0],r=n[1],a=function(n){var a=e.mapping(function(n){return[t+e.radius*Math.cos(n),r+e.radius*Math.sin(n)]}(n)),o=Object(P.a)(a,2),i=o[0],c=o[1],s=function(n){return[-e.radius*Math.sin(n),e.radius*Math.cos(n)]}(n),l=Object(P.a)(s,2),u=l[0],m=l[1];return[i*u-c*m,i*m+c*u]},o=2*Math.PI/32,i=[[],[]],c=0;c<32;c++){var s=va(c*o,(c+1)*o,a),l=Object(P.a)(s,2),u=l[0],m=l[1];i[0].push(u),i[1].push(m)}return[za(i[0]),za(i[1])]}}]),n}(ha)},xa=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(u.a)(this,Object(m.a)(n).call(this,e))).state={done:!1,mouseDown:!1,mousePosition:null,strategy:null},t.canvas=a.a.createRef(),t}return Object(p.a)(n,e),Object(l.a)(n,[{key:"resizeCanvas",value:function(){var e=this.canvas.current,n=window.devicePixelRatio;e.width=e.offsetWidth*n,e.height=e.offsetHeight*n}},{key:"resetState",value:function(){this.state.done&&this.setState({done:!1,mousePosition:null,strategy:null})}},{key:"handleMouseDown",value:function(e){var n=this.props,t=n.integrator,r=n.expression,a=n.variables,o=n.onClose;if(this.state.done)o();else{var i=ke(r,a);this.resizeCanvas();var c=this.canvas.current.getContext("2d");c.clearRect(0,0,c.canvas.width,c.canvas.height),this.setState({mouseDown:!0,strategy:new Ea[t](i,c,window.devicePixelRatio)})}}},{key:"handleMouseMove",value:function(e){var n=this.state,t=n.strategy,r=n.mouseDown,a=this.props.variables;if(r){var o=e.clientX,i=e.clientY,c=br(o,i,a),s=Object(P.a)(c,2),l=s[0],u=s[1];if(this.setState({mousePosition:[o,i]}),!Object(M.isNil)(t)){var m=window.devicePixelRatio;t.update({x:l,y:u,clientX:o*m,clientY:i*m})}}}},{key:"handleMouseUp",value:function(e){this.state.strategy.finish(),this.setState({mouseDown:!1,done:!0})}},{key:"render",value:function(){var e=this,n=this.props.integrator,t=this.state,r=t.done,o=t.mouseDown,i=t.mousePosition,c=t.strategy;if(Object(M.isNil)(n))return this.resetState(),null;var s=null;if(!Object(M.isNil)(c)&&!Object(M.isNil)(i)){var l=c.value(),u=Object(P.a)(l,2),m=u[0],p=u[1],h=function(e){return Math.abs(e)<1e-10?0:e};s=a.a.createElement(pa,{x:h(m),y:h(p),style:{position:"absolute",top:i[1],left:i[0]-(window.innerWidth<700?80:0),zIndex:3}})}return a.a.createElement("div",{className:"integral container",onMouseDown:this.handleMouseDown.bind(this),onMouseMove:this.handleMouseMove.bind(this),onMouseUp:this.handleMouseUp.bind(this),onTouchStart:this.handleMouseDown.bind(this),onTouchMove:function(n){return e.handleMouseMove(n.touches[0])},onTouchEnd:this.handleMouseUp.bind(this)},a.a.createElement("canvas",{ref:this.canvas,className:"canvas"}),s,a.a.createElement("p",{className:"instructions"},"Click and drag to draw a contour"),a.a.createElement("style",null,"\n                .integral.container {\n                    position: absolute;\n\n                    top: 0;\n                    bottom: 0;\n                    left: 0;\n                    right: 0;\n\n                    z-index: 15;\n                    cursor: ".concat(r?"default":"crosshair",";\n\n                    overflow: hidden;\n\n                    background-color: hsla(213, 10%, 10%, 0.6);\n\n                    display: flex;\n                    flex-direction: row;\n                    align-items: center;\n                    justify-content: center;\n                }\n\n                .integral canvas.canvas {\n                    position: absolute;\n                    top: 0;\n                    left: 0;\n\n                    width: 100%;\n                    height: 100%;\n                    \n                    z-index: 1;\n                }\n\n                .integral .instructions {\n                    color: hsl(213, 10%, 85%);\n                    font-size: 20px;\n                    text-align: center;\n\n                    margin: 0;\n                    display: ").concat(o||r?"none":"block",";\n                    z-index: 2;\n                }\n            ")))}}]),n}(r.PureComponent),$a=t(588),Oa=t(269),ja=t.n(Oa),Pa=t(270),Ca=t.n(Pa),ka=t(271),Ta=t.n(ka),Fa=[{strategy:"freeform",label:"Freeform",icon:a.a.createElement(ja.a,null)},{strategy:"freeform-closed",label:"Freeform (Closed Loop)",icon:a.a.createElement(Ca.a,null)},{strategy:"circle",label:"Circular Contour",icon:a.a.createElement(Ta.a,null)}],Na=function(e){function n(){return Object(s.a)(this,n),Object(u.a)(this,Object(m.a)(n).apply(this,arguments))}return Object(p.a)(n,e),Object(l.a)(n,[{key:"renderIntegrator",value:function(e){var n=e.strategy,t=e.label,r=e.icon,o=this.props,i=o.hidePanels,c=o.openCalculator;return a.a.createElement(Fr.a,{button:!0,key:n,onClick:function(){window.innerWidth<700&&i(),c(null),setTimeout((function(){return c(n)}),0)}},a.a.createElement($a.a,null,r),a.a.createElement(ca.a,{style:{paddingLeft:0}},t))}},{key:"render",value:function(){return a.a.createElement(xr.a,null,a.a.createElement($r.a,{disableSticky:!0},"Contour Integrals"),Fa.map(this.renderIntegrator.bind(this)))}}]),n}(r.PureComponent),Ma=t(165),Sa=t(272),qa=t.n(Sa),Aa=t(209),Ia=(t(529),t(530),t(531),t(532),t(533),function(e){var n=e.value,t=e.onChange;e.errorMessage;return a.a.createElement("div",{id:"function-editor"},a.a.createElement(Ma.a,{variant:"caption"},"Please read the \u201cAdvanced Features\u201d documentation in the right pane before proceeding!",a.a.createElement("br",null),"Compilation errors are currently logged to the developer console."),a.a.createElement(qa.a,{value:n,onValueChange:t,highlight:function(e){var n=Object(Aa.highlight)(e,Aa.languages.glsl);return console.log(n),n},padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:14,backgroundColor:"hsl(200, 20%, 10%)",color:"white",marginTop:10,borderRadius:8}}),a.a.createElement(Ma.a,{className:"resize-helper",variant:"caption"},a.a.createElement("br",null),"This pane is resizable! Use the handle on the bottom-right corner."))}),Va=t(598),Ya=t(597),La=t(589),Ua=t(590),Ra=t(275),Da=t.n(Ra),Ba=t(596),Wa=t(273),Ha=t(591);t(534);function Ga(e,n){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return Ka(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ka(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw o}}}}function Ka(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}Ba.a.registerLanguage("glsl",Wa.a);var Xa=[{name:"Operators",entries:["+","-","*","/","^","!","%"]},{name:"Trigonometry",entries:["sin","cos","tan","sec","csc","cot","arcsin","arccos","arctan","arcsec","arccsc","arccot","sinh","cosh","tanh","sech","csch","coth","arsinh","arcosh","artanh","arsech","arcsch","arcoth"]},{name:"Exponential",entries:["exp","log","ln"]},{name:"Constants",entries:["e","pi","phi","tau"]},{name:"Elliptic/Modular",entries:["nome","sn(z, k)","cn(z, k)","dn(z, k)","wp(z, \u03c4)","wp'(z, \u03c4)","sm","cm","theta00(z, \u03c4)","theta01(z, \u03c4)","theta10(z, \u03c4)","theta11(z, \u03c4)","j(\u03c4)","E4(\u03c4)","E6(\u03c4)","E8(\u03c4)","E10(\u03c4)","E12(\u03c4)","E14(\u03c4)","E16(\u03c4)"]},{name:"Special Functions",entries:["sqrt","gamma","beta","binomial","eta","zeta","erf","lambertw"]},{name:"Miscellaneous",entries:["abs","arg","sgn","cis","conj","real","imag","floor","ceil","round","step"]},{name:"Higher-Order Functions",entries:["sum","product","derivative"]}],Za={"+":"z + t","-":"z - t","*":"t * z","/":"1/z","^":"z^z^z^z^z^z^z","!":"z!","%":"z % (1+t*i)",e:null,pi:null,tau:null,phi:null,beta:"beta(z, 3)",binomial:"binom(z, 5)",nome:"j(nome(z))","sn(z, k)":"sn(z, t + i)","cn(z, k)":"cn(z, t + i)","dn(z, k)":"dn(z, t + i)","wp(z, \u03c4)":"wp(z, t + i)","wp'(z, \u03c4)":"wp'(z, t + i)","theta00(z, \u03c4)":"theta00(z, t + i)","theta01(z, \u03c4)":"theta01(z, t + i)","theta10(z, \u03c4)":"theta10(z, t + i)","theta11(z, \u03c4)":"theta11(z, t + i)","j(\u03c4)":"j(z)","E4(\u03c4)":"e4(z)","E6(\u03c4)":"e6(z)","E8(\u03c4)":"e8(z)","E10(\u03c4)":"e10(z)","E12(\u03c4)":"e12(z)","E14(\u03c4)":"e14(z)","E16(\u03c4)":"e16(z)",sum:"sum(z^n/n!, n, 0, 5)",product:"prod(1-z/n, n, 1, 5)",derivative:"diff(cos(z*t), t)"},Ja=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(u.a)(this,Object(m.a)(n).call(this,e))).classes=e.classes,t}return Object(p.a)(n,e),Object(l.a)(n,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"renderChips",value:function(e){var n=this,t=this.props,r=t.setExpression,o=t.closeMenu;return e.map((function(e){return a.a.createElement(Va.a,{key:e,label:e,onClick:null===Za[e]?void 0:function(){window.innerWidth<=900&&o(),function(e){r(Za[e]||"".concat(e,"(z)"))}(e)},className:n.classes.chip})}))}},{key:"renderSupportedFunctions",value:function(){var e,n=[],t=Ga(Xa);try{for(t.s();!(e=t.n()).done;){var r=e.value;n.push(a.a.createElement("div",{key:r.name},a.a.createElement("h3",null,r.name),this.renderChips(r.entries)))}}catch(o){t.e(o)}finally{t.f()}return n}},{key:"render",value:function(){return a.a.createElement("div",{id:"help-text"},a.a.createElement("h1",null,a.a.createElement("img",{src:"android-chrome-192x192.png",className:"logo",alt:"logo"}),a.a.createElement("div",{className:"text"},"Complex Function Plotter",a.a.createElement("div",{className:"subtitle"},"Made with ","<3"," by Samuel J. Li"))),a.a.createElement("h2",null,"Introduction"),a.a.createElement("p",null,"Creates interactive domain-coloring plots of complex functions."),a.a.createElement("p",null,"Each point on the complex plane is colored according to the value of the function at that point. Hue and brightness are used to display phase and magnitude, respectively."),a.a.createElement("p",null,"To increase the displayable range of values, brightness cycles from dark to light repeatedly with magnitude, jumping at every power of two. The \u201cedges\u201d of regions with different brightness correspond to curves along which the function has constant magnitude."),a.a.createElement("p",null,"This method allows for quick visualization of the locations and orders of any poles and zeros. For more information, see the ",a.a.createElement("a",{href:"https://en.wikipedia.org/wiki/Domain_coloring"},"Wikipedia article on domain coloring.")),a.a.createElement("h2",null,"Controls"),a.a.createElement("p",null,"To plot a complex function, enter its expression in the top bar. Parentheses (curved or square), complex number literals, and arbitrary variables (see \u201cVariables\u201d below) are supported. Input is case-insensitive."),a.a.createElement("p",null,"A red underline will appear if the expression cannot be plotted. You might have made a syntax error or forgot to declare a variable."),a.a.createElement("p",null,"Drag the plot to pan, and use the scroll wheel to zoom in and out."),a.a.createElement("h2",null,"Supported Functions"),a.a.createElement("p",{style:{marginBottom:8}},"Click on any function to see an example."),a.a.createElement("div",{className:"help-indent"},a.a.createElement(Ma.a,{variant:"caption"},"Don\u2019t see what you want? ",a.a.createElement("a",{href:"mailto:contact@samuelj.li"},"Request a function")),this.renderSupportedFunctions(),a.a.createElement("p",{style:{marginTop:16}}),a.a.createElement(Ma.a,{variant:"caption"},"Warning: Large sums or products may cause the plotter to freeze!")),a.a.createElement("h2",null,"Variables"),a.a.createElement("p",null,"Expressions can contain arbitrary user-defined variables."),a.a.createElement("p",null,"Click on the ",a.a.createElement(O.a,{style:{fontSize:20,marginBottom:-5}})," icon in the upper-left corner to open the variables panel. Variables can be added with the ",a.a.createElement("span",{className:this.classes.buttonStyle},"Add")," button and removed with the ",a.a.createElement(Ar.a,{style:{fontSize:20,marginBottom:-5}})," button."),a.a.createElement("p",null,"Click on the variable\u2019s current value or the slider\u2019s upper & lower bounds to edit them."),a.a.createElement("p",null,"Any string of lowercase letters can be used as a variable name, except for reserved functions, the built-in variable ",a.a.createElement("i",null,"z"),", and the constant ",a.a.createElement("i",null,"i"),"."),a.a.createElement("h2",null,"Contour Integrals"),a.a.createElement("p",null,"The calculator is able to compute arbitrary contour integrals and residues. The following options are available under the \u2018Contour Integral\u2019 section of the left pane:"),a.a.createElement("div",{className:"help-indent"},a.a.createElement("h3",null,"Freeform"),a.a.createElement("p",null,"After selecting this option, click and drag to draw an arbitrary contour. The integral of the currently plotted function along the given contour will be displayed."),a.a.createElement("h3",null,"Freeform (Closed Loop)"),a.a.createElement("p",null,"Same as \u2018Freeform,\u2019 except that the contour is closed with a line segment connecting the start and end points after it is drawn."),a.a.createElement("h3",null,"Circular Contour"),a.a.createElement("p",null,"After selecting this option, click and drag to draw a circular contour. The integral of the currently plotted function along the given circle (with counterclockwise orientation) will be displayed.")),a.a.createElement("p",null,"Note that custom functions and some of the more intricate built-in functions are not yet supported. The computed values are generally accurate to the displayed precision unless the function is highly pathological."),a.a.createElement("h2",null,"Graphics Options"),a.a.createElement("p",null,"The following options can be found below the variables panel:"),a.a.createElement("div",{className:"help-indent"},a.a.createElement("h3",null,"Enable Checkerboard"),a.a.createElement("p",null,"Overlays a checkerboard with eight squares per unit length, colored according to the real and imaginary parts of the function\u2019s value."),a.a.createElement("h3",null,"Invert Gradient"),a.a.createElement("p",null,"Reverses the direction of the magnitude gradient. When the gradient is inverted, the apparent height of the \u201clayers\u201d formed correlate with the magnitude of the function."),a.a.createElement("h3",null,"Continuous Gradient"),a.a.createElement("p",null,"Use a continuous magnitude gradient rather than the \u201cstepped\u201d default. Reduces the range of visually discernible magnitudes, but removes shading artifacts in certain situations."),a.a.createElement("h3",null,"Enable Axes"),a.a.createElement("p",null,"Overlay coordinate axes and gridlines on the plot. May decrease performance on some devices.")),a.a.createElement("h2",null,"Tips"),a.a.createElement("p",null,"To share a graph, just copy and paste the URL! The address automatically changes to reflect the plotted expression."),a.a.createElement("h2",null,"Advanced Features"),a.a.createElement(Ya.a,{style:{margin:"0 -5px"}},a.a.createElement(La.a,{expandIcon:a.a.createElement(Da.a,null)},a.a.createElement(Ma.a,{variant:"caption"},"Please read thoroughly iff you are using advanced options.")),a.a.createElement(Ua.a,null,a.a.createElement("div",null,a.a.createElement("h3",null,"Custom Functions"),a.a.createElement("p",null,"This option can be found under the \u201cAdvanced Options\u201d heading in the left pane. Overrides the main expression bar, allowing you to code your own function."),a.a.createElement("p",null,"Custom functions use the ",a.a.createElement("a",{href:"https://en.wikipedia.org/wiki/OpenGL_Shading_Language"},"GLSL")," programming language. If you've never worked with GLSL before, it's extremely similar to C. Here are a few tips and caveats:"),a.a.createElement("ul",null,a.a.createElement("li",null,"Complex numbers are represented by the ",a.a.createElement("tt",null,"vec2")," type, which represents a 2D vector. The real part can be accessed through ",a.a.createElement("tt",null,"z.x")," and the imaginary part by ",a.a.createElement("tt",null,"z.y"),"."),a.a.createElement("li",null,"Your custom function should be named ",a.a.createElement("tt",null,"mapping"),", and should take one input of type ",a.a.createElement("tt",null,"vec2")," and return an output of type ",a.a.createElement("tt",null,"vec2"),"."),a.a.createElement("li",null,"Complex number literals ",a.a.createElement("i",null,"a+bi")," should be entered as ",a.a.createElement("tt",null,"vec2(a, b)"),", even if they are real. GLSL doesn\u2019t support addition or subtraction between the \u201ccomplex\u201d ",a.a.createElement("tt",null,"vec2")," type and floats. Scalar multiplication should work fine with floats, however. For convenience, there are constants ",a.a.createElement("tt",null,"ONE")," and ",a.a.createElement("tt",null,"I")," available."),a.a.createElement("li",null,"Addition and subtraction operators (",a.a.createElement("tt",null,"+")," and ",a.a.createElement("tt",null,"-"),") work fine between ",a.a.createElement("tt",null,"vec2")," complex numbers. However, multiplication, division, and exponentiation operators act component-wise on the real and imaginary parts, which is probably not what you want. There are ",a.a.createElement("tt",null,"cmul"),", ",a.a.createElement("tt",null,"cdiv"),", and ",a.a.createElement("tt",null,"cpow")," functions available which will perform the proper complex operation."),a.a.createElement("li",null,"All supported functions are available, but with a ",a.a.createElement("tt",null,"c")," prefix. For example, the sin function is named ",a.a.createElement("tt",null,"csin"),". This is to avoid clashing with the built-in (real-valued) GLSL functions."),a.a.createElement("li",null,"Constants are available in uppercase with a ",a.a.createElement("tt",null,"C_")," prefix (e.g. ",a.a.createElement("tt",null,"C_PI"),"), and are already in complex ",a.a.createElement("tt",null,"vec2")," form.")),a.a.createElement("h3",null,"Limitations"),a.a.createElement("p",null,"There are currently a few limitations with the custom function feature which I hope to resolve soon:"),a.a.createElement("ul",null,a.a.createElement("li",null,"URL-based sharing doesn\u2019t currently work for custom functions. You may share the code directly instead."),a.a.createElement("li",null,"The editor will show a red underline if your code fails to compile, but currently does not show useful error information. For now, this information is visible in the developer console."),a.a.createElement("li",null,a.a.createElement("i",null,"(Thanks to Tim N. for pointing this out.)")," Due to low-level limitations of GLSL, variable-length loops such as the following do not work:",a.a.createElement(Ba.a,{language:"glsl",style:Ha.a},"for (int i=0; i<x; i++) {\n    // do stuff\n}"),"The following workaround is available:",a.a.createElement(Ba.a,{language:"glsl",style:Ha.a},"for (int i=0; i<1000; i++) {\n    if (i<x) {\n        // do stuff\n    }\n}"),"This effectively requires setting an arbitrary but finite limit on the number of iterations you wish to do; however, this may be acceptable in several applications. Note that the loop will be unrolled during compilation, so setting an excessively high limit will lead to poor performance.")),a.a.createElement("h3",null,"Tips"),a.a.createElement("p",null,"Most desktop browsers will display a small resize handle at the bottom-right corner of the left pane. This can be very useful when working on complex code."),a.a.createElement("p",null,"You can define arbitrary helper functions before your ",a.a.createElement("tt",null,"mapping")," function \u2014 you have the full power of GLSL!"),a.a.createElement("p",null,a.a.createElement("b",null,"You can use all your declared variables")," directly in your code! They\u2019ve already been converted into complex ",a.a.createElement("tt",null,"vec2")," form."),a.a.createElement("h3",null,"Obligatory Warning"),a.a.createElement("p",null,"This is an advanced feature \u2014 you may break things! If anything freezes or crashes, a quick reload should resolve the issue (save your code first)!")))),a.a.createElement("h2",null,"Citations"),a.a.createElement("p",null,"If you use this tool to produce images for a publication, I would greatly appreciate a citation! Something along the lines of:"),a.a.createElement("ul",null,a.a.createElement("li",null,"Li, Samuel Jinglian, 2018. \u201cComplex Function Plotter.\u201d ",a.a.createElement("a",{href:"https://samuelj.li/complex-function-plotter/"},"https://samuelj.li/complex-function-plotter/"),".")),a.a.createElement("p",null,"or the equivalent in your journal's citation style is enough."),a.a.createElement("h2",null,"Acknowledgements"),a.a.createElement("ul",null,a.a.createElement("li",null,"Inspired by David Bau\u2019s ",a.a.createElement("a",{href:"http://davidbau.com/conformal"},"Conformal Map Plotter"),"."),a.a.createElement("li",null,"Thanks to Tim N. for helping improve the custom function documentation for variable-length loops."),a.a.createElement("li",null,"Thanks to Liu Yi (Ireis, CAS) for requesting the implementation of elliptic functions."),a.a.createElement("li",null,"Thanks to Jason Poulin for requesting variable animation support and other improvements."),a.a.createElement("li",null,"Thanks to Marius Sarbach for requesting the coordinate axis overlay."),a.a.createElement("li",null,"Thanks to Ryan Solecki for requesting the sum, product, and derivative features."),a.a.createElement("li",null,"Thanks to Gabriele D'Urso and Ryan Solecki for requesting the product log (Lambert W) function.")),a.a.createElement(Ma.a,{variant:"caption"},"Complex Function Plotter \u2014 Made with love by Samuel J. Li"),a.a.createElement("br",null),a.a.createElement(Ma.a,{variant:"caption"},a.a.createElement("a",{href:"https://github.com/wgxli/complex-function-plotter"},"View the source")," on GitHub"),a.a.createElement("br",null),a.a.createElement(Ma.a,{variant:"caption"},"Found a bug? \u2014 ",a.a.createElement("a",{href:"mailto:bug.report@samuelj.li"},"bug.report@samuelj.li")))}}]),n}(a.a.Component),Qa=yr()((function(e){return{buttonStyle:Object(i.a)({},e.typography.button),chip:{margin:3}}}))(Ja);function eo(e,n){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return no(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return no(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw o}}}}function no(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var to="vec2 mapping(vec2 z) {\n  z += t;\n  vec2 c = z;\n  for (int i=0; i<64; i++) {\n    z = cmul(z, z) + c;\n  }\n  return z;\n}";var ro=function(e){function n(){var e,t;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=Object(u.a)(this,(e=Object(m.a)(n)).call.apply(e,[this].concat(a)))).state={expressionText:"z-t",expression:["sub",["variable","z"],["variable","t"]],expressionError:!1,typingTimer:null,customShader:to,shaderError:!1,menuOpen:!1,helpOpen:!1,variableChanging:!1,integrationStrategy:null,variables:{log_scale:5,center_x:0,center_y:0,t:.3,enable_checkerboard:1,invert_gradient:0,continuous_gradient:0,enable_axes:1,custom_function:0}},t}return Object(p.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("hashchange",this.handleHashChange.bind(this)),document.addEventListener("gesturestart",(function(n){return e.preventDefault(n)}),{passive:!1}),document.addEventListener("touchmove",(function(n){return e.preventDefault(n)}),{passive:!1}),this.handleHashChange()}},{key:"preventDefault",value:function(e){if("canvas"!==e.target.tagName.toLowerCase())return e;e.preventDefault()}},{key:"handleMenuButton",value:function(){this.setState({menuOpen:!this.state.menuOpen})}},{key:"handleHelpButton",value:function(){this.setState({helpOpen:!this.state.helpOpen})}},{key:"handleVariableUpdate",value:function(e){this.refs.plot.handleVariableUpdate(e)}},{key:"handleVariableAdd",value:function(e,n){var t=this.state.variables;t[e]=n,this.setState({variables:t})}},{key:"handleVariableRemove",value:function(e){var n=this.state.variables;delete n[e],this.setState({variables:n})}},{key:"handleOptionToggle",value:function(e){var n=this.state.variables;n[e]=n[e]<.5?1:0,this.handleVariableUpdate(Object(c.a)({},e,n[e])),this.setState({variables:n})}},{key:"setErrorMessage",value:function(e){var n=this.state,t=n.variables,r=n.expressionError,a=n.shaderError;t.custom_function>.5?e!==a&&this.setState({shaderError:e}):e!==r&&this.setState({expressionError:e})}},{key:"handleHashChange",value:function(){var e=window.location.hash;""===e?this.setExpression("z-t",!0):this.setExpression(decodeURIComponent(e.slice(1)),!0)}},{key:"setExpression",value:function(e,n){if(e=e.toLowerCase(),window.history.replaceState(void 0,void 0,"#"+encodeURIComponent(e)),this.setState({expressionText:e,integrationStrategy:null}),n){var t,r=Zt(e.trim()),a=function e(n){if(!Array.isArray(n))return new Set;if("variable"===n[0]&&"z"!==n[1])return new Set([n[1]]);var t,r=new Set,a=eo(n);try{for(a.s();!(t=a.n()).done;){var o=t.value;r=new Set([].concat(Object(h.a)(r),Object(h.a)(e(o))))}}catch(i){a.e(i)}finally{a.f()}return r}(r),o=Object(i.a)({},this.state.variables),c=eo(a);try{for(c.s();!(t=c.n()).done;){o[t.value]=.3}}catch(s){c.e(s)}finally{c.f()}this.setState({expression:r,variables:o})}else clearTimeout(this.typingTimer),this.typingTimer=setTimeout(this.finalizeExpression.bind(this),100)}},{key:"finalizeExpression",value:function(){var e=Zt(this.state.expressionText.trim());this.setState({expression:e})}},{key:"setCustomShader",value:function(e){this.setState({customShader:e})}},{key:"renderFunctionEditor",value:function(){var e=this.state,n=e.variables,t=e.customShader,r=e.shaderError;return n.custom_function>.5?a.a.createElement(Ia,{onChange:this.setCustomShader.bind(this),errorMessage:r,value:t}):void 0}},{key:"render",value:function(){var e=this,n=this.state,t=n.variables,r=n.customShader,o=n.expression,c=n.expressionText,s=n.menuOpen,l=n.helpOpen,u=n.expressionError,m=n.integrationStrategy,p=n.variableChanging,h=t.custom_function>.5,d=h?r:o;return a.a.createElement(f.a,{theme:y},a.a.createElement("div",{id:"app"},a.a.createElement(j,{menuOpen:s,helpOpen:l,onMenuButton:this.handleMenuButton.bind(this),onHelpButton:this.handleHelpButton.bind(this),onChange:this.setExpression.bind(this),value:c,error:u,disabled:h}),a.a.createElement(Er,{className:"control-panel ".concat(p?"changing":""),open:s,onToggle:this.handleMenuButton.bind(this),anchor:"left",transitionWidth:480},a.a.createElement(ia,{variables:t,onUpdate:this.handleVariableUpdate.bind(this),onAdd:this.handleVariableAdd.bind(this),onRemove:this.handleVariableRemove.bind(this),setChanging:function(n){return e.setState({variableChanging:n})}}),a.a.createElement(Na,{variables:t,hidePanels:function(){return e.setState({helpOpen:!1,menuOpen:!1})},openCalculator:function(n){return e.setState({integrationStrategy:n})}}),a.a.createElement(ua,{heading:"Graphics Options",options:{enable_checkerboard:"Enable Checkerboard",invert_gradient:"Invert Gradient",continuous_gradient:"Continuous Gradient",enable_axes:"Enable Axes"},onToggle:this.handleOptionToggle.bind(this),variables:t}),a.a.createElement(ua,{heading:"Advanced Options",options:{custom_function:"Custom Function"},onToggle:this.handleOptionToggle.bind(this),variables:t}),this.renderFunctionEditor()),a.a.createElement(xa,{expression:d,variables:t,integrator:m,onClose:function(){return e.setState({integrationStrategy:null})}}),a.a.createElement(vr,{ref:"plot",expression:d,variables:t,onError:this.setErrorMessage.bind(this)}),a.a.createElement(Er,{className:"help-panel",open:l,anchor:"right",onToggle:this.handleHelpButton.bind(this),transitionWidth:900},a.a.createElement(Qa,{setExpression:function(n){e.setExpression(n),e.handleVariableUpdate(Object(i.a)({},e.state.variables,{custom_function:0}))},closeMenu:function(){return e.setState({helpOpen:!1})}}))))}}]),n}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(o.render)(a.a.createElement(ro,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[284,1,2]]]);
//# sourceMappingURL=main.9a3ec522.chunk.js.map